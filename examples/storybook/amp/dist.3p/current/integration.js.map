{
  "version": 3,
  "sources": ["../../src/polyfills/math-sign.js", "../../src/polyfills/object-assign.js", "../../src/polyfills/object-values.js", "../../node_modules/promise-pjs/promise.mjs", "../../src/polyfills/promise.js", "../../src/polyfills/string-starts-with.js", "../../3p/polyfills.js", "../../src/core/constants/amp-events.js", "../../src/core/data-structures/promise.js", "../../src/core/types/array.js", "../../src/core/types/enum.js", "../../src/core/types/string/index.js", "../../src/core/types/object/index.js", "../../src/core/types/index.js", "../../src/core/error/message-helpers.js", "../../src/core/assert/base.js", "../../src/core/error/index.js", "../../src/internal-version.js", "../../src/core/types/string/url.js", "../../src/mode.js", "../../src/core/types/function/index.js", "../../src/config.js", "../../src/log.js", "../../src/core/dom/event-helper-listen.js", "../../src/core/types/object/json.js", "../../src/3p-frame-messaging.js", "../../src/core/data-structures/observable.js", "../../third_party/css-escape/css-escape.js", "../../src/event-helper.js", "../../3p/iframe-messaging-client.js", "../../src/core/data-structures/lru-cache.js", "../../src/url.js", "../../3p/ampcontext.js", "../../3p/3p.js", "../../3p/ampcontext-integration.js", "../../3p/frame-metadata.js", "../../3p/messaging.js", "../../3p/environment.js", "../../3p/integration-lib.js", "../../src/style.js", "../../3p/beopinion.js", "../../3p/bodymovinanimation.js", "../../3p/embedly.js", "../../3p/facebook.js", "../../3p/github.js", "../../3p/3d-gltf/animation-loop.js", "../../3p/3d-gltf/viewer.js", "../../3p/3d-gltf/index.js", "../../3p/mathml.js", "../../3p/reddit.js", "../../3p/twitter.js", "../../3p/viqeoplayer.js", "../../3p/yotpo.js", "../../ads/vendors/_ping_.js", "../../ads/vendors/1wo.js", "../../ads/vendors/24smi.js", "../../ads/vendors/a8.js", "../../ads/vendors/a9.js", "../../ads/vendors/accesstrade.js", "../../ads/vendors/adagio.js", "../../ads/vendors/adblade.js", "../../ads/vendors/adbutler.js", "../../ads/vendors/adform.js", "../../ads/vendors/yandex.js", "../../ads/vendors/adfox.js", "../../ads/vendors/adgeneration.js", "../../ads/vendors/adglare.js", "../../ads/vendors/adhese.js", "../../ads/vendors/adincube.js", "../../ads/vendors/adition.js", "../../ads/vendors/adman.js", "../../ads/vendors/admanmedia.js", "../../ads/vendors/admixer.js", "../../ads/vendors/adnuntius.js", "../../src/core/constants/consent-state.js", "../../ads/vendors/adocean.js", "../../ads/vendors/adop.js", "../../ads/vendors/adpicker.js", "../../ads/vendors/adplugg.js", "../../ads/vendors/adpon.js", "../../ads/vendors/adpushup.js", "../../ads/vendors/adreactor.js", "../../ads/vendors/adsensor.js", "../../ads/vendors/adservsolutions.js", "../../ads/vendors/adsloom.js", "../../ads/vendors/adsnative.js", "../../ads/vendors/adspeed.js", "../../ads/vendors/adspirit.js", "../../ads/vendors/adstir.js", "../../ads/vendors/adstyle.js", "../../ads/vendors/adtech.js", "../../ads/vendors/adtelligent.js", "../../ads/vendors/adthrive.js", "../../ads/vendors/adunity.js", "../../ads/vendors/aduptech.js", "../../ads/vendors/adventive.js", "../../ads/vendors/adverline.js", "../../ads/vendors/adverticum.js", "../../ads/vendors/advertserve.js", "../../ads/vendors/adyoulike.js", "../../ads/vendors/affiliateb.js", "../../ads/vendors/aja.js", "../../ads/vendors/amoad.js", "../../ads/vendors/aniview.js", "../../ads/vendors/anyclip.js", "../../ads/vendors/appnexus.js", "../../ads/vendors/appvador.js", "../../ads/vendors/atomx.js", "../../ads/vendors/baidu.js", "../../ads/vendors/beaverads.js", "../../ads/vendors/bidtellect.js", "../../ads/vendors/blade.js", "../../ads/vendors/brainy.js", "../../ads/vendors/bringhub.js", "../../ads/vendors/broadstreetads.js", "../../ads/vendors/byplay.js", "../../ads/vendors/caajainfeed.js", "../../ads/vendors/capirs.js", "../../ads/vendors/caprofitx.js", "../../ads/vendors/cedato.js", "../../ads/vendors/nws.js", "../../ads/vendors/colombia.js", "../../ads/vendors/conative.js", "../../ads/vendors/connatix.js", "../../ads/vendors/contentad.js", "../../ads/vendors/criteo.js", "../../ads/vendors/csa.js", "../../ads/vendors/dable.js", "../../ads/vendors/digiteka.js", "../../ads/vendors/directadvert.js", "../../ads/vendors/distroscale.js", "../../ads/vendors/dotandads.js", "../../ads/vendors/dynad.js", "../../ads/vendors/eadv.js", "../../ads/vendors/empower.js", "../../ads/vendors/engageya.js", "../../ads/vendors/epeex.js", "../../ads/vendors/eplanning.js", "../../ads/vendors/ezoic.js", "../../ads/vendors/f1e.js", "../../ads/vendors/f1h.js", "../../ads/vendors/_fakedelayed_.js", "../../ads/vendors/feedad.js", "../../ads/vendors/felmat.js", "../../ads/vendors/finative.js", "../../ads/vendors/firstimpression.js", "../../ads/vendors/flite.js", "../../ads/vendors/fluct.js", "../../ads/vendors/forkmedia.js", "../../ads/vendors/freewheel.js", "../../ads/vendors/fusion.js", "../../ads/vendors/genieessp.js", "../../ads/vendors/giraff.js", "../../ads/vendors/glomex.js", "../../ads/vendors/gmossp.js", "../../ads/vendors/gumgum.js", "../../ads/vendors/holder.js", "../../ads/vendors/ibillboard.js", "../../ads/vendors/idealmedia.js", "../../ads/google/ima/ima-player-data.js", "../../src/static-template.js", "../../build/amp-ima-video-iframe.css.js", "../../ads/google/ima/ima-video.js", "../../ads/vendors/imedia.js", "../../ads/vendors/imobile.js", "../../ads/google/doubleclick.js", "../../ads/vendors/imonomy.js", "../../ads/vendors/improvedigital.js", "../../ads/vendors/inmobi.js", "../../ads/vendors/innity.js", "../../ads/vendors/insticator.js", "../../ads/vendors/invibes.js", "../../ads/vendors/iprom.js", "../../ads/vendors/ix.js", "../../ads/vendors/jubna.js", "../../ads/vendors/kargo.js", "../../ads/vendors/ketshwa.js", "../../ads/vendors/kiosked.js", "../../ads/vendors/kixer.js", "../../ads/vendors/kuadio.js", "../../ads/vendors/lentainform.js", "../../ads/vendors/ligatus.js", "../../ads/vendors/lockerdome.js", "../../ads/vendors/logly.js", "../../ads/vendors/loka.js", "../../ads/vendors/luckyads.js", "../../ads/vendors/macaw.js", "../../ads/vendors/mads.js", "../../ads/vendors/mantis.js", "../../ads/vendors/marfeel.js", "../../ads/vendors/mediaad.js", "../../ads/vendors/medianet.js", "../../ads/vendors/mediavine.js", "../../ads/vendors/medyanet.js", "../../ads/vendors/meg.js", "../../ads/vendors/mgid.js", "../../ads/vendors/microad.js", "../../ads/vendors/miximedia.js", "../../ads/vendors/mixpo.js", "../../ads/vendors/monetizer101.js", "../../ads/vendors/mox.js", "../../ads/vendors/my6sense.js", "../../ads/vendors/myfinance.js", "../../ads/vendors/myoffrz.js", "../../ads/vendors/mytarget.js", "../../ads/vendors/mywidget.js", "../../ads/vendors/nativeroll.js", "../../ads/vendors/nativery.js", "../../ads/vendors/nativo.js", "../../ads/vendors/navegg.js", "../../ads/vendors/nend.js", "../../ads/vendors/netletix.js", "../../ads/vendors/noddus.js", "../../ads/vendors/nokta.js", "../../ads/vendors/oblivki.js", "../../ads/vendors/onead.js", "../../ads/vendors/onnetwork.js", "../../ads/vendors/openadstream.js", "../../ads/vendors/openx.js", "../../ads/vendors/opinary.js", "../../ads/vendors/outbrain.js", "../../ads/vendors/pixels.js", "../../ads/vendors/playstream.js", "../../ads/vendors/plista.js", "../../ads/vendors/polymorphicads.js", "../../ads/vendors/popin.js", "../../ads/vendors/postquare.js", "../../ads/vendors/ppstudio.js", "../../ads/vendors/pressboard.js", "../../ads/vendors/promoteiq.js", "../../ads/vendors/pubexchange.js", "../../ads/vendors/pubguru.js", "../../ads/vendors/pubmatic.js", "../../ads/vendors/pubmine.js", "../../ads/vendors/puffnetwork.js", "../../ads/vendors/pulse.js", "../../ads/vendors/pulsepoint.js", "../../ads/vendors/purch.js", "../../ads/vendors/quoraad.js", "../../ads/vendors/rakutenunifiedads.js", "../../ads/vendors/rbinfox.js", "../../ads/vendors/rcmwidget.js", "../../ads/vendors/readmo.js", "../../ads/vendors/realclick.js", "../../ads/vendors/recomad.js", "../../ads/vendors/recreativ.js", "../../ads/vendors/relap.js", "../../ads/vendors/relappro.js", "../../ads/vendors/remixd.js", "../../ads/vendors/revcontent.js", "../../ads/vendors/revjet.js", "../../ads/vendors/rfp.js", "../../ads/vendors/rnetplus.js", "../../ads/vendors/rubicon.js", "../../ads/vendors/runative.js", "../../ads/google/a4a/shared/content-recommendation.js", "../../ads/google/utils.js", "../../ads/vendors/sas.js", "../../ads/vendors/seedingalliance.js", "../../ads/vendors/sekindo.js", "../../ads/vendors/sharethrough.js", "../../ads/vendors/shemedia.js", "../../ads/vendors/sklik.js", "../../ads/vendors/slimcutmedia.js", "../../ads/vendors/smartadserver.js", "../../ads/vendors/smartclip.js", "../../ads/vendors/smi2.js", "../../ads/vendors/smilewanted.js", "../../ads/vendors/sogouad.js", "../../ads/vendors/sona.js", "../../ads/vendors/sortable.js", "../../ads/vendors/sovrn.js", "../../ads/vendors/speakol.js", "../../ads/vendors/spotx.js", "../../ads/vendors/springAds.js", "../../ads/vendors/ssp.js", "../../ads/vendors/strossle.js", "../../ads/vendors/sulvo.js", "../../ads/vendors/sunmedia.js", "../../ads/vendors/svknative.js", "../../ads/vendors/swoop.js", "../../ads/vendors/taboola.js", "../../ads/vendors/tail.js", "../../ads/vendors/tcsemotion.js", "../../ads/vendors/teads.js", "../../ads/vendors/temedya.js", "../../ads/vendors/torimochi.js", "../../ads/vendors/tracdelight.js", "../../ads/vendors/triplelift.js", "../../ads/vendors/trugaze.js", "../../ads/vendors/uas.js", "../../ads/vendors/ucfunnel.js", "../../ads/vendors/unruly.js", "../../ads/vendors/uzou.js", "../../ads/vendors/valuecommerce.js", "../../ads/vendors/vdoai.js", "../../ads/vendors/verizonmedia.js", "../../ads/vendors/videointelligence.js", "../../ads/vendors/videonow.js", "../../ads/vendors/viralize.js", "../../ads/vendors/vlyby.js", "../../ads/vendors/vmfive.js", "../../ads/vendors/webediads.js", "../../ads/vendors/weborama.js", "../../ads/vendors/whopainfeed.js", "../../ads/vendors/widespace.js", "../../ads/vendors/wisteria.js", "../../ads/vendors/wpmedia.js", "../../ads/vendors/xlift.js", "../../ads/vendors/yahoo.js", "../../ads/vendors/yahoofedads.js", "../../ads/vendors/yahoojp.js", "../../ads/vendors/yahoonativeads.js", "../../ads/vendors/yektanet.js", "../../ads/vendors/yengo.js", "../../ads/vendors/yieldbot.js", "../../ads/vendors/yieldmo.js", "../../ads/vendors/yieldone.js", "../../ads/vendors/yieldpro.js", "../../ads/vendors/zedo.js", "../../ads/vendors/zen.js", "../../ads/vendors/zergnet.js", "../../ads/vendors/zucks.js", "../../3p/integration.js"],
  "sourcesContent": ["/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Parses the number x and returns its sign. For positive x returns 1, for\n * negative, -1. For 0 and -0, returns 0 and -0 respectively. For any number\n * that parses to NaN, returns NaN.\n *\n * @param {number} x\n * @return {number}\n */\nexport function sign(x) {\n  x = Number(x);\n\n  // If x is 0, -0, or NaN, return it.\n  if (!x) {\n    return x;\n  }\n\n  return x > 0 ? 1 : -1;\n}\n\n/**\n * Sets the Math.sign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Math.sign) {\n    win.Object.defineProperty(win.Math, 'sign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: sign,\n    });\n  }\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Copies values of all enumerable own properties from one or more source\n * objects (provided as extended arguments to the function) to a target object.\n *\n * @param {!Object} target\n * @param {...Object} var_args\n * @return {!Object}\n */\nexport function assign(target, var_args) {\n  if (target == null) {\n    throw new TypeError('Cannot convert undefined or null to object');\n  }\n\n  const output = Object(target);\n  for (let i = 1; i < arguments.length; i++) {\n    const source = arguments[i];\n    if (source != null) {\n      for (const key in source) {\n        if (hasOwnProperty.call(source, key)) {\n          output[key] = source[key];\n        }\n      }\n    }\n  }\n  return output;\n}\n\n/**\n * Sets the Object.assign polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.assign) {\n    win.Object.defineProperty(win.Object, 'assign', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: assign,\n    });\n  }\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Implements `Object.values` API.\n * See https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_objects/Object/values.\n *\n * @param {!Object} target\n * @return {!Array<*>}\n */\nexport function values(target) {\n  return Object.keys(target).map((k) => target[k]);\n}\n\n/**\n * Sets the Object.values polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Object.values) {\n    win.Object.defineProperty(win.Object, 'values', {\n      configurable: true,\n      writable: true,\n      value: values,\n    });\n  }\n}\n", "'use strict';\n\n/**\n * Constructs a ES6/Promises A+ Promise instance.\n *\n * @constructor\n * @param {function(function(*=), function (*=))} resolver\n */\nfunction Promise(resolver) {\n  if (!(this instanceof Promise)) {\n    throw new TypeError('Constructor Promise requires `new`');\n  }\n  if (!isFunction(resolver)) {\n    throw new TypeError('Must pass resolver function');\n  }\n\n  /**\n   * @type {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise}\n   * @private\n   */\n  this._state = PendingPromise;\n\n  /**\n   * @type {*}\n   * @private\n   */\n  this._value = [];\n\n  /**\n   * @type {boolean}\n   * @private\n   */\n  this._isChainEnd = true;\n\n  doResolve(\n    this,\n    adopter(this, FulfilledPromise),\n    adopter(this, RejectedPromise),\n    { then: resolver }\n  );\n}\n\n/****************************\n  Public Instance Methods\n ****************************/\n\n/**\n * Creates a new promise instance that will receive the result of this promise\n * as inputs to the onFulfilled or onRejected callbacks.\n *\n * @param {function(*)} onFulfilled\n * @param {function(*)} onRejected\n */\nPromise.prototype.then = function(onFulfilled, onRejected) {\n  onFulfilled = isFunction(onFulfilled) ? onFulfilled : void 0;\n  onRejected = isFunction(onRejected) ? onRejected : void 0;\n\n  if (onFulfilled || onRejected) {\n    this._isChainEnd = false;\n  }\n\n  return this._state(\n    this._value,\n    onFulfilled,\n    onRejected\n  );\n};\n\n/**\n * Creates a new promise that will handle the rejected state of this promise.\n *\n * @param {function(*)} onRejected\n * @returns {!Promise}\n */\nPromise.prototype.catch = function(onRejected) {\n  return this.then(void 0, onRejected);\n};\n\n/****************************\n  Public Static Methods\n ****************************/\n\n/**\n * Creates a fulfilled Promise of value. If value is itself a then-able,\n * resolves with the then-able's value.\n *\n * @this {!Promise}\n * @param {*=} value\n * @returns {!Promise}\n */\nPromise.resolve = function(value) {\n  var Constructor = this;\n  var promise;\n\n  if (isObject(value) && value instanceof this) {\n    promise = value;\n  } else {\n    promise = new Constructor(function(resolve) {\n      resolve(value);\n    });\n  }\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a rejected Promise of reason.\n *\n * @this {!Promise}\n * @param {*=} reason\n * @returns {!Promise}\n */\nPromise.reject = function(reason) {\n  var Constructor = this;\n  var promise = new Constructor(function(_, reject) {\n    reject(reason);\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve with an array of the values of the\n * passed in promises. If any promise rejects, the returned promise will\n * reject.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.all = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    var length = promises.length;\n    var values = new Array(length);\n\n    if (length === 0) {\n      return resolve(values);\n    }\n\n    each(promises, function(promise, index) {\n      Constructor.resolve(promise).then(function(value) {\n        values[index] = value;\n        if (--length === 0) {\n          resolve(values);\n        }\n      }, reject);\n    });\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\n/**\n * Creates a Promise that will resolve or reject based on the first\n * resolved or rejected promise.\n *\n * @this {!Promise}\n * @param {!Array<Promise|*>} promises\n * @returns {!Promise}\n */\nPromise.race = function(promises) {\n  var Constructor = this;\n  var promise = new Constructor(function(resolve, reject) {\n    for (var i = 0; i < promises.length; i++) {\n      Constructor.resolve(promises[i]).then(resolve, reject);\n    }\n  });\n\n  return /** @type {!Promise} */(promise);\n};\n\nvar onPossiblyUnhandledRejection = function(reason, promise) {\n  throw reason;\n};\n\n/**\n * An internal use static function.\n */\nPromise._overrideUnhandledExceptionHandler = function(handler) {\n  onPossiblyUnhandledRejection = handler;\n};\n\n/****************************\n  Private functions\n ****************************/\n\n/**\n * The Fulfilled Promise state. Calls onFulfilled with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onFulfilled, returns the current promise to avoid a promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} value The current promise's resolved value.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} unused\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Fulfilled state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction FulfilledPromise(value, onFulfilled, unused, deferred) {\n  if (!onFulfilled) {\n    deferredAdopt(deferred, FulfilledPromise, value);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onFulfilled, value));\n  return deferred.promise;\n}\n\n/**\n * The Rejected Promise state. Calls onRejected with the resolved value of\n * this promise, creating a new promise.\n *\n * If there is no onRejected, returns the current promise to avoid a promise\n * instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} reason The current promise's rejection reason.\n * @param {function(*=)=} unused\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Rejected state from the\n *     Pending state.\n * @returns {!Promise}\n */\nfunction RejectedPromise(reason, unused, onRejected, deferred) {\n  if (!onRejected) {\n    deferredAdopt(deferred, RejectedPromise, reason);\n    return this;\n  }\n  if (!deferred) {\n    deferred = new Deferred(this.constructor);\n  }\n  defer(tryCatchDeferred(deferred, onRejected, reason));\n  return deferred.promise;\n}\n\n/**\n * The Pending Promise state. Eventually calls onFulfilled once the promise has\n * resolved, or onRejected once the promise rejects.\n *\n * If there is no onFulfilled and no onRejected, returns the current promise to\n * avoid a promise instance.\n *\n * @this {!Promise} The current promise\n * @param {*=} queue The current promise's pending promises queue.\n * @param {function(*=)=} onFulfilled\n * @param {function(*=)=} onRejected\n * @param {Deferred} deferred A deferred object that holds a promise and its\n *     resolve and reject functions. It IS NOT passed when called from\n *     Promise#then to save an object instance (since we may return the current\n *     promise). It IS passed in when adopting the Pending state from the\n *     Pending state of another promise.\n * @returns {!Promise}\n */\nfunction PendingPromise(queue, onFulfilled, onRejected, deferred) {\n  if (!deferred) {\n    if (!onFulfilled && !onRejected) { return this; }\n    deferred = new Deferred(this.constructor);\n  }\n  queue.push({\n    deferred: deferred,\n    onFulfilled: onFulfilled || deferred.resolve,\n    onRejected: onRejected || deferred.reject\n  });\n  return deferred.promise;\n}\n\n/**\n * Constructs a deferred instance that holds a promise and its resolve and\n * reject functions.\n *\n * @constructor\n */\nfunction Deferred(Promise) {\n  var deferred = this;\n  /** @type {!Promise} */\n  this.promise = new Promise(function(resolve, reject) {\n    /** @type {function(*=)} */\n    deferred.resolve = resolve;\n\n    /** @type {function(*=)} */\n    deferred.reject = reject;\n  });\n  return deferred;\n}\n\n/**\n * Transitions the state of promise to another state. This is only ever called\n * on with a promise that is currently in the Pending state.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction adopt(promise, state, value, adoptee) {\n  var queue = promise._value;\n  promise._state = state;\n  promise._value = value;\n\n  if (adoptee && state === PendingPromise) {\n    adoptee._state(value, void 0, void 0, {\n      promise: promise,\n      resolve: void 0,\n      reject: void 0\n    });\n  }\n\n  for (var i = 0; i < queue.length; i++) {\n    var next = queue[i];\n    promise._state(\n      value,\n      next.onFulfilled,\n      next.onRejected,\n      next.deferred\n    );\n  }\n  queue.length = 0;\n\n  // If we're adopting another promise, it's not the end of the promise chain,\n  // the new promise is.\n  if (adoptee) {\n    adoptee._isChainEnd = false;\n  }\n\n  // Determine if this rejected promise will be \"handled\".\n  if (state === RejectedPromise && promise._isChainEnd) {\n    setTimeout(function() {\n      if (promise._isChainEnd) {\n        onPossiblyUnhandledRejection(value, promise);\n      }\n    }, 0);\n  }\n}\n\n/**\n * A partial application of adopt.\n *\n * @param {!Promise} promise\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @returns {function(*=)}\n */\nfunction adopter(promise, state) {\n  return function(value) {\n    adopt(promise, state, value);\n  };\n}\n\n/**\n * Updates a deferred promises state. Necessary for updating an adopting\n * promise's state when the adoptee resolves.\n *\n * @param {?Deferred} deferred\n * @param {function(this:Promise,*=,function(*=),function(*=),Deferred):!Promise} state\n * @param {*=} value\n */\nfunction deferredAdopt(deferred, state, value) {\n  if (deferred) {\n    var promise = deferred.promise;\n    promise._state = state;\n    promise._value = value;\n  }\n}\n\n/**\n * A no-op function to prevent double resolving.\n */\nfunction noop() {}\n\n/**\n * Tests if fn is a Function\n *\n * @param {*} fn\n * @returns {boolean}\n */\nfunction isFunction(fn) {\n  return typeof fn === 'function';\n}\n\n/**\n * Tests if fn is an Object\n *\n * @param {*} obj\n * @returns {boolean}\n */\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Iterates over each element of an array, calling the iterator with the\n * element and its index.\n *\n * @param {!Array} collection\n * @param {function(*=,number)} iterator\n */\nfunction each(collection, iterator) {\n  for (var i = 0; i < collection.length; i++) {\n    iterator(collection[i], i);\n  }\n}\n\n/**\n * Creates a function that will attempt to resolve the deferred with the return\n * of fn. If any error is raised, rejects instead.\n *\n * @param {!Deferred} deferred\n * @param {function(*=)} fn\n * @param {*} arg\n * @returns {function()}\n */\nfunction tryCatchDeferred(deferred, fn, arg) {\n  var promise = deferred.promise;\n  var resolve = deferred.resolve;\n  var reject = deferred.reject;\n  return function() {\n    try {\n      var result = fn(arg);\n      doResolve(promise, resolve, reject, result, result);\n    } catch (e) {\n      reject(e);\n    }\n  };\n}\n\n/**\n * Queues and executes multiple deferred functions on another run loop.\n */\nvar defer = (function() {\n  /**\n   * Defers fn to another run loop.\n   */\n  var scheduleFlush;\n  if (typeof window !== 'undefined' && window.postMessage) {\n    window.addEventListener('message', flush);\n    scheduleFlush = function() {\n      window.postMessage('macro-task', '*');\n    };\n  } else {\n    scheduleFlush = function() {\n      setTimeout(flush, 0);\n    };\n  }\n\n  var queue = new Array(16);\n  var length = 0;\n\n  function flush() {\n    for (var i = 0; i < length; i++) {\n      var fn = queue[i];\n      queue[i] = null;\n      fn();\n    }\n    length = 0;\n  }\n\n  /**\n   * @param {function()} fn\n   */\n  function defer(fn) {\n    if (length === 0) { scheduleFlush(); }\n    queue[length++] = fn;\n  }\n\n  return defer;\n})();\n\n/**\n * The Promise resolution procedure.\n * https://github.com/promises-aplus/promises-spec#the-promise-resolution-procedure\n *\n * @param {!Promise} promise\n * @param {function(*=)} resolve\n * @param {function(*=)} reject\n * @param {*} value\n * @param {*=} context\n */\nfunction doResolve(promise, resolve, reject, value, context) {\n  var _reject = reject;\n  var then;\n  var _resolve;\n  try {\n    if (value === promise) {\n      throw new TypeError('Cannot fulfill promise with itself');\n    }\n    var isObj = isObject(value);\n    if (isObj && value instanceof promise.constructor) {\n      adopt(promise, value._state, value._value, value);\n    } else if (isObj && (then = value.then) && isFunction(then)) {\n      _resolve = function(value) {\n        _resolve = _reject = noop;\n        doResolve(promise, resolve, reject, value, value);\n      };\n      _reject = function(reason) {\n        _resolve = _reject = noop;\n        reject(reason);\n      };\n      then.call(\n        context,\n        function(value) { _resolve(value); },\n        function(reason) { _reject(reason); }\n      );\n    } else {\n      resolve(value);\n    }\n  } catch (e) {\n    _reject(e);\n  }\n}\n\nexport default Promise;\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport Promise from 'promise-pjs';\n\n/**\n * Sets the Promise polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.Promise) {\n    win.Promise = Promise;\n    // In babel the * export is an Object with a default property.\n    // In closure compiler it is the Promise function itself.\n    if (Promise.default) {\n      win.Promise = Promise.default;\n    }\n    // We copy the individual static methods, because closure\n    // compiler flattens the polyfill namespace.\n    win.Promise.resolve = Promise.resolve;\n    win.Promise.reject = Promise.reject;\n    win.Promise.all = Promise.all;\n    win.Promise.race = Promise.race;\n  }\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Return true if string begins with the characters of the specified string.\n * Polyfill copied from MDN: https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string/startsWith\n *\n * @param {string} search\n * @param {number=} rawPos\n * @return {boolean}\n * @this {string}\n */\nfunction startsWith(search, rawPos) {\n  const pos = rawPos > 0 ? rawPos | 0 : 0;\n  // eslint-disable-next-line local/no-invalid-this\n  return this.substr(pos, search.length) === search;\n}\n\n/**\n * Sets the String.startsWith polyfill if it does not exist.\n * @param {!Window} win\n */\nexport function install(win) {\n  if (!win.String.prototype.startsWith) {\n    win.Object.defineProperty(win.String.prototype, 'startsWith', {\n      enumerable: false,\n      configurable: true,\n      writable: true,\n      value: startsWith,\n    });\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Loads all polyfills needed by the AMP 3p integration frame.\n */\n\n// This list should not get longer without a very good reason.\nimport {install as installMathSign} from '../src/polyfills/math-sign';\nimport {install as installObjectAssign} from '../src/polyfills/object-assign';\nimport {install as installObjectValues} from '../src/polyfills/object-values';\nimport {install as installPromise} from '../src/polyfills/promise';\nimport {install as installStringStartsWith} from '../src/polyfills/string-starts-with';\n\nif (!IS_ESM) {\n  installMathSign(self);\n  installObjectAssign(self);\n  installObjectValues(self);\n  installPromise(self);\n  installStringStartsWith(self);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Common AMP events.\n * @enum {string}\n */\nexport const AmpEvents = {\n  DOM_UPDATE: 'amp:dom-update',\n  FORM_DIRTINESS_CHANGE: 'amp:form-dirtiness-change',\n  FORM_VALUE_CHANGE: 'amp:form-value-change',\n  VISIBILITY_CHANGE: 'amp:visibilitychange', // https://github.com/ampproject/amphtml/blob/main/ads/README.md#page-visibility\n  // The following codes are only used for testing.\n  // TODO(choumx): Move these to a separate enum so they can be DCE'd.\n  ATTACHED: 'amp:attached',\n  STUBBED: 'amp:stubbed',\n  LOAD_START: 'amp:load-start',\n  LOAD_END: 'amp:load-end',\n  ERROR: 'amp:error',\n  SIZE_CHANGED: 'amp:size-changed',\n  UNLOAD: 'amp:unload',\n};\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nlet resolved;\n\n/**\n * Returns a cached resolved promise.\n * Babel converts direct calls to Promise.resolve() (with no arguments) into\n * calls to this.\n *\n * @return {!Promise<undefined>}\n */\nexport function resolvedPromise() {\n  if (resolved) {\n    return resolved;\n  }\n\n  // It's important that we call with `undefined` here, to prevent a transform\n  // recursion. If we didn't pass an arg, then the transformer would replace\n  // this callsite with a call to `resolvedPromise()`.\n  resolved = Promise.resolve(undefined);\n  return resolved;\n}\n\n/**\n * Returns a Deferred struct, which holds a pending promise and its associated\n * resolve and reject functions.\n *\n * This is preferred instead of creating a Promise instance to extract the\n * resolve/reject functions yourself:\n *\n * ```\n * // Avoid doing\n * let resolve;\n * const promise = new Promise(res => {\n *   resolve = res;\n * });\n *\n * // Good\n * const deferred = new Deferred();\n * const { promise, resolve } = deferred;\n * ```\n *\n * @template T\n */\nexport class Deferred {\n  /** Constructor. */\n  constructor() {\n    /** @const {!Promise<T>} */\n    this.promise = new /*OK*/ Promise((res, rej) => {\n      /** @const {function(T=)} */\n      this.resolve = res;\n      /** @const {function(*=)} */\n      this.reject = rej;\n    });\n  }\n}\n\n/**\n * Creates a promise resolved to the return value of fn.\n * If fn sync throws, it will cause the promise to reject.\n *\n * @param {function():T} fn\n * @return {!Promise<T>}\n * @template T\n */\nexport function tryResolve(fn) {\n  return new Promise((resolve) => {\n    resolve(fn());\n  });\n}\n\n/**\n * Resolves with the result of the last promise added.\n * @implements {IThenable}\n */\nexport class LastAddedResolver {\n  /**\n   * @param {!Array<!IThenable>=} opt_promises\n   */\n  constructor(opt_promises) {\n    /** @private @const {!Deferred} */\n    this.deferred_ = new Deferred();\n\n    /** @private */\n    this.count_ = 0;\n\n    if (opt_promises) {\n      for (const promise of opt_promises) {\n        this.add(promise);\n      }\n    }\n  }\n\n  /**\n   * Add a promise to possibly be resolved.\n   * @param {!IThenable} promise\n   * @return {!Promise}\n   */\n  add(promise) {\n    const countAtAdd = ++this.count_;\n    promise.then(\n      (result) => {\n        if (this.count_ === countAtAdd) {\n          this.deferred_.resolve(result);\n        }\n      },\n      (error) => {\n        // Don't follow behavior of Promise.all and Promise.race error so that\n        // this will only reject when most recently added promise fails.\n        if (this.count_ === countAtAdd) {\n          this.deferred_.reject(error);\n        }\n      }\n    );\n    return this.deferred_.promise;\n  }\n\n  /** @override */\n  then(opt_resolve, opt_reject) {\n    return this.deferred_.promise.then(opt_resolve, opt_reject);\n  }\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Converts an array-like object to an array.\n * @param {?IArrayLike<T>|string} arrayLike\n * @return {!Array<T>}\n * @template T\n */\nexport function toArray(arrayLike) {\n  return arrayLike ? Array.prototype.slice.call(arrayLike) : [];\n}\n\n/**\n * Determines if value is actually an Array.\n * @param {*} value\n * @return {boolean}\n */\nexport const {isArray} = Array;\n\n/**\n * If the specified argument is an array, it's returned as is. If it's a\n * single item, the array containing this item is created and returned.\n *\n * The double-template pattern here solves a bug where CC can be passed a value\n * with declared type {string|!Array<string>} and return a value with a type of\n * {!Array<string|Array<string>>}.\n *\n * @param {!Array<T>|S} arrayOrSingleItem\n * @return {!Array<T>|!Array<S>}\n * @template S\n * @template T\n */\nexport function arrayOrSingleItemToArray(arrayOrSingleItem) {\n  return isArray(arrayOrSingleItem)\n    ? /** @type {!Array<T>} */ (arrayOrSingleItem)\n    : [/** @type {!S} */ (arrayOrSingleItem)];\n}\n\n/**\n * Compares if two arrays contains exactly same elements of same number\n * of same order. Note that it does NOT handle NaN case as expected.\n *\n * @param {!Array<T>} arr1\n * @param {!Array<T>} arr2\n * @return {boolean}\n * @template T\n */\nexport function areEqualOrdered(arr1, arr2) {\n  if (arr1.length !== arr2.length) {\n    return false;\n  }\n  for (let i = 0; i < arr1.length; i++) {\n    if (arr1[i] !== arr2[i]) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * Removes elements that shouldRemove returns true for from the array.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} shouldRemove\n * @return {!Array<T>}\n * @template T\n */\nexport function remove(array, shouldRemove) {\n  const removed = [];\n  let index = 0;\n  for (let i = 0; i < array.length; i++) {\n    const item = array[i];\n    if (shouldRemove(item, i, array)) {\n      removed.push(item);\n    } else {\n      if (index < i) {\n        array[index] = item;\n      }\n      index++;\n    }\n  }\n  if (index < array.length) {\n    array.length = index;\n  }\n  return removed;\n}\n\n/**\n * Returns the index of the first element matching the predicate.\n * Like Array#findIndex.\n *\n * @param {!Array<T>} array\n * @param {function(T, number, !Array<T>):boolean} predicate\n * @return {number}\n * @template T\n */\nexport function findIndex(array, predicate) {\n  for (let i = 0; i < array.length; i++) {\n    if (predicate(array[i], i, array)) {\n      return i;\n    }\n  }\n  return -1;\n}\n\n/**\n * Converts the given iterator to an array.\n *\n * @param {!Iterator<T>} iterator\n * @return {Array<T>}\n * @template T\n */\nexport function fromIterator(iterator) {\n  const array = [];\n  for (let e = iterator.next(); !e.done; e = iterator.next()) {\n    array.push(e.value);\n  }\n  return array;\n}\n\n/**\n * Adds item to array if it is not already present.\n *\n * @param {Array<T>} array\n * @param {T} item\n * @return {boolean}\n * @template T\n */\nexport function pushIfNotExist(array, item) {\n  if (array.indexOf(item) < 0) {\n    array.push(item);\n    return true;\n  }\n  return false;\n}\n\n/**\n * Removes the first matching item in the array. Returns `true` if the array\n * has changed.\n *\n * @param {!Array<T>} array\n * @param {T} item\n * @return {boolean}\n * @template T\n */\nexport function removeItem(array, item) {\n  const index = array.indexOf(item);\n  if (index == -1) {\n    return false;\n  }\n  array.splice(index, 1);\n  return true;\n}\n\n/**\n * Returns the last item in an array.\n *\n * @param {Array<T>} array\n * @template T\n * @return {?T}\n */\nexport function lastItem(array) {\n  return array[array.length - 1];\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Checks whether `val` is a valid value of `enumObj`.\n *\n * @param {!Object<T>} enumObj\n * @param {T} val\n * @return {boolean}\n * @template T\n */\nexport function isEnumValue(enumObj, val) {\n  for (const k in enumObj) {\n    if (enumObj[k] === val) {\n      return true;\n    }\n  }\n  return false;\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {string} _match\n * @param {string} character\n * @return {string}\n */\nfunction toUpperCase(_match, character) {\n  return character.toUpperCase();\n}\n\n/**\n * @param {string} match\n * @return {string}\n */\nfunction prependDashAndToLowerCase(match) {\n  return '-' + match.toLowerCase();\n}\n\n/**\n * @param {string} name Attribute name containing dashes.\n * @return {string} Dashes removed and successive character sent to upper case.\n * visibleForTesting\n */\nexport function dashToCamelCase(name) {\n  return name.replace(/-([a-z])/g, toUpperCase);\n}\n\n/**\n * Converts a string that is in camelCase to one that is in dash-case.\n *\n * @param {string} string The string to convert.\n * @return {string} The string in dash-case.\n */\nexport function camelCaseToDash(string) {\n  return string.replace(/(?!^)[A-Z]/g, prependDashAndToLowerCase);\n}\n\n/**\n * @param {string} name Attribute name with dashes\n * @return {string} Dashes replaced by underlines.\n */\nexport function dashToUnderline(name) {\n  return name.replace('-', '_');\n}\n\n/**\n * Polyfill for String.prototype.endsWith.\n * @param {string} string\n * @param {string} suffix\n * @return {boolean}\n */\nexport function endsWith(string, suffix) {\n  const index = string.length - suffix.length;\n  return index >= 0 && string.indexOf(suffix, index) == index;\n}\n\n/**\n * Polyfill for String.prototype.includes.\n * @param {string} string\n * @param {string} substring\n * @param {number=} start\n * @return {boolean}\n */\nexport function includes(string, substring, start) {\n  if (typeof start !== 'number') {\n    start = 0;\n  }\n  if (start + substring.length > string.length) {\n    return false;\n  }\n  return string.indexOf(substring, start) !== -1;\n}\n\n/**\n * Expands placeholders in a given template string with values.\n *\n * Placeholders use ${key-name} syntax and are replaced with the value\n * returned from the given getter function.\n *\n * @param {string} template The template string to expand.\n * @param {function(string):*} getter Function used to retrieve a value for a\n *   placeholder. Returns values will be coerced into strings.\n * @param {number=} opt_maxIterations Number of times to expand the template.\n *   Defaults to 1, but should be set to a larger value your placeholder tokens\n *   can be expanded to other placeholder tokens. Take caution with large values\n *   as recursively expanding a string can be exponentially expensive.\n * @return {string}\n */\nexport function expandTemplate(template, getter, opt_maxIterations) {\n  const maxIterations = opt_maxIterations || 1;\n  for (let i = 0; i < maxIterations; i++) {\n    let matches = 0;\n    template = template.replace(/\\${([^}]*)}/g, (_a, b) => {\n      matches++;\n      return getter(b);\n    });\n    if (!matches) {\n      break;\n    }\n  }\n  return template;\n}\n\n/**\n * Hash function djb2a\n * This is intended to be a simple, fast hashing function using minimal code.\n * It does *not* have good cryptographic properties.\n * @param {string} str\n * @return {string} 32-bit unsigned hash of the string\n */\nexport function stringHash32(str) {\n  const {length} = str;\n  let hash = 5381;\n  for (let i = 0; i < length; i++) {\n    hash = (hash * 33) ^ str.charCodeAt(i);\n  }\n  // Convert from 32-bit signed to unsigned.\n  return String(hash >>> 0);\n}\n\n/**\n * Trims a string on the end, removing whitespace characters.\n * @param {string} str  A string to trim.\n * @return {string} The string, with trailing whitespace removed.\n */\nexport function trimEnd(str) {\n  // TODO(sparhami) Does this get inlined for an ES2019 build?\n  if (str.trimEnd) {\n    return str.trimEnd();\n  }\n\n  return ('_' + str).trim().slice(1);\n}\n\n/**\n * Trims any leading whitespace from a string.\n * @param {string} str  A string to trim.\n * @return {string} The string, with leading whitespace removed.\n */\nexport function trimStart(str) {\n  if (str.trimStart) {\n    return str.trimStart();\n  }\n\n  return (str + '_').trim().slice(0, -1);\n}\n\n/**\n * Wrapper around String.replace that handles asynchronous resolution.\n * @param {string} str\n * @param {RegExp} regex\n * @param {Function|string} replacer\n * @return {!Promise<string>}\n */\nexport function asyncStringReplace(str, regex, replacer) {\n  if (isString(replacer)) {\n    return Promise.resolve(str.replace(regex, replacer));\n  }\n  const stringBuilder = [];\n  let lastIndex = 0;\n\n  str.replace(regex, function (match) {\n    // String.prototype.replace will pass 3 to n number of arguments to the\n    // callback function based on how many capture groups the regex may or may\n    // not contain. We know that the match will always be first, and the\n    // index will always be second to last.\n    const matchIndex = arguments[arguments.length - 2];\n    stringBuilder.push(str.slice(lastIndex, matchIndex));\n    lastIndex = matchIndex + match.length;\n\n    // Store the promise in it's eventual string position.\n    const replacementPromise = replacer.apply(null, arguments);\n    stringBuilder.push(replacementPromise);\n  });\n  stringBuilder.push(str.slice(lastIndex));\n\n  return Promise.all(stringBuilder).then((resolved) => resolved.join(''));\n}\n\n/**\n * Pads the beginning of a string with a substring to a target length.\n * @param {string} s\n * @param {number} targetLength\n * @param {string} padString\n * @return {string}\n */\nexport function padStart(s, targetLength, padString) {\n  if (s.length >= targetLength) {\n    return s;\n  }\n  targetLength = targetLength - s.length;\n  let padding = padString;\n  while (targetLength > padding.length) {\n    padding += padString;\n  }\n  return padding.slice(0, targetLength) + s;\n}\n\n/**\n * Tests if a value is a string.\n * @param {?} s\n * @return {boolean}\n */\nexport function isString(s) {\n  return typeof s == 'string';\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* @const */\nconst {hasOwnProperty: hasOwn_, toString: toString_} = Object.prototype;\n\n/**\n * Determines if value is actually an Object.\n * @param {*} value\n * @return {boolean}\n */\nexport function isObject(value) {\n  return toString_.call(value) === '[object Object]';\n}\n\n/**\n * Returns a map-like object.\n * If opt_initial is provided, copies its own properties into the\n * newly created object.\n * @param {T=} opt_initial This should typically be an object literal.\n * @return {T}\n * @template T\n */\nexport function map(opt_initial) {\n  const obj = Object.create(null);\n  if (opt_initial) {\n    Object.assign(obj, opt_initial);\n  }\n  return obj;\n}\n\n/**\n * Return an empty JsonObject or makes the passed in object literal\n * an JsonObject.\n * The JsonObject type is just a simple object that is at-dict.\n * See\n * https://github.com/google/closure-compiler/wiki/@struct-and-@dict-Annotations\n * for what a dict is type-wise.\n * The linter enforces that the argument is, in fact, at-dict like.\n * @param {!Object=} opt_initial\n * @return {!JsonObject}\n */\nexport function dict(opt_initial) {\n  // We do not copy. The linter enforces that the passed in object is a literal\n  // and thus the caller cannot have a reference to it.\n  return /** @type {!JsonObject} */ (opt_initial || {});\n}\n\n/**\n * Checks if the given key is a property in the map.\n *\n * @param {T}  obj a map like property.\n * @param {string}  key\n * @return {boolean}\n * @template T\n */\nexport function hasOwn(obj, key) {\n  return hasOwn_.call(obj, key);\n}\n\n/**\n * Returns obj[key] iff key is obj's own property (is not inherited).\n * Otherwise, returns undefined.\n *\n * @param {Object} obj\n * @param {string} key\n * @return {*}\n */\nexport function ownProperty(obj, key) {\n  if (hasOwn(obj, key)) {\n    return obj[key];\n  } else {\n    return undefined;\n  }\n}\n\n/**\n * Deep merges source into target.\n *\n * @param {!Object} target\n * @param {!Object} source\n * @param {number} depth The maximum merge depth. If exceeded, Object.assign\n *                       will be used instead.\n * @return {!Object}\n * @throws {Error} If source contains a circular reference.\n * Note: Only nested objects are deep-merged, primitives and arrays are not.\n */\nexport function deepMerge(target, source, depth = 10) {\n  // Keep track of seen objects to detect recursive references.\n  const seen = [];\n\n  /** @type {!Array<{t: !Object, s: !Object, d: number}>} */\n  const queue = [];\n  queue.push({t: target, s: source, d: 0});\n\n  // BFS to ensure objects don't have recursive references at shallower depths.\n  while (queue.length > 0) {\n    const {d, s, t} = queue.shift();\n    if (seen.includes(s)) {\n      throw new Error('Source object has a circular reference.');\n    }\n    seen.push(s);\n    if (t === s) {\n      continue;\n    }\n    if (d > depth) {\n      Object.assign(t, s);\n      continue;\n    }\n    for (const key of Object.keys(s)) {\n      const newValue = s[key];\n      // Perform a deep merge IFF both target and source have the same key\n      // whose corresponding values are objects.\n      if (hasOwn(t, key)) {\n        const oldValue = t[key];\n        if (isObject(newValue) && isObject(oldValue)) {\n          queue.push({t: oldValue, s: newValue, d: d + 1});\n          continue;\n        }\n      }\n      t[key] = newValue;\n    }\n  }\n  return target;\n}\n\n/**\n * @param {!Object} o An object to remove properties from\n * @param {!Array<string>} props A list of properties to remove from the Object\n * @return {!Object} An object with the given properties removed\n */\nexport function omit(o, props) {\n  return Object.keys(o).reduce((acc, key) => {\n    if (!props.includes(key)) {\n      acc[key] = o[key];\n    }\n    return acc;\n  }, {});\n}\n\n/**\n * @param {!Object|null|undefined} o1\n * @param {!Object|null|undefined} o2\n * @return {boolean}\n */\nexport function objectsEqualShallow(o1, o2) {\n  if (o1 == null || o2 == null) {\n    // Null is only equal to null, and undefined to undefined.\n    return o1 === o2;\n  }\n\n  for (const k in o1) {\n    if (o1[k] !== o2[k]) {\n      return false;\n    }\n  }\n  for (const k in o2) {\n    if (o2[k] !== o1[k]) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * @param {T} obj\n * @param {string} prop\n * @param {function(T, string):R} factory\n * @return {R}\n * @template T,R\n */\nexport function memo(obj, prop, factory) {\n  let result = /** @type {?R} */ (obj[prop]);\n  if (result === undefined) {\n    result = factory(obj, prop);\n    obj[prop] = result;\n  }\n  return result;\n}\n\n/**\n * Recreates objects with prototype-less copies.\n * @param {!JsonObject} obj\n * @return {!JsonObject}\n */\nexport function recreateNonProtoObject(obj) {\n  const copy = map();\n  for (const k in obj) {\n    if (!hasOwn(obj, k)) {\n      continue;\n    }\n    const v = obj[k];\n    copy[k] = isObject(v) ? recreateNonProtoObject(v) : v;\n  }\n  return /** @type {!JsonObject} */ (copy);\n}\n\n/**\n * Returns a value from an object for a field-based expression. The expression\n * is a simple nested dot-notation of fields, such as `field1.field2`. If any\n * field in a chain does not exist or is not an object or array, the returned\n * value will be `undefined`.\n *\n * @param {!JsonObject} obj\n * @param {string} expr\n * @return {*}\n */\nexport function getValueForExpr(obj, expr) {\n  // The `.` indicates \"the object itself\".\n  if (expr == '.') {\n    return obj;\n  }\n  // Otherwise, navigate via properties.\n  const parts = expr.split('.');\n  let value = obj;\n  for (const part of parts) {\n    if (\n      part &&\n      value &&\n      value[part] !== undefined &&\n      typeof value == 'object' &&\n      hasOwn(value, part)\n    ) {\n      value = value[part];\n      continue;\n    }\n    value = undefined;\n    break;\n  }\n  return value;\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Export all type-checking helpers for convenience\nexport {isArray} from './array';\nexport {isEnumValue} from './enum';\nexport {isString} from './string';\nexport {isObject} from './object';\n\n/**\n * Determines if value is an ELement\n * @param {*} value\n * @return {boolean}\n */\nexport function isElement(value) {\n  return value?.nodeType == /* Node.ELEMENT_NODE */ 1;\n}\n\n/**\n * Determines if value is of number type and finite.\n * NaN and Infinity are not considered a finite number.\n * String numbers are not considered numbers.\n * @param {*} value\n * @return {boolean}\n */\nexport function isFiniteNumber(value) {\n  return typeof value === 'number' && isFinite(value);\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isElement} from '../types';\n\n/**\n * Triple zero width space.\n *\n * This is added to user error messages, so that we can later identify\n * them, when the only thing that we have is the message. This is the\n * case in many browsers when the global exception handler is invoked.\n *\n * @const {string}\n */\nexport const USER_ERROR_SENTINEL = '\\u200B\\u200B\\u200B';\n\n/**\n * Converts an element to a readable string; all other types are unchanged.\n * TODO(rcebulko): Unify with log.js\n * @param {*} val\n * @return {*}\n */\nexport function elementStringOrPassThru(val) {\n  // Do check equivalent to `val instanceof Element` without cross-window bug\n  if (isElement(val)) {\n    val = /** @type {Element} */ (val);\n    return val.tagName.toLowerCase() + (val.id ? `#${val.id}` : '');\n  }\n  return val;\n}\n\n/**\n * Tests if an error message contains the user sentinel.\n * @param {string} message\n * @return {boolean} Whether this message was a user error.\n */\nexport function isUserErrorMessage(message) {\n  return message.indexOf(USER_ERROR_SENTINEL) >= 0;\n}\n\n/**\n * Strips the user error sentinel from an error message.\n * @param {string} message\n * @return {string} The new message without USER_ERROR_SENTINEL\n */\nexport function stripUserError(message) {\n  return message.replace(USER_ERROR_SENTINEL, '');\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {elementStringOrPassThru} from '../error/message-helpers';\nimport {includes} from '../types/string';\nimport {isArray, isElement, isString} from '../types';\nimport {remove} from '../types/array';\n\n/**\n * @fileoverview This file provides the base implementation for assertion\n * functions. Most files should never import from this; instead, import from\n * `dev` or `user`. It is also used by the Log class for its assertions.\n */\n\n/**\n * A base assertion function, provided to various assertion helpers.\n * @typedef {function(?, string=, ...*):?|function(?, !Array<*>)}\n */\nexport let AssertionFunctionDef;\n\n/**\n * Throws an error if the second argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n * @param {?string} sentinel\n * @param {T} shouldBeTruthy\n * @param {string} opt_message\n * @param {...*} var_args Arguments substituted into %s in the message\n * @return {T}\n * @template T\n * @throws {Error} when shouldBeTruthy is not truthy.\n */\nexport function assert(\n  sentinel,\n  shouldBeTruthy,\n  opt_message = 'Assertion failed',\n  var_args\n) {\n  if (shouldBeTruthy) {\n    return shouldBeTruthy;\n  }\n\n  // Include the sentinel string if provided and not already present\n  if (sentinel && !includes(opt_message, sentinel)) {\n    opt_message += sentinel;\n  }\n\n  // Skip the first 3 arguments to isolate format params\n  // const messageArgs = Array.prototype.slice.call(arguments, 3);\n  // Index at which message args start\n  let i = 3;\n\n  // Substitute provided values into format string in message\n  const splitMessage = opt_message.split('%s');\n  let message = splitMessage.shift();\n  const messageArray = [message];\n\n  while (splitMessage.length) {\n    const subValue = arguments[i++];\n    const nextConstant = splitMessage.shift();\n\n    message += elementStringOrPassThru(subValue) + nextConstant;\n    messageArray.push(subValue, nextConstant.trim());\n  }\n\n  const error = new Error(message);\n  error.messageArray = remove(messageArray, (x) => x !== '');\n  // __AMP_REPORT_ERROR is installed globally per window in the entry point in\n  // AMP documents. It may not be present for Bento/Preact elements on non-AMP\n  // pages.\n  self.__AMP_REPORT_ERROR?.(error);\n  throw error;\n}\n\n/**\n * Asserts types, backbone of `assertNumber`, `assertString`, etc.\n *\n * It understands array-based \"id\"-contracted messages.\n *\n * Otherwise creates a sprintf syntax string containing the optional message or the\n * default. The `subject` of the assertion is added at the end.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {T} subject\n * @param {*} shouldBeTruthy\n * @param {string} defaultMessage\n * @param {!Array<*>|string=} opt_message\n * @return {T}\n * @template T\n * @private\n */\nfunction assertType_(\n  assertFn,\n  subject,\n  shouldBeTruthy,\n  defaultMessage,\n  opt_message\n) {\n  if (isArray(opt_message)) {\n    assertFn(\n      shouldBeTruthy,\n      /** @type {!Array} */ (opt_message).concat([subject])\n    );\n  } else {\n    assertFn(shouldBeTruthy, `${opt_message || defaultMessage}: %s`, subject);\n  }\n\n  return subject;\n}\n\n/**\n * Throws an error if the first argument isn't an Element.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeElement\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {!Element} The value of shouldBeTrueish.\n * @throws {Error} when shouldBeElement is not an Element\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertElement(assertFn, shouldBeElement, opt_message) {\n  return /** @type {!Element} */ (\n    assertType_(\n      assertFn,\n      shouldBeElement,\n      isElement(shouldBeElement),\n      'Element expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a string. The string can\n * be empty.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeString\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {string} The string value. Can be an empty string.\n * @throws {Error} when shouldBeString is not an String\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertString(assertFn, shouldBeString, opt_message) {\n  return /** @type {string} */ (\n    assertType_(\n      assertFn,\n      shouldBeString,\n      isString(shouldBeString),\n      'String expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a number. The allowed values\n * include `0` and `NaN`.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeNumber\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {number} The number value. The allowed values include `0`\n *   and `NaN`.\n * @throws {Error} when shouldBeNumber is not an Number\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertNumber(assertFn, shouldBeNumber, opt_message) {\n  return /** @type {number} */ (\n    assertType_(\n      assertFn,\n      shouldBeNumber,\n      typeof shouldBeNumber == 'number',\n      'Number expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument is not an array.\n * The array can be empty.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeArray\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {!Array} The array value\n * @throws {Error} when shouldBeArray is not an Array\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertArray(assertFn, shouldBeArray, opt_message) {\n  return /** @type {!Array} */ (\n    assertType_(\n      assertFn,\n      shouldBeArray,\n      isArray(shouldBeArray),\n      'Array expected',\n      opt_message\n    )\n  );\n}\n\n/**\n * Throws an error if the first argument isn't a boolean.\n *\n * For more details see `assert`.\n *\n * @param {!AssertionFunctionDef} assertFn underlying assertion function to call\n * @param {*} shouldBeBoolean\n * @param {!Array<*>|string=} opt_message The assertion message\n * @return {boolean} The boolean value.\n * @throws {Error} when shouldBeBoolean is not an Boolean\n * @closurePrimitive {asserts.matchesReturn}\n */\nexport function assertBoolean(assertFn, shouldBeBoolean, opt_message) {\n  return /** @type {boolean} */ (\n    assertType_(\n      assertFn,\n      shouldBeBoolean,\n      !!shouldBeBoolean === shouldBeBoolean,\n      'Boolean expected',\n      opt_message\n    )\n  );\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Some exceptions (DOMException, namely) have read-only message.\n * @param {!Error} error\n * @return {!Error};\n */\nexport function duplicateErrorIfNecessary(error) {\n  const messageProperty = Object.getOwnPropertyDescriptor(error, 'message');\n  if (messageProperty?.writable) {\n    return error;\n  }\n\n  const {message, stack} = error;\n  const e = new Error(message);\n  // Copy all the extraneous things we attach.\n  for (const prop in error) {\n    e[prop] = error[prop];\n  }\n  // Ensure these are copied.\n  e.stack = stack;\n  return e;\n}\n\n/**\n * @param {...*} var_args\n * @return {!Error}\n * @visibleForTesting\n */\nexport function createErrorVargs(var_args) {\n  let error = null;\n  let message = '';\n  for (const arg of arguments) {\n    if (arg instanceof Error && !error) {\n      error = duplicateErrorIfNecessary(arg);\n    } else {\n      if (message) {\n        message += ' ';\n      }\n      message += arg;\n    }\n  }\n\n  if (!error) {\n    error = new Error(message);\n  } else if (message) {\n    error.message = message + ': ' + error.message;\n  }\n  return error;\n}\n\n/**\n * Rethrows the error without terminating the current context. This preserves\n * whether the original error designation is a user error or a dev error.\n * @param {...*} var_args\n */\nexport function rethrowAsync(var_args) {\n  const error = createErrorVargs.apply(null, arguments);\n  setTimeout(() => {\n    // __AMP_REPORT_ERROR is installed globally per window in the entry point.\n    // It may not exist for Bento components without the runtime.\n    self.__AMP_REPORT_ERROR?.(error);\n    throw error;\n  });\n}\n\n/**\n * Executes the provided callback in a try/catch and rethrows any errors\n * asynchronously.\n *\n * @param {function(...*):T} callback\n * @param {...*} args\n * @return {T}\n * @template T\n */\nexport function tryCallback(callback, ...args) {\n  try {\n    return callback.apply(null, args);\n  } catch (e) {\n    rethrowAsync(e);\n  }\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Returns the internal AMP runtime version. Note that this is not the RTV,\n * which is a prefix and the runtime version.\n *\n * The call sites for this function are replaced with a compile time constant\n * string.\n *\n * @return {string}\n */\nexport function internalRuntimeVersion() {\n  return '$internalRuntimeVersion$';\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {map} from '../object';\n\nconst QUERY_STRING_REGEX = /(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;\n\n/**\n * Tries to decode a URI component, falling back to opt_fallback (or an empty\n * string)\n *\n * @param {string} component\n * @param {string=} fallback\n * @return {string}\n */\nexport function tryDecodeUriComponent(component, fallback = '') {\n  try {\n    return decodeURIComponent(component);\n  } catch (e) {\n    return fallback;\n  }\n}\n\n/**\n * Parses the query string of an URL. This method returns a simple key/value\n * map. If there are duplicate keys the latest value is returned.\n *\n * @param {string} queryString\n * @return {!JsonObject}\n */\nexport function parseQueryString(queryString) {\n  const params = map();\n  if (!queryString) {\n    return params;\n  }\n\n  let match;\n  while ((match = QUERY_STRING_REGEX.exec(queryString))) {\n    const name = tryDecodeUriComponent(match[1], match[1]);\n    const value = match[2]\n      ? tryDecodeUriComponent(match[2].replace(/\\+/g, ' '), match[2])\n      : '';\n    params[name] = value;\n  }\n  return params;\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalRuntimeVersion} from './internal-version';\nimport {parseQueryString} from './core/types/string/url';\n\n/**\n * @typedef {{\n *   localDev: boolean,\n *   development: boolean,\n *   minified: boolean,\n *   test: boolean,\n *   examiner: boolean,\n *   log: (string|undefined),\n *   version: string,\n *   rtvVersion: string,\n *   runtime: (null|string|undefined),\n *   a4aId: (null|string|undefined),\n *   esm: (boolean|undefined),\n * }}\n */\nexport let ModeDef;\n\n/**\n * `rtvVersion` is the prefixed version we serve off of the cdn.\n * The prefix denotes canary(00) or prod(01) or an experiment version ( > 01).\n * @type {string}\n */\nlet rtvVersion = '';\n\n/**\n * Provides info about the current app.\n * @param {?Window=} opt_win\n * @return {!ModeDef}\n */\nexport function getMode(opt_win) {\n  const win = opt_win || self;\n  if (win.__AMP_MODE) {\n    return win.__AMP_MODE;\n  }\n  return (win.__AMP_MODE = getMode_(win));\n}\n\n/**\n * Provides info about the current app.\n * @param {!Window} win\n * @return {!ModeDef}\n */\nfunction getMode_(win) {\n  // TODO(erwinmombay): simplify the logic here\n  const AMP_CONFIG = self.AMP_CONFIG || {};\n\n  // Magic constants that are replaced by closure compiler.\n  // IS_MINIFIED is always replaced with true when closure compiler is used\n  // while IS_FORTESTING is only replaced when `amp dist` is called without the\n  // --fortesting flag.\n  const IS_FORTESTING = true;\n  const IS_MINIFIED = false;\n\n  const runningTests =\n    IS_FORTESTING && !!(AMP_CONFIG.test || win.__AMP_TEST || win['__karma__']);\n  const isLocalDev = IS_FORTESTING && (!!AMP_CONFIG.localDev || runningTests);\n  const hashQuery = parseQueryString(\n    // location.originalHash is set by the viewer when it removes the fragment\n    // from the URL.\n    win.location['originalHash'] || win.location.hash\n  );\n\n  if (!rtvVersion) {\n    rtvVersion = getRtvVersion(win);\n  }\n\n  // The `minified`, `test` and `localDev` properties are replaced\n  // as boolean literals when we run `amp dist` without the `--fortesting`\n  // flags. This improved DCE on the production file we deploy as the code\n  // paths for localhost/testing/development are eliminated.\n  return {\n    localDev: isLocalDev,\n    development: isModeDevelopment(win),\n    examiner: hashQuery['development'] == '2',\n    esm: IS_ESM,\n    // amp-geo override\n    geoOverride: hashQuery['amp-geo'],\n    minified: IS_MINIFIED,\n    test: runningTests,\n    log: hashQuery['log'],\n    version: internalRuntimeVersion(),\n    rtvVersion,\n  };\n}\n\n/**\n * Retrieve the `rtvVersion` which will have a numeric prefix\n * denoting canary/prod/experiment (unless `isLocalDev` is true).\n *\n * @param {!Window} win\n * @return {string}\n */\nfunction getRtvVersion(win) {\n  if (win.AMP_CONFIG && win.AMP_CONFIG.v) {\n    return win.AMP_CONFIG.v;\n  }\n\n  // Currently `internalRuntimeVersion` and thus `mode.version` contain only\n  // major version. The full version however must also carry the minor version.\n  // We will default to production default `01` minor version for now.\n  // TODO(erwinmombay): decide whether internalRuntimeVersion should contain\n  // minor version.\n  return `01${internalRuntimeVersion()}`;\n}\n\n/**\n * Triggers validation or enable pub level logging. Validation can be\n * bypassed via #validate=0.\n * Note that AMP_DEV_MODE flag is used for testing purposes.\n * @param {!Window} win\n * @return {boolean}\n */\nexport function isModeDevelopment(win) {\n  const hashQuery = parseQueryString(\n    win.location['originalHash'] || win.location.hash\n  );\n  return !!(\n    ['1', 'actions', 'amp', 'amp4ads', 'amp4email'].includes(\n      hashQuery['development']\n    ) || win.AMP_DEV_MODE\n  );\n}\n\n/**\n * @param {!Window} win\n * @return {string}\n * @visibleForTesting\n */\nexport function getRtvVersionForTesting(win) {\n  return getRtvVersion(win);\n}\n\n/** @visibleForTesting */\nexport function resetRtvVersionForTesting() {\n  rtvVersion = '';\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/** @fileoverview Helpers to wrap functions. */\n\n/**\n * Creates a function that is evaluated only once and returns the cached result\n * subsequently.\n *\n * Please note that `once` only takes the function definition into account,\n * so it will return the same cached value even when the arguments are\n * different.\n *\n * @param {function(...):T} fn\n * @return {function(...):T}\n * @template T\n */\nexport function once(fn) {\n  let evaluated = false;\n  let retValue = null;\n  let callback = fn;\n  return (...args) => {\n    if (!evaluated) {\n      retValue = callback.apply(self, args);\n      evaluated = true;\n      callback = null; // GC\n    }\n    return retValue;\n  };\n}\n\n/**\n * Wraps a given callback and applies a rate limit.\n * It throttles the calls so that no consequent calls have time interval\n * smaller than the given minimal interval.\n *\n * @param {!Window} win\n * @param {function(...T):R} callback\n * @param {number} minInterval the minimum time interval in millisecond\n * @return {function(...T)}\n * @template T\n * @template R\n */\nexport function throttle(win, callback, minInterval) {\n  let locker = 0;\n  let nextCallArgs = null;\n\n  /**\n   * @param {!Object} args\n   */\n  function fire(args) {\n    nextCallArgs = null;\n    // Lock the fire for minInterval milliseconds\n    locker = win.setTimeout(waiter, minInterval);\n\n    callback.apply(null, args);\n  }\n\n  /**\n   * Waiter function\n   */\n  function waiter() {\n    locker = 0;\n    // If during the period there're invocations queued up, fire once.\n    if (nextCallArgs) {\n      fire(nextCallArgs);\n    }\n  }\n\n  return function (...args) {\n    if (locker) {\n      nextCallArgs = args;\n    } else {\n      fire(args);\n    }\n  };\n}\n\n/**\n * Wraps a given callback and applies a wait timer, so that minInterval\n * milliseconds must pass since the last call before the callback is actually\n * invoked.\n *\n * @param {!Window} win\n * @param {function(...T):R} callback\n * @param {number} minInterval the minimum time interval in millisecond\n * @return {function(...T)}\n * @template T\n * @template R\n */\nexport function debounce(win, callback, minInterval) {\n  let locker = 0;\n  let timestamp = 0;\n  let nextCallArgs = null;\n\n  /**\n   * @param {?Array} args\n   */\n  function fire(args) {\n    nextCallArgs = null;\n    callback.apply(null, args);\n  }\n\n  /**\n   * Wait function for debounce\n   */\n  function waiter() {\n    locker = 0;\n    const remaining = minInterval - (win.Date.now() - timestamp);\n    if (remaining > 0) {\n      locker = win.setTimeout(waiter, remaining);\n    } else {\n      fire(nextCallArgs);\n    }\n  }\n\n  return function (...args) {\n    timestamp = win.Date.now();\n    nextCallArgs = args;\n    if (!locker) {\n      locker = win.setTimeout(waiter, minInterval);\n    }\n  };\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Allows for runtime configuration. Internally, the runtime should\n * use the src/config.js module for various constants. We can use the\n * AMP_CONFIG global to translate user-defined configurations to this\n * module.\n * @type {!Object<string, string>}\n */\nconst env = self.AMP_CONFIG || {};\n\nconst thirdPartyFrameRegex =\n  (typeof env['thirdPartyFrameRegex'] == 'string'\n    ? new RegExp(env['thirdPartyFrameRegex'])\n    : env['thirdPartyFrameRegex']) || /^d-\\d+\\.ampproject\\.net$/;\n\nconst cdnProxyRegex =\n  (typeof env['cdnProxyRegex'] == 'string'\n    ? new RegExp(env['cdnProxyRegex'])\n    : env['cdnProxyRegex']) ||\n  /^https:\\/\\/([a-zA-Z0-9_-]+\\.)?cdn\\.ampproject\\.org$/;\n\n/**\n * Check for a custom URL definition in special <meta> tags. Note that this does\n * not allow for distinct custom URLs in AmpDocShadow instances. The shell is\n * allowed to define one set of custom URLs via AMP_CONFIG (recommended) or by\n * including <meta> tags in the shell <head>. Those custom URLs then apply to\n * all AMP documents loaded in the shell.\n * @param {string} name\n * @return {?string}\n * @private\n */\nfunction getMetaUrl(name) {\n  // Avoid exceptions in unit tests\n  if (!self.document || !self.document.head) {\n    return null;\n  }\n\n  // Disallow on proxy origins\n  if (self.location && cdnProxyRegex.test(self.location.origin)) {\n    return null;\n  }\n\n  const metaEl = self.document.head./*OK*/ querySelector(\n    `meta[name=\"${name}\"]`\n  );\n  return (metaEl && metaEl.getAttribute('content')) || null;\n}\n\n/**\n * @typedef {{\n *   thirdParty: string,\n *   thirdPartyFrameHost: string,\n *   thirdPartyFrameRegex: !RegExp,\n *   cdn: string,\n *   cdnProxyRegex: !RegExp,\n *   localhostRegex: !RegExp,\n *   errorReporting: string,\n *   betaErrorReporting: string,\n *   localDev: boolean,\n *   trustedViewerHosts: !Array<!RegExp>,\n *   geoApi: ?string,\n * }}\n */\nexport const urls = {\n  thirdParty: env['thirdPartyUrl'] || 'https://3p.ampproject.net',\n  thirdPartyFrameHost: env['thirdPartyFrameHost'] || 'ampproject.net',\n  thirdPartyFrameRegex,\n  cdn:\n    env['cdnUrl'] || getMetaUrl('runtime-host') || 'https://cdn.ampproject.org',\n  /* Note that cdnProxyRegex is only ever checked against origins\n   * (proto://host[:port]) so does not need to consider path\n   */\n  cdnProxyRegex,\n  localhostRegex: /^https?:\\/\\/localhost(:\\d+)?$/,\n  errorReporting:\n    env['errorReportingUrl'] ||\n    'https://us-central1-amp-error-reporting.cloudfunctions.net/r',\n  betaErrorReporting:\n    env['betaErrorReportingUrl'] ||\n    'https://us-central1-amp-error-reporting.cloudfunctions.net/r-beta',\n  localDev: env['localDev'] || false,\n  /**\n   * These domains are trusted with more sensitive viewer operations such as\n   * propagating the referrer. If you believe your domain should be here,\n   * file the issue on GitHub to discuss. The process will be similar\n   * (but somewhat more stringent) to the one described in the [3p/README.md](\n   * https://github.com/ampproject/amphtml/blob/main/3p/README.md)\n   *\n   * {!Array<!RegExp>}\n   */\n  trustedViewerHosts: [\n    /(^|\\.)google\\.(com?|[a-z]{2}|com?\\.[a-z]{2}|cat)$/,\n    /(^|\\.)gmail\\.(com|dev)$/,\n  ],\n  // Optional fallback API if amp-geo is left unpatched\n  geoApi: env['geoApiUrl'] || getMetaUrl('amp-geo-api'),\n};\n\nexport const config = {\n  urls,\n};\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport * as assertions from './core/assert/base';\nimport {\n  USER_ERROR_SENTINEL,\n  elementStringOrPassThru,\n  isUserErrorMessage,\n  stripUserError,\n} from './core/error/message-helpers';\nimport {createErrorVargs, duplicateErrorIfNecessary} from './core/error';\nimport {getMode} from './mode';\nimport {internalRuntimeVersion} from './internal-version';\nimport {isArray} from './core/types';\nimport {once} from './core/types/function';\nimport {urls} from './config';\n\nconst noop = () => {};\n\n// These are exported here despite being defined in core to avoid updating\n// imports for now.\nexport {USER_ERROR_SENTINEL, isUserErrorMessage, stripUserError};\n\n/**\n * Four zero width space.\n *\n * @const {string}\n */\nexport const USER_ERROR_EMBED_SENTINEL = '\\u200B\\u200B\\u200B\\u200B';\n\n/**\n * @param {string} message\n * @return {boolean} Whether this message was a a user error from an iframe embed.\n */\nexport function isUserErrorEmbed(message) {\n  return message.indexOf(USER_ERROR_EMBED_SENTINEL) >= 0;\n}\n\n/**\n * @enum {number}\n */\nexport const LogLevel = {\n  OFF: 0,\n  ERROR: 1,\n  WARN: 2,\n  INFO: 3,\n  FINE: 4,\n};\n\n/**\n * Sets reportError function. Called from error-reporting.js to break cyclic\n * dependency.\n * @param {function(this:Window, Error, (?Element)=): ?|undefined} fn\n */\nexport function setReportError(fn) {\n  self.__AMP_REPORT_ERROR = fn;\n}\n\n/**\n * @type {!LogLevel|undefined}\n * @private\n */\nlet levelOverride_ = undefined;\n\n/**\n * @param {!LogLevel} level\n */\nexport function overrideLogLevel(level) {\n  levelOverride_ = level;\n}\n\n/**\n * Prefixes `internalRuntimeVersion` with the `01` channel signifier (for prod.) for\n * extracted message URLs.\n * (Specific channel is irrelevant: message tables are invariant on internal version.)\n * @return {string}\n */\nconst messageUrlRtv = () => `01${internalRuntimeVersion()}`;\n\n/**\n * Gets a URL to display a message on amp.dev.\n * @param {string} id\n * @param {!Array} interpolatedParts\n * @return {string}\n */\nconst externalMessageUrl = (id, interpolatedParts) =>\n  interpolatedParts.reduce(\n    (prefix, arg) => `${prefix}&s[]=${messageArgToEncodedComponent(arg)}`,\n    `https://log.amp.dev/?v=${messageUrlRtv()}&id=${encodeURIComponent(id)}`\n  );\n\n/**\n * URL to simple log messages table JSON file, which contains an Object<string, string>\n * which maps message id to full message template.\n * @return {string}\n */\nconst externalMessagesSimpleTableUrl = () =>\n  `${urls.cdn}/rtv/${messageUrlRtv()}/log-messages.simple.json`;\n\n/**\n * @param {*} arg\n * @return {string}\n */\nconst messageArgToEncodedComponent = (arg) =>\n  encodeURIComponent(String(elementStringOrPassThru(arg)));\n\n/**\n * Logging class. Use of sentinel string instead of a boolean to check user/dev\n * errors because errors could be rethrown by some native code as a new error,\n * and only a message would survive. Also, some browser don\u2019t support a 5th\n * error object argument in window.onerror. List of supporting browser can be\n * found here:\n * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n * @final\n * @private Visible for testing only.\n */\nexport class Log {\n  /**\n   * opt_suffix will be appended to error message to identify the type of the\n   * error message. We can't rely on the error object to pass along the type\n   * because some browsers do not have this param in its window.onerror API.\n   * See:\n   * https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror.html\n   *\n   * @param {!Window} win\n   * @param {function(number, boolean):!LogLevel} levelFunc\n   * @param {string=} opt_suffix\n   */\n  constructor(win, levelFunc, opt_suffix = '') {\n    /**\n     * In tests we use the main test window instead of the iframe where\n     * the tests runs because only the former is relayed to the console.\n     * @const {!Window}\n     */\n    this.win = getMode().test && win.__AMP_TEST_IFRAME ? win.parent : win;\n\n    /** @private @const {function(number, boolean):!LogLevel} */\n    this.levelFunc_ = levelFunc;\n\n    /** @private @const {!LogLevel} */\n    this.level_ = this.defaultLevel_();\n\n    /** @private @const {string} */\n    this.suffix_ = opt_suffix;\n\n    /** @private {?JsonObject} */\n    this.messages_ = null;\n\n    this.fetchExternalMessagesOnce_ = once(() => {\n      win\n        .fetch(externalMessagesSimpleTableUrl())\n        .then((response) => response.json(), noop)\n        .then((opt_messages) => {\n          if (opt_messages) {\n            this.messages_ = /** @type {!JsonObject} */ (opt_messages);\n          }\n        });\n    });\n\n    // This bound assertion function is capable of handling the format used when\n    // error/assertion messages are extracted. This logic hasn't yet been\n    // migrated to an AMP-independent form for use in core. This binding allows\n    // Log assertion helpers to maintain message-extraction capabilities until\n    // that logic can be moved to core.\n    this.boundAssertFn_ = /** @type {!assertions.AssertionFunctionDef} */ (\n      this.assert.bind(this)\n    );\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  getLevel_() {\n    return levelOverride_ !== undefined ? levelOverride_ : this.level_;\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevel_() {\n    // No console - can't enable logging.\n    if (!this.win.console || !this.win.console.log) {\n      return LogLevel.OFF;\n    }\n\n    // Logging has been explicitly disabled.\n    if (getMode().log == '0') {\n      return LogLevel.OFF;\n    }\n\n    // Logging is enabled for tests directly.\n    if (getMode().test && this.win.ENABLE_LOG) {\n      return LogLevel.FINE;\n    }\n\n    // LocalDev by default allows INFO level, unless overriden by `#log`.\n    if (getMode().localDev && !getMode().log) {\n      return LogLevel.INFO;\n    }\n\n    return this.defaultLevelWithFunc_();\n  }\n\n  /**\n   * @return {!LogLevel}\n   * @private\n   */\n  defaultLevelWithFunc_() {\n    // Delegate to the specific resolver.\n    return this.levelFunc_(parseInt(getMode().log, 10), getMode().development);\n  }\n\n  /**\n   * @param {string} tag\n   * @param {!LogLevel} level\n   * @param {!Array} messages\n   * @return {boolean} true if a message was logged\n   */\n  msg_(tag, level, messages) {\n    if (this.getLevel_() < level) {\n      return false;\n    }\n    let fn = this.win.console.log;\n    if (level == LogLevel.ERROR) {\n      fn = this.win.console.error || fn;\n    } else if (level == LogLevel.INFO) {\n      fn = this.win.console.info || fn;\n    } else if (level == LogLevel.WARN) {\n      fn = this.win.console.warn || fn;\n    }\n    const args = this.maybeExpandMessageArgs_(messages);\n    // Prefix console message with \"[tag]\".\n    const prefix = `[${tag}]`;\n    if (typeof args[0] === 'string') {\n      // Prepend string to avoid breaking string substitutions e.g. %s.\n      args[0] = prefix + ' ' + args[0];\n    } else {\n      args.unshift(prefix);\n    }\n    fn.apply(this.win.console, args);\n    return true;\n  }\n\n  /**\n   * Whether the logging is enabled.\n   * @return {boolean}\n   */\n  isEnabled() {\n    return this.getLevel_() != LogLevel.OFF;\n  }\n\n  /**\n   * Reports a fine-grained message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  fine(tag, ...args) {\n    this.msg_(tag, LogLevel.FINE, args);\n  }\n\n  /**\n   * Reports a informational message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  info(tag, ...args) {\n    this.msg_(tag, LogLevel.INFO, args);\n  }\n\n  /**\n   * Reports a warning message.\n   * @param {string} tag\n   * @param {...*} args\n   */\n  warn(tag, ...args) {\n    this.msg_(tag, LogLevel.WARN, args);\n  }\n\n  /**\n   * Reports an error message. If the logging is disabled, the error is rethrown\n   * asynchronously.\n   * @param {string} tag\n   * @param {...*} args\n   * @return {!Error|undefined}\n   * @private\n   */\n  error_(tag, ...args) {\n    if (!this.msg_(tag, LogLevel.ERROR, args)) {\n      return this.createError.apply(this, args);\n    }\n  }\n\n  /**\n   * Reports an error message.\n   * @param {string} tag\n   * @param {...*} var_args\n   */\n  error(tag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      // TODO(rcebulko): Determine if/how this Error#name property is used.\n      error.name = tag || error.name;\n      // __AMP_REPORT_ERROR is installed globally per window in the entry point.\n      self.__AMP_REPORT_ERROR(error);\n    }\n  }\n\n  /**\n   * Reports an error message and marks with an expected property. If the\n   * logging is disabled, the error is rethrown asynchronously.\n   * @param {string} unusedTag\n   * @param {...*} var_args\n   */\n  expectedError(unusedTag, var_args) {\n    const error = this.error_.apply(this, arguments);\n    if (error) {\n      error.expected = true;\n      // __AMP_REPORT_ERROR is installed globally per window in the entry point.\n      self.__AMP_REPORT_ERROR(error);\n    }\n  }\n\n  /**\n   * Creates an error object.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    return error;\n  }\n\n  /**\n   * Creates an error object with its expected property set to true.\n   * @param {...*} var_args\n   * @return {!Error}\n   */\n  createExpectedError(var_args) {\n    const error = createErrorVargs.apply(null, arguments);\n    this.prepareError_(error);\n    error.expected = true;\n    return error;\n  }\n\n  /**\n   * Throws an error if the first argument isn't trueish.\n   *\n   * Supports argument substitution into the message via %s placeholders.\n   *\n   * Throws an error object that has two extra properties:\n   * - associatedElement: This is the first element provided in the var args.\n   *   It can be used for improved display of error messages.\n   * - messageArray: The elements of the substituted message as non-stringified\n   *   elements in an array. When e.g. passed to console.error this yields\n   *   native displays of things like HTML elements.\n   *\n   * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n   *     not evaluate to true.\n   * @param {!Array|string=} opt_message The assertion message\n   * @param {...*} var_args Arguments substituted into %s in the message.\n   * @return {T} The value of shouldBeTrueish.\n   * @throws {!Error} When `value` is falsey.\n   * @template T\n   * @closurePrimitive {asserts.truthy}\n   */\n  assert(shouldBeTrueish, opt_message, var_args) {\n    if (isArray(opt_message)) {\n      return this.assert.apply(\n        this,\n        [shouldBeTrueish].concat(\n          this.expandMessageArgs_(/** @type {!Array} */ (opt_message))\n        )\n      );\n    }\n\n    return assertions.assert.apply(\n      null,\n      [this.suffix_].concat(Array.prototype.slice.call(arguments))\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't an Element\n   *\n   * Otherwise see `assert` for usage\n   *\n   * @param {*} shouldBeElement\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {!Element} The value of shouldBeTrueish.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertElement(shouldBeElement, opt_message) {\n    return assertions.assertElement(\n      this.boundAssertFn_,\n      shouldBeElement,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't a string. The string can\n   * be empty.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeString\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {string} The string value. Can be an empty string.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertString(shouldBeString, opt_message) {\n    return assertions.assertString(\n      this.boundAssertFn_,\n      shouldBeString,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't a number. The allowed values\n   * include `0` and `NaN`.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeNumber\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {number} The number value. The allowed values include `0`\n   *   and `NaN`.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertNumber(shouldBeNumber, opt_message) {\n    return assertions.assertNumber(\n      this.boundAssertFn_,\n      shouldBeNumber,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument is not an array.\n   * The array can be empty.\n   *\n   * @param {*} shouldBeArray\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {!Array} The array value\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertArray(shouldBeArray, opt_message) {\n    return assertions.assertArray(\n      this.boundAssertFn_,\n      shouldBeArray,\n      opt_message\n    );\n  }\n\n  /**\n   * Throws an error if the first argument isn't a boolean.\n   *\n   * For more details see `assert`.\n   *\n   * @param {*} shouldBeBoolean\n   * @param {!Array|string=} opt_message The assertion message\n   * @return {boolean} The boolean value.\n   * @closurePrimitive {asserts.matchesReturn}\n   */\n  assertBoolean(shouldBeBoolean, opt_message) {\n    return assertions.assertBoolean(\n      this.boundAssertFn_,\n      shouldBeBoolean,\n      opt_message\n    );\n  }\n\n  /**\n   * @param {!Error} error\n   * @private\n   */\n  prepareError_(error) {\n    error = duplicateErrorIfNecessary(error);\n\n    if (this.suffix_) {\n      if (!error.message) {\n        error.message = this.suffix_;\n      } else if (error.message.indexOf(this.suffix_) == -1) {\n        error.message += this.suffix_;\n      }\n    } else if (isUserErrorMessage(error.message)) {\n      error.message = error.message.replace(USER_ERROR_SENTINEL, '');\n    }\n  }\n\n  /**\n   * @param {!Array} args\n   * @return {!Array}\n   * @private\n   */\n  maybeExpandMessageArgs_(args) {\n    if (isArray(args[0])) {\n      return this.expandMessageArgs_(/** @type {!Array} */ (args[0]));\n    }\n    return args;\n  }\n\n  /**\n   * Either redirects a pair of (errorId, ...args) to a URL where the full\n   * message is displayed, or displays it from a fetched table.\n   *\n   * This method is used by the output of the `transform-log-methods` babel\n   * plugin. It should not be used directly. Use the (*error|assert*|info|warn)\n   * methods instead.\n   *\n   * @param {!Array} parts\n   * @return {!Array}\n   * @private\n   */\n  expandMessageArgs_(parts) {\n    // First value should exist.\n    const id = parts.shift();\n    // Best effort fetch of message template table.\n    // Since this is async, the first few logs might be indirected to a URL even\n    // if in development mode. Message table is ~small so this should be a short\n    // gap.\n    if (getMode(this.win).development) {\n      this.fetchExternalMessagesOnce_();\n    }\n    if (this.messages_ && id in this.messages_) {\n      return [this.messages_[id]].concat(parts);\n    }\n    return [`More info at ${externalMessageUrl(id, parts)}`];\n  }\n}\n\n/**\n * Cache for logs. We do not use a Service since the service module depends\n * on Log and closure literally can't even.\n * @type {{user: ?Log, dev: ?Log, userForEmbed: ?Log}}\n */\nself.__AMP_LOG = self.__AMP_LOG || {\n  user: null,\n  dev: null,\n  userForEmbed: null,\n};\n\nconst logs = self.__AMP_LOG;\n\n/**\n * Eventually holds a constructor for Log objects. Lazily initialized, so we\n * can avoid ever referencing the real constructor except in JS binaries\n * that actually want to include the implementation.\n * @type {?typeof Log}\n */\nlet logConstructor = null;\n\n/**\n * Initializes log constructor.\n */\nexport function initLogConstructor() {\n  logConstructor = Log;\n  // Initialize instances for use. If a binary (an extension for example) that\n  // does not call `initLogConstructor` invokes `dev()` or `user()` earlier than\n  // the binary that does call `initLogConstructor` (amp.js), the extension will\n  // throw an error as that extension will never be able to initialize the log\n  // instances and we also don't want it to call `initLogConstructor` either\n  // (since that will cause the Log implementation to be bundled into that\n  // binary). So we must initialize the instances eagerly so that they are ready\n  // for use (stored globally) after the main binary calls `initLogConstructor`.\n  dev();\n  user();\n}\n\n/**\n * Resets log constructor for testing.\n */\nexport function resetLogConstructorForTesting() {\n  logConstructor = null;\n}\n\n/**\n * Publisher level log.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Development mode is enabled via `#development=1` or logging is explicitly\n *     enabled via `#log=D` where D >= 1.\n *  3. AMP.setLogLevel(D) is called, where D >= 1.\n *\n * @param {!Element=} opt_element\n * @return {!Log}\n */\nexport function user(opt_element) {\n  if (!logs.user) {\n    logs.user = getUserLogger(USER_ERROR_SENTINEL);\n  }\n  if (!isFromEmbed(logs.user.win, opt_element)) {\n    return logs.user;\n  } else {\n    if (logs.userForEmbed) {\n      return logs.userForEmbed;\n    }\n    return (logs.userForEmbed = getUserLogger(USER_ERROR_EMBED_SENTINEL));\n  }\n}\n\n/**\n * Getter for user logger\n * @param {string=} suffix\n * @return {!Log}\n */\nfunction getUserLogger(suffix) {\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return new logConstructor(\n    self,\n    (logNum, development) => {\n      if (development || logNum >= 1) {\n        return LogLevel.FINE;\n      }\n      return LogLevel.WARN;\n    },\n    suffix\n  );\n}\n\n/**\n * AMP development log. Calls to `devLog().assert` and `dev.fine` are stripped\n * in the PROD binary. However, `devLog().assert` result is preserved in either\n * case.\n *\n * Enabled in the following conditions:\n *  1. Not disabled using `#log=0`.\n *  2. Logging is explicitly enabled via `#log=D`, where D >= 2.\n *  3. AMP.setLogLevel(D) is called, where D >= 2.\n *\n * @return {!Log}\n */\nexport function dev() {\n  if (logs.dev) {\n    return logs.dev;\n  }\n  if (!logConstructor) {\n    throw new Error('failed to call initLogConstructor');\n  }\n  return (logs.dev = new logConstructor(self, (logNum) => {\n    if (logNum >= 3) {\n      return LogLevel.FINE;\n    }\n    if (logNum >= 2) {\n      return LogLevel.INFO;\n    }\n    return LogLevel.OFF;\n  }));\n}\n\n/**\n * @param {!Window} win\n * @param {!Element=} opt_element\n * @return {boolean} isEmbed\n */\nexport function isFromEmbed(win, opt_element) {\n  if (!opt_element) {\n    return false;\n  }\n  return opt_element.ownerDocument.defaultView != win;\n}\n\n/**\n * Throws an error if the first argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - associatedElement: This is the first element provided in the var args.\n *   It can be used for improved display of error messages.\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n *\n * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n *     not evaluate to true.\n * @param {!Array|string=} opt_message The assertion message\n * @param {*=} opt_1 Optional argument (Var arg as individual params for better\n * @param {*=} opt_2 Optional argument inlining)\n * @param {*=} opt_3 Optional argument\n * @param {*=} opt_4 Optional argument\n * @param {*=} opt_5 Optional argument\n * @param {*=} opt_6 Optional argument\n * @param {*=} opt_7 Optional argument\n * @param {*=} opt_8 Optional argument\n * @param {*=} opt_9 Optional argument\n * @return {T} The value of shouldBeTrueish.\n * @throws {!Error} When `shouldBeTrueish` is falsey.\n * @template T\n * @closurePrimitive {asserts.truthy}\n */\nexport function devAssert(\n  shouldBeTrueish,\n  opt_message,\n  opt_1,\n  opt_2,\n  opt_3,\n  opt_4,\n  opt_5,\n  opt_6,\n  opt_7,\n  opt_8,\n  opt_9\n) {\n  if (getMode().minified) {\n    return shouldBeTrueish;\n  }\n  if (self.__AMP_ASSERTION_CHECK) {\n    // This will never execute regardless, but will be included on unminified\n    // builds. It will be DCE'd away from minified builds, and so can be used to\n    // validate that Babel is properly removing dev assertions in minified\n    // builds.\n    console /*OK*/\n      .log('__devAssert_sentinel__');\n  }\n\n  return dev()./*Orig call*/ assert(\n    shouldBeTrueish,\n    opt_message,\n    opt_1,\n    opt_2,\n    opt_3,\n    opt_4,\n    opt_5,\n    opt_6,\n    opt_7,\n    opt_8,\n    opt_9\n  );\n}\n\n/**\n * Throws an error if the first argument isn't trueish.\n *\n * Supports argument substitution into the message via %s placeholders.\n *\n * Throws an error object that has two extra properties:\n * - associatedElement: This is the first element provided in the var args.\n *   It can be used for improved display of error messages.\n * - messageArray: The elements of the substituted message as non-stringified\n *   elements in an array. When e.g. passed to console.error this yields\n *   native displays of things like HTML elements.\n *\n * @param {T} shouldBeTrueish The value to assert. The assert fails if it does\n *     not evaluate to true.\n * @param {!Array|string=} opt_message The assertion message\n * @param {*=} opt_1 Optional argument (Var arg as individual params for better\n * @param {*=} opt_2 Optional argument inlining)\n * @param {*=} opt_3 Optional argument\n * @param {*=} opt_4 Optional argument\n * @param {*=} opt_5 Optional argument\n * @param {*=} opt_6 Optional argument\n * @param {*=} opt_7 Optional argument\n * @param {*=} opt_8 Optional argument\n * @param {*=} opt_9 Optional argument\n * @return {T} The value of shouldBeTrueish.\n * @throws {!Error} When `shouldBeTrueish` is falsey.\n * @template T\n * @closurePrimitive {asserts.truthy}\n */\nexport function userAssert(\n  shouldBeTrueish,\n  opt_message,\n  opt_1,\n  opt_2,\n  opt_3,\n  opt_4,\n  opt_5,\n  opt_6,\n  opt_7,\n  opt_8,\n  opt_9\n) {\n  return user()./*Orig call*/ assert(\n    shouldBeTrueish,\n    opt_message,\n    opt_1,\n    opt_2,\n    opt_3,\n    opt_4,\n    opt_5,\n    opt_6,\n    opt_7,\n    opt_8,\n    opt_9\n  );\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * Whether addEventListener supports options or only takes capture as a boolean\n * @type {boolean|undefined}\n * @visibleForTesting\n */\nlet optsSupported;\n\n/**\n * Whether addEventListener supports options or only takes passive as a boolean\n * @type {boolean|undefined}\n */\nlet passiveSupported;\n\n/**\n * Options supported by addEventListener\n * @typedef AddEventListenerOptsDef\n * @property {undefined|boolean} [capture]\n * @property {undefined|boolean} [once]\n * @property {undefined|boolean} [passive]\n * @property {undefined|!AbortSignal} [signal]\n * }}\n */\nlet AddEventListenerOptsDef;\n\n/**\n * Listens for the specified event on the element.\n *\n * Do not use this directly. This method is implemented as a shared\n * dependency. Use `listen()` in either `event-helper` or `3p-frame-messaging`,\n * depending on your use case.\n *\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {!AddEventListenerOptsDef=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function internalListenImplementation(\n  element,\n  eventType,\n  listener,\n  opt_evtListenerOpts\n) {\n  let localElement = element;\n  let localListener = listener;\n  /** @type {?function(!Event)} */\n  let wrapped = (event) => {\n    try {\n      return localListener(event);\n    } catch (e) {\n      // __AMP_REPORT_ERROR is installed globally per window in the entry point.\n      self.__AMP_REPORT_ERROR?.(e);\n      throw e;\n    }\n  };\n  const optsSupported = detectEvtListenerOptsSupport();\n  const capture = !!opt_evtListenerOpts?.capture;\n\n  localElement.addEventListener(\n    eventType,\n    wrapped,\n    optsSupported ? opt_evtListenerOpts : capture\n  );\n  return () => {\n    localElement?.removeEventListener(\n      eventType,\n      wrapped,\n      optsSupported ? opt_evtListenerOpts : capture\n    );\n    // Ensure these are GC'd\n    localListener = null;\n    localElement = null;\n    wrapped = null;\n  };\n}\n\n/**\n * Tests whether the browser supports options as an argument of addEventListener\n * or not.\n *\n * @return {boolean}\n */\nexport function detectEvtListenerOptsSupport() {\n  // Only run the test once\n  if (optsSupported !== undefined) {\n    return optsSupported;\n  }\n\n  optsSupported = false;\n  try {\n    // Test whether browser supports EventListenerOptions or not\n    const options = {\n      get capture() {\n        optsSupported = true;\n      },\n    };\n    self.addEventListener('test-options', null, options);\n    self.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return optsSupported;\n}\n\n/**\n * Resets the test for whether addEventListener supports options or not.\n */\nexport function resetEvtListenerOptsSupportForTesting() {\n  optsSupported = undefined;\n}\n\n/**\n * Return boolean. if listener option is supported, return `true`.\n * if not supported, return `false`\n * @param {!Window} win\n * @return {boolean}\n */\nexport function supportsPassiveEventListener(win) {\n  if (passiveSupported !== undefined) {\n    return passiveSupported;\n  }\n\n  passiveSupported = false;\n  try {\n    const options = {\n      get passive() {\n        // This function will be called when the browser\n        // attempts to access the passive property.\n        passiveSupported = true;\n        return false;\n      },\n    };\n\n    win.addEventListener('test-options', null, options);\n    win.removeEventListener('test-options', null, options);\n  } catch (err) {\n    // EventListenerOptions are not supported\n  }\n  return passiveSupported;\n}\n\n/**\n * Resets the test for whether addEventListener supports passive options or not.\n */\nexport function resetPassiveSupportedForTesting() {\n  passiveSupported = undefined;\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {isArray} from '../array';\n\n/**\n * @fileoverview This module declares JSON types as defined in the\n * {@link http://json.org/}.\n */\n\n// NOTE Type are changed to {*} because of\n// https://github.com/google/closure-compiler/issues/1999\n\n/**\n * JSON scalar. It's either string, number or boolean.\n * @typedef {string|number|boolean|null}\n */\nlet JSONScalarDef;\n\n/**\n * JSON object. It's a map with string keys and JSON values.\n * @typedef {!Object<string, ?*>} (* should be JSONValueDef)\n */\nlet JSONObjectDef;\n\n/**\n * JSON array. It's an array with JSON values.\n * @typedef {!Array<?*>} (* should be JSONValueDef)\n */\nlet JSONArrayDef;\n\n/**\n * JSON value. It's either a scalar, an object or an array.\n * @typedef {!JSONScalarDef|!JSONObjectDef|!JSONArrayDef}\n */\nlet JSONValueDef;\n\n/**\n * @typedef {{\n *   YOU_MUST_USE: string,\n *   jsonLiteral: function(),\n *   TO_MAKE_THIS_TYPE: string,\n * }}\n */\nlet InternalJsonLiteralTypeDef;\n\n/**\n * Simple wrapper around JSON.parse that casts the return value\n * to JsonObject.\n * Create a new wrapper if an array return value is desired.\n * @param {string} json JSON string to parse\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function parseJson(json) {\n  return /** @type {?JsonObject} */ (JSON.parse(json));\n}\n\n/**\n * Parses the given `json` string without throwing an exception if not valid.\n * Returns `undefined` if parsing fails.\n * Returns the `Object` corresponding to the JSON string when parsing succeeds.\n * @param {string} json JSON string to parse\n * @param {function(!Error)=} opt_onFailed Optional function that will be called\n *     with the error if parsing fails.\n * @return {?JsonObject} May be extend to parse arrays.\n */\nexport function tryParseJson(json, opt_onFailed) {\n  try {\n    return parseJson(json);\n  } catch (e) {\n    opt_onFailed?.(e);\n    return null;\n  }\n}\n\n/**\n * Deeply checks strict equality of items in nested arrays and objects.\n *\n * @param {JSONValueDef} a\n * @param {JSONValueDef} b\n * @param {number} depth The maximum depth. Must be finite.\n * @return {boolean}\n * @throws {Error} If depth argument is not finite.\n */\nexport function deepEquals(a, b, depth = 5) {\n  if (!isFinite(depth) || depth < 0) {\n    throw new Error('Invalid depth: ' + depth);\n  }\n  if (a === b) {\n    return true;\n  }\n  /** @type {!Array<{a: JSONValueDef, b: JSONValueDef, depth: number}>} */\n  const queue = [{a, b, depth}];\n  while (queue.length > 0) {\n    const {a, b, depth} = queue.shift();\n    // Only check deep equality if depth > 0.\n    if (depth > 0) {\n      if (typeof a !== typeof b) {\n        return false;\n      } else if (isArray(a) && isArray(b)) {\n        if (a.length !== b.length) {\n          return false;\n        }\n        for (let i = 0; i < a.length; i++) {\n          queue.push({a: a[i], b: b[i], depth: depth - 1});\n        }\n        continue;\n      } else if (a && b && typeof a === 'object' && typeof b === 'object') {\n        const keysA = Object.keys(a);\n        const keysB = Object.keys(b);\n        if (keysA.length !== keysB.length) {\n          return false;\n        }\n        for (const k of keysA) {\n          queue.push({a: a[k], b: b[k], depth: depth - 1});\n        }\n        continue;\n      }\n    }\n    // If we get here, then depth == 0 or (a, b) are primitives.\n    if (a !== b) {\n      return false;\n    }\n  }\n  return true;\n}\n\n/**\n * This helper function handles configurations specified in a JSON format.\n *\n * It allows the configuration is to be written in plain JS (which has better\n * dev ergonomics like comments and trailing commas), and allows the\n * configuration to be transformed into an efficient JSON-parsed representation\n * in the dist build. See https://v8.dev/blog/cost-of-javascript-2019#json\n *\n * @param {!Object} obj\n * @return {!JsonObject}\n */\nexport function jsonConfiguration(obj) {\n  return /** @type {!JsonObject} */ (obj);\n}\n\n/**\n * This converts an Object into a suitable type to be used in `includeJsonLiteral`.\n * This doesn't actually do any conversion, it only changes the closure type.\n *\n * @param {?JSONValueDef} value\n * @return {!InternalJsonLiteralTypeDef}\n */\nexport function jsonLiteral(value) {\n  return /** @type {!InternalJsonLiteralTypeDef} */ (value);\n}\n\n/**\n * Allows inclusion of a variable (that's wrapped in a jsonLiteral\n * call) to be included inside a jsonConfiguration.\n *\n * @param {!InternalJsonLiteralTypeDef} value\n * @return {*}\n */\nexport function includeJsonLiteral(value) {\n  return value;\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev, devAssert} from './log';\nimport {dict} from './core/types/object';\nimport {internalListenImplementation} from './core/dom/event-helper-listen';\nimport {tryParseJson} from './core/types/object/json';\n\n/** @const */\nconst AMP_MESSAGE_PREFIX = 'amp-';\nexport const CONSTANTS = {\n  responseTypeSuffix: '-result',\n  messageIdFieldName: 'messageId',\n  payloadFieldName: 'payload',\n  contentFieldName: 'content',\n};\n\n/** @enum {string} */\nexport const MessageType = {\n  // For amp-ad\n  SEND_EMBED_STATE: 'send-embed-state',\n  EMBED_STATE: 'embed-state',\n  SEND_EMBED_CONTEXT: 'send-embed-context',\n  EMBED_CONTEXT: 'embed-context',\n  SEND_INTERSECTIONS: 'send-intersections',\n  INTERSECTION: 'intersection',\n  EMBED_SIZE: 'embed-size',\n  EMBED_SIZE_CHANGED: 'embed-size-changed',\n  EMBED_SIZE_DENIED: 'embed-size-denied',\n  NO_CONTENT: 'no-content',\n  GET_HTML: 'get-html',\n  GET_CONSENT_STATE: 'get-consent-state',\n  SIGNAL_INTERACTIVE: 'signal-interactive',\n\n  // For the frame to be placed in full overlay mode for lightboxes\n  FULL_OVERLAY_FRAME: 'full-overlay-frame',\n  FULL_OVERLAY_FRAME_RESPONSE: 'full-overlay-frame-response',\n  CANCEL_FULL_OVERLAY_FRAME: 'cancel-full-overlay-frame',\n  CANCEL_FULL_OVERLAY_FRAME_RESPONSE: 'cancel-full-overlay-frame-response',\n\n  // For amp-inabox\n  SEND_POSITIONS: 'send-positions',\n  POSITION: 'position',\n\n  // For amp-analytics' iframe-transport\n  SEND_IFRAME_TRANSPORT_EVENTS: 'send-iframe-transport-events',\n  IFRAME_TRANSPORT_EVENTS: 'iframe-transport-events',\n  IFRAME_TRANSPORT_RESPONSE: 'iframe-transport-response',\n\n  // For user-error-in-iframe\n  USER_ERROR_IN_IFRAME: 'user-error-in-iframe',\n\n  // For amp-iframe\n  SEND_CONSENT_DATA: 'send-consent-data',\n  CONSENT_DATA: 'consent-data',\n};\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n    element,\n    eventType,\n    listener,\n    opt_evtListenerOpts\n  );\n}\n\n/**\n * Serialize an AMP post message. Output looks like:\n * 'amp-011481323099490{\"type\":\"position\",\"sentinel\":\"12345\",\"foo\":\"bar\"}'\n * @param {string} type\n * @param {string} sentinel\n * @param {JsonObject=} data\n * @param {?string=} rtvVersion\n * @return {string}\n */\nexport function serializeMessage(\n  type,\n  sentinel,\n  data = dict(),\n  rtvVersion = null\n) {\n  // TODO: consider wrap the data in a \"data\" field. { type, sentinal, data }\n  const message = data;\n  message['type'] = type;\n  message['sentinel'] = sentinel;\n  return AMP_MESSAGE_PREFIX + (rtvVersion || '') + JSON.stringify(message);\n}\n\n/**\n * Deserialize an AMP post message.\n * Returns null if it's not valid AMP message format.\n *\n * @param {*} message\n * @return {?JsonObject|undefined}\n */\nexport function deserializeMessage(message) {\n  if (!isAmpMessage(message)) {\n    return null;\n  }\n  const startPos = message.indexOf('{');\n  devAssert(startPos != -1, 'JSON missing in %s', message);\n  return tryParseJson(message.substr(startPos), (e) =>\n    dev().error('MESSAGING', 'Failed to parse message: ' + message, e)\n  );\n}\n\n/**\n *  Returns true if message looks like it is an AMP postMessage\n *  @param {*} message\n *  @return {boolean}\n */\nexport function isAmpMessage(message) {\n  return (\n    typeof message == 'string' &&\n    message.indexOf(AMP_MESSAGE_PREFIX) == 0 &&\n    message.indexOf('{') != -1\n  );\n}\n\n/** @typedef {{creativeId: string, message: string}} */\nexport let IframeTransportEvent;\n// An event, and the transport ID of the amp-analytics tags that\n// generated it. For instance if the creative with transport\n// ID 2 sends \"hi\", then an IframeTransportEvent would look like:\n// { creativeId: \"2\", message: \"hi\" }\n// If the creative with transport ID 2 sent that, and also sent \"hello\",\n// and the creative with transport ID 3 sends \"goodbye\" then an *array* of 3\n// AmpAnalyticsIframeTransportEvent would be sent to the 3p frame like so:\n// [\n//   { creativeId: \"2\", message: \"hi\" }, // An AmpAnalyticsIframeTransportEvent\n//   { creativeId: \"2\", message: \"hello\" }, // Another\n//   { creativeId: \"3\", message: \"goodbye\" } // And another\n// ]\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {removeItem} from '../types/array';\n\n/**\n * This class helps to manage observers. Observers can be added, removed or\n * fired through and instance of this class.\n * @template TYPE\n */\nexport class Observable {\n  /**\n   * Creates an instance of Observable.\n   */\n  constructor() {\n    /** @type {?Array<function(TYPE)>} */\n    this.handlers_ = null;\n  }\n\n  /**\n   * Adds the observer to this instance.\n   * @param {function(TYPE)} handler Observer's handler.\n   * @return {!UnlistenDef}\n   */\n  add(handler) {\n    if (!this.handlers_) {\n      this.handlers_ = [];\n    }\n    this.handlers_.push(handler);\n    return () => {\n      this.remove(handler);\n    };\n  }\n\n  /**\n   * Removes the observer from this instance.\n   * @param {function(TYPE)} handler Observer's instance.\n   */\n  remove(handler) {\n    if (!this.handlers_) {\n      return;\n    }\n    removeItem(this.handlers_, handler);\n  }\n\n  /**\n   * Removes all observers.\n   */\n  removeAll() {\n    if (!this.handlers_) {\n      return;\n    }\n    this.handlers_.length = 0;\n  }\n\n  /**\n   * Fires an event. All observers are called.\n   * @param {TYPE=} opt_event\n   */\n  fire(opt_event) {\n    if (!this.handlers_) {\n      return;\n    }\n    for (const handler of this.handlers_) {\n      handler(opt_event);\n    }\n  }\n\n  /**\n   * Returns number of handlers. Mostly needed for tests.\n   * @return {number}\n   */\n  getHandlerCount() {\n    return this.handlers_?.length ?? 0;\n  }\n}\n", "/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n\n\n/**\n * This regex consists of 4 matching capture groups and one (non-matching) fallback:\n *\n * - (\\0), catch the null terminator character so it may be replaced by UTF\n *   Replacement Char\n * - ^(-)$, catch a solitary dash char, so that it may be backslash escaped.\n *   This is a separate capture group so that the legal-chars (group 4) doesn't\n *   capture it first, since that group doesn't need to escape its dash.\n * - ([\\x01-\\x1f\\x7f]|^-?[0-9]), catch a UTF control char, or any leading\n *   number (with an optional leading dash). The control or the number (but not\n *   the leading dash) must be hex-escaped,.\n * - ([\\x80-\\uffff0-9a-zA-Z_-]+), catch legal-chars, with the exception of a\n *   solitary dash, which will already have matched in group 1.\n * - [^], finally, a catch-all that allows us to backslash escape the char.\n *\n * Together, this matches everything necessary for CSS.escape.\n */\nvar regex = /(\\0)|^(-)$|([\\x01-\\x1f\\x7f]|^-?[0-9])|([\\x80-\\uffff0-9a-zA-Z_-]+)|[^]/g;\n\nfunction escaper(match, nil, dash, hexEscape, chars) {\n  // Chars is the legal-chars (group 4) capture\n  if (chars) {\n    return chars;\n  }\n  // Nil is the null terminator (group 1) capture\n  if (nil) {\n    return '\\uFFFD';\n  }\n  // Both UTF control chars, and leading numbers (with optional leading dash)\n  // (group 3) must be backslash escaped with a trailing space.  Funnily, the\n  // leading dash must not be escaped, but the number. :shrug:\n  if (hexEscape) {\n    return match.slice(0, -1) + '\\\\' + match.slice(-1).charCodeAt(0).toString(16) + ' '\n  }\n  // Finally, the solitary dash and the catch-all chars require backslash\n  // escaping.\n  return '\\\\' + match;\n}\n\n/**\n * https://drafts.csswg.org/cssom/#serialize-an-identifier\n * @param {string} value\n * @return {string}\n */\nexport function cssEscape(value) {\n  return String(value).replace(regex, escaper);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {internalListenImplementation} from './core/dom/event-helper-listen';\nimport {lastChildElement} from './core/dom/query';\nimport {user} from './log';\n\n/** @const {string}  */\nconst LOAD_FAILURE_PREFIX = 'Failed to load:';\n\n/** @const {string} */\nexport const MEDIA_LOAD_FAILURE_SRC_PROPERTY = '__AMP_MEDIA_LOAD_FAILURE_SRC';\n\n/**\n * Returns a CustomEvent with a given type and detail; supports fallback for IE.\n * @param {!Window} win\n * @param {string} type\n * @param {!JsonObject|string|undefined|null} detail\n * @param {EventInit=} opt_eventInit\n * @return {!Event}\n */\nexport function createCustomEvent(win, type, detail, opt_eventInit) {\n  const eventInit = /** @type {!CustomEventInit} */ ({detail});\n  Object.assign(eventInit, opt_eventInit);\n  // win.CustomEvent is a function on Edge, Chrome, FF, Safari but\n  // is an object on IE 11.\n  if (IS_ESM || typeof win.CustomEvent == 'function') {\n    return new win.CustomEvent(type, eventInit);\n  } else {\n    // Deprecated fallback for IE.\n    const e = win.document.createEvent('CustomEvent');\n    e.initCustomEvent(\n      type,\n      !!eventInit.bubbles,\n      !!eventInit.cancelable,\n      detail\n    );\n    return e;\n  }\n}\n\n/**\n * Listens for the specified event on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listen(element, eventType, listener, opt_evtListenerOpts) {\n  return internalListenImplementation(\n    element,\n    eventType,\n    listener,\n    opt_evtListenerOpts\n  );\n}\n\n/**\n * Returns the data property of an event with the correct type.\n * @param {!Event|{data: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getData(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.data);\n}\n\n/**\n * Returns the detail property of an event with the correct type.\n * @param {!Event|{detail: !JsonObject}} event\n * @return {?JsonObject|string|undefined}\n */\nexport function getDetail(event) {\n  return /** @type {?JsonObject|string|undefined} */ (event.detail);\n}\n\n/**\n * Listens for the specified event on the element and removes the listener\n * as soon as event has been received.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {function(!Event)} listener\n * @param {Object=} opt_evtListenerOpts\n * @return {!UnlistenDef}\n */\nexport function listenOnce(element, eventType, listener, opt_evtListenerOpts) {\n  let localListener = listener;\n  const unlisten = internalListenImplementation(\n    element,\n    eventType,\n    (event) => {\n      try {\n        localListener(event);\n      } finally {\n        // Ensure listener is GC'd\n        localListener = null;\n        unlisten();\n      }\n    },\n    opt_evtListenerOpts\n  );\n  return unlisten;\n}\n\n/**\n * Returns  a promise that will resolve as soon as the specified event has\n * fired on the element.\n * @param {!EventTarget} element\n * @param {string} eventType\n * @param {Object=} opt_evtListenerOpts\n * @param {function(!UnlistenDef)=} opt_cancel An optional function that, when\n *     provided, will be called with the unlistener. This gives the caller\n *     access to the unlistener, so it may be called manually when necessary.\n * @return {!Promise<!Event>}\n */\nexport function listenOncePromise(\n  element,\n  eventType,\n  opt_evtListenerOpts,\n  opt_cancel\n) {\n  let unlisten;\n  const eventPromise = new Promise((resolve) => {\n    unlisten = listenOnce(element, eventType, resolve, opt_evtListenerOpts);\n  });\n  eventPromise.then(unlisten, unlisten);\n  if (opt_cancel) {\n    opt_cancel(unlisten);\n  }\n  return eventPromise;\n}\n\n/**\n * Whether the specified element/window has been loaded already.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nexport function isLoaded(eleOrWindow) {\n  return !!(\n    eleOrWindow.complete ||\n    eleOrWindow.readyState == 'complete' ||\n    (isHTMLMediaElement(eleOrWindow) && eleOrWindow.readyState > 0) ||\n    // If the passed in thing is a Window, infer loaded state from\n    //\n    (eleOrWindow.document && eleOrWindow.document.readyState == 'complete')\n  );\n}\n\n/**\n * Returns a promise that will resolve or fail based on the eleOrWindow's 'load'\n * and 'error' events. Optionally this method takes a timeout, which will reject\n * the promise if the resource has not loaded by then.\n * @param {T} eleOrWindow Supports both Elements and as a special case Windows.\n * @return {!Promise<T>}\n * @template T\n */\nexport function loadPromise(eleOrWindow) {\n  let unlistenLoad;\n  let unlistenError;\n  if (isLoaded(eleOrWindow)) {\n    return Promise.resolve(eleOrWindow);\n  }\n  const isMediaElement = isHTMLMediaElement(eleOrWindow);\n  if (\n    isMediaElement &&\n    eleOrWindow[MEDIA_LOAD_FAILURE_SRC_PROPERTY] === eleOrWindow.currentSrc\n  ) {\n    return Promise.reject(eleOrWindow);\n  }\n  const loadingPromise = new Promise((resolve, reject) => {\n    // Listen once since IE 5/6/7 fire the onload event continuously for\n    // animated GIFs.\n    if (isMediaElement) {\n      // The following event can be triggered by the media or one of its\n      // sources. Using capture is required as the media events do not bubble.\n      unlistenLoad = listenOnce(eleOrWindow, 'loadedmetadata', resolve, {\n        capture: true,\n      });\n    } else {\n      unlistenLoad = listenOnce(eleOrWindow, 'load', resolve);\n    }\n    // Don't unlisten on error for Windows.\n    if (!eleOrWindow.tagName) {\n      return;\n    }\n    let errorTarget = eleOrWindow;\n    // If the media element has no `src`, it will try to load the sources in\n    // document order. If the last source errors, then the media element\n    // loading errored.\n    if (isMediaElement && !eleOrWindow.hasAttribute('src')) {\n      errorTarget = lastChildElement(\n        eleOrWindow,\n        (child) => child.tagName === 'SOURCE'\n      );\n      if (!errorTarget) {\n        return reject(new Error('Media has no source.'));\n      }\n    }\n    unlistenError = listenOnce(errorTarget, 'error', reject);\n  });\n\n  return loadingPromise.then(\n    () => {\n      if (unlistenError) {\n        unlistenError();\n      }\n      return eleOrWindow;\n    },\n    () => {\n      if (unlistenLoad) {\n        unlistenLoad();\n      }\n      failedToLoad(eleOrWindow);\n    }\n  );\n}\n\n/**\n * Emit error on load failure.\n * @param {!Element|!Window} eleOrWindow Supports both Elements and as a special\n *     case Windows.\n */\nfunction failedToLoad(eleOrWindow) {\n  // Mark the element as errored since some elements - like HTMLMediaElement\n  // using HTMLSourceElement - do not provide any synchronous way to verify if\n  // they already errored, even though the error event was already dispatched.\n  if (isHTMLMediaElement(eleOrWindow)) {\n    eleOrWindow[MEDIA_LOAD_FAILURE_SRC_PROPERTY] =\n      eleOrWindow.currentSrc || true;\n  }\n\n  // Report failed loads as user errors so that they automatically go\n  // into the \"document error\" bucket.\n  let target = eleOrWindow;\n  if (target && target.src) {\n    target = target.src;\n  }\n  throw user().createError(LOAD_FAILURE_PREFIX, target);\n}\n\n/**\n * Returns true if the parameter is a HTMLMediaElement.\n * @param {!Element|!Window} eleOrWindow\n * @return {boolean}\n */\nfunction isHTMLMediaElement(eleOrWindow) {\n  return eleOrWindow.tagName === 'AUDIO' || eleOrWindow.tagName === 'VIDEO';\n}\n\n/**\n * Returns true if this error message is was created for a load error.\n * @param {string} message An error message\n * @return {boolean}\n */\nexport function isLoadErrorMessage(message) {\n  return message.indexOf(LOAD_FAILURE_PREFIX) != -1;\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {\n  CONSTANTS,\n  deserializeMessage,\n  listen,\n  serializeMessage,\n} from '../src/3p-frame-messaging';\nimport {Observable} from '../src/core/data-structures/observable';\nimport {dev} from '../src/log';\nimport {dict, map} from '../src/core/types/object';\nimport {getData} from '../src/event-helper';\nimport {getMode} from '../src/mode';\n\nexport class IframeMessagingClient {\n  /**\n   * @param {!Window} win A window object.\n   * @param {Window=} hostWindow The host window to send messages to. If not set\n   * then we'll broadcast our messages to all parent windows and choose the\n   * first one with a valid response to be the host window.\n   */\n  constructor(win, hostWindow) {\n    /** @private {!Window} */\n    this.win_ = win;\n    /** @private {?string} */\n    this.rtvVersion_ = getMode().rtvVersion || null;\n    /** @private {?Window} */\n    this.hostWindow_ = hostWindow || null;\n    /** @private {?string} */\n    this.sentinel_ = null;\n    /** @type {number} */\n    this.nextMessageId_ = 1;\n    /**\n     * Map messageType keys to observables to be fired when messages of that\n     * type are received.\n     * @private {!Object}\n     */\n    this.observableFor_ = map();\n    this.setupEventListener_();\n  }\n\n  /**\n   * Retrieves data from host.\n   *\n   * @param {string} requestType\n   * @param {?Object} payload\n   * @param {function(*)} callback\n   */\n  getData(requestType, payload, callback) {\n    const responseType = requestType + CONSTANTS.responseTypeSuffix;\n    const messageId = this.nextMessageId_++;\n    const unlisten = this.registerCallback(responseType, (result) => {\n      if (result[CONSTANTS.messageIdFieldName] === messageId) {\n        unlisten();\n        callback(result[CONSTANTS.contentFieldName]);\n      }\n    });\n    const data = dict();\n    data[CONSTANTS.payloadFieldName] = payload;\n    data[CONSTANTS.messageIdFieldName] = messageId;\n    this.sendMessage(requestType, data);\n  }\n\n  /**\n   * Make an event listening request.\n   *\n   * @param {string} requestType The type of the request message.\n   * @param {string} responseType The type of the response message.\n   * @param {function(JsonObject)} callback The callback function to call\n   *   when a message with type responseType is received.\n   * @return {function()}\n   */\n  makeRequest(requestType, responseType, callback) {\n    const unlisten = this.registerCallback(responseType, callback);\n    this.sendMessage(requestType);\n    return unlisten;\n  }\n\n  /**\n   * Make a one time event listening request.\n   * Will unlisten after response is received.\n   *\n   * @param {string} requestType The type of the request message.\n   * @param {string} responseType The type of the response message.\n   * @param {function(Object)} callback The callback function to call\n   *   when a message with type responseType is received.\n   * @return {*} TODO(#23582): Specify return type\n   */\n  requestOnce(requestType, responseType, callback) {\n    const unlisten = this.registerCallback(responseType, (event) => {\n      unlisten();\n      callback(event);\n    });\n    this.sendMessage(requestType);\n    return unlisten;\n  }\n\n  /**\n   * Register callback function for message with type messageType.\n   * @param {string} messageType The type of the message.\n   * @param {function(?JsonObject)} callback The callback function to call\n   *   when a message with type messageType is received.\n   * @return {function()}\n   */\n  registerCallback(messageType, callback) {\n    // NOTE : no validation done here. any callback can be register\n    // for any callback, and then if that message is received, this\n    // class *will execute* that callback\n    return this.getOrCreateObservableFor_(messageType).add(callback);\n  }\n\n  /**\n   * Send a postMessage to Host Window, or all parent windows if host window is\n   * not set.\n   * @param {string} type The type of message to send.\n   * @param {JsonObject=} opt_payload The payload of message to send.\n   */\n  sendMessage(type, opt_payload) {\n    const msg = serializeMessage(\n      type,\n      dev().assertString(this.sentinel_),\n      opt_payload,\n      this.rtvVersion_\n    );\n\n    if (!this.hostWindow_) {\n      for (\n        let j = 0, hostWin = this.win_;\n        j < 10 && hostWin != this.win_.top;\n        j++\n      ) {\n        hostWin = hostWin.parent;\n        this.sendMessageInternal_(hostWin, msg);\n        j++;\n      }\n    } else {\n      this.sendMessageInternal_(this.hostWindow_, msg);\n    }\n  }\n\n  /**\n   * @param {!Window} win\n   * @param {string} msg\n   * private\n   */\n  sendMessageInternal_(win, msg) {\n    // opt in the userActivation feature\n    // see https://github.com/dtapuska/useractivation\n    if (this.isMessageOptionsSupported_(win)) {\n      this.postMessageWithUserActivation_(win, msg);\n    } else {\n      win./*OK*/ postMessage(msg, '*');\n    }\n  }\n\n  /**\n   * @param {!Window} win\n   * @param {string} msg\n   * @suppress {checkTypes} // Can be removed after closure compiler update their externs.\n   */\n  postMessageWithUserActivation_(win, msg) {\n    win./*OK*/ postMessage(\n      msg,\n      dict({\n        'targetOrigin': '*',\n        'includeUserActivation': true,\n      })\n    );\n  }\n\n  /**\n   * Sets up event listener for post messages of the desired type.\n   *   The actual implementation only uses a single event listener for all of\n   *   the different messages, and simply diverts the message to be handled\n   *   by different callbacks.\n   *   To add new messages to listen for, call registerCallback with the\n   *   messageType to listen for, and the callback function.\n   * @private\n   */\n  setupEventListener_() {\n    listen(this.win_, 'message', (event) => {\n      // If we have set a host window, strictly check that it's from it.\n      if (this.hostWindow_ && event.source != this.hostWindow_) {\n        return;\n      }\n\n      // Does it look like a message from AMP?\n      const message = deserializeMessage(getData(event));\n      if (!message || message['sentinel'] != this.sentinel_) {\n        return;\n      }\n\n      // At this point the message is valid; serialize necessary information and\n      // set its source as the host window if we don't have it set (aka in\n      // broadcast mode).\n      message['origin'] = event.origin;\n\n      if (!this.hostWindow_) {\n        this.hostWindow_ = event.source;\n      }\n\n      this.fireObservable_(message['type'], message);\n    });\n  }\n\n  /**\n   * @param {string} sentinel\n   */\n  setSentinel(sentinel) {\n    this.sentinel_ = sentinel;\n  }\n\n  /**\n   * @param {string} messageType\n   * @return {!Observable<?JsonObject>}\n   */\n  getOrCreateObservableFor_(messageType) {\n    if (!(messageType in this.observableFor_)) {\n      this.observableFor_[messageType] = new Observable();\n    }\n    return this.observableFor_[messageType];\n  }\n\n  /**\n   * @param {string} messageType\n   * @param {Object} message\n   */\n  fireObservable_(messageType, message) {\n    if (messageType in this.observableFor_) {\n      this.observableFor_[messageType].fire(message);\n    }\n  }\n\n  /**\n   * @param {!Window} win\n   * @return {boolean}\n   */\n  isMessageOptionsSupported_(win) {\n    // Learned from https://github.com/dtapuska/useractivation\n    return win.postMessage.length == 1;\n  }\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {map} from '../types/object';\n\n/**\n * @template T\n */\nexport class LruCache {\n  /**\n   * @param {number} capacity\n   */\n  constructor(capacity) {\n    /** @private @const {number} */\n    this.capacity_ = capacity;\n\n    /** @private {number} */\n    this.size_ = 0;\n\n    /**\n     * An incrementing counter to define the last access.\n     * @private {number}\n     */\n    this.access_ = 0;\n\n    /** @private {!Object<(number|string), {payload: T, access: number}>} */\n    this.cache_ = map();\n  }\n\n  /**\n   * Returns whether key is cached.\n   *\n   * @param {number|string} key\n   * @return {boolean}\n   */\n  has(key) {\n    return !!this.cache_[key];\n  }\n\n  /**\n   * @param {number|string} key\n   * @return {T} The cached payload.\n   */\n  get(key) {\n    const cacheable = this.cache_[key];\n    if (cacheable) {\n      cacheable.access = ++this.access_;\n      return cacheable.payload;\n    }\n    return undefined;\n  }\n\n  /**\n   * @param {number|string} key\n   * @param {T} payload The payload to cache.\n   */\n  put(key, payload) {\n    if (!this.has(key)) {\n      this.size_++;\n    }\n    this.cache_[key] = {payload, access: this.access_};\n    this.evict_();\n  }\n\n  /**\n   * Evicts the oldest cache entry, if we've exceeded capacity.\n   */\n  evict_() {\n    if (this.size_ <= this.capacity_) {\n      return;\n    }\n\n    const cache = this.cache_;\n    let oldest = this.access_ + 1;\n    let oldestKey;\n    for (const key in cache) {\n      const {access} = cache[key];\n      if (access < oldest) {\n        oldest = access;\n        oldestKey = key;\n      }\n    }\n\n    if (oldestKey !== undefined) {\n      delete cache[oldestKey];\n      this.size_--;\n    }\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {LruCache} from './core/data-structures/lru-cache';\nimport {dict, hasOwn} from './core/types/object';\nimport {endsWith} from './core/types/string';\nimport {getMode} from './mode';\nimport {isArray} from './core/types';\nimport {parseQueryString} from './core/types/string/url';\nimport {urls} from './config';\nimport {userAssert} from './log';\n\n/**\n * @type {!JsonObject}\n */\nconst SERVING_TYPE_PREFIX = dict({\n  // No viewer\n  'c': true,\n  // In viewer\n  'v': true,\n  // Ad landing page\n  'a': true,\n  // Ad\n  'ad': true,\n});\n\n/**\n * Cached a-tag to avoid memory allocation during URL parsing.\n * @type {HTMLAnchorElement}\n */\nlet a;\n\n/**\n * We cached all parsed URLs. As of now there are no use cases\n * of AMP docs that would ever parse an actual large number of URLs,\n * but we often parse the same one over and over again.\n * @type {LruCache}\n */\nlet cache;\n\n/** @private @const Matches amp_js_* parameters in query string. */\nconst AMP_JS_PARAMS_REGEX = /[?&]amp_js[^&]*/;\n\n/** @private @const Matches amp_gsa parameters in query string. */\nconst AMP_GSA_PARAMS_REGEX = /[?&]amp_gsa[^&]*/;\n\n/** @private @const Matches amp_r parameters in query string. */\nconst AMP_R_PARAMS_REGEX = /[?&]amp_r[^&]*/;\n\n/** @private @const Matches amp_kit parameters in query string. */\nconst AMP_KIT_PARAMS_REGEX = /[?&]amp_kit[^&]*/;\n\n/** @private @const Matches usqp parameters from goog experiment in query string. */\nconst GOOGLE_EXPERIMENT_PARAMS_REGEX = /[?&]usqp[^&]*/;\n\nconst INVALID_PROTOCOLS = [\n  /*eslint no-script-url: 0*/ 'javascript:',\n  /*eslint no-script-url: 0*/ 'data:',\n  /*eslint no-script-url: 0*/ 'vbscript:',\n];\n\n/** @const {string} */\nexport const SOURCE_ORIGIN_PARAM = '__amp_source_origin';\n\n/**\n * Returns the correct origin for a given window.\n * @param {!Window} win\n * @return {string} origin\n */\nexport function getWinOrigin(win) {\n  return win.origin || parseUrlDeprecated(win.location.href).origin;\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {string} url\n * @param {boolean=} opt_nocache\n *   Cache is always ignored on ESM builds, see https://go.amp.dev/pr/31594\n * @return {!Location}\n */\nexport function parseUrlDeprecated(url, opt_nocache) {\n  if (!a) {\n    a = /** @type {!HTMLAnchorElement} */ (self.document.createElement('a'));\n    cache = IS_ESM\n      ? null\n      : self.__AMP_URL_CACHE || (self.__AMP_URL_CACHE = new LruCache(100));\n  }\n\n  return parseUrlWithA(a, url, IS_ESM || opt_nocache ? null : cache);\n}\n\n/**\n * Returns a Location-like object for the given URL. If it is relative,\n * the URL gets resolved.\n * Consider the returned object immutable. This is enforced during\n * testing by freezing the object.\n * @param {!HTMLAnchorElement} a\n * @param {string} url\n * @param {LruCache=} opt_cache\n *   Cache is always ignored on ESM builds, see https://go.amp.dev/pr/31594\n * @return {!Location}\n * @restricted\n */\nexport function parseUrlWithA(a, url, opt_cache) {\n  if (IS_ESM) {\n    a.href = '';\n    return /** @type {?} */ (new URL(url, a.href));\n  }\n\n  if (opt_cache && opt_cache.has(url)) {\n    return opt_cache.get(url);\n  }\n\n  a.href = url;\n\n  // IE11 doesn't provide full URL components when parsing relative URLs.\n  // Assigning to itself again does the trick #3449.\n  if (!a.protocol) {\n    a.href = a.href;\n  }\n\n  const info = /** @type {!Location} */ ({\n    href: a.href,\n    protocol: a.protocol,\n    host: a.host,\n    hostname: a.hostname,\n    port: a.port == '0' ? '' : a.port,\n    pathname: a.pathname,\n    search: a.search,\n    hash: a.hash,\n    origin: null, // Set below.\n  });\n\n  // Some IE11 specific polyfills.\n  // 1) IE11 strips out the leading '/' in the pathname.\n  if (info.pathname[0] !== '/') {\n    info.pathname = '/' + info.pathname;\n  }\n\n  // 2) For URLs with implicit ports, IE11 parses to default ports while\n  // other browsers leave the port field empty.\n  if (\n    (info.protocol == 'http:' && info.port == 80) ||\n    (info.protocol == 'https:' && info.port == 443)\n  ) {\n    info.port = '';\n    info.host = info.hostname;\n  }\n\n  // For data URI a.origin is equal to the string 'null' which is not useful.\n  // We instead return the actual origin which is the full URL.\n  let origin;\n  if (a.origin && a.origin != 'null') {\n    origin = a.origin;\n  } else if (info.protocol == 'data:' || !info.host) {\n    origin = info.href;\n  } else {\n    origin = info.protocol + '//' + info.host;\n  }\n  info.origin = origin;\n\n  // Freeze during testing to avoid accidental mutation.\n  const frozen = getMode().test && Object.freeze ? Object.freeze(info) : info;\n\n  if (opt_cache) {\n    opt_cache.put(url, frozen);\n  }\n\n  return frozen;\n}\n\n/**\n * Appends the string just before the fragment part (or optionally\n * to the front of the query string) of the URL.\n * @param {string} url\n * @param {string} paramString\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function appendEncodedParamStringToUrl(\n  url,\n  paramString,\n  opt_addToFront\n) {\n  if (!paramString) {\n    return url;\n  }\n  const mainAndFragment = url.split('#', 2);\n  const mainAndQuery = mainAndFragment[0].split('?', 2);\n\n  let newUrl =\n    mainAndQuery[0] +\n    (mainAndQuery[1]\n      ? opt_addToFront\n        ? `?${paramString}&${mainAndQuery[1]}`\n        : `?${mainAndQuery[1]}&${paramString}`\n      : `?${paramString}`);\n  newUrl += mainAndFragment[1] ? `#${mainAndFragment[1]}` : '';\n  return newUrl;\n}\n/**\n * Appends a query string field and value to a url. `key` and `value`\n * will be ran through `encodeURIComponent` before appending.\n * @param {string} url\n * @param {string} key\n * @param {string} value\n * @param {boolean=} opt_addToFront\n * @return {string}\n */\nexport function addParamToUrl(url, key, value, opt_addToFront) {\n  const field = `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n  return appendEncodedParamStringToUrl(url, field, opt_addToFront);\n}\n\n/**\n * Appends query string fields and values to a url. The `params` objects'\n * `key`s and `value`s will be transformed into query string keys/values.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addParamsToUrl(url, params) {\n  return appendEncodedParamStringToUrl(url, serializeQueryString(params));\n}\n\n/**\n * Append query string fields and values to a url, only if the key does not\n * exist in current query string.\n * @param {string} url\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function addMissingParamsToUrl(url, params) {\n  const location = parseUrlDeprecated(url);\n  const existingParams = parseQueryString(location.search);\n  const paramsToAdd = dict({});\n  const keys = Object.keys(params);\n  for (let i = 0; i < keys.length; i++) {\n    if (!hasOwn(existingParams, keys[i])) {\n      paramsToAdd[keys[i]] = params[keys[i]];\n    }\n  }\n  return addParamsToUrl(url, paramsToAdd);\n}\n\n/**\n * Serializes the passed parameter map into a query string with both keys\n * and values encoded.\n * @param {!JsonObject<string, string|!Array<string>>} params\n * @return {string}\n */\nexport function serializeQueryString(params) {\n  const s = [];\n  for (const k in params) {\n    const v = params[k];\n    if (v == null) {\n      continue;\n    } else if (isArray(v)) {\n      for (let i = 0; i < v.length; i++) {\n        const sv = /** @type {string} */ (v[i]);\n        s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n      }\n    } else {\n      const sv = /** @type {string} */ (v);\n      s.push(`${encodeURIComponent(k)}=${encodeURIComponent(sv)}`);\n    }\n  }\n  return s.join('&');\n}\n\n/**\n * Returns `true` if the URL is secure: either HTTPS or localhost (for testing).\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isSecureUrlDeprecated(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return (\n    url.protocol == 'https:' ||\n    url.hostname == 'localhost' ||\n    url.hostname == '127.0.0.1' ||\n    endsWith(url.hostname, '.localhost')\n  );\n}\n\n/**\n * Asserts that a given url is HTTPS or protocol relative. It's a user-level\n * assert.\n *\n * Provides an exception for localhost.\n *\n * @param {?string|undefined} urlString\n * @param {!Element|string} elementContext Element where the url was found.\n * @param {string=} sourceName Used for error messages.\n * @return {string}\n */\nexport function assertHttpsUrl(\n  urlString,\n  elementContext,\n  sourceName = 'source'\n) {\n  userAssert(\n    urlString != null,\n    '%s %s must be available',\n    elementContext,\n    sourceName\n  );\n  // (erwinm, #4560): type cast necessary until #4560 is fixed.\n  const theUrlString = /** @type {string} */ (urlString);\n  userAssert(\n    isSecureUrlDeprecated(theUrlString) || /^(\\/\\/)/.test(theUrlString),\n    '%s %s must start with ' +\n      '\"https://\" or \"//\" or be relative and served from ' +\n      'either https or from localhost. Invalid value: %s',\n    elementContext,\n    sourceName,\n    theUrlString\n  );\n  return theUrlString;\n}\n\n/**\n * Asserts that a given url is an absolute HTTP or HTTPS URL.\n * @param {string} urlString\n * @return {string}\n */\nexport function assertAbsoluteHttpOrHttpsUrl(urlString) {\n  userAssert(\n    /^https?\\:/i.test(urlString),\n    'URL must start with \"http://\" or \"https://\". Invalid value: %s',\n    urlString\n  );\n  return parseUrlDeprecated(urlString).href;\n}\n\n/**\n * Returns the URL without fragment. If URL doesn't contain fragment, the same\n * string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function removeFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return url;\n  }\n  return url.substring(0, index);\n}\n\n/**\n * Returns the fragment from the URL. If the URL doesn't contain fragment,\n * the empty string is returned.\n * @param {string} url\n * @return {string}\n */\nexport function getFragment(url) {\n  const index = url.indexOf('#');\n  if (index == -1) {\n    return '';\n  }\n  return url.substring(index);\n}\n\n/**\n * Returns whether the URL has the origin of a proxy.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isProxyOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.cdnProxyRegex.test(url.origin);\n}\n\n/**\n * @param {string} uri\n * @return {boolean}\n */\nexport function isAmpScriptUri(uri) {\n  return uri.startsWith('amp-script:');\n}\n\n/**\n * For proxy-origin URLs, returns the serving type. Otherwise, returns null.\n * E.g., 'https://amp-com.cdn.ampproject.org/a/s/amp.com/amp_document.html'\n * returns 'a'.\n * @param {string|!Location} url URL of an AMP document.\n * @return {?string}\n */\nexport function getProxyServingType(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  if (!isProxyOrigin(url)) {\n    return null;\n  }\n  const path = url.pathname.split('/', 2);\n  return path[1];\n}\n\n/**\n * Returns whether the URL origin is localhost.\n * @param {string|!Location} url URL of an AMP document.\n * @return {boolean}\n */\nexport function isLocalhostOrigin(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return urls.localhostRegex.test(url.origin);\n}\n\n/**\n * Returns whether the URL has valid protocol.\n * Deep link protocol is valid, but not javascript etc.\n * @param {string|!Location} url\n * @return {boolean}\n */\nexport function isProtocolValid(url) {\n  if (!url) {\n    return true;\n  }\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n  return !INVALID_PROTOCOLS.includes(url.protocol);\n}\n\n/**\n * Returns a URL without AMP JS parameters.\n * @param {string} url\n * @return {string}\n */\nexport function removeAmpJsParamsFromUrl(url) {\n  const parsed = parseUrlDeprecated(url);\n  const search = removeAmpJsParamsFromSearch(parsed.search);\n  return parsed.origin + parsed.pathname + search + parsed.hash;\n}\n\n/**\n * Returns a URL without a query string.\n * @param {string} url\n * @return {string}\n */\nexport function removeSearch(url) {\n  const index = url.indexOf('?');\n  if (index == -1) {\n    return url;\n  }\n  const fragment = getFragment(url);\n  return url.substring(0, index) + fragment;\n}\n\n/**\n * Removes parameters that start with amp js parameter pattern and returns the\n * new search string.\n * @param {string} urlSearch\n * @return {string}\n */\nfunction removeAmpJsParamsFromSearch(urlSearch) {\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const search = urlSearch\n    .replace(AMP_JS_PARAMS_REGEX, '')\n    .replace(AMP_GSA_PARAMS_REGEX, '')\n    .replace(AMP_R_PARAMS_REGEX, '')\n    .replace(AMP_KIT_PARAMS_REGEX, '')\n    .replace(GOOGLE_EXPERIMENT_PARAMS_REGEX, '')\n    .replace(/^[?&]/, ''); // Removes first ? or &.\n  return search ? '?' + search : '';\n}\n\n/**\n * Removes parameters with param name and returns the new search string.\n * @param {string} urlSearch\n * @param {string} paramName\n * @return {string}\n */\nexport function removeParamsFromSearch(urlSearch, paramName) {\n  // TODO: reuse the function in removeAmpJsParamsFromSearch. Accept paramNames\n  // as an array.\n  if (!urlSearch || urlSearch == '?') {\n    return '';\n  }\n  const paramRegex = new RegExp(`[?&]${paramName}=[^&]*`, 'g');\n  const search = urlSearch.replace(paramRegex, '').replace(/^[?&]/, '');\n  return search ? '?' + search : '';\n}\n\n/**\n * Returns the source URL of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string}\n */\nexport function getSourceUrl(url) {\n  if (typeof url == 'string') {\n    url = parseUrlDeprecated(url);\n  }\n\n  // Not a proxy URL - return the URL itself.\n  if (!isProxyOrigin(url)) {\n    return url.href;\n  }\n\n  // A proxy URL.\n  // Example path that is being matched here.\n  // https://cdn.ampproject.org/c/s/www.origin.com/foo/\n  // The /s/ is optional and signals a secure origin.\n  const path = url.pathname.split('/');\n  const prefix = path[1];\n  userAssert(\n    SERVING_TYPE_PREFIX[prefix],\n    'Unknown path prefix in url %s',\n    url.href\n  );\n  const domainOrHttpsSignal = path[2];\n  const origin =\n    domainOrHttpsSignal == 's'\n      ? 'https://' + decodeURIComponent(path[3])\n      : 'http://' + decodeURIComponent(domainOrHttpsSignal);\n  // Sanity test that what we found looks like a domain.\n  userAssert(origin.indexOf('.') > 0, 'Expected a . in origin %s', origin);\n  path.splice(1, domainOrHttpsSignal == 's' ? 3 : 2);\n  return (\n    origin +\n    path.join('/') +\n    removeAmpJsParamsFromSearch(url.search) +\n    (url.hash || '')\n  );\n}\n\n/**\n * Returns the source origin of an AMP document for documents served\n * on a proxy origin or directly.\n * @param {string|!Location} url URL of an AMP document.\n * @return {string} The source origin of the URL.\n */\nexport function getSourceOrigin(url) {\n  return parseUrlDeprecated(getSourceUrl(url)).origin;\n}\n\n/**\n * Returns absolute URL resolved based on the relative URL and the base.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n */\nexport function resolveRelativeUrl(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  if (IS_ESM || typeof URL == 'function') {\n    return new URL(relativeUrlString, baseUrl.href).toString();\n  }\n  return resolveRelativeUrlFallback_(relativeUrlString, baseUrl);\n}\n\n/**\n * Fallback for URL resolver when URL class is not available.\n * @param {string} relativeUrlString\n * @param {string|!Location} baseUrl\n * @return {string}\n * @private @visibleForTesting\n */\nexport function resolveRelativeUrlFallback_(relativeUrlString, baseUrl) {\n  if (typeof baseUrl == 'string') {\n    baseUrl = parseUrlDeprecated(baseUrl);\n  }\n  relativeUrlString = relativeUrlString.replace(/\\\\/g, '/');\n  const relativeUrl = parseUrlDeprecated(relativeUrlString);\n\n  // Absolute URL.\n  if (relativeUrlString.toLowerCase().startsWith(relativeUrl.protocol)) {\n    return relativeUrl.href;\n  }\n\n  // Protocol-relative URL.\n  if (relativeUrlString.startsWith('//')) {\n    return baseUrl.protocol + relativeUrlString;\n  }\n\n  // Absolute path.\n  if (relativeUrlString.startsWith('/')) {\n    return baseUrl.origin + relativeUrlString;\n  }\n\n  // Relative path.\n  return (\n    baseUrl.origin +\n    baseUrl.pathname.replace(/\\/[^/]*$/, '/') +\n    relativeUrlString\n  );\n}\n\n/**\n * Add \"__amp_source_origin\" query parameter to the URL.\n * @param {!Window} win\n * @param {string} url\n * @return {string}\n */\nexport function getCorsUrl(win, url) {\n  checkCorsUrl(url);\n  const sourceOrigin = getSourceOrigin(win.location.href);\n  return addParamToUrl(url, SOURCE_ORIGIN_PARAM, sourceOrigin);\n}\n\n/**\n * Checks if the url has __amp_source_origin and throws if it does.\n * @param {string} url\n */\nexport function checkCorsUrl(url) {\n  const parsedUrl = parseUrlDeprecated(url);\n  const query = parseQueryString(parsedUrl.search);\n  userAssert(\n    !(SOURCE_ORIGIN_PARAM in query),\n    'Source origin is not allowed in %s',\n    url\n  );\n}\n\n/**\n * Adds the path to the given url.\n *\n * @param {!Location} url\n * @param {string} path\n * @return {string}\n */\nexport function appendPathToUrl(url, path) {\n  const pathname = url.pathname.replace(/\\/?$/, '/') + path.replace(/^\\//, '');\n  return url.origin + pathname + url.search + url.hash;\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {AmpEvents} from '../src/core/constants/amp-events';\nimport {Deferred} from '../src/core/data-structures/promise';\nimport {IframeMessagingClient} from './iframe-messaging-client';\nimport {MessageType} from '../src/3p-frame-messaging';\nimport {dev, devAssert} from '../src/log';\nimport {dict, map} from '../src/core/types/object';\nimport {isObject} from '../src/core/types';\nimport {parseUrlDeprecated} from '../src/url';\nimport {tryParseJson} from '../src/core/types/object/json';\n\nexport class AbstractAmpContext {\n  /**\n   *  @param {!Window} win The window that the instance is built inside.\n   */\n  constructor(win) {\n    devAssert(\n      !this.isAbstractImplementation_(),\n      'Should not construct AbstractAmpContext instances directly'\n    );\n\n    /** @protected {!Window} */\n    this.win_ = win;\n\n    // This value is cached since it could be overwritten by the master frame\n    // check using a value of a different type.\n    /** @private {?string} */\n    this.cachedFrameName_ = this.win_.name || null;\n\n    /** @protected {?string} */\n    this.embedType_ = null;\n\n    // ----------------------------------------------------\n    // Please keep public attributes alphabetically sorted.\n    // ----------------------------------------------------\n\n    /** @public {?string|undefined} */\n    this.canary = null;\n\n    /** @type {?string} */\n    this.canonicalUrl = null;\n\n    /** @type {?string} */\n    this.clientId = null;\n\n    /** @type {?string|undefined} */\n    this.container = null;\n\n    /** @type {?Object} */\n    this.consentSharedData = null;\n\n    /** @type {?Object<string, *>} */\n    this.data = null;\n\n    /** @type {?string} */\n    this.domFingerprint = null;\n\n    /** @type {?boolean} */\n    this.hidden = null;\n\n    /** @type {?number} */\n    this.initialConsentState = null;\n\n    /** @type {?string} */\n    this.initialConsentValue = null;\n\n    /** @type {?Object} */\n    this.initialConsentMetadata = null;\n\n    /** @type {?Object} */\n    this.initialLayoutRect = null;\n\n    /** @type {?Object} */\n    this.initialIntersection = null;\n\n    /** @type {?Location} */\n    this.location = null;\n\n    /** @type {?Object} */\n    this.mode = null;\n\n    /** @type {?string} */\n    this.pageViewId = null;\n\n    /** @type {?string} */\n    this.referrer = null;\n\n    /** @type {?string} */\n    this.sentinel = null;\n\n    /** @type {?string} */\n    this.sourceUrl = null;\n\n    /** @type {?number} */\n    this.startTime = null;\n\n    /** @type {?string} */\n    this.tagName = null;\n\n    /** @type {!Object<number, Deferred>} */\n    this.resizeIdToDeferred_ = map();\n\n    /** @type {number} */\n    this.nextResizeRequestId_ = 0;\n\n    this.findAndSetMetadata_();\n\n    /** @protected {!IframeMessagingClient} */\n    this.client_ = new IframeMessagingClient(win, this.getHostWindow_());\n    this.client_.setSentinel(devAssert(this.sentinel));\n\n    this.listenForPageVisibility_();\n    this.listenToResizeResponse_();\n  }\n\n  /**\n   * @return {boolean}\n   * @protected\n   */\n  isAbstractImplementation_() {\n    return true;\n  }\n\n  /** Registers an general handler for page visibility. */\n  listenForPageVisibility_() {\n    this.client_.makeRequest(\n      MessageType.SEND_EMBED_STATE,\n      MessageType.EMBED_STATE,\n      (data) => {\n        this.hidden = data['pageHidden'];\n        this.dispatchVisibilityChangeEvent_();\n      }\n    );\n  }\n\n  /**\n   * TODO(alanorozco): Deprecate native event mechanism.\n   * @private\n   */\n  dispatchVisibilityChangeEvent_() {\n    const event = this.win_.document.createEvent('Event');\n    event.data = {hidden: this.hidden};\n    event.initEvent(AmpEvents.VISIBILITY_CHANGE, true, true);\n    this.win_.dispatchEvent(event);\n  }\n\n  /**\n   *  Listen to page visibility changes.\n   *  @param {function({hidden: boolean})} callback Function to call every time\n   *    we receive a page visibility message.\n   *  @return {function()} that when called stops triggering the callback\n   *    every time we receive a page visibility message.\n   */\n  onPageVisibilityChange(callback) {\n    return this.client_.registerCallback(MessageType.EMBED_STATE, (data) => {\n      callback({hidden: data['pageHidden']});\n    });\n  }\n\n  /**\n   *  Send message to runtime to start sending intersection messages.\n   *  @param {function(Array<Object>)} callback Function to call every time we\n   *    receive an intersection message.\n   *  @return {function()} that when called stops triggering the callback\n   *    every time we receive an intersection message.\n   */\n  observeIntersection(callback) {\n    return this.client_.makeRequest(\n      MessageType.SEND_INTERSECTIONS,\n      MessageType.INTERSECTION,\n      (intersection) => {\n        callback(intersection['changes']);\n      }\n    );\n  }\n\n  /**\n   *  Requests HTML snippet from the parent window.\n   *  @param {string} selector CSS selector\n   *  @param {!Array<string>} attributes permissible attributes to be kept\n   *    in the returned HTML string\n   *  @param {function(*)} callback to be invoked with the HTML string\n   */\n  getHtml(selector, attributes, callback) {\n    this.client_.getData(\n      MessageType.GET_HTML,\n      dict({\n        'selector': selector,\n        'attributes': attributes,\n      }),\n      callback\n    );\n  }\n\n  /**\n   * Requests consent state from the parent window.\n   *\n   * @param {function(*)} callback\n   */\n  getConsentState(callback) {\n    this.client_.getData(MessageType.GET_CONSENT_STATE, null, callback);\n  }\n\n  /**\n   *  Send message to runtime requesting to resize ad to height and width.\n   *    This is not guaranteed to succeed. All this does is make the request.\n   *  @param {number|undefined} width The new width for the ad we are requesting.\n   *  @param {number|undefined} height The new height for the ad we are requesting.\n   *  @param {boolean=} hasOverflow Whether the ad handles its own overflow ele\n   *  @return {Promise} Signify the success/failure of the request.\n   */\n  requestResize(width, height, hasOverflow) {\n    const requestId = this.nextResizeRequestId_++;\n    this.client_.sendMessage(\n      MessageType.EMBED_SIZE,\n      dict({\n        'id': requestId,\n        'width': width,\n        'height': height,\n        'hasOverflow': hasOverflow,\n      })\n    );\n    const deferred = new Deferred();\n    this.resizeIdToDeferred_[requestId] = deferred;\n    return deferred.promise;\n  }\n\n  /**\n   *  Set up listeners to handle responses from request size.\n   */\n  listenToResizeResponse_() {\n    this.client_.registerCallback(MessageType.EMBED_SIZE_CHANGED, (data) => {\n      const id = data['id'];\n      if (id !== undefined) {\n        this.resizeIdToDeferred_[id].resolve();\n        delete this.resizeIdToDeferred_[id];\n      }\n    });\n\n    this.client_.registerCallback(MessageType.EMBED_SIZE_DENIED, (data) => {\n      const id = data['id'];\n      if (id !== undefined) {\n        this.resizeIdToDeferred_[id].reject('Resizing is denied');\n        delete this.resizeIdToDeferred_[id];\n      }\n    });\n  }\n\n  /**\n   * @param {string} endpoint Method being called\n   * @private\n   */\n  sendDeprecationNotice_(endpoint) {\n    this.client_.sendMessage(\n      MessageType.USER_ERROR_IN_IFRAME,\n      dict({\n        'message': `${endpoint} is deprecated`,\n        'expected': true,\n      })\n    );\n  }\n\n  /**\n   *  Allows a creative to set the callback function for when the resize\n   *    request returns a success. The callback should be set before resizeAd\n   *    is ever called.\n   *  @param {function(number, number)} callback Function to call if the resize\n   *    request succeeds.\n   */\n  onResizeSuccess(callback) {\n    this.client_.registerCallback(MessageType.EMBED_SIZE_CHANGED, (obj) => {\n      callback(obj['requestedHeight'], obj['requestedWidth']);\n    });\n    this.sendDeprecationNotice_('onResizeSuccess');\n  }\n\n  /**\n   *  Allows a creative to set the callback function for when the resize\n   *    request is denied. The callback should be set before resizeAd\n   *    is ever called.\n   *  @param {function(number, number)} callback Function to call if the resize\n   *    request is denied.\n   */\n  onResizeDenied(callback) {\n    this.client_.registerCallback(MessageType.EMBED_SIZE_DENIED, (obj) => {\n      callback(obj['requestedHeight'], obj['requestedWidth']);\n    });\n    this.sendDeprecationNotice_('onResizeDenied');\n  }\n\n  /**\n   *  Make the ad interactive.\n   */\n  signalInteractive() {\n    this.client_.sendMessage(MessageType.SIGNAL_INTERACTIVE);\n  }\n\n  /**\n   *  Takes the current name on the window, and attaches it to\n   *  the name of the iframe.\n   *  @param {HTMLIFrameElement} iframe The iframe we are adding the context to.\n   */\n  addContextToIframe(iframe) {\n    // TODO(alanorozco): consider the AMP_CONTEXT_DATA case\n    iframe.name = dev().assertString(this.cachedFrameName_);\n  }\n\n  /**\n   *  Notifies the parent document of no content available inside embed.\n   */\n  noContentAvailable() {\n    this.client_.sendMessage(MessageType.NO_CONTENT);\n  }\n\n  /**\n   *  Parse the metadata attributes from the name and add them to\n   *  the class instance.\n   *  @param {!Object|string} data\n   *  @private\n   */\n  setupMetadata_(data) {\n    // TODO(alanorozco): Use metadata utils in 3p/frame-metadata\n    const dataObject = devAssert(\n      typeof data === 'string' ? tryParseJson(data) : data,\n      'Could not setup metadata.'\n    );\n\n    const context = dataObject._context || dataObject.attributes._context;\n\n    this.data = dataObject.attributes || dataObject;\n\n    // TODO(alanorozco, #10576): This is really ugly. Find a better structure\n    // than passing context values via data.\n    if ('_context' in this.data) {\n      delete this.data['_context'];\n    }\n\n    this.canary = context.canary;\n    this.canonicalUrl = context.canonicalUrl;\n    this.clientId = context.clientId;\n    this.consentSharedData = context.consentSharedData;\n    this.container = context.container;\n    this.domFingerprint = context.domFingerprint;\n    this.hidden = context.hidden;\n    this.initialConsentState = context.initialConsentState;\n    this.initialConsentValue = context.initialConsentValue;\n    this.initialConsentMetadata = context.initialConsentMetadata;\n    this.initialLayoutRect = context.initialLayoutRect;\n    this.initialIntersection = context.initialIntersection;\n    this.location = parseUrlDeprecated(context.location.href);\n    this.mode = context.mode;\n    this.pageViewId = context.pageViewId;\n    this.referrer = context.referrer;\n    this.sentinel = context.sentinel;\n    this.sourceUrl = context.sourceUrl;\n    this.startTime = context.startTime;\n    this.tagName = context.tagName;\n\n    this.embedType_ = dataObject.type || null;\n  }\n\n  /**\n   * Calculate the hostWindow\n   * @private\n   * @return {!Window}\n   */\n  getHostWindow_() {\n    const sentinelMatch = this.sentinel.match(/((\\d+)-\\d+)/);\n    devAssert(sentinelMatch, 'Incorrect sentinel format');\n    const depth = Number(sentinelMatch[2]);\n    const ancestors = [];\n    for (let win = this.win_; win && win != win.parent; win = win.parent) {\n      // Add window keeping the top-most one at the front.\n      ancestors.push(win.parent);\n    }\n    return ancestors[ancestors.length - 1 - depth];\n  }\n\n  /**\n   *  Checks to see if there is a window variable assigned with the\n   *  sentinel value, sets it, and returns true if so.\n   *  @private\n   */\n  findAndSetMetadata_() {\n    // If the context data is set on window, that means we don't need\n    // to check the name attribute as it has been bypassed.\n    // TODO(alanorozco): why the heck could AMP_CONTEXT_DATA be two different\n    // types? FIX THIS.\n    if (isObject(this.win_.sf_) && this.win_.sf_.cfg) {\n      this.setupMetadata_(/** @type {string}*/ (this.win_.sf_.cfg));\n    } else if (this.win_.AMP_CONTEXT_DATA) {\n      if (typeof this.win_.AMP_CONTEXT_DATA == 'string') {\n        this.sentinel = this.win_.AMP_CONTEXT_DATA;\n      } else if (isObject(this.win_.AMP_CONTEXT_DATA)) {\n        this.setupMetadata_(this.win_.AMP_CONTEXT_DATA);\n      }\n    } else {\n      this.setupMetadata_(this.win_.name);\n    }\n  }\n\n  /**\n   * Send 3p error to parent iframe\n   * @param {!Error} e\n   */\n  report3pError(e) {\n    if (!e.message) {\n      return;\n    }\n    this.client_.sendMessage(\n      MessageType.USER_ERROR_IN_IFRAME,\n      dict({\n        'message': e.message,\n      })\n    );\n  }\n}\n\nexport class AmpContext extends AbstractAmpContext {\n  /** @override */\n  isAbstractImplementation_() {\n    return false;\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Utility functions for scripts running inside of a third\n * party iframe.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\n\nimport {devAssert, userAssert} from '../src/log';\nimport {hasOwn, map} from '../src/core/types/object';\nimport {isArray} from '../src/core/types';\nimport {rethrowAsync} from '../src/core/error';\n\n/** @typedef {function(!Window, !Object)}  */\nlet ThirdPartyFunctionDef;\n\n/**\n * @const {!Object<ThirdPartyFunctionDef>}\n * @visibleForTesting\n */\nlet registrations;\n\n/** @type {number} */\nlet syncScriptLoads = 0;\n\n/**\n * Returns the registration map\n * @return {*} TODO(#23582): Specify return type\n */\nexport function getRegistrations() {\n  if (!registrations) {\n    registrations = map();\n  }\n  return registrations;\n}\n\n/**\n * @param {string} id The specific 3p integration.\n * @param {ThirdPartyFunctionDef} draw Function that draws the 3p integration.\n */\nexport function register(id, draw) {\n  const registrations = getRegistrations();\n  devAssert(!registrations[id], 'Double registration %s', id);\n  registrations[id] = draw;\n}\n\n/**\n * Execute the 3p integration with the given id.\n * @param {string} id\n * @param {!Window} win\n * @param {!Object} data\n */\nexport function run(id, win, data) {\n  const fn = registrations[id];\n  userAssert(fn, 'Unknown 3p: ' + id);\n  fn(win, data);\n}\n\n/**\n * Synchronously load the given script URL. Only use this if you need a sync\n * load. Otherwise use {@link loadScript}.\n * Supports taking a callback that will be called synchronously after the given\n * script was executed.\n * @param {!Window} win\n * @param {string} url\n * @param {function()=} opt_cb\n */\nexport function writeScript(win, url, opt_cb) {\n  win.document.write(\n    // eslint-disable-next-line no-useless-concat\n    '<' + 'script src=\"' + encodeURI(url) + '\"><' + '/script>'\n  );\n  if (opt_cb) {\n    executeAfterWriteScript(win, opt_cb);\n  }\n}\n\n/**\n * Asynchronously load the given script URL.\n * @param {!Window} win\n * @param {string} url\n * @param {function()=} opt_cb\n * @param {function()=} opt_errorCb\n */\nexport function loadScript(win, url, opt_cb, opt_errorCb) {\n  /** @const {!Element} */\n  const s = win.document.createElement('script');\n  s.src = url;\n  if (opt_cb) {\n    s.onload = opt_cb;\n  }\n  if (opt_errorCb) {\n    s.onerror = opt_errorCb;\n  }\n  win.document.body.appendChild(s);\n}\n\n/**\n * Call function in micro task or timeout as a fallback.\n * This is a lightweight helper, because we cannot guarantee that\n * Promises are available inside the 3p frame.\n * @param {!Window} win\n * @param {function()} fn\n */\nexport function nextTick(win, fn) {\n  const P = win.Promise;\n  if (P) {\n    P.resolve()./*OK*/ then(fn);\n  } else {\n    win.setTimeout(fn, 0);\n  }\n}\n\n/**\n * Run the function after all currently waiting sync scripts have been\n * executed.\n * @param {!Window} win\n * @param {function()} fn\n */\nfunction executeAfterWriteScript(win, fn) {\n  const index = syncScriptLoads++;\n  win['__runScript' + index] = fn;\n  // eslint-disable-next-line no-useless-concat\n  win.document.write('<' + 'script>__runScript' + index + '()<' + '/script>');\n}\n\n/**\n * Throws if the given src doesn't start with prefix(es).\n * @param {!Array<string>|string} prefix\n * @param {string} src\n */\nexport function validateSrcPrefix(prefix, src) {\n  if (!isArray(prefix)) {\n    prefix = [prefix];\n  }\n  if (src !== undefined) {\n    for (let p = 0; p < prefix.length; p++) {\n      const protocolIndex = src.indexOf(prefix[p]);\n      if (protocolIndex == 0) {\n        return;\n      }\n    }\n  }\n  throw new Error('Invalid src ' + src);\n}\n\n/**\n * Throws if the given src doesn't contain the string\n * @param {string} string\n * @param {string} src\n */\nexport function validateSrcContains(string, src) {\n  if (src.indexOf(string) === -1) {\n    throw new Error('Invalid src ' + src);\n  }\n}\n\n/**\n * Utility function to perform a potentially asynchronous task\n * exactly once for all frames of a given type and the provide the respective\n * value to all frames.\n * @param {!Window} global Your window\n * @param {string} taskId Must be not conflict with any other global variable\n *     you use. Must be the same for all callers from all frames that want\n *     the same result.\n * @param {function(function(*))} work Function implementing the work that\n *     is to be done. Receives a second function that should be called with\n *     the result when the work is done.\n * @param {function(*)} cb Callback function that is called when the work is\n *     done. The first argument is the result.\n */\nexport function computeInMasterFrame(global, taskId, work, cb) {\n  const {master} = global.context;\n  let tasks = master.__ampMasterTasks;\n  if (!tasks) {\n    tasks = master.__ampMasterTasks = {};\n  }\n  let cbs = tasks[taskId];\n  if (!tasks[taskId]) {\n    cbs = tasks[taskId] = [];\n  }\n  cbs.push(cb);\n  if (!global.context.isMaster) {\n    return; // Only do work in master.\n  }\n  work((result) => {\n    for (let i = 0; i < cbs.length; i++) {\n      cbs[i].call(null, result);\n    }\n    tasks[taskId] = {\n      push(cb) {\n        cb(result);\n      },\n    };\n  });\n}\n\n/**\n * Validates given data. Throws an exception if the data does not\n * contains a mandatory field. If called with the optional param\n * opt_optionalFields, it also validates that the data contains no fields other\n * than mandatory and optional fields.\n *\n * Mandatory fields also accept a string Array as an item. All items in that\n * array are considered as alternatives to each other. So the validation checks\n * that the data contains exactly one of those alternatives.\n *\n * @param {!Object} data\n * @param {!Array<string|!Array<string>>} mandatoryFields\n * @param {Array<string>=} opt_optionalFields\n */\nexport function validateData(data, mandatoryFields, opt_optionalFields) {\n  let allowedFields = opt_optionalFields || [];\n  for (let i = 0; i < mandatoryFields.length; i++) {\n    const field = mandatoryFields[i];\n    if (Array.isArray(field)) {\n      validateExactlyOne(data, field);\n      allowedFields = allowedFields.concat(field);\n    } else {\n      userAssert(\n        // Allow zero values for height, width etc.\n        data[field] != null,\n        'Missing attribute for %s: %s.',\n        data.type,\n        field\n      );\n      allowedFields.push(field);\n    }\n  }\n  if (opt_optionalFields) {\n    validateAllowedFields(data, allowedFields);\n  }\n}\n\n/**\n * Throws an exception if data does not contains exactly one field\n * mentioned in the alternativeFields array.\n * @param {!Object} data\n * @param {!Array<string>} alternativeFields\n */\nfunction validateExactlyOne(data, alternativeFields) {\n  userAssert(\n    alternativeFields.filter((field) => data[field]).length === 1,\n    '%s must contain exactly one of attributes: %s.',\n    data.type,\n    alternativeFields.join(', ')\n  );\n}\n\n/**\n * Throws a non-interrupting exception if data contains a field not supported\n * by this embed type.\n * @param {!Object} data\n * @param {!Array<string>} allowedFields\n */\nfunction validateAllowedFields(data, allowedFields) {\n  const defaultAvailableFields = {\n    width: true,\n    height: true,\n    type: true,\n    referrer: true,\n    canonicalUrl: true,\n    pageViewId: true,\n    location: true,\n    mode: true,\n    consentNotificationId: true,\n    blockOnConsent: true,\n    ampSlotIndex: true,\n    adHolderText: true,\n    loadingStrategy: true,\n    htmlAccessAllowed: true,\n    adContainerId: true,\n  };\n\n  for (const field in data) {\n    if (!hasOwn(data, field) || field in defaultAvailableFields) {\n      continue;\n    }\n    if (allowedFields.indexOf(field) < 0) {\n      // Throw in a timeout, because we do not want to interrupt execution,\n      // because that would make each removal an instant backward incompatible\n      // change.\n      rethrowAsync(new Error(`Unknown attribute for ${data.type}: ${field}.`));\n    }\n  }\n}\n\n/** @private {!Object<string, boolean>} */\nlet experimentToggles = {};\n\n/**\n * Returns true if an experiment is enabled.\n * @param {string} experimentId\n * @return {boolean}\n */\nexport function isExperimentOn(experimentId) {\n  return experimentToggles && !!experimentToggles[experimentId];\n}\n\n/**\n * Set experiment toggles.\n * @param {!Object<string, boolean>} toggles\n */\nexport function setExperimentToggles(toggles) {\n  experimentToggles = toggles;\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {AbstractAmpContext} from './ampcontext';\nimport {computeInMasterFrame} from './3p';\nimport {dev, user, userAssert} from '../src/log';\nimport {dict} from '../src/core/types/object';\n\n/**\n * Returns the \"master frame\" for all widgets of a given type.\n * This frame should be used to e.g. fetch scripts that can\n * be reused across frames.\n * once experiment is removed.\n * @param {!Window} win\n * @param {string} type\n * @return {!Window}\n */\nexport function masterSelection(win, type) {\n  type = type.toLowerCase();\n  // The master has a special name.\n  const masterName = 'frame_' + type + '_master';\n  let master;\n  try {\n    // Try to get the master from the parent. If it does not\n    // exist yet we get a security exception that we catch\n    // and ignore.\n    master = win.parent.frames[masterName];\n  } catch (expected) {\n    /* ignore */\n  }\n  if (!master) {\n    // No master yet, rename ourselves to be master. Yaihh.\n    win.name = masterName;\n    master = win;\n  }\n  return master;\n}\n\nexport class IntegrationAmpContext extends AbstractAmpContext {\n  /** @override */\n  isAbstractImplementation_() {\n    return false;\n  }\n\n  /**\n   * @return {boolean}\n   * @protected\n   */\n  updateDimensionsEnabled_() {\n    // Only make this available to selected embeds until the generic solution is\n    // available.\n    return (\n      this.embedType_ === 'facebook' ||\n      this.embedType_ === 'twitter' ||\n      this.embedType_ === 'github' ||\n      this.embedType_ === 'mathml' ||\n      this.embedType_ === 'reddit' ||\n      this.embedType_ === 'yotpo' ||\n      this.embedType_ === 'embedly'\n    );\n  }\n\n  /** @return {!Window} */\n  get master() {\n    return this.master_();\n  }\n\n  /** @return {!Window} */\n  master_() {\n    return masterSelection(this.win_, dev().assertString(this.embedType_));\n  }\n\n  /** @return {boolean} */\n  get isMaster() {\n    return this.isMaster_();\n  }\n\n  /** @return {boolean} */\n  isMaster_() {\n    return this.master == this.win_;\n  }\n\n  /**\n   * @param {number} width\n   * @param {number} height\n   */\n  updateDimensions(width, height) {\n    userAssert(this.updateDimensionsEnabled_(), 'Not available.');\n    this.requestResize(width, height);\n  }\n\n  /**\n   * Sends bootstrap loaded message.\n   */\n  bootstrapLoaded() {\n    this.client_.sendMessage('bootstrap-loaded');\n  }\n\n  /**\n   * @param {!JsonObject=} opt_data Fields: width, height\n   */\n  renderStart(opt_data) {\n    this.client_.sendMessage('render-start', opt_data);\n  }\n\n  /**\n   * Reports the \"entity\" that was rendered to this frame to the parent for\n   * reporting purposes.\n   * The entityId MUST NOT contain user data or personal identifiable\n   * information. One example for an acceptable data item would be the\n   * creative id of an ad, while the user's location would not be\n   * acceptable.\n   * TODO(alanorozco): Remove duplicate in 3p/integration.js once this\n   * implementation becomes canonical.\n   * @param {string} entityId See comment above for content.\n   */\n  reportRenderedEntityIdentifier(entityId) {\n    this.client_.sendMessage(\n      'entity-id',\n      dict({\n        'id': user().assertString(entityId),\n      })\n    );\n  }\n\n  /**\n   * Performs a potentially asynchronous task exactly once for all frames of a\n   * given type and the provide the respective value to all frames.\n   * @param {!Window} global Your window\n   * @param {string} taskId Must be not conflict with any other global variable\n   *     you use. Must be the same for all callers from all frames that want\n   *     the same result.\n   * @param {function(function(*))} work Function implementing the work that\n   *     is to be done. Receives a second function that should be called with\n   *     the result when the work is done.\n   * @param {function(*)} cb Callback function that is called when the work is\n   *     done. The first argument is the result.\n   */\n  computeInMasterFrame(global, taskId, work, cb) {\n    computeInMasterFrame(global, taskId, work, cb);\n  }\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../src/log';\nimport {dict} from '../src/core/types/object';\nimport {getMode} from '../src/mode';\nimport {once} from '../src/core/types/function';\nimport {parseJson} from '../src/core/types/object/json';\nimport {parseUrlDeprecated} from '../src/url';\n\n/**\n * @typedef {{\n *  ampcontextFilepath: ?string,\n *  ampcontextVersion: ?string,\n *  canary: ?boolean,\n *  canonicalUrl: ?string,\n *  clientId: ?string,\n *  container: ?string,\n *  domFingerprint: ?string,\n *  hidden: ?boolean,\n *  initialIntersection: ?IntersectionObserverEntry,\n *  initialLayoutRect:\n *      ?{left: number, top: number, width: number, height: number},\n *  mode: ?../src/mode.ModeDef,\n *  pageViewId: ?string,\n *  referrer: ?string,\n *  sentinel: ?string,\n *  sourceUrl: ?string,\n *  startTime: ?number,\n *  tagName: ?string,\n * }}\n */\nexport let ContextStateDef;\n\n/** @const {!JsonObject} */\nconst FALLBACK = dict({\n  'attributes': dict({\n    '_context': dict(),\n  }),\n});\n\n/**\n * Gets metadata encoded in iframe name attribute.\n * @return {!JsonObject}\n */\nconst allMetadata = once(() => {\n  const iframeName = window.name;\n\n  try {\n    // TODO(bradfrizzell@): Change the data structure of the attributes\n    //    to make it less terrible.\n    return parseJson(iframeName);\n  } catch (err) {\n    if (!getMode().test) {\n      dev().info('INTEGRATION', 'Could not parse context from:', iframeName);\n    }\n    return FALLBACK;\n  }\n});\n\n/**\n * @return {{mode: !Object, experimentToggles: !Object}}\n */\nexport function getAmpConfig() {\n  const metadata = allMetadata();\n\n  return {\n    mode: metadata['attributes']['_context'].mode,\n    experimentToggles: metadata['attributes']['_context'].experimentToggles,\n  };\n}\n\n/**\n * @return {!JsonObject}\n */\nconst getAttributeDataImpl_ = once(() => {\n  const data = Object.assign(dict({}), allMetadata()['attributes']);\n\n  // TODO(alanorozco): don't delete _context. refactor data object structure.\n  if ('_context' in data) {\n    delete data['_context'];\n  }\n\n  return data;\n});\n\n/**\n * @return {!JsonObject}\n */\nexport function getAttributeData() {\n  // using indirect invocation to prevent no-export-side-effect issue\n  return getAttributeDataImpl_();\n}\n\n/**\n * @return {!Location}\n */\nconst getLocationImpl_ = once(() => {\n  const href = allMetadata()['attributes']['_context']['location']['href'];\n  return parseUrlDeprecated(href);\n});\n\n/**\n * @return {!Location}\n */\nexport function getLocation() {\n  // using indirect invocation to prevent no-export-side-effect issue\n  return getLocationImpl_();\n}\n\n/**\n * @return {!ContextStateDef}\n */\nexport function getContextState() {\n  const rawContext = allMetadata()['attributes']['_context'];\n\n  return {\n    ampcontextFilepath: rawContext['ampcontextFilepath'],\n    ampcontextVersion: rawContext['ampcontextVersion'],\n    canary: rawContext['canary'],\n    canonicalUrl: rawContext['canonicalUrl'],\n    clientId: rawContext['clientId'],\n    container: rawContext['container'],\n    domFingerprint: rawContext['domFingerprint'],\n    hidden: rawContext['hidden'],\n    initialIntersection: rawContext['initialIntersection'],\n    initialLayoutRect: rawContext['initialLayoutRect'],\n    mode: rawContext['mode'],\n    pageViewId: rawContext['pageViewId'],\n    referrer: rawContext['referrer'],\n    sentinel: rawContext['sentinel'],\n    sourceUrl: rawContext['sourceUrl'],\n    startTime: rawContext['startTime'],\n    tagName: rawContext['tagName'],\n  };\n}\n\n/**\n * @return {string}\n */\nexport function getEmbedType() {\n  return getAttributeData()['type'];\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getData} from '../src/event-helper';\nimport {parseJson} from '../src/core/types/object/json';\n\n/**\n * Send messages to parent frame. These should not contain user data.\n * @param {string} type Type of messages\n * @param {!JsonObject=} opt_object Data for the message.\n * @deprecated Use iframe-messaging-client.js\n */\nexport function nonSensitiveDataPostMessage(type, opt_object) {\n  if (window.parent == window) {\n    return; // Nothing to do.\n  }\n  const object = opt_object || /** @type {JsonObject} */ ({});\n  object['type'] = type;\n  object['sentinel'] = window.context.sentinel;\n  window.parent./*OK*/ postMessage(object, window.context.location.origin);\n}\n\n/**\n * Message event listeners.\n * @const {!Array<{type: string, cb: function(!JsonObject)}>}\n */\nconst listeners = [];\n\n/**\n * Listen to message events from document frame.\n * @param {!Window} win\n * @param {string} type Type of messages\n * @param {function(!JsonObject)} callback Called with data payload of message.\n * @return {function()} function to unlisten for messages.\n * @deprecated Use iframe-messaging-client.js\n */\nexport function listenParent(win, type, callback) {\n  const listener = {\n    type,\n    cb: callback,\n  };\n  listeners.push(listener);\n  startListening(win);\n  return function () {\n    const index = listeners.indexOf(listener);\n    if (index > -1) {\n      listeners.splice(index, 1);\n    }\n  };\n}\n\n/**\n * Listens for message events and dispatches to listeners registered\n * via listenParent.\n * @param {!Window} win\n */\nfunction startListening(win) {\n  if (win.AMP_LISTENING) {\n    return;\n  }\n  win.AMP_LISTENING = true;\n  win.addEventListener('message', function (event) {\n    // Cheap operations first, so we don't parse JSON unless we have to.\n    const eventData = getData(event);\n    if (\n      event.source != win.parent ||\n      event.origin != win.context.location.origin ||\n      typeof eventData != 'string' ||\n      eventData.indexOf('amp-') != 0\n    ) {\n      return;\n    }\n    // Parse JSON only once per message.\n    const data = /** @type {!JsonObject} */ (\n      parseJson(/**@type {string} */ (getData(event)).substr(4))\n    );\n    if (win.context.sentinel && data['sentinel'] != win.context.sentinel) {\n      return;\n    }\n    // Don't let other message handlers interpret our events.\n    if (event.stopImmediatePropagation) {\n      event.stopImmediatePropagation();\n    }\n    // Find all the listeners for this type.\n    for (let i = 0; i < listeners.length; i++) {\n      if (listeners[i].type != data['type']) {\n        continue;\n      }\n      const {cb} = listeners[i];\n      try {\n        cb(data);\n      } catch (e) {\n        // Do not interrupt execution.\n        setTimeout(() => {\n          throw e;\n        });\n      }\n    }\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {listenParent} from './messaging';\n\n/**\n * Info about the current document/iframe.\n * @type {boolean}\n */\nlet inViewport = true;\n\n/**\n * @param {boolean} inV\n */\nexport function setInViewportForTesting(inV) {\n  inViewport = inV;\n}\n\n// Active intervals. Must be global, because people clear intervals\n// with clearInterval from a different window.\nconst intervals = {};\nlet intervalId = 1;\n\n/**\n * Add instrumentation to a window and all child iframes.\n * @param {!Window} win\n */\nexport function manageWin(win) {\n  try {\n    manageWin_(win);\n  } catch (e) {\n    // We use a try block, because the ad integrations often swallow errors.\n    console./*OK*/ error(e.message, e.stack);\n  }\n}\n\n/**\n * @param {!Window} win\n */\nfunction manageWin_(win) {\n  if (win.ampSeen) {\n    return;\n  }\n  win.ampSeen = true;\n  // Instrument window.\n  instrumentEntryPoints(win);\n\n  // Watch for new iframes.\n  installObserver(win);\n  // Existing iframes.\n  maybeInstrumentsNodes(win, win.document.querySelectorAll('iframe'));\n  blockSyncPopups(win);\n}\n\n/**\n * Add instrumentation code to doc.write.\n * @param {!Window} parent\n * @param {!Window} win\n */\nfunction instrumentDocWrite(parent, win) {\n  const doc = win.document;\n  const {close} = doc;\n  doc.close = function () {\n    parent.ampManageWin = function (win) {\n      manageWin(win);\n    };\n    if (!parent.ampSeen) {\n      // .call does not work in Safari with document.write.\n      doc.write('<script>window.parent.ampManageWin(window)</script>');\n    }\n    doc._close = close;\n    return doc._close();\n  };\n}\n\n/**\n * Add instrumentation code to iframe's srcdoc.\n * @param {!Window} parent\n * @param {!Element} iframe\n */\nfunction instrumentSrcdoc(parent, iframe) {\n  let srcdoc = iframe.getAttribute('srcdoc');\n  parent.ampManageWin = function (win) {\n    manageWin(win);\n  };\n  srcdoc += '<script>window.parent.ampManageWin(window)</script>';\n  iframe.setAttribute('srcdoc', srcdoc);\n}\n\n/**\n * Instrument added nodes if they are instrumentable iframes.\n * @param {!Window} win\n * @param {!Array<!Node>|NodeList<!Node>|NodeList<!Element>|null} addedNodes\n */\nfunction maybeInstrumentsNodes(win, addedNodes) {\n  for (let n = 0; n < addedNodes.length; n++) {\n    const node = addedNodes[n];\n    try {\n      if (node.tagName != 'IFRAME') {\n        continue;\n      }\n      const src = node.getAttribute('src');\n      const srcdoc = node.getAttribute('srcdoc');\n      if (src == null || /^(about:|javascript:)/i.test(src.trim()) || srcdoc) {\n        if (node.contentWindow) {\n          instrumentIframeWindow(node, win, node.contentWindow);\n          node.addEventListener('load', () => {\n            try {\n              instrumentIframeWindow(node, win, node.contentWindow);\n            } catch (e) {\n              console./*OK*/ error(e.message, e.stack);\n            }\n          });\n        } else if (srcdoc) {\n          instrumentSrcdoc(parent, node);\n        }\n      }\n    } catch (e) {\n      console./*OK*/ error(e.message, e.stack);\n    }\n  }\n}\n\n/**\n * Installs a mutation observer in a window to look for iframes.\n * @param {!Element} node\n * @param {!Window} parent\n * @param {!Window} win\n */\nfunction instrumentIframeWindow(node, parent, win) {\n  if (win.ampSeen) {\n    return;\n  }\n  const doc = win.document;\n  instrumentDocWrite(parent, win);\n  if (doc.body && doc.body.childNodes.length) {\n    manageWin(win);\n  }\n}\n\n/**\n * Installs a mutation observer in a window to look for iframes.\n * @param {!Window} win\n */\nfunction installObserver(win) {\n  if (!window.MutationObserver) {\n    return;\n  }\n  const observer = new MutationObserver(function (mutations) {\n    for (let i = 0; i < mutations.length; i++) {\n      maybeInstrumentsNodes(win, mutations[i].addedNodes);\n    }\n  });\n  observer.observe(win.document.documentElement, {\n    subtree: true,\n    childList: true,\n  });\n}\n\n/**\n * Replace timers with variants that can be throttled.\n * @param {!Window} win\n */\nfunction instrumentEntryPoints(win) {\n  // Change setTimeout to respect a minimum timeout.\n  const {setTimeout} = win;\n  win.setTimeout = function (fn, time) {\n    time = minTime(time);\n    arguments[1] = time;\n    return setTimeout.apply(this, arguments);\n  };\n  // Implement setInterval in terms of setTimeout to make\n  // it respect the same rules\n  win.setInterval = function (fn) {\n    const id = intervalId++;\n    const args = Array.prototype.slice.call(arguments);\n    /**\n     * @return {*}\n     * @suppress {uselessCode}\n     */\n    function wrapper() {\n      next();\n      if (typeof fn == 'string') {\n        // Handle rare and dangerous string arg case.\n        return (0, win.eval) /*NOT OK but whatcha gonna do.*/\n          .call(win, fn); // lgtm [js/useless-expression]\n      } else {\n        return fn.apply(this, arguments);\n      }\n    }\n    args[0] = wrapper;\n    /**\n     *\n     */\n    function next() {\n      intervals[id] = win.setTimeout.apply(win, args);\n    }\n    next();\n    return id;\n  };\n  const {clearInterval} = win;\n  win.clearInterval = function (id) {\n    clearInterval(id);\n    win.clearTimeout(intervals[id]);\n    delete intervals[id];\n  };\n}\n\n/**\n * Blackhole the legacy popups since they should never be used for anything.\n * @param {!Window} win\n */\nfunction blockSyncPopups(win) {\n  let count = 0;\n  /**\n   * Checks for security error.\n   */\n  function maybeThrow() {\n    // Prevent deep recursion.\n    if (count++ > 2) {\n      throw new Error('security error');\n    }\n  }\n  try {\n    win.alert = maybeThrow;\n    win.prompt = function () {\n      maybeThrow();\n      return '';\n    };\n    win.confirm = function () {\n      maybeThrow();\n      return false;\n    };\n  } catch (e) {\n    console./*OK*/ error(e.message, e.stack);\n  }\n}\n\n/**\n * Calculates the minimum time that a timeout should have right now.\n * @param {number|undefined} time\n * @return {number|undefined}\n */\nfunction minTime(time) {\n  if (!inViewport) {\n    time += 1000;\n  }\n  // Eventually this should throttle like this:\n  // - for timeouts in the order of a frame use requestAnimationFrame\n  //   instead.\n  // - only allow about 2-4 short timeouts (< 16ms) in a 16ms time frame.\n  //   Throttle further timeouts to requestAnimationFrame.\n  return time;\n}\n\n/**\n * Installs embed state listener.\n */\nexport function installEmbedStateListener() {\n  listenParent(window, 'embed-state', function (data) {\n    inViewport = data['inViewport'];\n  });\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {IntegrationAmpContext} from './ampcontext-integration';\nimport {dict} from '../src/core/types/object';\nimport {endsWith} from '../src/core/types/string';\nimport {getAmpConfig, getEmbedType, getLocation} from './frame-metadata';\nimport {getSourceUrl, isProxyOrigin, parseUrlDeprecated} from '../src/url';\nimport {\n  initLogConstructor,\n  isUserErrorMessage,\n  setReportError,\n  userAssert,\n} from '../src/log';\nimport {installEmbedStateListener, manageWin} from './environment';\nimport {internalRuntimeVersion} from '../src/internal-version';\nimport {parseJson} from '../src/core/types/object/json';\nimport {run, setExperimentToggles} from './3p';\nimport {urls} from '../src/config';\n\n/**\n * Whether the embed type may be used with amp-embed tag.\n * @const {!Object<string, boolean>}\n */\nconst AMP_EMBED_ALLOWED = {\n  _ping_: true,\n  '1wo': true,\n  '24smi': true,\n  adsloom: true,\n  adstyle: true,\n  bringhub: true,\n  dable: true,\n  engageya: true,\n  epeex: true,\n  firstimpression: true,\n  forkmedia: true,\n  glomex: true,\n  idealmedia: true,\n  insticator: true,\n  jubna: true,\n  kuadio: true,\n  'mantis-recommend': true,\n  mediaad: true,\n  mgid: true,\n  miximedia: true,\n  mywidget: true,\n  nativery: true,\n  lentainform: true,\n  opinary: true,\n  outbrain: true,\n  plista: true,\n  postquare: true,\n  ppstudio: true,\n  pubexchange: true,\n  pulse: true,\n  rbinfox: true,\n  rcmwidget: true,\n  readmo: true,\n  recreativ: true,\n  runative: true,\n  smartclip: true,\n  smi2: true,\n  speakol: true,\n  strossle: true,\n  svknative: true,\n  taboola: true,\n  temedya: true,\n  vlyby: true,\n  whopainfeed: true,\n  yahoofedads: true,\n  yahoonativeads: true,\n  yektanet: true,\n  zen: true,\n  zergnet: true,\n};\n\n// For backward compat, we always allow these types without the iframe\n// opting in.\nconst defaultAllowedTypesInCustomFrame = [\n  // Entries must be reasonably safe and not allow overriding the injected\n  // JS URL.\n  // Each custom iframe can override this through the second argument to\n  // draw3p. See amp-ad docs.\n  'facebook',\n  'twitter',\n  'doubleclick',\n  'yieldbot',\n  '_ping_',\n];\n\n/**\n * Initialize 3p frame.\n * @param {!Window} win\n */\nexport function init(win) {\n  initLogConstructor();\n  const config = getAmpConfig();\n\n  // Overriding to short-circuit src/mode#getMode()\n  win.__AMP_MODE = config.mode;\n\n  setReportError(console.error.bind(console));\n\n  setExperimentToggles(config.experimentToggles);\n}\n\n/**\n * Visible for testing.\n * Draws a 3p embed to the window. Expects the data to include the 3p type.\n * @param {!Window} win\n * @param {!Object} data\n * @param {function(!Object, function(!Object))|undefined} configCallback\n *     Optional callback that allows user code to manipulate the incoming\n *     configuration. See\n *     https://github.com/ampproject/amphtml/issues/1210 for some context\n *     on this.\n */\nexport function draw3pInternal(win, data, configCallback) {\n  const type = data['type'];\n\n  userAssert(\n    isTagNameAllowed(type, win.context.tagName),\n    'Embed type %s not allowed with tag %s',\n    type,\n    win.context.tagName\n  );\n  if (configCallback) {\n    configCallback(data, (data) => {\n      userAssert(data, 'Expected configuration to be passed as first argument');\n      run(type, win, data);\n    });\n  } else {\n    run(type, win, data);\n  }\n}\n\n/**\n * Draws an embed, optionally synchronously, to the DOM.\n * @param {function(!Object, function(!Object))} opt_configCallback If provided\n *     will be invoked with two arguments:\n *     1. The configuration parameters supplied to this embed.\n *     2. A callback that MUST be called for rendering to proceed. It takes\n *        no arguments. Configuration is expected to be modified in-place.\n * @param {!Array<string>=} opt_allowed3pTypes List of advertising network\n *     types you expect.\n * @param {!Array<string>=} opt_allowedEmbeddingOrigins List of domain suffixes\n *     that are allowed to embed this frame.\n */\nexport function draw3p(\n  opt_configCallback,\n  opt_allowed3pTypes,\n  opt_allowedEmbeddingOrigins\n) {\n  try {\n    const location = getLocation();\n\n    ensureFramed(window);\n    validateParentOrigin(window, location);\n    validateAllowedTypes(window, getEmbedType(), opt_allowed3pTypes);\n    if (opt_allowedEmbeddingOrigins) {\n      validateAllowedEmbeddingOrigins(window, opt_allowedEmbeddingOrigins);\n    }\n    window.context = new IntegrationAmpContext(window);\n    manageWin(window);\n    installEmbedStateListener();\n\n    // Ugly type annotation is due to Event.prototype.data being denylisted\n    // and the compiler not being able to discern otherwise\n    // TODO(alanorozco): Do this more elegantly once old impl is cleaned up.\n    draw3pInternal(\n      window,\n      /** @type {!IntegrationAmpContext} */ (window.context).data || {},\n      opt_configCallback\n    );\n\n    window.context.bootstrapLoaded();\n  } catch (e) {\n    if (window.context && window.context.report3pError) {\n      // window.context has initiated yet\n      if (e.message && isUserErrorMessage(e.message)) {\n        // report user error to parent window\n        window.context.report3pError(e);\n      }\n    }\n\n    const c = window.context || {mode: {test: false}};\n    if (!c.mode.test) {\n      lightweightErrorReport(e, c.canary);\n      throw e;\n    }\n  }\n}\n\n/**\n * Throws if the current frame's parent origin is not equal to\n * the claimed origin.\n * Only check for browsers that support ancestorOrigins\n * @param {!Window} window\n * @param {!Location} parentLocation\n * @visibleForTesting\n */\nexport function validateParentOrigin(window, parentLocation) {\n  const ancestors = window.location.ancestorOrigins;\n  // Currently only webkit and blink based browsers support\n  // ancestorOrigins. In that case we proceed but mark the origin\n  // as non-validated.\n  if (!ancestors || !ancestors.length) {\n    return;\n  }\n  userAssert(\n    ancestors[0] == parentLocation.origin,\n    'Parent origin mismatch: %s, %s',\n    ancestors[0],\n    parentLocation.origin\n  );\n}\n\n/**\n * Check that this iframe intended this particular ad type to run.\n * @param {!Window} window\n * @param {string} type 3p type\n * @param {!Array<string>|undefined} allowedTypes May be undefined.\n * @visibleForTesting\n */\nexport function validateAllowedTypes(window, type, allowedTypes) {\n  const thirdPartyHost = parseUrlDeprecated(urls.thirdParty).hostname;\n\n  // Everything allowed in default iframe.\n  if (window.location.hostname == thirdPartyHost) {\n    return;\n  }\n  if (urls.thirdPartyFrameRegex.test(window.location.hostname)) {\n    return;\n  }\n  if (window.location.hostname == 'ads.localhost') {\n    return;\n  }\n  if (defaultAllowedTypesInCustomFrame.indexOf(type) != -1) {\n    return;\n  }\n  userAssert(\n    allowedTypes && allowedTypes.indexOf(type) != -1,\n    '3p type for custom iframe not allowed: %s',\n    type\n  );\n}\n\n/**\n * Check that parent host name was allowed.\n * @param {!Window} window\n * @param {!Array<string>} allowedHostnames Suffixes of allowed host names.\n * @visibleForTesting\n */\nexport function validateAllowedEmbeddingOrigins(window, allowedHostnames) {\n  if (!window.document.referrer) {\n    throw new Error('Referrer expected: ' + window.location.href);\n  }\n  const ancestors = window.location.ancestorOrigins;\n  // We prefer the unforgable ancestorOrigins, but referrer is better than\n  // nothing.\n  const ancestor = ancestors ? ancestors[0] : window.document.referrer;\n  let {hostname} = parseUrlDeprecated(ancestor);\n  if (isProxyOrigin(ancestor)) {\n    // If we are on the cache domain, parse the source hostname from\n    // the referrer. The referrer is used because it should be\n    // trustable.\n    hostname = parseUrlDeprecated(\n      getSourceUrl(window.document.referrer)\n    ).hostname;\n  }\n  for (let i = 0; i < allowedHostnames.length; i++) {\n    // Either the hostname is allowed\n    if (allowedHostnames[i] == hostname) {\n      return;\n    }\n    // Or it ends in .$hostname (aka is a sub domain of an allowed domain.\n    if (endsWith(hostname, '.' + allowedHostnames[i])) {\n      return;\n    }\n  }\n  throw new Error(\n    'Invalid embedding hostname: ' + hostname + ' not in ' + allowedHostnames\n  );\n}\n\n/**\n * Throws if this window is a top level window.\n * @param {!Window} window\n * @visibleForTesting\n */\nexport function ensureFramed(window) {\n  if (window == window.parent) {\n    throw new Error('Must be framed: ' + window.location.href);\n  }\n}\n\n/**\n * Expects the fragment to contain JSON.\n * @param {string} fragment Value of location.fragment\n * @return {?JsonObject}\n * @visibleForTesting\n */\nexport function parseFragment(fragment) {\n  try {\n    let json = fragment.substr(1);\n    // Some browser, notably Firefox produce an encoded version of the fragment\n    // while most don't. Since we know how the string should start, this is easy\n    // to detect.\n    if (json.startsWith('{%22')) {\n      json = decodeURIComponent(json);\n    }\n    return /** @type {!JsonObject} */ (json ? parseJson(json) : dict());\n  } catch (err) {\n    return null;\n  }\n}\n\n/**\n * Not all types of embeds are allowed to be used with all tag names on the\n * AMP side. This function checks whether the current usage is permissible.\n * @param {string} type\n * @param {string|undefined} tagName The tagName that was used to embed this\n *     3p-frame.\n * @return {boolean}\n */\nexport function isTagNameAllowed(type, tagName) {\n  if (tagName == 'AMP-EMBED') {\n    return !!AMP_EMBED_ALLOWED[type];\n  }\n  return true;\n}\n\n/**\n * Reports an error to the server. Must only be called once per page.\n * Not for use in event handlers.\n *\n * We don't use the default error in error.js handler because it has\n * too many deps for this small JS binary.\n *\n * @param {!Error} e\n * @param {boolean} isCanary\n */\nfunction lightweightErrorReport(e, isCanary) {\n  new Image().src =\n    urls.errorReporting +\n    '?3p=1&v=' +\n    encodeURIComponent(internalRuntimeVersion()) +\n    '&m=' +\n    encodeURIComponent(e.message) +\n    '&ca=' +\n    (isCanary ? 1 : 0) +\n    '&r=' +\n    encodeURIComponent(document.referrer) +\n    '&s=' +\n    encodeURIComponent(e.stack || '');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// Note: loaded by 3p system. Cannot rely on babel polyfills.\nimport {dev, devAssert} from './log';\nimport {map} from './core/types/object';\n\n/** @type {Object<string, string>} */\nlet propertyNameCache;\n\n/** @const {!Array<string>} */\nconst vendorPrefixes = ['Webkit', 'webkit', 'Moz', 'moz', 'ms', 'O', 'o'];\n\nconst EMPTY_CSS_DECLARATION = /** @type {!CSSStyleDeclaration} */ ({\n  'getPropertyPriority': () => '',\n  'getPropertyValue': () => '',\n});\n\n/**\n * @param {string} camelCase camel cased string\n * @return {string} title cased string\n */\nexport function camelCaseToTitleCase(camelCase) {\n  return camelCase.charAt(0).toUpperCase() + camelCase.slice(1);\n}\n\n/**\n  Checks the style if a prefixed version of a property exists and returns\n * it or returns an empty string.\n * @private\n * @param {!Object} style\n * @param {string} titleCase the title case version of a css property name\n * @return {string} the prefixed property name or null.\n */\nfunction getVendorJsPropertyName_(style, titleCase) {\n  for (let i = 0; i < vendorPrefixes.length; i++) {\n    const propertyName = vendorPrefixes[i] + titleCase;\n    if (style[propertyName] !== undefined) {\n      return propertyName;\n    }\n  }\n  return '';\n}\n\n/**\n * Returns the possibly prefixed JavaScript property name of a style property\n * (ex. WebkitTransitionDuration) given a camelCase'd version of the property\n * (ex. transitionDuration).\n * @param {!Object} style\n * @param {string} camelCase the camel cased version of a css property name\n * @param {boolean=} opt_bypassCache bypass the memoized cache of property\n *   mapping\n * @return {string}\n */\nexport function getVendorJsPropertyName(style, camelCase, opt_bypassCache) {\n  if (isVar(camelCase)) {\n    // CSS vars are returned as is.\n    return camelCase;\n  }\n  if (!propertyNameCache) {\n    propertyNameCache = map();\n  }\n  let propertyName = propertyNameCache[camelCase];\n  if (!propertyName || opt_bypassCache) {\n    propertyName = camelCase;\n    if (style[camelCase] === undefined) {\n      const titleCase = camelCaseToTitleCase(camelCase);\n      const prefixedPropertyName = getVendorJsPropertyName_(style, titleCase);\n\n      if (style[prefixedPropertyName] !== undefined) {\n        propertyName = prefixedPropertyName;\n      }\n    }\n    if (!opt_bypassCache) {\n      propertyNameCache[camelCase] = propertyName;\n    }\n  }\n  return propertyName;\n}\n\n/**\n * Sets the CSS styles of the specified element with !important. The styles\n * are specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setImportantStyles(element, styles) {\n  const {style} = element;\n  for (const k in styles) {\n    style.setProperty(\n      getVendorJsPropertyName(style, k),\n      String(styles[k]),\n      'important'\n    );\n  }\n}\n\n/**\n * Sets the CSS style of the specified element with optional units, e.g. \"px\".\n * @param {?Element} element\n * @param {string} property\n * @param {*} value\n * @param {string=} opt_units\n * @param {boolean=} opt_bypassCache\n */\nexport function setStyle(element, property, value, opt_units, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(\n    element.style,\n    property,\n    opt_bypassCache\n  );\n  if (!propertyName) {\n    return;\n  }\n  const styleValue = /** @type {string} */ (\n    opt_units ? value + opt_units : value\n  );\n  if (isVar(propertyName)) {\n    element.style.setProperty(propertyName, styleValue);\n  } else {\n    element.style[propertyName] = styleValue;\n  }\n}\n\n/**\n * Returns the value of the CSS style of the specified element.\n * @param {!Element} element\n * @param {string} property\n * @param {boolean=} opt_bypassCache\n * @return {*}\n */\nexport function getStyle(element, property, opt_bypassCache) {\n  const propertyName = getVendorJsPropertyName(\n    element.style,\n    property,\n    opt_bypassCache\n  );\n  if (!propertyName) {\n    return undefined;\n  }\n  if (isVar(propertyName)) {\n    return element.style.getPropertyValue(propertyName);\n  }\n  return element.style[propertyName];\n}\n\n/**\n * Sets the CSS styles of the specified element. The styles\n * a specified as a map from CSS property names to their values.\n * @param {!Element} element\n * @param {!Object<string, *>} styles\n */\nexport function setStyles(element, styles) {\n  for (const k in styles) {\n    setStyle(element, k, styles[k]);\n  }\n}\n\n/**\n * Asserts that the style is not the `display` style.\n * This is the only possible way to pass a dynamic style to setStyle.\n *\n * If you wish to set `display`, use the `toggle` helper instead. This is so\n * changes to display can trigger necessary updates. See #17475.\n *\n * @param {string} style\n * @return {string}\n */\nexport function assertNotDisplay(style) {\n  if (style === 'display') {\n    dev().error(\n      'STYLE',\n      '`display` style detected. You must use toggle instead.'\n    );\n  }\n  return style;\n}\n\n/**\n * Asserts that the styles does not contain the `display` style.\n * This is the only possible way to pass a dynamic styles object to setStyles\n * and setImportantStyles.\n *\n * If you wish to set `display`, use the `toggle` helper instead. This is so\n * changes to display can trigger necessary updates. See #17475.\n *\n * @param {!Object<string, *>} styles\n * @return {!Object<string, *>}\n */\nexport function assertDoesNotContainDisplay(styles) {\n  if ('display' in styles) {\n    dev().error(\n      'STYLE',\n      '`display` style detected in styles. You must use toggle instead.'\n    );\n  }\n  return styles;\n}\n\n/**\n * Sets the initial display style of an element. This is a last resort. If you\n * can set the initial display using CSS, YOU MUST.\n * DO NOT USE THIS TO ARBITRARILY SET THE DISPLAY STYLE AFTER INITIAL SETUP.\n *\n * @param {!Element} el\n * @param {string} value\n */\nexport function setInitialDisplay(el, value) {\n  const {style} = el;\n  devAssert(\n    value !== '' && value !== 'none',\n    'Initial display value must not be \"none\". Use toggle instead.'\n  );\n  devAssert(\n    !style['display'],\n    'setInitialDisplay MUST NOT be used for ' +\n      'resetting the display style. If you are looking for display:none ' +\n      'toggling, use toggle instead.'\n  );\n  style['display'] = value;\n}\n\n/**\n * Shows or hides the specified element.\n * @param {!Element} element\n * @param {boolean=} opt_display\n */\nexport function toggle(element, opt_display) {\n  if (opt_display === undefined) {\n    opt_display = element.hasAttribute('hidden');\n  }\n  if (opt_display) {\n    element.removeAttribute('hidden');\n  } else {\n    element.setAttribute('hidden', '');\n  }\n}\n\n/**\n * Returns a pixel value.\n * @param {number} value\n * @return {string}\n */\nexport function px(value) {\n  return `${value}px`;\n}\n\n/**\n * Returns a degree value.\n * @param {number} value\n * @return {string}\n */\nexport function deg(value) {\n  return `${value}deg`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function translateX(value) {\n  if (typeof value == 'string') {\n    return `translateX(${value})`;\n  }\n  return `translateX(${px(value)})`;\n}\n\n/**\n * Returns a \"translateX\" for CSS \"transform\" property.\n * @param {number|string} x\n * @param {(number|string)=} opt_y\n * @return {string}\n */\nexport function translate(x, opt_y) {\n  if (typeof x == 'number') {\n    x = px(x);\n  }\n  if (opt_y === undefined) {\n    return `translate(${x})`;\n  }\n  if (typeof opt_y == 'number') {\n    opt_y = px(opt_y);\n  }\n  return `translate(${x}, ${opt_y})`;\n}\n\n/**\n * Returns a \"scale\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function scale(value) {\n  return `scale(${value})`;\n}\n\n/**\n * Returns a \"rotate\" for CSS \"transform\" property.\n * @param {number|string} value\n * @return {string}\n */\nexport function rotate(value) {\n  if (typeof value == 'number') {\n    value = deg(value);\n  }\n  return `rotate(${value})`;\n}\n\n/**\n * Remove alpha value from a rgba color value.\n * Return the new color property with alpha equals if has the alpha value.\n * Caller needs to make sure the input color value is a valid rgba/rgb value\n * @param {string} rgbaColor\n * @return {string}\n */\nexport function removeAlphaFromColor(rgbaColor) {\n  return rgbaColor.replace(\n    /\\(([^,]+),([^,]+),([^,)]+),[^)]+\\)/g,\n    '($1,$2,$3, 1)'\n  );\n}\n\n/**\n * Gets the computed style of the element. The helper is necessary to enforce\n * the possible `null` value returned by a buggy Firefox.\n *\n * @param {!Window} win\n * @param {!Element} el\n * @return {!CSSStyleDeclaration}\n */\nexport function computedStyle(win, el) {\n  const style = /** @type {?CSSStyleDeclaration} */ (win.getComputedStyle(el));\n  return style || EMPTY_CSS_DECLARATION;\n}\n\n/**\n * Resets styles that were set dynamically (i.e. inline)\n * @param {!Element} element\n * @param {!Array<string>} properties\n */\nexport function resetStyles(element, properties) {\n  for (let i = 0; i < properties.length; i++) {\n    setStyle(element, properties[i], null);\n  }\n}\n\n/**\n * Propagates the object-fit/position element attributes as styles.\n * @param {!Element} fromEl ie: amp-img\n * @param {!Element} toEl ie: the img within amp-img\n */\nexport function propagateObjectFitStyles(fromEl, toEl) {\n  if (fromEl.hasAttribute('object-fit')) {\n    setStyle(toEl, 'object-fit', fromEl.getAttribute('object-fit'));\n  }\n\n  if (fromEl.hasAttribute('object-position')) {\n    setStyle(toEl, 'object-position', fromEl.getAttribute('object-position'));\n  }\n}\n\n/**\n * @param {string} property\n * @return {boolean}\n */\nfunction isVar(property) {\n  return property.startsWith('--');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS-IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from './3p';\nimport {setStyles} from '../src/style';\n\n/**\n * Produces the Twitter API object for the passed in callback. If the current\n * frame is the master frame it makes a new one by injecting the respective\n * script, otherwise it schedules the callback for the script from the master\n * window.\n * @param {!Window} global\n */\nfunction getBeOpinion(global) {\n  loadScript(global, 'https://widget.beop.io/sdk.js', function () {});\n}\n\n/**\n * @param {!Window} global\n * @description Make canonicalUrl available from iframe\n */\nfunction addCanonicalLinkTag(global) {\n  const {canonicalUrl} = global.context;\n  if (canonicalUrl) {\n    const link = global.document.createElement('link');\n    link.setAttribute('rel', 'canonical');\n    link.setAttribute('href', canonicalUrl);\n    global.document.head.appendChild(link);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @return {?Node}\n */\nfunction createContainer(global, data) {\n  // add canonical link tag\n  addCanonicalLinkTag(global);\n\n  // create div\n  const container = global.document.createElement('container');\n  container.className = 'BeOpinionWidget';\n\n  // get content id\n  if (data['content'] !== null) {\n    container.setAttribute('data-content', data['content']);\n  }\n\n  // get my-content value, forcing it to '1' if it is not an amp-ad\n  if (global.context.tagName === 'AMP-BEOPINION') {\n    container.setAttribute('data-my-content', '1');\n  } else if (data['my-content'] !== null) {\n    container.setAttribute('data-my-content', data['my-content']);\n  }\n\n  // get slot name\n  if (data['name'] !== null) {\n    container.setAttribute('data-name', data['name']);\n  }\n\n  setStyles(container, {\n    width: '100%',\n    display: 'block',\n  });\n\n  return container;\n}\n\n/**\n * @param {*} global\n * @param {*} accountId\n * @return {!Function}\n */\nfunction getBeOpinionAsyncInit(global, accountId) {\n  const {context} = global;\n  return function () {\n    global.BeOpinionSDK.init({\n      account: accountId,\n      onContentReceive: function (hasContent) {\n        if (hasContent) {\n          context.renderStart();\n        } else {\n          context.noContentAvailable();\n        }\n      },\n      onHeightChange: function (newHeight) {\n        const c = global.document.getElementById('c');\n        const boundingClientRect = c./*REVIEW*/ getBoundingClientRect();\n        context\n          .requestResize(boundingClientRect.width, newHeight)\n          .catch(function () {\n            context.requestResize(boundingClientRect.width, newHeight);\n          });\n      },\n    });\n    global.BeOpinionSDK['watch'](); // global.BeOpinionSDK.watch() fails 'amp check-types' validation\n  };\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function beopinion(global, data) {\n  const container = createContainer(global, data);\n  const c = global.document.getElementById('c');\n  c.appendChild(container);\n\n  global.beOpinionAsyncInit = getBeOpinionAsyncInit(global, data.account);\n  getBeOpinion(global);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dict} from '../src/core/types/object';\nimport {getData} from '../src/event-helper';\nimport {loadScript} from './3p';\nimport {parseJson} from '../src/core/types/object/json';\nimport {setStyles} from '../src/style';\n\nconst libSourceUrl = dict({\n  'canvas':\n    'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.6/lottie_canvas.min.js',\n  'html':\n    'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.6/lottie_html.min.js',\n  'svg':\n    'https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.7.6/lottie_svg.min.js',\n});\n\n/**\n * Produces the AirBnB Bodymovin Player SDK object for the passed in callback.\n * @param {!Window} global\n * @param {function(!Object)} cb\n */\n\nlet animationHandler;\n\n/**\n * @param {!Window} global\n * @param {string} renderer\n * @param {!Function} cb\n */\nfunction getBodymovinAnimationSdk(global, renderer, cb) {\n  const scriptToLoad = libSourceUrl[renderer] ?? libSourceUrl['svg'];\n  loadScript(global, scriptToLoad, function () {\n    cb(global.bodymovin);\n  });\n}\n\n/**\n * @param {!Event} event\n */\nfunction parseMessage(event) {\n  const eventMessage = parseJson(getData(event));\n  const action = eventMessage['action'];\n  if (action == 'play') {\n    animationHandler.play();\n  } else if (action == 'pause') {\n    animationHandler.pause();\n  } else if (action == 'stop') {\n    animationHandler.stop();\n  } else if (action == 'seekTo') {\n    if (eventMessage['valueType'] === 'time') {\n      animationHandler.goToAndStop(eventMessage['value']);\n    } else {\n      const frameNumber = Math.round(\n        eventMessage['value'] * animationHandler.totalFrames\n      );\n      animationHandler.goToAndStop(frameNumber, true);\n    }\n  }\n}\n\n/**\n * @param {!Window} global\n */\nexport function bodymovinanimation(global) {\n  const dataReceived = parseJson(global.name)['attributes']._context;\n  const dataLoop = dataReceived['loop'];\n  const animatingContainer = global.document.createElement('div');\n  setStyles(animatingContainer, {\n    width: '100%',\n    height: '100%',\n  });\n\n  global.document.getElementById('c').appendChild(animatingContainer);\n  const shouldLoop = dataLoop != 'false';\n  const loop = !isNaN(dataLoop) ? dataLoop : shouldLoop;\n  const renderer = dataReceived['renderer'];\n  getBodymovinAnimationSdk(global, renderer, function (bodymovin) {\n    animationHandler = bodymovin.loadAnimation({\n      container: animatingContainer,\n      renderer,\n      loop,\n      autoplay: dataReceived['autoplay'],\n      animationData: dataReceived['animationData'],\n    });\n    const message = JSON.stringify(\n      dict({\n        'action': 'ready',\n      })\n    );\n    global.addEventListener('message', parseMessage, false);\n    global.parent./*OK*/ postMessage(message, '*');\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../src/core/types/object';\nimport {loadScript} from './3p';\nimport {setStyle} from '../src/style';\n\n/**\n * Embedly platform library url to create cards.\n * @const {string}\n */\nconst EMBEDLY_SDK_URL = 'https://cdn.embedly.com/widgets/platform.js';\n\n/**\n * Event name emitted by embedly's SDK.\n * @type {string}\n */\nconst RESIZE_EVENT_NAME = 'card.resize';\n\n/**\n * Css class expected by embedly library to style card.\n * @const {string}\n */\nconst CARD_CSS_CLASS = 'embedly-card';\n\n/**\n * Allowed card options.\n *\n * - Key is in camel case as received in \"data\".\n * - The value is in the format expected by embedly.\n *\n * @see {@link http://docs.embed.ly/docs/cards#customize}\n * @const @enum {string}\n */\nexport const CardOptions = {\n  cardVia: 'card-via',\n  cardTheme: 'card-theme',\n  cardImage: 'card-image',\n  cardControls: 'card-controls',\n  cardAlign: 'card-align',\n  cardRecommend: 'card-recommend',\n  cardEmbed: 'card-embed',\n  cardKey: 'card-key',\n};\n\n/**\n * Loads embedly card SDK that is consumed by this 3p integration.\n *\n * @param {!Window} global\n * @param {function()} callback\n * @visibleForTesting\n */\nfunction getEmbedly(global, callback) {\n  loadScript(global, EMBEDLY_SDK_URL, function () {\n    callback();\n  });\n}\n\n/**\n * Creates embedly card using sdk.\n *\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function embedly(global, data) {\n  const card = global.document.createElement('a');\n\n  card.href = data.url;\n  card.classList.add(CARD_CSS_CLASS);\n\n  // Add permissible data attributes and values to card\n  // when these are provided by component.\n  for (const key in CardOptions) {\n    if (hasOwn(CardOptions, key) && typeof data[key] !== 'undefined') {\n      card.setAttribute(`data-${CardOptions[key]}`, data[key]);\n    }\n  }\n\n  const container = global.document.getElementById('c');\n\n  // Adds support to embedly dark theme not set by the sdk\n  if (data['cardTheme'] === 'dark') {\n    setStyle(container, 'background', 'rgba(51, 51, 51)');\n  }\n\n  container.appendChild(card);\n\n  getEmbedly(global, function () {\n    // Given by the parent frame.\n    delete data.width;\n    delete data.height;\n\n    global.window['embedly']('card', card);\n\n    // Use embedly SDK to listen to resize event from loaded card\n    global.window['embedly']('on', RESIZE_EVENT_NAME, function (iframe) {\n      context.requestResize(\n        iframe./*OK*/ width,\n        parseInt(iframe./*OK*/ height, 10) + /* margin */ 5\n      );\n    });\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dashToUnderline} from '../src/core/types/string';\nimport {devAssert} from '../src/log';\nimport {dict} from '../src/core/types/object';\nimport {isEnumValue} from '../src/core/types/enum';\nimport {loadScript} from './3p';\nimport {setStyle} from '../src/style';\n\n/** @const @enum {string} */\nexport const FacebookEmbedType = {\n  // Embeds a single comment or reply to a comment on a post rendered by\n  // amp-facebook.\n  COMMENT: 'comment',\n  // Allows users to comment on the embedded content using their Facebook\n  // accounts. Correlates to amp-facebook-comments.\n  COMMENTS: 'comments',\n  LIKE: 'like',\n  PAGE: 'page',\n  POST: 'post',\n  VIDEO: 'video',\n};\n\n/**\n * Produces the Facebook SDK object for the passed in callback.\n *\n * Note: Facebook SDK fails to render multiple plugins when the SDK is only\n * loaded in one frame. To Allow the SDK to render them correctly we load the\n * script per iframe.\n *\n * @param {!Window} global\n * @param {function(!Object)} cb\n * @param {string} locale\n */\nfunction getFacebookSdk(global, cb, locale) {\n  loadScript(\n    global,\n    'https://connect.facebook.net/' + locale + '/sdk.js',\n    () => {\n      cb(global.FB);\n    }\n  );\n}\n\n/**\n * Create DOM element for all Facebook embeds.\n * @param {!Window} global\n * @param {string} classNameSuffix The suffix for the `fb-` class.\n * @param {string} href\n * @return {!Element} div\n */\nfunction createContainer(global, classNameSuffix, href) {\n  const container = global.document.createElement('div');\n  container.className = 'fb-' + classNameSuffix;\n  container.setAttribute('data-href', href);\n  return container;\n}\n\n/**\n * Create DOM element for the Facebook embedded content plugin for posts.\n * @see https://developers.facebook.com/docs/plugins/embedded-posts\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getPostContainer(global, data) {\n  if (data.alignCenter) {\n    const c = global.document.getElementById('c');\n    setStyle(c, 'text-align', 'center');\n  }\n  return createContainer(global, 'post', data.href);\n}\n\n/**\n * Create DOM element for the Facebook embedded content plugin for videos.\n * @see https://developers.facebook.com/docs/plugins/embedded-video-player\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getVideoContainer(global, data) {\n  const container = createContainer(global, 'video', data.href);\n  // If the user hasn't set the `data-embed-as` attribute and the provided href\n  // is a video, Force the `data-embed-as` attribute to 'video' and make sure\n  // to show the post's text.\n  if (!data.embedAs) {\n    container.setAttribute('data-embed-as', 'video');\n    // Since 'data-embed-as=\"video\"' disables post text, setting the\n    // 'data-show-text' to 'true' enables the ability to see the text (changed\n    // from the default 'false')\n    container.setAttribute('data-show-text', 'true');\n  }\n  return container;\n}\n\n/**\n * Create DOM element for the Facebook embedded content plugin for comments or\n * comment replies.\n * @see https://developers.facebook.com/docs/plugins/embedded-comments\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getCommentContainer(global, data) {\n  const c = global.document.getElementById('c');\n  const container = createContainer(global, 'comment-embed', data.href);\n  container.setAttribute(\n    'data-include-parent',\n    data.includeCommentParent || 'false'\n  );\n  container.setAttribute('data-width', c./*OK*/ offsetWidth);\n  return container;\n}\n\n/**\n * Gets the default type to embed as, if not specified.\n * @param {string} href\n * @return {string}\n */\nfunction getDefaultEmbedAs(href) {\n  return href.match(/\\/videos\\/\\d+\\/?$/) ? 'video' : 'post';\n}\n\n/**\n * Create DOM element for the Facebook embedded page plugin.\n * Reference: https://developers.facebook.com/docs/plugins/page-plugin\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getPageContainer(global, data) {\n  const container = createContainer(global, 'page', data.href);\n  container.setAttribute('data-tabs', data.tabs);\n  container.setAttribute('data-hide-cover', data.hideCover);\n  container.setAttribute('data-show-facepile', data.showFacepile);\n  container.setAttribute('data-hide-cta', data.hideCta);\n  container.setAttribute('data-small-header', data.smallHeader);\n  container.setAttribute('data-adapt-container-width', true);\n\n  const c = global.document.getElementById('c');\n  // Note: The facebook embed  allows a maximum width of 500px.\n  // If the container's width exceeds that, the embed's width will\n  // be clipped to 500px.\n  container.setAttribute('data-width', c./*OK*/ offsetWidth);\n  return container;\n}\n\n/**\n * Create DOM element for the Facebook comments plugin:\n * Reference: https://developers.facebook.com/docs/plugins/comments\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getCommentsContainer(global, data) {\n  const container = createContainer(global, 'comments', data.href);\n  container.setAttribute('data-numposts', data.numposts || 10);\n  container.setAttribute('data-colorscheme', data.colorscheme || 'light');\n  container.setAttribute('data-order-by', data.orderBy || 'social');\n  container.setAttribute('data-width', '100%');\n  return container;\n}\n\n/**\n * Create DOM element for the Facebook like-button plugin:\n * Reference: https://developers.facebook.com/docs/plugins/like-button\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getLikeContainer(global, data) {\n  const container = createContainer(global, 'like', data.href);\n  container.setAttribute('data-action', data.action || 'like');\n  container.setAttribute('data-colorscheme', data.colorscheme || 'light');\n  container.setAttribute('data-kd_site', data.kd_site || 'false');\n  container.setAttribute('data-layout', data.layout || 'standard');\n  container.setAttribute('data-ref', data.ref || '');\n  container.setAttribute('data-share', data.share || 'false');\n  container.setAttribute('data-show_faces', data.show_faces || 'false');\n  container.setAttribute('data-size', data.size || 'small');\n  return container;\n}\n\n/**\n * Create DOM element for the Facebook embedded content plugin.\n * @param {!Window} global\n * @param {!Object} data The element data\n * @param {string} embedAs\n * @return {!Element} div\n */\nfunction getEmbedContainer(global, data, embedAs) {\n  devAssert(isEnumValue(FacebookEmbedType, embedAs));\n  switch (embedAs) {\n    case FacebookEmbedType.PAGE:\n      return getPageContainer(global, data);\n    case FacebookEmbedType.LIKE:\n      return getLikeContainer(global, data);\n    case FacebookEmbedType.COMMENTS:\n      return getCommentsContainer(global, data);\n    case FacebookEmbedType.COMMENT:\n      return getCommentContainer(global, data);\n    case FacebookEmbedType.VIDEO:\n      return getVideoContainer(global, data);\n    default:\n      return getPostContainer(global, data);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function facebook(global, data) {\n  const container = getEmbedContainer(\n    global,\n    data,\n    data.embedAs || getDefaultEmbedAs(data.href)\n  );\n  global.document.getElementById('c').appendChild(container);\n\n  getFacebookSdk(\n    global,\n    (FB) => {\n      // Dimensions are given by the parent frame.\n      delete data.width;\n      delete data.height;\n\n      FB.Event.subscribe('xfbml.resize', (event) => {\n        context.updateDimensions(\n          parseInt(event.width, 10),\n          parseInt(event.height, 10) + /* margins */ 20\n        );\n      });\n\n      FB.init({xfbml: true, version: 'v2.5'});\n\n      // Report to parent that the SDK has loaded and is ready to paint\n      const message = JSON.stringify(\n        dict({\n          'action': 'ready',\n        })\n      );\n      global.parent./*OK*/ postMessage(message, '*');\n    },\n    data.locale ? data.locale : dashToUnderline(window.navigator.language)\n  );\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {userAssert} from '../src/log';\nimport {writeScript} from './3p';\n\n/**\n * Get the correct script for the gist.\n *\n * Use writeScript: Failed to execute 'write' on 'Document': It isn't possible\n * to write into a document from an asynchronously-loaded external script unless\n * it is explicitly opened.\n *\n * @param {!Window} global\n * @param {string} scriptSource The source of the script, different for post and comment embeds.\n * @param {function()} cb\n */\nfunction getGistJs(global, scriptSource, cb) {\n  writeScript(global, scriptSource, function () {\n    cb();\n  });\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function github(global, data) {\n  userAssert(\n    data.gistid,\n    'The data-gistid attribute is required for <amp-gist> %s',\n    data.element\n  );\n\n  let gistUrl =\n    'https://gist.github.com/' + encodeURIComponent(data.gistid) + '.js';\n\n  if (data.file) {\n    gistUrl += '?file=' + encodeURIComponent(data.file);\n  }\n\n  getGistJs(global, gistUrl, function () {\n    // Dimensions are given by the parent frame.\n    delete data.width;\n    delete data.height;\n    const gistContainer = global.document.querySelector('#c .gist');\n\n    // get all links in the embed\n    const gistLinks = global.document.querySelectorAll('.gist-meta a');\n    for (let i = 0; i < gistLinks.length; i++) {\n      // have the links open in a new tab #8587\n      gistLinks[i].target = '_BLANK';\n    }\n\n    context.updateDimensions(\n      gistContainer./*OK*/ offsetWidth,\n      gistContainer./*OK*/ offsetHeight\n    );\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport default class AnimationLoop {\n  /**\n   * Creates an instance of AnimationLoop.\n   * @param {!Function} task\n   */\n  constructor(task) {\n    /** @private */\n    this.task_ = task;\n\n    /** @private {boolean} */\n    this.isRunning_ = false;\n\n    /** @private {number} */\n    this.currentRAF_ = 0;\n\n    /** @public {boolean} */\n    this.needsUpdate = true;\n\n    /** @private */\n    this.loop_ = this.loop_.bind(this);\n  }\n\n  /**\n   * Runs the task\n   * @return {boolean}\n   */\n  run() {\n    if (this.isRunning_) {\n      return false;\n    }\n    this.isRunning_ = true;\n    this.loop_();\n    return true;\n  }\n\n  /**\n   * Stops the task execution.\n   */\n  stop() {\n    this.isRunning_ = false;\n    if (this.currentRAF_ !== 0) {\n      cancelAnimationFrame(this.currentRAF_);\n      this.currentRAF_ = 0;\n    }\n  }\n\n  /** @private */\n  loop_() {\n    if (!this.isRunning_) {\n      return;\n    }\n\n    if (this.needsUpdate) {\n      this.needsUpdate = false;\n      this.task_();\n    }\n\n    this.currentRAF_ = requestAnimationFrame(this.loop_);\n  }\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/* global THREE */\n\nimport {setStyle} from '../../src/style';\nimport AnimationLoop from './animation-loop';\n\nconst CAMERA_DISTANCE_FACTOR = 1;\nconst CAMERA_FAR_FACTOR = 50;\nconst CAMERA_NEAR_FACTOR = 0.1;\n\nexport default class GltfViewer {\n  /**\n   * Creates an instance of GltfViewer.\n   * @param {!JsonObject} options\n   * @param {*} handlers\n   */\n  constructor(options, handlers) {\n    /** @private */\n    this.options_ = options;\n\n    /** @private */\n    this.handlers_ = handlers;\n\n    /** @private */\n    this.renderer_ = new THREE.WebGLRenderer(options['renderer']);\n\n    /** @private */\n    this.camera_ = new THREE.PerspectiveCamera();\n\n    /** @private */\n    this.controls_ = new THREE.OrbitControls(\n      this.camera_,\n      this.renderer_.domElement\n    );\n\n    /** @private */\n    this.scene_ = new THREE.Scene();\n\n    /** @private */\n    this.animationLoop_ = new AnimationLoop(() => this.step_());\n\n    /** @private */\n    this.ampPlay_ = true;\n\n    /** @private */\n    this.ampInViewport_ = false;\n\n    /** @private */\n    this.setSize_ = this.setupSize_();\n\n    /** @private */\n    this.model_ = new THREE.Group();\n\n    this.setupRenderer_();\n    this.setupControls_();\n    this.setupLight_();\n    this.loadObject_();\n    this.reconcileAnimationLoop_();\n\n    this.actions = {\n      'setSize': this.setSize_,\n      'toggleAmpPlay': this.toggleAmpPlay_.bind(this),\n      'toggleAmpViewport': this.toggleAmpViewport_.bind(this),\n      'setModelRotation': this.setModelRotation_.bind(this),\n    };\n  }\n\n  /**\n   * @param {JsonObject} args\n   * @private\n   */\n  setModelRotation_(args) {\n    const xAngle =\n      'x' in args\n        ? this.getModelRotationOnAxis_(args, 'x')\n        : this.model_.rotation.x;\n\n    const yAngle =\n      'y' in args\n        ? this.getModelRotationOnAxis_(args, 'y')\n        : this.model_.rotation.y;\n\n    const zAngle =\n      'z' in args\n        ? this.getModelRotationOnAxis_(args, 'z')\n        : this.model_.rotation.z;\n\n    this.model_.rotation.set(xAngle, yAngle, zAngle);\n    this.animationLoop_.needsUpdate = true;\n  }\n\n  /**\n   * @param {JsonObject} args\n   * @param {string} axisName\n   * @return {number}\n   * @private\n   */\n  getModelRotationOnAxis_(args, axisName) {\n    const {\n      [axisName]: value,\n      [axisName + 'Min']: min = 0,\n      [axisName + 'Max']: max = Math.PI * 2,\n    } = args;\n    return value * max + (1 - value) * min;\n  }\n\n  /**\n   * @private\n   * @return {*} TODO(#23582): Specify return type\n   */\n  setupSize_() {\n    let oldW = null;\n    let oldH = null;\n    /** @param {JsonObject} box */\n    const setSize = (box) => {\n      const w = box['width'];\n      const h = box['height'];\n      if (oldW === w && oldH === h) {\n        return;\n      }\n      this.camera_.aspect = w / h;\n      this.camera_.updateProjectionMatrix();\n      this.renderer_.setSize(w, h);\n      this.animationLoop_.needsUpdate = true;\n      oldW = w;\n      oldH = h;\n    };\n\n    setSize(this.options_['initialLayoutRect']);\n\n    return setSize;\n  }\n\n  /** @private */\n  setupControls_() {\n    Object.assign(this.controls_, this.options_['controls']);\n    this.controls_.addEventListener('change', () => {\n      this.animationLoop_.needsUpdate = true;\n    });\n  }\n\n  /**\n   * Sets lighting scheme.\n   *\n   * There are no formal reasoning behind lighting scheme.\n   * It just looks good.\n   *\n   * Two directional lights, from above and below.\n   * One ambient to avoid completely dark areas.\n   * All lights are white.\n   *\n   * @private */\n  setupLight_() {\n    const amb = new THREE.AmbientLight(0xedecd5, 0.5);\n\n    const dir1 = new THREE.DirectionalLight(0xffffff, 0.5);\n    dir1.position.set(0, 5, 3);\n\n    const dir2 = new THREE.DirectionalLight(0xaecdd6, 0.4);\n    dir2.position.set(-1, -2, 4);\n\n    const light = new THREE.Group();\n    light.add(amb, dir1, dir2);\n\n    this.scene_.add(light);\n  }\n\n  /** @private */\n  setupRenderer_() {\n    const el = this.renderer_.domElement;\n    setStyle(el, 'position', 'absolute');\n    setStyle(el, 'top', 0);\n    setStyle(el, 'right', 0);\n    setStyle(el, 'bottom', 0);\n    setStyle(el, 'left', 0);\n    document.body.appendChild(this.renderer_.domElement);\n\n    this.renderer_.gammaOutput = true;\n    this.renderer_.gammaFactor = 2.2;\n    this.renderer_.setPixelRatio(\n      Math.min(\n        this.options_['rendererSettings']['maxPixelRatio'],\n        devicePixelRatio\n      )\n    );\n    this.renderer_.setClearColor(\n      this.options_['rendererSettings']['clearColor'],\n      this.options_['rendererSettings']['clearAlpha']\n    );\n  }\n\n  /**\n   * Camera is set to be not too far or near in terms of object's size.\n   *\n   * We are positioning camera on a ray coming from center (C)\n   * of bounding box to its corner with max coordinates (M),\n   * and outside bbox to the length of CM * CAMERA_DISTANCE_FACTOR.\n   *\n   * It may look weird for objects stretched along one axis,\n   * also there are objects meant to be observed from inside,\n   * it will incorrectly work for them too.\n   *\n   * @param {!THREE.Object3D} object\n   * @private */\n  setupCameraForObject_(object) {\n    const center = new THREE.Vector3();\n    const size = new THREE.Vector3();\n    const bbox = new THREE.Box3();\n    bbox.setFromObject(object);\n    bbox.getCenter(center);\n    bbox.getSize(size);\n\n    const sizeLength = size.length();\n    this.camera_.far = sizeLength * CAMERA_FAR_FACTOR;\n    this.camera_.near = sizeLength * CAMERA_NEAR_FACTOR;\n    this.camera_.position.lerpVectors(\n      center,\n      bbox.max,\n      1 + CAMERA_DISTANCE_FACTOR\n    );\n    this.camera_.lookAt(center);\n\n    this.camera_.updateProjectionMatrix();\n    this.camera_.updateMatrixWorld();\n\n    this.controls_.target.copy(center);\n  }\n\n  /** @private */\n  loadObject_() {\n    const loader = new THREE.GLTFLoader();\n    loader.crossOrigin = true;\n\n    loader.load(\n      this.options_['src'],\n      /** @param {{scene: !THREE.Scene}} gltfData */\n      (gltfData) => {\n        this.setupCameraForObject_(gltfData.scene);\n        gltfData.scene.children.slice().forEach((child) => {\n          this.model_.add(child);\n        });\n\n        this.scene_.add(this.model_);\n\n        this.animationLoop_.needsUpdate = true;\n        this.handlers_.onload();\n      },\n      this.handlers_.onprogress,\n      this.handlers_.onerror\n    );\n  }\n\n  /** @private */\n  step_() {\n    this.controls_.update();\n    this.renderer_.render(this.scene_, this.camera_);\n  }\n\n  /**\n   * @param {boolean} value\n   * @private */\n  toggleAmpPlay_(value) {\n    this.ampPlay_ = value;\n    this.reconcileAnimationLoop_();\n  }\n\n  /**\n   * @param {boolean} inVp\n   * @private */\n  toggleAmpViewport_(inVp) {\n    this.ampInViewport_ = inVp;\n    this.reconcileAnimationLoop_();\n  }\n\n  /** @private */\n  reconcileAnimationLoop_() {\n    if (this.ampInViewport_ && this.ampPlay_) {\n      this.animationLoop_.needsUpdate = true;\n      this.animationLoop_.run();\n    } else {\n      this.animationLoop_.stop();\n    }\n  }\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dict} from '../../src/core/types/object';\nimport {listenParent, nonSensitiveDataPostMessage} from '../messaging';\nimport {loadScript} from '../3p';\nimport {parseJson} from '../../src/core/types/object/json';\nimport {user} from '../../src/log';\n\nimport GltfViewer from './viewer';\n\nconst seq = (taskA, taskB) => (cb) => taskA(() => taskB(cb));\nconst parallel = (taskA, taskB) => (cb) => {\n  let n = 0;\n  const finish = () => {\n    n++;\n    if (n === 2) {\n      cb();\n    }\n  };\n  taskA(finish);\n  taskB(finish);\n};\n\nconst loadThree = (global, cb) => {\n  const loadScriptCb = (url) => (cb) => loadScript(global, url, cb);\n  const loadThreeExample = (examplePath) =>\n    loadScriptCb(\n      'https://cdn.jsdelivr.net/npm/three@0.91/examples/js/' + examplePath\n    );\n\n  seq(\n    loadScriptCb('https://cdnjs.cloudflare.com/ajax/libs/three.js/91/three.js'),\n    parallel(\n      loadThreeExample('loaders/GLTFLoader.js'),\n      loadThreeExample('controls/OrbitControls.js')\n    )\n  )(cb);\n};\n\n/**\n * @param {!Window} global\n */\nexport function gltfViewer(global) {\n  const dataReceived = parseJson(global.name)['attributes']._context;\n\n  loadThree(global, () => {\n    const viewer = new GltfViewer(dataReceived, {\n      onload: () => {\n        nonSensitiveDataPostMessage('loaded');\n      },\n      onprogress: (e) => {\n        if (!e.lengthComputable) {\n          return;\n        }\n        nonSensitiveDataPostMessage(\n          'progress',\n          dict({\n            'total': e.total,\n            'loaded': e.loaded,\n          })\n        );\n      },\n      onerror: (err) => {\n        user().error('3DGLTF', err);\n        nonSensitiveDataPostMessage(\n          'error',\n          dict({\n            'error': (err || '').toString(),\n          })\n        );\n      },\n    });\n    listenParent(global, 'action', (msg) => {\n      viewer.actions[msg['action']](msg['args']);\n    });\n    nonSensitiveDataPostMessage('ready');\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {setStyle} from '../src/style';\nimport {userAssert} from '../src/log';\nimport {writeScript} from './3p';\n\n/**\n * Get the correct script for the mathml formula.\n *\n * Use writeScript: Failed to execute 'write' on 'Document': It isn't possible\n * to write into a document from an asynchronously-loaded external script unless\n * it is explicitly opened.\n *\n * @param {!Window} global\n * @param {string} scriptSource The source of the script, different for post and comment embeds.\n * @param {function(*)} cb\n */\nfunction getMathmlJs(global, scriptSource, cb) {\n  writeScript(global, scriptSource, function () {\n    cb(global.MathJax);\n  });\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mathml(global, data) {\n  userAssert(\n    data.formula,\n    'The formula attribute is required for <amp-mathml> %s',\n    data.element\n  );\n\n  getMathmlJs(\n    global,\n    'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML',\n    (mathjax) => {\n      // Dimensions are given by the parent frame.\n      delete data.width;\n      delete data.height;\n      const div = document.createElement('div');\n      div.setAttribute('id', 'mathmlformula');\n      div.textContent = data.formula;\n      setStyle(div, 'visibility', 'hidden');\n      global.document.body.appendChild(div);\n      mathjax.Hub.Config({\n        showMathMenu: false,\n        // (#26082): From a11y perspective, user should not be able to tab to\n        // the math formula which has no functionality to interact with.  This\n        // configuration removes the formula from the tab-index.\n        menuSettings: {\n          inTabOrder: false,\n        },\n      });\n      mathjax.Hub.Queue(function () {\n        const rendered = document.getElementById('MathJax-Element-1-Frame');\n        // Remove built in mathjax margins.\n        let display = document.getElementsByClassName('MJXc-display');\n        if (!display[0]) {\n          const span = document.createElement('span');\n          span.setAttribute('class', 'mjx-chtml MJXc-display');\n          span.appendChild(rendered);\n          div.appendChild(span);\n          display = document.getElementsByClassName('MJXc-display');\n        }\n        display[0].setAttribute('style', 'margin-top:0;margin-bottom:0');\n        context.requestResize(\n          rendered./*OK*/ offsetWidth,\n          rendered./*OK*/ offsetHeight\n        );\n        setStyle(div, 'visibility', 'visible');\n      });\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from './3p';\n\n/**\n * Get the correct script for the container.\n * @param {!Window} global\n * @param {string} scriptSource The source of the script, different for post and comment embeds.\n */\nfunction getContainerScript(global, scriptSource) {\n  loadScript(global, scriptSource, () => {});\n}\n\n/**\n * Embedly looks for a blockquote with a '-card' suffixed class.\n * @param {!Window} global\n * @return {!Element} blockquote\n */\nfunction getPostContainer(global) {\n  const blockquote = global.document.createElement('blockquote');\n  blockquote.classList.add('reddit-card');\n  blockquote.setAttribute('data-card-created', Math.floor(Date.now() / 1000));\n  return blockquote;\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getCommentContainer(global, data) {\n  const div = global.document.createElement('div');\n  div.classList.add('reddit-embed');\n  div.setAttribute('data-embed-media', 'www.redditmedia.com');\n  // 'uuid' and 'created' are provided by the embed script, but don't seem\n  // to actually be needed. Account for them, but let them default to undefined.\n  div.setAttribute('data-embed-uuid', data.uuid);\n  div.setAttribute('data-embed-created', data.embedcreated);\n  div.setAttribute('data-embed-parent', data.embedparent || 'false');\n  div.setAttribute('data-embed-live', data.embedlive || 'false');\n\n  return div;\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function reddit(global, data) {\n  const embedtype = data.embedtype || 'post';\n\n  let container;\n  let scriptSource = '';\n\n  // Post and comment embeds are handled totally differently.\n  if (embedtype === 'post') {\n    container = getPostContainer(global);\n    scriptSource = 'https://embed.redditmedia.com/widgets/platform.js';\n  } else if (embedtype === 'comment') {\n    container = getCommentContainer(global, data);\n    scriptSource = 'https://www.redditstatic.com/comment-embed.js';\n  }\n\n  const link = global.document.createElement('a');\n  link.href = data.src;\n\n  container.appendChild(link);\n  global.document.getElementById('c').appendChild(container);\n\n  getContainerScript(global, scriptSource);\n\n  global.addEventListener('resize', (event) => {\n    global.context.updateDimensions(\n      event.target.outerWidth,\n      event.target.outerHeight\n    );\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// TODO(malteubl) Move somewhere else since this is not an ad.\n\nimport {loadScript} from './3p';\nimport {setStyles} from '../src/style';\n\n/**\n * Produces the Twitter API object for the passed in callback. If the current\n * frame is the master frame it makes a new one by injecting the respective\n * script, otherwise it schedules the callback for the script from the master\n * window.\n * @param {!Window} global\n * @param {function(!Object)} cb\n */\nfunction getTwttr(global, cb) {\n  loadScript(global, 'https://platform.twitter.com/widgets.js', () => {\n    cb(global.twttr);\n  });\n  // Temporarily disabled the code sharing between frames.\n  // The iframe throttling implemented in modern browsers can break with this,\n  // because things may execute in frames that are currently throttled, even\n  // though they are needed in the main frame.\n  // See https://github.com/ampproject/amphtml/issues/3220\n  //\n  // computeInMasterFrame(global, 'twttrCbs', done => {\n  //  loadScript(global, 'https://platform.twitter.com/widgets.js', () => {\n  //    done(global.twttr);\n  //  });\n  //}, cb);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function twitter(global, data) {\n  const tweet = global.document.createElement('div');\n  tweet.id = 'tweet';\n  setStyles(tweet, {\n    width: '100%',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center',\n  });\n  global.document.getElementById('c').appendChild(tweet);\n  getTwttr(global, function (twttr) {\n    // Dimensions are given by the parent frame.\n    delete data.width;\n    delete data.height;\n\n    if (data.tweetid) {\n      twttr.widgets\n        .createTweet(cleanupTweetId_(data.tweetid), tweet, data)\n        ./*OK*/ then((el) => tweetCreated(twttr, el));\n    } else if (data.momentid) {\n      twttr.widgets\n        .createMoment(data.momentid, tweet, data)\n        ./*OK*/ then((el) => tweetCreated(twttr, el));\n    } else if (data.timelineSourceType) {\n      // Extract properties starting with 'timeline'.\n      const timelineData = Object.keys(data)\n        .filter((prop) => prop.startsWith('timeline'))\n        .reduce((newData, prop) => {\n          newData[stripPrefixCamelCase(prop, 'timeline')] = data[prop];\n          return newData;\n        }, {});\n      twttr.widgets\n        .createTimeline(timelineData, tweet, data)\n        ./*OK*/ then((el) => tweetCreated(twttr, el));\n    }\n  });\n\n  /**\n   * Handles a tweet or moment being created, resizing as necessary.\n   * @param {!Object} twttr\n   * @param {?Element} el\n   */\n  function tweetCreated(twttr, el) {\n    if (!el) {\n      global.context.noContentAvailable();\n      return;\n    }\n\n    resize(/** @type {!Element} */ (el));\n    twttr.events.bind('resize', (event) => {\n      // To be safe, make sure the resize event was triggered for the widget we\n      // created below.\n      if (el === event.target) {\n        resize(/** @type {!Element} */ (el));\n      }\n    });\n  }\n\n  /**\n   * @param {!Element} container\n   */\n  function resize(container) {\n    const height = container./*OK*/ offsetHeight;\n    // 0 height is always wrong and we should get another resize request\n    // later.\n    if (height == 0) {\n      return;\n    }\n    context.updateDimensions(\n      container./*OK*/ offsetWidth,\n      height + /* margins */ 20\n    );\n  }\n\n  /**\n   * @param {string} input\n   * @param {string} prefix\n   * @return {*} TODO(#23582): Specify return type\n   */\n  function stripPrefixCamelCase(input, prefix) {\n    const stripped = input.replace(new RegExp('^' + prefix), '');\n    return stripped.charAt(0).toLowerCase() + stripped.substr(1);\n  }\n}\n\n/**\n * @param {string} tweetid\n * @visibleForTesting\n * @return {*} TODO(#23582): Specify return type\n */\nexport function cleanupTweetId_(tweetid) {\n  // 1)\n  // Handle malformed ids such as\n  // https://twitter.com/abc123/status/585110598171631616\n  tweetid = tweetid.toLowerCase();\n  let match = tweetid.match(/https:\\/\\/twitter.com\\/[^\\/]+\\/status\\/(\\d+)/);\n  if (match) {\n    return match[1];\n  }\n\n  // 2)\n  // Handle malformed ids such as\n  // 585110598171631616?ref_src\n  match = tweetid.match(/^(\\d+)\\?ref.*/);\n  if (match) {\n    return match[1];\n  }\n\n  return tweetid;\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {getData} from '../src/event-helper';\nimport {loadScript} from './3p';\nimport {tryDecodeUriComponent} from '../src/core/types/string/url';\n\n/**\n * @param {Window} global\n * @param {Object} VIQEO\n * @private\n */\nfunction viqeoPlayerInitLoaded(global, VIQEO) {\n  const {canonicalUrl, pageViewId, sourceUrl} = global.context;\n  const data = getData(global.context);\n  let viqeoPlayerInstance;\n  VIQEO['setConfig']({url: sourceUrl, amp: {pageViewId, canonicalUrl}});\n  VIQEO['subscribeTracking']((params) => {\n    viqeoPlayerInstance = params['player'];\n  }, 'Player:added');\n  VIQEO['subscribeTracking'](() => {\n    sendMessage('updatePlayedRanges', viqeoPlayerInstance['getPlayedRanges']());\n    sendMessage('updateCurrentTime', viqeoPlayerInstance['getCurrentTime']());\n  }, 'Player:currentTimeUpdated');\n  VIQEO['subscribeTracking'](() => {\n    sendMessage('updateDuration', viqeoPlayerInstance['getDuration']());\n  }, 'Player:durationUpdated');\n  VIQEO['createPlayer']({\n    videoId: data['videoid'],\n    profileId: data['profileid'],\n    parent: global.document.getElementById('c'),\n  });\n\n  global.addEventListener('message', parseMessage, false);\n\n  subscribe('ready', 'ready');\n  subscribe('paused', 'pause');\n  subscribe('started', 'play');\n  subscribe('played', 'play');\n  subscribe('replayed', 'play');\n  subscribe('ended', 'end');\n  subscribe('advStarted', 'startAdvert');\n  subscribe('advEnded', 'endAdvert');\n  subscribe('muted', 'mute');\n  subscribe('unmuted', 'unmute');\n\n  /**\n   * Subscribe on viqeo's events\n   * @param {string} playerEventName\n   * @param {string} targetEventName\n   * @private\n   */\n  function subscribe(playerEventName, targetEventName) {\n    VIQEO['subscribeTracking'](() => {\n      sendMessage(targetEventName);\n    }, `Player:${playerEventName}`);\n  }\n\n  const sendMessage = (eventName, value = null) => {\n    const {parent} = global;\n    const message = /** @type {JsonObject} */ ({\n      source: 'ViqeoPlayer',\n      action: eventName,\n      value,\n    });\n    parent./*OK*/ postMessage(message, '*');\n  };\n\n  /**\n   * Parse events data for viqeo\n   * @param {!Event|{data: !JsonObject}} event\n   */\n  function parseMessage(event) {\n    const eventData = getData(event);\n    const action = eventData['action'];\n    if (!action) {\n      return;\n    }\n    if (action === 'play') {\n      viqeoPlayerInstance.play();\n    } else if (action === 'pause') {\n      viqeoPlayerInstance.pause();\n    } else if (action === 'stop') {\n      viqeoPlayerInstance.stop();\n    } else if (action === 'mute') {\n      viqeoPlayerInstance.setVolume(0);\n    } else if (action === 'unmute') {\n      viqeoPlayerInstance.setVolume(1);\n    }\n  }\n}\n\n/**\n * Prepare and return viqeo instance\n * @param {!Window} global\n */\nexport function viqeoplayer(global) {\n  const data = getData(global.context);\n  const kindIsProd = data['data-kind'] !== 'stage';\n\n  let scriptPlayerInit = data['script-url'];\n  scriptPlayerInit =\n    (scriptPlayerInit && tryDecodeUriComponent(scriptPlayerInit)) ||\n    (kindIsProd\n      ? 'https://cdn.viqeo.tv/js/vq_starter.js'\n      : 'https://static.viqeo.tv/js/vq_player_init.js?branch=dev1');\n\n  global['onViqeoLoad'] = (VIQEO) => viqeoPlayerInitLoaded(global, VIQEO);\n  loadScript(global, scriptPlayerInit);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from './3p';\n\n/**\n * Get the correct script for the container.\n * @param {!Window} global\n * @param {string} scriptSource The source of the script, different for post and comment embeds.\n * @param {function(!Object, string)} cb\n */\nfunction getContainerScript(global, scriptSource, cb) {\n  loadScript(global, scriptSource, () => {\n    global.Yotpo = global.Yotpo || {};\n    delete global.Yotpo.widgets['testimonials'];\n    const yotpoWidget =\n      typeof global.yotpo === 'undefined' ? undefined : global.yotpo;\n    yotpoWidget.on('CssReady', function () {\n      cb(yotpoWidget, 'cssLoaded');\n    });\n    yotpoWidget.on('BatchReady', function () {\n      cb(yotpoWidget, 'batchLoaded');\n    });\n  });\n}\n\n/**\n * Create DOM element for the Yotpo bottom line plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getBottomLineContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className = 'preview-only-full-height';\n\n  const childDiv = global.document.createElement('div');\n  childDiv.className = 'preview-only-flex-center preview-only-full-height';\n  container.appendChild(childDiv);\n\n  const bottomLine = global.document.createElement('div');\n  bottomLine.className = 'yotpo bottomLine';\n  bottomLine.setAttribute('data-product-id', data.productId);\n\n  childDiv.appendChild(bottomLine);\n\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo main widget plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getMainWidgetContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-main-widget';\n  container.setAttribute('data-product-id', data.productId);\n  container.setAttribute('data-name', data.name);\n  container.setAttribute('data-url', data.url);\n  container.setAttribute('data-image-url', data.imageUrl);\n  container.setAttribute('data-description', data.description);\n  container.setAttribute('data-yotpo-element-id', data.yotpoElementId);\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo reviews carousel plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getReviewsCarouselContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-reviews-carousel yotpo-size-7';\n  container.setAttribute('data-background-color', data.backgroudColor);\n  container.setAttribute('data-mode', data.mode);\n  container.setAttribute('data-review-ids', data.reviewIds);\n  container.setAttribute('data-show-bottomline', data.showBottomLine);\n  container.setAttribute('data-autoplay-enabled', data.autoplayEnabled);\n  container.setAttribute('data-autoplay-speed', data.autoplaySpeed);\n  container.setAttribute('data-show-navigation', data.showNavigation);\n  container.setAttribute('data-yotpo-element-id', data.yotpoElementId);\n  container.setAttribute('style', 'max-width: 1250px;');\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo UGC Gallery plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getUgcGalleryContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-pictures-gallery';\n  container.setAttribute('data-layout', data.layout);\n  container.setAttribute('data-layout-scroll', data.layoutScroll);\n  container.setAttribute('data-spacing', data.spacing);\n  container.setAttribute('data-source', data.source);\n  container.setAttribute('data-title', data.title);\n  container.setAttribute('data-hover-color', data.hoverColor);\n  container.setAttribute('data-hover-opacity', data.hoverOpacity);\n  container.setAttribute('data-hover-icon', data.hoverIcon);\n  container.setAttribute('data-cta-text', data.ctaText);\n  container.setAttribute('data-cta-color', data.ctaColor);\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Badges plugin:\n * @param {!Window} global\n * @return {!Element} div\n */\nfunction getBadgetsContainer(global) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-badge badge-init';\n  container.setAttribute('id', 'y-badges');\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Reviews Tab plugin:\n * @param {!Window} global\n * @return {!Element} div\n */\nfunction getReviewsTabContainer(global) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-modal';\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Product Gallery plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getProductGalleryContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className =\n    'yotpo yotpo-pictures-gallery yotpo-product-gallery yotpo-size-6';\n  container.setAttribute('data-product-id', data.productId);\n  container.setAttribute('data-demo', data.demo);\n  container.setAttribute('data-layout-rows', data.layoutRows);\n  container.setAttribute('data-layout-scroll', data.layoutScroll);\n  container.setAttribute('data-spacing', data.spacing);\n  container.setAttribute('data-source', data.source);\n  container.setAttribute('data-title', data.title);\n  container.setAttribute('data-hover-color', data.hoverColor);\n  container.setAttribute('data-hover-opacity', data.hoverOpacity);\n  container.setAttribute('data-hover-icon', data.hoverIcon);\n  container.setAttribute('data-upload-button', data.uploadButton);\n  container.setAttribute('data-preview', data.preview);\n  container.setAttribute('data-yotpo-element-id', data.yotpoElementId);\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Visual UGC Gallery plugin:\n * @param {!Window} global\n * @return {!Element} div\n */\nfunction getVisualUgcGalleryContainer(global) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-preview-pictures-gallery';\n\n  const childDiv = global.document.createElement('div');\n  childDiv.className = 'yotpo yotpo-pictures-gallery';\n  container.appendChild(childDiv);\n\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Embedded Widget plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getEmbeddedWidgetContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className = 'preview-only-table';\n\n  const cellCentered = global.document.createElement('div');\n  cellCentered.className = 'preview-only-table-cell-centered';\n  container.appendChild(cellCentered);\n\n  const embeddedWidget = global.document.createElement('div');\n  embeddedWidget.className = 'yotpo embedded-widget';\n  cellCentered.appendChild(embeddedWidget);\n\n  embeddedWidget.setAttribute('data-product-id', data.productId);\n  embeddedWidget.setAttribute('data-demo', data.demo);\n  embeddedWidget.setAttribute('data-layout', data.layout);\n  embeddedWidget.setAttribute('data-width', data.width);\n  embeddedWidget.setAttribute('data-reviews', data.reviews);\n  embeddedWidget.setAttribute('data-header-text', data.headerText);\n  embeddedWidget.setAttribute(\n    'data-header-background-color',\n    data.headerBackgroundColor\n  );\n  embeddedWidget.setAttribute(\n    'data-body-background-color',\n    data.bodyBackgroundColor\n  );\n  embeddedWidget.setAttribute('data-font-size', data.fontSize);\n  embeddedWidget.setAttribute('data-font-color', data.fontColor);\n  embeddedWidget.setAttribute('data-yotpo-element-id', data.yotpoElementId);\n\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Embedded Widget plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getPhotosCarouselContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className = 'yotpo yotpo-preview-slider';\n\n  const photosCarousel = global.document.createElement('div');\n  photosCarousel.className = 'yotpo yotpo-slider';\n  container.appendChild(photosCarousel);\n\n  photosCarousel.setAttribute('data-product-id', data.productId);\n  photosCarousel.setAttribute('data-demo', data.demo);\n\n  return container;\n}\n\n/**\n * Create DOM element for the Yotpo Promoted Products plugin:\n * @param {!Window} global\n * @param {!Object} data The element data\n * @return {!Element} div\n */\nfunction getPromotedProductsContainer(global, data) {\n  const container = global.document.createElement('div');\n  container.className =\n    'yotpo yotpo-main-widget yotpo-promoted-product ' +\n    'yotpo-medium promoted-products-box';\n\n  container.setAttribute('id', 'widget-div-id');\n  container.setAttribute('data-demo', data.demo);\n  container.setAttribute('data-product-id', data.productId);\n\n  return container;\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yotpo(global, data) {\n  const {widgetType} = data;\n  let container;\n  if (widgetType == 'BottomLine') {\n    container = getBottomLineContainer(global, data);\n  } else if (widgetType == 'ReviewsCarousel') {\n    container = getReviewsCarouselContainer(global, data);\n  } else if (widgetType == 'PicturesGallery') {\n    container = getUgcGalleryContainer(global, data);\n  } else if (widgetType == 'Badge') {\n    container = getBadgetsContainer(global);\n  } else if (widgetType == 'ReviewsTab') {\n    container = getReviewsTabContainer(global);\n  } else if (widgetType == 'ProductGallery') {\n    container = getProductGalleryContainer(global, data);\n  } else if (widgetType == 'VisualUgcGallery') {\n    container = getVisualUgcGalleryContainer(global);\n  } else if (widgetType == 'EmbeddedWidget') {\n    container = getEmbeddedWidgetContainer(global, data);\n  } else if (widgetType == 'PhotosCarousel') {\n    container = getPhotosCarouselContainer(global, data);\n  } else if (widgetType == 'PromotedProducts') {\n    container = getPromotedProductsContainer(global, data);\n  } else {\n    container = getMainWidgetContainer(global, data);\n  }\n\n  global.document.getElementById('c').appendChild(container);\n\n  let cssLoaded = false;\n  let batchLoaded = false;\n  const scriptSource =\n    'https://staticw2.yotpo.com/' + data.appKey + '/widget.js';\n  getContainerScript(global, scriptSource, (yotpoWidget, eventType) => {\n    if (eventType === 'cssLoaded') {\n      cssLoaded = true;\n    }\n    if (eventType === 'batchLoaded') {\n      batchLoaded = true;\n    }\n\n    if (batchLoaded && cssLoaded) {\n      setTimeout(() => {\n        if (yotpoWidget.widgets[0]) {\n          context.updateDimensions(\n            yotpoWidget.widgets[0].element./*OK*/ offsetWidth,\n            yotpoWidget.widgets[0].element./*OK*/ offsetHeight\n          );\n        }\n      }, 100);\n    }\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev, devAssert, userAssert} from '../../src/log';\nimport {validateData} from '../../3p/3p';\n\n/**\n * A fake ad network integration that is mainly used for testing\n * and demo purposes. This implementation gets stripped out in compiled\n * production code.\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function _ping_(global, data) {\n  // for testing only. see #10628\n  global.networkIntegrationDataParamForTesting = data;\n\n  validateData(data, ['url'], ['valid', 'adHeight', 'adWidth', 'enableIo']);\n  userAssert(!data['error'], 'Fake user error!');\n  global.document.getElementById('c').textContent = data.ping;\n  global.ping = Object.create(null);\n\n  if (data.ad_container) {\n    devAssert(global.context.container == data.ad_container, 'wrong container');\n  }\n  if (data.valid == 'false') {\n    // Immediately send no-content for visual diff test\n    global.context.noContentAvailable();\n  }\n  if (data.valid && data.valid == 'true') {\n    const img = document.createElement('img');\n    if (data.url) {\n      img.setAttribute('src', data.url);\n      img.setAttribute('width', data.width);\n      img.setAttribute('height', data.height);\n    }\n    let width, height;\n    if (data.adHeight) {\n      img.setAttribute('height', data.adHeight);\n      height = Number(data.adHeight);\n    }\n    if (data.adWidth) {\n      img.setAttribute('width', data.adWidth);\n      width = Number(data.adWidth);\n    }\n    document.body.appendChild(img);\n    if (width || height) {\n      global.context.renderStart({width, height});\n    } else {\n      global.context.renderStart();\n    }\n    if (data.enableIo) {\n      global.context.observeIntersection(function (changes) {\n        /** @type {!Array} */ (changes).forEach(function (c) {\n          dev().info(\n            'AMP-AD',\n            'Intersection: (WxH)' +\n              `${c.intersectionRect.width}x${c.intersectionRect.height}`\n          );\n        });\n        // store changes to global.lastIO for testing purpose\n        global.ping.lastIO = changes[changes.length - 1];\n      });\n    }\n    global.context.getHtml('a', ['href'], function (html) {\n      dev().info('GET-HTML', html);\n    });\n    global.context.getConsentState(function (consentState) {\n      dev().info('GET-CONSENT-STATE', consentState);\n    });\n    if (global.context.consentSharedData) {\n      const TAG = 'consentSharedData';\n      dev().info(TAG, global.context.consentSharedData);\n    }\n    if (global.context.initialConsentValue) {\n      const TAG = 'consentStringValue';\n      dev().info(TAG, global.context.initialConsentValue);\n    }\n    if (global.context.initialConsentMetadata) {\n      const TAG = 'consentMetadata';\n      dev().info(TAG, global.context.initialConsentMetadata);\n    }\n  } else {\n    global.setTimeout(() => {\n      global.context.noContentAvailable();\n    }, 1000);\n  }\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function _1wo(global, data) {\n  validateData(data, ['src', 'owoType', 'owoCode', 'owoMode']);\n  const {src} = data;\n  createContainer(global, data);\n  loadScript(global, src);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction createContainer(global, data) {\n  const d = global.document.createElement('div');\n  d.setAttribute('data-owo-type', data['owoType']);\n  d.setAttribute('data-owo-code', data['owoCode']);\n  d.setAttribute('data-owo-mode', data['owoMode']);\n  global.document.getElementById('c').appendChild(d);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData, validateSrcPrefix} from '../../3p/3p';\n\nconst jsnPrefix = 'https://jsn.24smi.net/';\nconst smiJs = `${jsnPrefix}smi.js`;\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function _24smi(global, data) {\n  validateData(data, [['blockid', 'src']]);\n  const {src} = data;\n  let blockId = data['blockid'];\n\n  if (!blockId) {\n    validateSrcPrefix(jsnPrefix, src);\n    blockId = getBlockId(src);\n  }\n\n  const element = createContainer(global);\n  (global.smiq = global.smiq || []).push({\n    element,\n    blockId,\n  });\n  loadScript(global, smiJs);\n}\n\n/**\n * @param {!Window} global\n * @return {Element}\n */\nfunction createContainer(global) {\n  const d = global.document.createElement('div');\n  global.document.getElementById('c').appendChild(d);\n  return d;\n}\n\n/**\n * @param {string} src\n * @return {string}\n */\nfunction getBlockId(src) {\n  const parts = src.split('/');\n  return parts[parts.length - 1].split('.')[0];\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function a8(global, data) {\n  validateData(data, ['aid'], ['wid', 'eno', 'mid', 'mat', 'type']);\n  global.a8Param = data;\n  writeScript(global, 'https://statics.a8.net/amp/ad.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\nconst mandatoryParams = [],\n  optionalParams = [\n    'ad_mode',\n    'placement',\n    'tracking_id',\n    'ad_type',\n    'marketplace',\n    'region',\n    'title',\n    'default_search_phrase',\n    'default_category',\n    'linkid',\n    'search_bar',\n    'search_bar_position',\n    'rows',\n    'design',\n    'asins',\n    'debug',\n    'aax_src_id',\n    'header_style',\n    'link_style',\n    'link_hover_style',\n    'text_style',\n    'random_permute',\n    'render_full_page',\n    'axf_exp_name',\n    'axf_treatment',\n    'disable_borders',\n    'attributes',\n    'carousel',\n    'feedback_enable',\n    'max_ads_in_a_row',\n    'list_price',\n    'prime',\n    'prime_position',\n    'widget_padding',\n    'strike_text_style',\n    'brand_text_link',\n    'brand_position',\n    'large_rating',\n    'rating_position',\n    'max_title_height',\n    'enable_swipe_on_mobile',\n    'overrides',\n    'ead',\n    'force_win_bid',\n    'fallback_mode',\n    'url',\n    'regionurl',\n    'divid',\n    'recomtype',\n    'adinstanceid',\n  ];\nconst prefix = 'amzn_assoc_';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function a9(global, data) {\n  let i;\n  for (i = 0; i < 46; i++) {\n    optionalParams[i] = prefix + optionalParams[i];\n  }\n\n  validateData(data, mandatoryParams, optionalParams);\n\n  const publisherUrl = global.context.canonicalUrl || global.context.sourceUrl;\n\n  if (data.amzn_assoc_ad_mode) {\n    if (data.amzn_assoc_ad_mode === 'auto') {\n      if (data.adinstanceid && data.adinstanceid !== '') {\n        loadRecTag(global, data, publisherUrl);\n      } else {\n        loadSearTag(global, data, publisherUrl);\n      }\n    } else if (\n      data.amzn_assoc_ad_mode === 'search' ||\n      data.amzn_assoc_ad_mode === 'manual'\n    ) {\n      loadSearTag(global, data, publisherUrl);\n    }\n  } else {\n    loadSearTag(global, data, publisherUrl);\n  }\n}\n\n/**\n * @param {!Object} data\n * @return {string}\n */\nfunction getURL(data) {\n  let url = 'https://z-na.amazon-adsystem.com/widgets/onejs?MarketPlace=US';\n  if (data.regionurl && data.regionurl !== '') {\n    url = data.regionurl;\n  }\n\n  return url;\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @param {string} publisherUrl\n */\nfunction loadRecTag(global, data, publisherUrl) {\n  let url = getURL(data);\n  url += '&adInstanceId=' + data['adinstanceid'];\n  global['amzn_assoc_URL'] = publisherUrl;\n\n  if (data['recomtype'] === 'sync') {\n    writeScript(global, url);\n  } else if (data['recomtype'] === 'async') {\n    const d = global.document.createElement('div');\n    d.setAttribute('id', data['divid']);\n    global.document.getElementById('c').appendChild(d);\n    loadScript(global, url);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @param {string} publisherUrl\n */\nfunction loadSearTag(global, data, publisherUrl) {\n  /**\n   * Sets macro type.\n   * @param {string} type\n   */\n  function setMacro(type) {\n    if (!type) {\n      return;\n    }\n\n    if (hasOwn(data, type)) {\n      global[type] = data[type];\n    }\n  }\n\n  /**\n   * Sets the params.\n   */\n  function setParams() {\n    const url = getURL(data);\n    let i;\n\n    for (i = 0; i < 44; i++) {\n      setMacro(optionalParams[i]);\n    }\n\n    if (data.amzn_assoc_fallback_mode) {\n      const str = data.amzn_assoc_fallback_mode.split(',');\n      let types = str[0].split(':');\n      let typev = str[1].split(':');\n      types = parseJson(types[1]);\n      typev = parseJson(typev[1]);\n      global['amzn_assoc_fallback_mode'] = {\n        'type': types,\n        'value': typev,\n      };\n    }\n    if (data.amzn_assoc_url) {\n      global['amzn_assoc_URL'] = data['amzn_assoc_url'];\n    } else {\n      global['amzn_assoc_URL'] = publisherUrl;\n    }\n\n    writeScript(global, url);\n  }\n\n  /**\n   * Initializer.\n   */\n  function init() {\n    setParams();\n  }\n\n  init();\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function accesstrade(global, data) {\n  validateData(data, ['atops', 'atrotid']);\n  global.atParams = data;\n  writeScript(global, 'https://h.accesstrade.net/js/amp/amp.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adagio(global, data) {\n  validateData(data, ['sid', 'loc']);\n\n  const $neodata = global;\n\n  $neodata._adagio = {};\n  $neodata._adagio.amp = data;\n\n  loadScript($neodata, 'https://js-ssl.neodatagroup.com/adagio_amp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\nconst adbladeFields = ['width', 'height', 'cid'];\nconst adbladeHostname = 'web.adblade.com';\nconst industrybrainsHostname = 'web.industrybrains.com';\n\n/**\n * @param {string} hostname\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction addAdiantUnit(hostname, global, data) {\n  validateData(data, adbladeFields, []);\n\n  // create a data element so our script knows what to do\n  const ins = global.document.createElement('ins');\n  ins.setAttribute('class', 'adbladeads');\n  ins.setAttribute('data-width', data.width);\n  ins.setAttribute('data-height', data.height);\n  ins.setAttribute('data-cid', data.cid);\n  ins.setAttribute('data-host', hostname);\n  ins.setAttribute('data-protocol', 'https');\n  ins.setAttribute('data-tag-type', 1);\n  global.document.getElementById('c').appendChild(ins);\n\n  ins.parentNode.addEventListener(\n    'eventAdbladeRenderStart',\n    global.context.renderStart()\n  );\n\n  // run our JavaScript code to display the ad unit\n  writeScript(global, 'https://' + hostname + '/js/ads/async/show.js');\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adblade(global, data) {\n  addAdiantUnit(adbladeHostname, global, data);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function industrybrains(global, data) {\n  addAdiantUnit(industrybrainsHostname, global, data);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adbutler(global, data) {\n  validateData(\n    data,\n    ['account', 'zone', 'width', 'height'],\n    ['keyword', 'place']\n  );\n\n  data['place'] = data['place'] || 0;\n\n  const placeholderID = 'placement_' + data['zone'] + '_' + data['place'];\n\n  // placeholder div\n  const d = global.document.createElement('div');\n  d.setAttribute('id', placeholderID);\n  global.document.getElementById('c').appendChild(d);\n\n  global.AdButler = global.AdButler || {};\n  global.AdButler.ads = global.AdButler.ads || [];\n\n  global.AdButler.ads.push({\n    handler(opt) {\n      global.AdButler.register(\n        data['account'],\n        data['zone'],\n        [data['width'], data['height']],\n        placeholderID,\n        opt\n      );\n    },\n    opt: {\n      place: data['place'],\n      pageKey: global.context.pageViewId,\n      keywords: data['keyword'],\n      domain: 'servedbyadbutler.com',\n      click: 'CLICK_MACRO_PLACEHOLDER',\n    },\n  });\n  loadScript(global, 'https://servedbyadbutler.com/app.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, validateSrcPrefix, writeScript} from '../../3p/3p';\n\n// Valid adform ad source hosts\nconst hosts = {\n  track: 'https://track.adform.net',\n  adx: 'https://adx.adform.net',\n  a2: 'https://a2.adform.net',\n  adx2: 'https://adx2.adform.net',\n  asia: 'https://asia.adform.net',\n  adx3: 'https://adx3.adform.net',\n};\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adform(global, data) {\n  validateData(data, [['src', 'bn', 'mid']]);\n  global.Adform = {ampData: data};\n  const {bn, mid, src} = data;\n  let url;\n\n  // Custom ad url using \"data-src\" attribute\n  if (src) {\n    validateSrcPrefix(\n      Object.keys(hosts).map((type) => hosts[type]),\n      src\n    );\n    url = src;\n  }\n  // Ad tag using \"data-bn\" attribute\n  else if (bn) {\n    url = hosts.track + '/adfscript/?bn=' + encodeURIComponent(bn) + ';msrc=1';\n  }\n  // Ad placement using \"data-mid\" attribute\n  else if (mid) {\n    url = hosts.adx + '/adx/?mid=' + encodeURIComponent(mid);\n  }\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst n = 'yandexContextAsyncCallbacks';\nconst renderTo = 'yandex_rtb';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yandex(global, data) {\n  validateData(data, ['blockId'], ['data', 'onRender', 'onError']);\n\n  addToQueue(global, data);\n  loadScript(global, 'https://an.yandex.ru/system/context_amp.js');\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction addToQueue(global, data) {\n  global[n] = global[n] || [];\n  global[n].push(() => {\n    // Create container\n    createContainer(global, renderTo);\n\n    // Show Ad in container\n    global.Ya.Context.AdvManager.render(\n      {\n        blockId: data.blockId,\n        statId: data.statId,\n        renderTo,\n        data: data.data,\n        async: true,\n        onRender: () => {\n          if (typeof data.onRender === 'function') {\n            data.onRender();\n          }\n          global.context.renderStart();\n        },\n      },\n      () => {\n        if (typeof data.onError === 'function') {\n          data.onError();\n        } else {\n          global.context.noContentAvailable();\n        }\n      }\n    );\n  });\n}\n\n/**\n * @param {!Window} global\n * @param {string} id\n */\nfunction createContainer(global, id) {\n  const d = global.document.createElement('div');\n  d.id = id;\n  global.document.getElementById('c').appendChild(d);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {yandex} from './yandex';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adfox(global, data) {\n  validateData(data, ['adfoxParams', 'ownerId']);\n  loadScript(global, 'https://yastatic.net/pcode/adfox/loader.js', () =>\n    initAdFox(global, data)\n  );\n}\n\n/**\n * @param {!Window} global\n * @param {Object} data\n */\nfunction initAdFox(global, data) {\n  const params = JSON.parse(data.adfoxParams);\n\n  createContainer(global, 'adfox_container');\n\n  global.Ya.adfoxCode.create({\n    ownerId: data.ownerId,\n    containerId: 'adfox_container',\n    params,\n    onLoad: (data, onRender, onError) => {\n      checkLoading(global, data, onRender, onError);\n    },\n    onRender: () => global.context.renderStart(),\n    onError: () => global.context.noContentAvailable(),\n    onStub: () => global.context.noContentAvailable(),\n  });\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @param {!Object} onRender\n * @param {!Object} onError\n * @return {boolean}\n */\nfunction checkLoading(global, data, onRender, onError) {\n  if (data.bundleName === 'banner.direct') {\n    const dblParams = {\n      blockId: data.bundleParams.blockId,\n      data: data.bundleParams.data,\n      onRender,\n      onError,\n    };\n\n    yandex(global, dblParams);\n    return false;\n  }\n  return true;\n}\n\n/**\n * @param {!Window} global\n * @param {string} id\n */\nfunction createContainer(global, id) {\n  const container = global.document.createElement('div');\n  container.setAttribute('id', id);\n  global.document.getElementById('c').appendChild(container);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adgeneration(global, data) {\n  validateData(data, ['id'], ['targetid', 'displayid', 'adtype', 'option']);\n\n  // URL encoding\n  const option = data.option ? encodeQueryValue(data.option) : null;\n\n  const url =\n    'https://i.socdm.com/sdk/js/adg-script-loader.js?' +\n    'id=' +\n    encodeURIComponent(data.id) +\n    '&width=' +\n    encodeURIComponent(data.width) +\n    '&height=' +\n    encodeURIComponent(data.height) +\n    '&async=true' +\n    '&adType=' +\n    validateAdType(data.adType) +\n    '&displayid=' +\n    (data.displayid ? encodeURIComponent(data.displayid) : '1') +\n    '&tagver=2.0.0' +\n    (data.targetid ? '&targetID=' + encodeURIComponent(data.targetid) : '') +\n    (option ? '&' + option : '');\n  writeScript(global, url);\n}\n\n/**\n * URL encoding of query string\n * @param {string} str\n * @return {string}\n */\nfunction encodeQueryValue(str) {\n  return str\n    .split('&')\n    .map((v) => {\n      const key = v.split('=')[0],\n        val = v.split('=')[1];\n      return encodeURIComponent(key) + '=' + encodeURIComponent(val);\n    })\n    .join('&');\n}\n/**\n * If adtype is \"RECTANGLE\", replace it with \"RECT\"\n * @param {string} str\n * @return {string}\n */\nfunction validateAdType(str) {\n  if (str != null) {\n    const upperStr = encodeURIComponent(str.toUpperCase());\n    if (upperStr === 'RECTANGLE') {\n      return 'RECT';\n    } else {\n      return upperStr;\n    }\n  }\n  return 'FREE';\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adglare(global, data) {\n  validateData(data, ['host', 'zid'], ['keywords']);\n\n  const adglareSpan = global.document.createElement('span');\n  adglareSpan.id = 'zone' + data.zid;\n  global.document.getElementById('c').appendChild(adglareSpan);\n\n  let url =\n    'https://' +\n    data.host +\n    '.engine.adglare.net/?' +\n    data.zid +\n    '&ampad&rnd=' +\n    Date.now() +\n    Math.random();\n  if (data.keywords) {\n    url = url + '&keywords=' + data.keywords;\n  }\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adhese(global, data) {\n  validateData(data, ['location', 'format', 'account', 'requestType']);\n  let targetParam = '';\n  const gctx = global.context;\n\n  if (data['targeting']) {\n    const targetList = data['targeting'];\n    for (const category in targetList) {\n      targetParam += encodeURIComponent(category);\n      const targets = targetList[category];\n      for (let x = 0; x < targets.length; x++) {\n        targetParam +=\n          encodeURIComponent(targets[x]) + (targets.length - 1 > x ? ';' : '');\n      }\n      targetParam += '/';\n    }\n  }\n\n  if (gctx.consentSharedData) {\n    if (\n      gctx.consentSharedData.consentStateValue &&\n      gctx.consentSharedData.consentStateValue == 'accepted'\n    ) {\n      targetParam += 'tlall/';\n    }\n    if (\n      gctx.consentSharedData.consentString &&\n      gctx.consentSharedData.consentString !== ''\n    ) {\n      targetParam += 'xt' + gctx.consentSharedData.consentString + '/';\n    }\n  }\n\n  targetParam += '?t=' + Date.now();\n  writeScript(\n    window,\n    'https://ads-' +\n      encodeURIComponent(data['account']) +\n      '.adhese.com/' +\n      encodeURIComponent(data['requestType']) +\n      '/sl' +\n      encodeURIComponent(data['location']) +\n      encodeURIComponent(data['position']) +\n      '-' +\n      encodeURIComponent(data['format']) +\n      '/' +\n      targetParam\n  );\n\n  const co = global.document.querySelector('#c');\n  co.width = data['width'];\n  co.height = data['height'];\n  co.addEventListener('adhLoaded', getAdInfo.bind(null, global), false);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} e\n */\nfunction getAdInfo(global, e) {\n  if (\n    e.detail.isReady &&\n    e.detail.width == e.target.width &&\n    e.detail.height == e.target.height\n  ) {\n    global.context.renderStart();\n  } else if (\n    e.detail.isReady &&\n    (e.detail.width != e.target.width || e.detail.height != e.target.height)\n  ) {\n    global.context.renderStart({\n      width: e.detail.width,\n      height: e.detail.height,\n    });\n  } else {\n    global.context.noContentAvailable();\n  }\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adincube(global, data) {\n  validateData(data, ['adType', 'siteKey'], ['params']);\n\n  let url = global.context.location.protocol;\n  url += '//tag.adincube.com/tag/1.0/next?';\n  url += 'ad_type=' + encodeURIComponent(String(data['adType']).toUpperCase());\n  url += '&ad_subtype=' + encodeURIComponent(data['width']);\n  url += 'x' + encodeURIComponent(data['height']);\n  url += '&site_key=' + encodeURIComponent(data['siteKey']);\n  url += '&r=' + encodeURIComponent(global.context.referrer);\n  url += '&h=' + encodeURIComponent(global.context.location.href);\n  url += '&c=amp';\n  url += '&t=' + Date.now();\n\n  if (data['params']) {\n    url += parseParams(data['params']);\n  }\n\n  loadScript(global, url);\n}\n\n/**\n * @param {string} data\n * @return {string}\n */\nfunction parseParams(data) {\n  try {\n    const params = JSON.parse(data);\n    let queryParams = '';\n    for (const p in params) {\n      if (hasOwn(params, p)) {\n        queryParams += '&' + p + '=' + encodeURIComponent(params[p]);\n      }\n    }\n    return queryParams;\n  } catch (e) {\n    return '';\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adition(global, data) {\n  validateData(data, ['version']);\n  global.data = data;\n  writeScript(\n    global,\n    'https://imagesrv.adition.com/js/amp/v' +\n      encodeURIComponent(data['version']) +\n      '.js'\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adman(global, data) {\n  validateData(data, ['ws', 'host', 's'], []);\n\n  const script = global.document.createElement('script');\n  script.setAttribute('data-ws', data.ws);\n  script.setAttribute('data-h', data.host);\n  script.setAttribute('data-s', data.s);\n  script.setAttribute('data-tech', 'amp');\n\n  script.src = 'https://static.adman.gr/adman.js';\n\n  global.document.body.appendChild(script);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function admanmedia(global, data) {\n  validateData(data, ['id']);\n\n  const encodedId = encodeURIComponent(data.id);\n  loadScript(\n    global,\n    `https://pub.admanmedia.com/go?id=${encodedId}`,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {tryParseJson} from '../../src/core/types/object/json';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function admixer(global, data) {\n  validateData(data, ['zone'], ['sizes']);\n  /**\n   * @type {Object}\n   */\n  const payload = {\n    imps: [],\n    referrer: window.context.referrer,\n  };\n  const imp = {\n    params: {\n      zone: data.zone,\n    },\n  };\n  if (data.sizes) {\n    imp.sizes = tryParseJson(data.sizes);\n  }\n  payload.imps.push(imp);\n  const json = JSON.stringify(/** @type {JsonObject} */ (payload));\n  writeScript(global, 'https://inv-nets.admixer.net/ampsrc.js?data=' + json);\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adnuntius(global, data) {\n  validateData(data, ['auId']);\n\n  loadScript(global, 'https://cdn.adnuntius.com/adn.js', () => {\n    global.adn = global.adn || {};\n    global.adn.calls = global.adn.calls || [];\n    global.adn.calls.push(() => {\n      global.adn.request({\n        amp: {data},\n      });\n    });\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n// This file will be imported by 3P scripts.\n\n/**\n * Possible consent policy state to proceed with.\n * @enum {number}\n */\nexport const CONSENT_POLICY_STATE = {\n  // Enum value has external dependency. Please do not change existing value.\n  // If new values are added, please notify the AMP for Ads team to assure\n  // correct Real Time Config behavior is maintained for Fast Fetch.\n  SUFFICIENT: 1,\n  INSUFFICIENT: 2,\n  UNKNOWN_NOT_REQUIRED: 3,\n  UNKNOWN: 4,\n};\n\n/**\n * Defines valid consent string types passed\n * in by consent iframe metadata.\n * @enum {number}\n */\nexport const CONSENT_STRING_TYPE = {\n  // Enum value has external dependency for metadata collection.\n  // It is up to the vendor to interpret an undefined CONSENT_STRING_TYPE.\n  TCF_V1: 1,\n  TCF_V2: 2,\n  US_PRIVACY_STRING: 3,\n};\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CONSENT_POLICY_STATE} from '../../src/core/constants/consent-state';\nimport {computeInMasterFrame, validateData, writeScript} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\n/**\n * @const {Object<string, string>}\n */\nconst ADO_JS_PATHS = {\n  'sync': '/files/js/ado.js',\n  'buffered': '/files/js/ado.FIF.test.js',\n};\n\n/**\n * @param {string} str\n * @return {boolean}\n */\nfunction isFalseString(str) {\n  return /^(?:false|off)?$/i.test(str);\n}\n\n/**\n * @param {string} mode\n * @param {!Window} global\n * @param {boolean} consent\n */\nfunction setupAdoConfig(mode, global, consent) {\n  if (global['ado']) {\n    const config = {\n      mode: mode == 'sync' ? 'old' : 'new',\n      protocol: 'https:',\n      fif: {\n        enabled: mode != 'sync',\n      },\n      consent,\n    };\n\n    global['ado']['config'](config);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction setupPreview(global, data) {\n  if (global.ado && data.aoPreview && !isFalseString(data.aoPreview)) {\n    global.ado.preview({\n      enabled: true,\n    });\n  }\n}\n\n/**\n * @param {string} str\n * @return {Object|undefined}\n * @throws {SyntaxError}\n */\nfunction parseJSONObj(str) {\n  return str.match(/^\\s*{/) ? parseJson(str) : undefined;\n}\n\n/**\n * @param {string} keys\n * @return {string|undefined}\n */\nfunction buildKeys(keys) {\n  return keys || undefined;\n}\n\n/**\n * @param {string} vars\n * @return {Object|string|undefined}\n */\nfunction buildVars(vars) {\n  try {\n    return parseJSONObj(vars);\n  } catch (e) {\n    return vars || undefined;\n  }\n}\n\n/**\n * @param {string} clusters\n * @return {Object|undefined}\n */\nfunction buildClusters(clusters) {\n  try {\n    return parseJSONObj(clusters);\n  } catch (e) {\n    // return undefined\n  }\n}\n\n/** @type {number} */\nlet runSyncCount = 0;\n\n/**\n * @param {!Window} global\n * @param {function()} cb\n */\nfunction runSync(global, cb) {\n  global['__aoPrivFnct' + ++runSyncCount] = cb;\n  global.document.write(\n    // eslint-disable-next-line no-useless-concat\n    '<' + 'script>__aoPrivFnct' + runSyncCount + '();<' + '/script>'\n  );\n}\n\n/**\n * @param {string} mode\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction appendPlacement(mode, global, data) {\n  const doc = global.document;\n  const placement = doc.createElement('div');\n  placement.id = data['aoId'];\n\n  const dom = doc.getElementById('c');\n  dom.appendChild(placement);\n\n  const config = {\n    id: data['aoId'],\n    server: data['aoEmitter'],\n    keys: buildKeys(data['aoKeys']),\n    vars: buildVars(data['aoVars']),\n    clusters: buildClusters(data['aoClusters']),\n  };\n\n  if (global.ado) {\n    if (mode == 'sync') {\n      runSync(global, function () {\n        global['ado']['placement'](config);\n      });\n\n      runSync(global, function () {\n        if (!config['_hasAd']) {\n          window.context.noContentAvailable();\n        }\n      });\n    } else {\n      global['ado']['onAd'](data['aoId'], function (isAd) {\n        if (!isAd) {\n          window.context.noContentAvailable();\n        }\n      });\n      global['ado']['placement'](config);\n    }\n  }\n}\n\n/**\n * @param {string} masterId\n * @param {!Object} data\n * @param {!Window} global\n * @param {Function} callback\n */\nfunction executeMaster(masterId, data, global, callback) {\n  const config = {\n    id: masterId,\n    server: data['aoEmitter'],\n    keys: buildKeys(data['aoKeys']),\n    vars: buildVars(data['aoVars']),\n    clusters: buildClusters(data['aoClusters']),\n  };\n\n  if (global['ado']) {\n    global['ado']['onEmit']((masterId, instanceId, codes) => {\n      callback(codes);\n    });\n\n    global['ado']['master'](config);\n  }\n}\n\n/**\n *\n * @param {string} masterId\n * @param {!Object} data\n * @param {!Window} global\n * @param {Function} callback\n */\nfunction requestCodes(masterId, data, global, callback) {\n  const slaveId = data['aoId'];\n\n  computeInMasterFrame(\n    global,\n    'ao-master-exec',\n    (done) => {\n      executeMaster(masterId, data, global, (codes) => done(codes));\n    },\n    (codes) => {\n      const creative = codes[slaveId];\n      if (codes[slaveId + '_second_phase']) {\n        creative['code'] += '\\n' + codes[slaveId + '_second_phase']['code'];\n      }\n      callback(creative);\n    }\n  );\n}\n\nclass AdoBuffer {\n  /**\n   *\n   * @param {Object} container\n   * @param {!Window} global\n   */\n  constructor(container, global) {\n    this.container = container;\n    this.global = global;\n    this.callback = null;\n  }\n\n  /**\n   *\n   * @param {Function} callback\n   */\n  render(callback) {\n    this.callback = callback;\n\n    if (this.global.document.readyState === 'loading') {\n      this.global.document.addEventListener(\n        'DOMContentLoaded',\n        this._init.bind(this)\n      );\n    } else {\n      this._init();\n    }\n  }\n\n  /**\n   */\n  _init() {\n    const ado = this.global['ado'];\n    const gao = this.global['gao'];\n\n    if (ado['busy'] || (typeof gao !== 'undefined' && gao['busy'])) {\n      ado['queue'].unshift(this._execute.bind(this));\n    } else {\n      this._execute();\n    }\n  }\n\n  /**\n   */\n  _execute() {\n    const adoElement = new this.global['AdoElement']({\n      'id': this.container.id,\n      'orgId': this.container.id,\n      'clearId': this.container.id,\n      '_isBuffer': true,\n    });\n    this.global['AdoElems'] = this.global['AdoElems'] || [];\n    this.global['AdoElems'].push(adoElement);\n    adoElement['getDOMElement']();\n    adoElement['initBuffor']();\n    this.global['ado']['elems'][this.container.id] = adoElement;\n\n    this.callback(adoElement);\n\n    adoElement['rewriteBuffor']();\n    adoElement['dispatch']();\n  }\n}\n\n/**\n *\n * @param {string} slaveId\n * @param {!Object} config\n * @param {!Window} global\n */\nfunction executeSlave(slaveId, config, global) {\n  const doc = global.document;\n  const placement = doc.createElement('div');\n  placement['id'] = slaveId;\n\n  const dom = doc.getElementById('c');\n  dom.appendChild(placement);\n\n  if (global['ado']) {\n    if (!config || config['isEmpty']) {\n      global.context.noContentAvailable();\n    } else {\n      const buffer = new AdoBuffer(placement, global);\n      buffer.render(() => {\n        new Function(config['sendHitsDef'] + config['code'])();\n      });\n    }\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adocean(global, data) {\n  validateData(\n    data,\n    ['aoEmitter', 'aoId'],\n    ['aoMode', 'aoPreview', 'aoKeys', 'aoVars', 'aoClusters', 'aoMaster']\n  );\n\n  const masterId = data['aoMaster'];\n  const mode = data['aoMode'] !== 'sync' || masterId ? 'buffered' : 'sync';\n  const adoUrl = 'https://' + data['aoEmitter'] + ADO_JS_PATHS[mode];\n  const ctx = global.context;\n\n  /*\n   * INSUFFICIENT and UNKNOWN should be treated as INSUFFICIENT\n   * not defined states should be treated as INSUFFICIENT\n   */\n  const consent =\n    ctx.initialConsentState === null /* tags without data-block-on-consent */ ||\n    ctx.initialConsentState === CONSENT_POLICY_STATE.SUFFICIENT ||\n    ctx.initialConsentState === CONSENT_POLICY_STATE.UNKNOWN_NOT_REQUIRED;\n\n  writeScript(global, adoUrl, () => {\n    setupAdoConfig(mode, global, consent);\n    setupPreview(global, data);\n\n    if (masterId) {\n      const ado = global['ado'];\n      if (ado && ado['features'] && ado['features']['passback']) {\n        ado['features']['passback'] = false;\n      }\n\n      requestCodes(masterId, data, global, (codes) => {\n        executeSlave(data['aoId'], codes, global);\n      });\n    } else {\n      appendPlacement(mode, global, data);\n    }\n  });\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adop(global, data) {\n  validateData(data, ['z']);\n  global.adop = data;\n  writeScript(global, 'https://compass.adop.cc/assets/js/adop/amp.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adpicker(global, data) {\n  validateData(data, ['ph']);\n  const url =\n    'https://cdn.adpicker.net' +\n    '/ads/main.js?et=amp' +\n    '&ph=' +\n    encodeURIComponent(data.ph) +\n    '&cb=' +\n    Math.floor(89999999 * Math.random() + 10000000);\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * Make an AdPlugg iframe.\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adplugg(global, data) {\n  // Load ad.js\n  loadScript(global, 'https://www.adplugg.com/serve/js/ad.js');\n\n  // Validate the amp-ad attributes.\n  validateData(\n    data,\n    ['accessCode', 'width', 'height'], //required\n    ['zone'] //optional\n  );\n\n  // Get the amp wrapper element.\n  const ampwrapper = global.document.getElementById('c');\n\n  // Build and append the ad tag.\n  const adTag = global.document.createElement('div');\n  adTag.setAttribute('class', 'adplugg-tag');\n  adTag.setAttribute('data-adplugg-access-code', data['accessCode']);\n  if (data['zone']) {\n    adTag.setAttribute('data-adplugg-zone', data['zone']);\n  }\n  ampwrapper.appendChild(adTag);\n\n  // Get a handle on the AdPlugg SDK.\n  global.AdPlugg = global.AdPlugg || [];\n  const {AdPlugg} = global;\n\n  // Register event listeners (via async wrapper).\n  AdPlugg.push(function () {\n    const {AdPlugg} = global;\n    // Register the renderStart event listener.\n    AdPlugg.on(adTag, 'adplugg:renderStart', function (event) {\n      // Create the opt_data object.\n      const optData = {};\n      if (hasOwn(event, 'width')) {\n        optData.width = event.width;\n      }\n      if (hasOwn(event, 'height')) {\n        optData.height = event.height;\n      }\n      global.context.renderStart(optData);\n    });\n\n    // Register the noContentAvailable event listener.\n    AdPlugg.on(adTag, 'adplugg:noContentAvailable', function () {\n      global.context.noContentAvailable();\n    });\n  });\n\n  // Fill the tag.\n  AdPlugg.push({'command': 'run'});\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adpon(global, data) {\n  validateData(data, ['fid'], ['debugScript']);\n\n  global._adpon = {fid: data['fid']};\n\n  writeScript(global, data['debugScript'] || 'https://ad.adpon.jp/amp.js');\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adpushup(global, data) {\n  validateData(\n    data,\n    ['siteid', 'slotpath', 'width', 'height'],\n    ['totalampslots', 'jsontargeting', 'extras']\n  );\n  loadScript(\n    global,\n    'https://securepubads.g.doubleclick.net/tag/js/gpt.js',\n    () => {\n      loadScript(\n        global,\n        'https://cdn.adpushup.com/' + data.siteid + '/amp.js',\n        () => {\n          window.adpushup.initAmp(\n            global,\n            data.width,\n            data.height,\n            data.siteid,\n            data.slotpath,\n            data.totalampslots,\n            data.jsontargeting,\n            data.extras\n          );\n        }\n      );\n    }\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adreactor(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['zid', 'pid', 'custom3']);\n  const url =\n    'https://adserver.adreactor.com' +\n    '/servlet/view/banner/javascript/zone?' +\n    'zid=' +\n    encodeURIComponent(data.zid) +\n    '&pid=' +\n    encodeURIComponent(data.pid) +\n    '&custom3=' +\n    encodeURIComponent(data.custom3) +\n    '&random=' +\n    Math.floor(89999999 * Math.random() + 10000000) +\n    '&millis=' +\n    Date.now();\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n */\nexport function adsensor(global) {\n  writeScript(\n    global,\n    'https://wfpscripts.webspectator.com/amp/adsensor-amp.js'\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adservsolutions(global, data) {\n  validateData(data, [], ['client', 'zid']);\n  global['ABNS'] =\n    global['ABNS'] ||\n    function () {\n      (global['ABNSl'] = global['ABNSl'] || []).push(arguments);\n    };\n  global['ABNSh'] = data.client;\n  writeScript(global, 'https://cdn.' + global['ABNSh'] + '/libs/b.js');\n  global['ABNS']('c', {id: data.zid + '&o=a'});\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adsloom(global, data) {\n  validateData(data, ['widgetId']);\n  global._adsLoom = global._adsLoom || {\n    widgetId: data['widgetId'],\n    clientId: global.context.clientId,\n    sourceUrl: global.context.sourceUrl,\n  };\n  loadScript(\n    global,\n    'https://adsloomwebservices.adsloom.com/scripts/amp-loader.js'\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adsnative(global, data) {\n  try {\n    validateData(data, ['anapiid'], ['ankv', 'ancat', 'antid']);\n  } catch (e) {\n    validateData(data, ['annid', 'anwid'], ['ankv', 'ancat', 'antid']);\n  }\n\n  // convert string to object\n  let actualkv = undefined;\n  if (data.ankv) {\n    actualkv = {};\n    const arraykv = data.ankv.split(',');\n    for (const k in arraykv) {\n      const kv = arraykv[k].split(':');\n      actualkv[kv.pop()] = kv.pop();\n    }\n  }\n\n  // convert string to array\n  const actualcat = data.ancat ? data.ancat.split(',') : undefined;\n\n  // populate settings\n  global._AdsNativeOpts = {\n    apiKey: data.anapiid,\n    networkKey: data.annid,\n    nativeAdElementId: 'adsnative_ampad',\n    currentPageUrl: global.context.location.href,\n    widgetId: data.anwid,\n    templateKey: data.antid,\n    categories: actualcat,\n    keyValues: actualkv,\n    amp: true,\n  };\n\n  // drop ad placeholder div\n  const ad = global.document.createElement('div');\n  const ampwrapper = global.document.getElementById('c');\n  ad.id = global._AdsNativeOpts.nativeAdElementId;\n  ampwrapper.appendChild(ad);\n\n  // load renderjs\n  writeScript(global, 'https://static.adsnative.com/static/js/render.v1.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adspeed(global, data) {\n  validateData(data, ['zone', 'client']);\n\n  const url =\n    'https://g.adspeed.net/ad.php?do=amphtml&zid=' +\n    data.zone +\n    '&oid=' +\n    data.client +\n    '&cb=' +\n    Math.random();\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {setStyles} from '../../src/style';\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adspirit(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['asmParams', 'asmHost']);\n  const i = global.document.createElement('ins');\n  i.setAttribute('data-asm-params', data['asmParams']);\n  i.setAttribute('data-asm-host', data['asmHost']);\n  i.setAttribute('class', 'asm_async_creative');\n  setStyles(i, {\n    display: 'inline-block',\n    'text-align': 'left',\n  });\n  global.document.getElementById('c').appendChild(i);\n  const s = global.document.createElement('script');\n  s.src = 'https://' + data['asmHost'] + '/adasync.js';\n  global.document.body.appendChild(s);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adstir(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['appId', 'adSpot']);\n\n  const v = '4.0';\n\n  const d = global.document.createElement('div');\n  d.setAttribute('class', 'adstir-ad-async');\n  d.setAttribute('data-ver', v);\n  d.setAttribute('data-app-id', data['appId']);\n  d.setAttribute('data-ad-spot', data['adSpot']);\n  d.setAttribute('data-amp', true);\n  d.setAttribute('data-origin', global.context.location.href);\n  global.document.getElementById('c').appendChild(d);\n\n  loadScript(global, 'https://js.ad-stir.com/js/adstir_async.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adstyle(global, data) {\n  validateData(data, ['widget']);\n\n  global._adstyle = global._adstyle || {\n    viewId: global.context.pageViewId,\n    widgetIds: [],\n    referrer: global.context.referrer,\n    url: global.context.canonicalUrl,\n    source: global.context.sourceUrl,\n  };\n\n  global._adstyle.widgetIds.push(data.widget);\n\n  const url = 'https://widgets.ad.style/amp.js';\n\n  window.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      window['intersectionRect' + data.widget] = c.intersectionRect;\n      window['boundingClientRect' + data.widget] = c.boundingClientRect;\n    });\n  });\n\n  loadScript(global, url);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  validateData,\n  validateSrcContains,\n  validateSrcPrefix,\n  writeScript,\n} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adtech(global, data) {\n  const adsrc = data.src;\n  if (typeof adsrc != 'undefined') {\n    validateSrcPrefix('https:', adsrc);\n    validateSrcContains('/addyn/', adsrc);\n    writeScript(global, adsrc);\n  } else {\n    validateData(\n      data,\n      ['atwmn', 'atwdiv'],\n      [\n        'atwco',\n        'atwheight',\n        'atwhtnmat',\n        'atwmoat',\n        'atwnetid',\n        'atwothat',\n        'atwplid',\n        'atwpolar',\n        'atwsizes',\n        'atwwidth',\n      ]\n    );\n    global.atwco = data.atwco;\n    global.atwdiv = data.atwdiv;\n    global.atwheight = data.atwheight;\n    global.atwhtnmat = data.atwhtnmat;\n    global.atwmn = data.atwmn;\n    global.atwmoat = data.atwmoat;\n    global.atwnetid = data.atwnetid;\n    global.atwothat = data.atwothat;\n    global.atwplid = data.atwplid;\n    global.atwpolar = data.atwpolar;\n    global.atwsizes = data.atwsizes;\n    global.atwwidth = data.atwwidth;\n    writeScript(global, 'https://s.aolcdn.com/os/ads/adsWrapper3.js');\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adtelligent(global, data) {\n  validateData(\n    data,\n    [],\n    ['source', 'floor', 'hbmpPubId', 'hbmpSiteId', 'hbmpUnitId']\n  );\n\n  const doc = global.document;\n  const container = doc.createElement('div');\n  const ctx = window.context;\n  doc.body.appendChild(container);\n  if (data.source) {\n    const url =\n      `https://s.adtelligent.com/?floor=${data.floor || 0}` +\n      `&content_page_url=${encodeURIComponent(ctx.location)}` +\n      `&width=${data.width}` +\n      `&height=${data.height}` +\n      `&cb=${Date.now()}` +\n      `&aid=${data.source}`;\n    container.id = 'PDS' + data.source;\n    loadScript(global, url, () => {\n      ctx.renderStart({\n        width: data.width,\n        height: data.height,\n      });\n    });\n  } else {\n    const HTML_ELEMENT_ID = 'adt-placement';\n    const vpbSrc = `//player.adtelligent.com/prebid/wrapper_hb_${data['hbmpPubId']}_${data['hbmpSiteId']}.js`;\n    const pbSrc = vpbSrc.replace('wrapper_hb', 'hb');\n    container.id = HTML_ELEMENT_ID;\n    global.vpb = window.vpb || {\n      cmd: [],\n      fastLoad: true,\n      amp: true,\n      startAuction: 1,\n    };\n\n    loadScript(global, vpbSrc);\n    loadScript(global, pbSrc);\n\n    global.vpb.cmd.push(function () {\n      global.vpb.startAuction({\n        code: HTML_ELEMENT_ID,\n        adUnitId: parseInt(data['hbmpUnitId'], 10),\n        sizes: [[data.width, data.height]],\n        render: true,\n        onEnd(winner) {\n          ctx.renderStart({\n            width: winner.width,\n            height: winner.height,\n          });\n        },\n      });\n    });\n  }\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adthrive(global, data) {\n  validateData(data, ['siteId', 'adUnit'], ['sizes']);\n  loadScript(\n    global,\n    'https://ads.adthrive.com/sites/' +\n      encodeURIComponent(data.siteId) +\n      '/amp.min.js'\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adunity(global, data) {\n  const doc = global.document;\n\n  validateData(\n    data,\n    ['auAccount', 'auSite'],\n    [\n      'auSection',\n      'auZone',\n      'auDemo',\n      'auIsdemo',\n      'auAd',\n      'auOrder',\n      'auSegment',\n      'auOptions',\n      'auSources',\n      'auAds',\n      'auTriggerFn',\n      'auTriggerVal',\n      'auCallbackVal',\n      'auCallbackFn',\n      'auPassbackFn',\n      'auPassbackVal',\n      'auClick',\n      'auDual',\n      'auImpression',\n      'auVideo',\n    ]\n  );\n\n  //prepare tag structure\n  const tag = doc.createElement('div');\n  tag.classList.add('au-tag');\n  tag.setAttribute('data-au-width', data['width']);\n  tag.setAttribute('data-au-height', data['height']);\n\n  if (data != null) {\n    for (const key in data) {\n      //skip not valid attributes\n      if (!hasOwnProperty.call(data, key)) {\n        continue;\n      }\n\n      //skip if attribute is type or ampSlotIndex\n      if (key.startsWith('type') || key.startsWith('ampSlotIndex')) {\n        continue;\n      }\n\n      if (key.startsWith('au')) {\n        if (key == 'auVideo') {\n          tag.setAttribute('class', 'au-video');\n        } else {\n          const auKey = key.substring(2).toLowerCase();\n          tag.setAttribute('data-au-' + auKey, data[key]);\n        }\n      }\n    }\n  }\n\n  //make sure is executed only once\n  let libAd = false;\n\n  //execute tag only if in view\n  const inViewCb = global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      if (!libAd && c.intersectionRect.height > data['height'] / 2) {\n        libAd = true;\n        inViewCb();\n        renderTags(global, data);\n      }\n    });\n  });\n  const tagPh = doc.getElementById('c');\n  tagPh.appendChild(tag);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction renderTags(global, data) {\n  if (data == null) {\n    return;\n  }\n\n  global.context.renderStart({\n    width: data.width,\n    height: data.height,\n  });\n  loadScript(global, 'https://content.adunity.com/aulib.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * ID for the html container\n *\n * @const {string}\n */\nexport const ADUPTECH_ELEMENT_ID = 'aduptech';\n\n/**\n * URL to the AdUp Technology javascript api\n *\n * @const {string}\n */\nexport const ADUPTECH_API_URL = 'https://s.d.adup-tech.com/jsapi';\n\n/**\n * Logic for the AdUp Technology amp-ad tag\n *\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function aduptech(global, data) {\n  const {context, document} = global;\n\n  validateData(\n    data,\n    ['placementkey'],\n    ['mincpc', 'query', 'pageurl', 'gdpr', 'gdpr_consent', 'adtest']\n  );\n\n  // add id attriubte to container\n  document.getElementById('c').setAttribute('id', ADUPTECH_ELEMENT_ID);\n\n  // init api options\n  const options = {\n    amp: true,\n    responsive: true,\n    placementkey: data.placementkey,\n    onAds: () => context.renderStart(),\n    onNoAds: () => context.noContentAvailable(),\n  };\n\n  if ('mincpc' in data) {\n    options.mincpc = data.mincpc;\n  }\n\n  if ('query' in data) {\n    options.query = data.query;\n  }\n\n  if ('adtest' in data) {\n    options.adtest = data.adtest;\n  }\n\n  if ('pageurl' in data) {\n    options.pageurl = data.pageurl;\n  } else if (context.sourceUrl) {\n    options.pageurl = context.sourceUrl;\n  } else if (context.location && context.location.href) {\n    options.pageurl = context.location.href;\n  }\n\n  if ('gdpr' in data) {\n    options.gdpr = data.gdpr;\n  }\n\n  // prefer consent string from consentSharedData (if defined)\n  // otherwise use consent string from optional tag attribute\n  if (\n    context.consentSharedData !== null &&\n    typeof context.consentSharedData === 'object' &&\n    context.consentSharedData.consentString &&\n    context.consentSharedData.consentString !== ''\n  ) {\n    // eslint-disable-next-line google-camelcase/google-camelcase\n    options.gdpr_consent = context.consentSharedData.consentString;\n  } else if ('gdpr_consent' in data) {\n    // eslint-disable-next-line google-camelcase/google-camelcase\n    options.gdpr_consent = data.gdpr_consent;\n  }\n\n  // load api and embed ads iframe\n  loadScript(global, ADUPTECH_API_URL, () =>\n    global.uAd.embed(ADUPTECH_ELEMENT_ID, options)\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {addParamsToUrl} from '../../src/url';\nimport {dict, hasOwn} from '../../src/core/types/object';\nimport {endsWith} from '../../src/core/types/string';\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adventive(global, data) {\n  if (hasOwn(data, 'isDev')) {\n    adventive_(global, data);\n  } else {\n    validateData(data, ['src'], ['isDev']);\n    writeScript(global, `${data.src}&isAmp=1`);\n  }\n}\n\nconst adv = {\n    addInstance: () => {},\n    args: {},\n    isLibLoaded: false,\n    mode: {\n      dev: false,\n      live: false,\n      localDev: false,\n      preview: false,\n      prod: false,\n      testing: false,\n    },\n  },\n  requiredData = ['pid'],\n  optionalData = ['click', 'async', 'isDev'],\n  sld = {true: 'adventivedev', false: 'adventive'},\n  thld = {true: 'amp', false: 'ads'},\n  cacheTime = 5;\n\n/**\n * Future data:\n * - async\n * - click\n * - height\n * - isDev\n * - width\n * - pid\n *\n * Considerations:\n * - Recipe reuse for multi-placed Ads.\n * - Reduce request to only what is needed\n * - Mitigate risk of data corruption\n *\n * @todo implement multi-size handling for multi-slotted ads. @see doubleclick\n *\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction adventive_(global, data) {\n  validateData(data, requiredData, optionalData);\n\n  if (!hasOwn(global, 'adventive')) {\n    global.adventive = adv;\n  }\n  const ns = global.adventive;\n  if (!hasOwn(ns, 'context')) {\n    ns.context = global.context;\n  }\n\n  if (!Object.isFrozen(ns.mode)) {\n    updateMode(ns.mode, global.context.location.hostname);\n  }\n\n  const cb = callback.bind(this, data.pid, ns),\n    url = getUrl(global.context, data, ns);\n  url\n    ? (hasOwn(data, 'async') ? loadScript : writeScript)(global, url, cb)\n    : cb();\n}\n\n/**\n * @param {!Object} mode\n * @param {string} hostname\n */\nfunction updateMode(mode, hostname) {\n  mode.localDev = hostname === 'localhost';\n  mode.dev = !mode.localDev && endsWith(hostname, `${sld[false]}.com`);\n  mode.prod = !mode.localDev && endsWith(hostname, `${sld[true]}.com`);\n  mode.preview = (mode.dev || mode.prod) && hostname.startsWith('/ad');\n  mode.testing = (mode.dev || mode.prod) && hostname.startsWith('/testing');\n  mode.live = (mode.testing || !mode.preview) && !mode.localDev;\n\n  Object.freeze(mode);\n}\n\n/**\n * @param {string} id\n * @param {!Object} ns\n */\nfunction callback(id, ns) {\n  ns.addInstance(id);\n}\n\n/**\n * @param {!Object} context\n * @param {!Object} data\n * @param {!Object} ns\n * @return {string|boolean} if a search query is generated, a full url is\n *    provided, otherwise false\n */\nfunction getUrl(context, data, ns) {\n  const {mode} = ns,\n    isDev = hasOwn(data, 'isDev'),\n    sld_ = sld[!mode.dev],\n    thld_ = thld[isDev && !mode.live],\n    search = reduceSearch(ns, data.pid, data.click, context.referrer),\n    url = search\n      ? addParamsToUrl(`https://${thld_}.${sld_}.com/ad`, search)\n      : false;\n  return url;\n}\n\n/**\n * @todo determine if we can reduce the request to nothing & return false\n * @todo usage of RTC may be applicable here for macros\n * @todo check if click-macros can be offloaded to amp-analytics (i.e recipe)\n *\n * @param {!Object} ns\n * @param {string} placementId\n * @param {string} click\n * @param {string} referrer\n * @return {JsonObject} if no more data is needed, false, otherwise JSON\n *    representation of the url search query.\n */\nfunction reduceSearch(ns, placementId, click, referrer) {\n  const isRecipeLoaded = hasOwn(ns.args, 'placementId');\n  let isRecipeStale = true;\n  if (isRecipeLoaded) {\n    const info = ns.args[placementId];\n    isRecipeStale = Date.now() - info['requestTime'] > 60 * cacheTime;\n  }\n  const needsRequest = !isRecipeLoaded || isRecipeStale;\n\n  return !needsRequest\n    ? null\n    : dict({\n        'click': click,\n        'referrer': referrer,\n        'isAmp': '1',\n        'lib': !ns.isLibLoaded ? '1' : '', // may be prefetchable via _config\n        'pid': needsRequest ? placementId : '',\n      });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adverline(global, data) {\n  validateData(data, ['id', 'plc'], ['s', 'section']);\n\n  writeScript(global, 'https://ads.adverline.com/richmedias/amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {setStyle} from '../../src/style';\nimport {validateData, writeScript} from '../../3p/3p';\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adverticum(global, data) {\n  validateData(data, ['goa3zone'], ['costumetargetstring']);\n  const zoneid = 'zone' + data['goa3zone'];\n  const d = global.document.createElement('div');\n\n  d.id = zoneid;\n  d.classList.add('goAdverticum');\n\n  document.getElementById('c').appendChild(d);\n  if (data['costumetargetstring']) {\n    const s = global.document.createTextNode(data['costumetargetstring']);\n    const v = global.document.createElement('var');\n    v.setAttribute('id', 'cT');\n    v.setAttribute('class', 'customtarget');\n    setStyle(v, 'display', 'none');\n    v.appendChild(s);\n    document.getElementById(zoneid).appendChild(v);\n  }\n  writeScript(global, '//ad.adverticum.net/g3.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function advertserve(global, data) {\n  validateData(\n    data,\n    ['zid', 'pid', 'client'],\n    [\n      'custom1',\n      'custom2',\n      'custom3',\n      'custom4',\n      'custom5',\n      'custom6',\n      'custom7',\n      'custom8',\n      'custom9',\n      'custom10',\n    ]\n  );\n\n  const customFields = (function () {\n    let params = '';\n    for (let i = 1; i <= 10; i++) {\n      const fieldName = 'custom' + i;\n      if (data[fieldName] !== undefined) {\n        params += '&' + fieldName + '=' + encodeURIComponent(data[fieldName]);\n      }\n    }\n    return params;\n  })();\n\n  const url =\n    'https://' +\n    data.client +\n    '.advertserve.com' +\n    '/servlet/view/banner/javascript/zone?amp=true' +\n    '&zid=' +\n    encodeURIComponent(data.zid) +\n    '&pid=' +\n    encodeURIComponent(data.pid) +\n    customFields +\n    '&random=' +\n    Math.floor(89999999 * Math.random() + 10000000) +\n    '&millis=' +\n    Date.now();\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function adyoulike(global, data) {\n  validateData(data, ['placement'], ['dc', 'campaign']);\n  global.adyoulikeParams = data;\n\n  writeScript(global, 'https://fo-static.omnitagjs.com/amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function affiliateb(global, data) {\n  validateData(data, ['afb_a', 'afb_p', 'afb_t']);\n  global.afbParam = data;\n  writeScript(global, 'https://track.affiliate-b.com/amp/a.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function aja(global, data) {\n  validateData(data, ['asi']);\n\n  const {document} = global;\n  const asi = data['asi'];\n\n  const d = document.createElement('div');\n  d.dataset['ajaAd'] = '';\n  d.dataset['ajaAsi'] = asi;\n  document.getElementById('c').appendChild(d);\n\n  loadScript(global, 'https://cdn.as.amanad.adtdp.com/sdk/asot-amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function amoad(global, data) {\n  validateData(data, ['sid'], ['adType']);\n\n  let script;\n  const attrs = {};\n  if (data['adType'] === 'native') {\n    script = 'https://j.amoad.com/js/n.js';\n    attrs['class'] = 'amoad_native';\n    attrs['data-sid'] = data.sid;\n  } else {\n    script = 'https://j.amoad.com/js/a.js';\n    attrs['class'] = `amoad_frame sid_${data.sid} container_div sp`;\n  }\n  global.amoadOption = {ampData: data};\n\n  const d = global.document.createElement('div');\n  Object.keys(attrs).forEach((k) => {\n    d.setAttribute(k, attrs[k]);\n  });\n  global.document.getElementById('c').appendChild(d);\n\n  loadScript(global, script);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function aniview(global, data) {\n  const requiredParams = ['publisherid', 'channelid'];\n  validateData(data, requiredParams);\n  global.avampdata = data;\n  const scpdomain = data.scriptdomain || 'player.aniview.com';\n  const scpurl = 'https://' + scpdomain + '/script/6.1/ampaniview.js';\n  writeScript(global, scpurl);\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst requiredParams = ['pubname', 'widgetname'];\n\nconst scriptHost = 'player.anyclip.com';\nconst scriptPath = 'anyclip-widget/lre-widget/prod/v1/src';\nconst scriptName = 'aclre-amp-loader.js';\nconst scriptUrl = `https://${scriptHost}/${scriptPath}/${scriptName}`;\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function anyclip(global, data) {\n  validateData(data, requiredParams);\n\n  global.addEventListener('message', () => {\n    global.context.renderStart();\n  });\n\n  loadScript(global, scriptUrl, () => {\n    global.anyclip = global.anyclip || {};\n    global.anyclip.getWidget = global.anyclip.getWidget || function () {};\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\nimport {setStyles} from '../../src/style';\n\nconst APPNEXUS_AST_URL = 'https://acdn.adnxs.com/ast/ast.js';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function appnexus(global, data) {\n  const args = [];\n  args.push('size=' + data.width + 'x' + data.height);\n  if (data.tagid) {\n    validateData(data, ['tagid']);\n    args.push('id=' + encodeURIComponent(data.tagid));\n    writeScript(global, constructTtj(args));\n    return;\n  } else if (data.member && data.code) {\n    validateData(data, ['member', 'code']);\n    args.push('member=' + encodeURIComponent(data.member));\n    args.push('inv_code=' + encodeURIComponent(data.code));\n    writeScript(global, constructTtj(args));\n    return;\n  }\n\n  /**\n   * Construct the TTJ URL.\n   * Note params should be properly encoded first (use encodeURIComponent);\n   * @param  {!Array<string>} args query string params to add to the base URL.\n   * @return {string}      Formated TTJ URL.\n   */\n  function constructTtj(args) {\n    let url = 'https://ib.adnxs.com/ttj?';\n    for (let i = 0; i < args.length; i++) {\n      //append arg to query. Please encode arg first.\n      url += args[i] + '&';\n    }\n\n    return url;\n  }\n\n  appnexusAst(global, data);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction appnexusAst(global, data) {\n  validateData(data, ['adUnits']);\n  let apntag;\n  if (context.isMaster) {\n    // in case we are in the master iframe, we load AST\n    context.master.apntag = context.master.apntag || {};\n    context.master.apntag.anq = context.master.apntag.anq || [];\n    apntag = context.master.apntag;\n\n    context.master.adUnitTargetIds = context.master.adUnitTargetIds || [];\n\n    context.master.adUnitTargetIds = data.adUnits.map(\n      (adUnit) => adUnit.targetId\n    );\n\n    apntag.anq.push(() => {\n      if (data.pageOpts) {\n        apntag.anq.push(() => {\n          //output console information\n          apntag.debug = data.debug || false;\n          apntag.setPageOpts(data.pageOpts);\n        });\n      }\n\n      /** @type {!Array} */ (data.adUnits).forEach((adUnit) => {\n        apntag.defineTag(adUnit);\n      });\n    });\n    loadScript(global, APPNEXUS_AST_URL, () => {\n      apntag.anq.push(() => {\n        apntag.loadTags();\n      });\n    });\n  }\n\n  const div = global.document.createElement('div');\n  div.setAttribute('id', data.target);\n  const divContainer = global.document.getElementById('c');\n  if (divContainer) {\n    divContainer.appendChild(div);\n    setStyles(divContainer, {\n      top: '50%',\n      left: '50%',\n      bottom: '',\n      right: '',\n      transform: 'translate(-50%, -50%)',\n    });\n  }\n\n  if (!apntag) {\n    apntag = context.master.apntag;\n    //preserve a global reference\n    /** @type {{showTag: function(string, Object)}} global.apntag */\n    global.apntag = context.master.apntag;\n  }\n\n  if (!context.isMaster && data.adUnits) {\n    const newAddUnits = data.adUnits.filter((adUnit) => {\n      return context.master.adUnitTargetIds.indexOf(adUnit.targetId) === -1;\n    });\n    if (newAddUnits.length) {\n      apntag.anq.push(() => {\n        /** @type {!Array} */ (newAddUnits).forEach((adUnit) => {\n          apntag.defineTag(adUnit);\n          context.master.adUnitTargetIds.push(adUnit.targetId);\n        });\n        apntag.loadTags();\n      });\n    }\n  }\n\n  // check for ad responses received for a slot but before listeners are\n  // registered, for example when an above-the-fold ad is scrolled into view\n  apntag.anq.push(() => {\n    if (typeof apntag.checkAdAvailable === 'function') {\n      const getAd = apntag.checkAdAvailable(data.target);\n      getAd({resolve: isAdAvailable, reject: context.noContentAvailable});\n    }\n  });\n\n  apntag.anq.push(() => {\n    apntag.onEvent('adAvailable', data.target, isAdAvailable);\n    apntag.onEvent('adNoBid', data.target, context.noContentAvailable);\n  });\n\n  /**\n   * resolve getAd with an available ad object\n   *\n   * @param {{targetId: string}} adObj\n   */\n  function isAdAvailable(adObj) {\n    global.context.renderStart({width: adObj.width, height: adObj.height});\n    global.apntag.showTag(adObj.targetId, global.window);\n  }\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function appvador(global, data) {\n  validateData(data, ['id'], ['options', 'jsType', 'customScriptSrc']);\n\n  const container = global.document.getElementById('c');\n  const apvDiv = global.document.createElement('div');\n  apvDiv.setAttribute('id', 'apvad-' + data.id);\n  container.appendChild(apvDiv);\n\n  const scriptUrl = data.customScriptSrc\n    ? data.customScriptSrc\n    : 'https://cdn.apvdr.com/js/' +\n      (data.jsType ? encodeURIComponent(data.jsType) : 'VastAdUnit') +\n      '.min.js';\n  const apvScript =\n    'new APV.' +\n    (data.jsType ? data.jsType : 'VASTAdUnit') +\n    '({s:\"' +\n    data.id +\n    '\",isAmpAd:true' +\n    (data.options ? ',' + data.options : '') +\n    '}).load();';\n\n  const cb = function () {\n    const apvLoadScript = global.document.createElement('script');\n    apvLoadScript.text = apvScript;\n    container.appendChild(apvLoadScript);\n  };\n\n  writeScript(global, scriptUrl, cb);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function atomx(global, data) {\n  const optionals = ['click', 'uv1', 'uv2', 'uv3', 'context'];\n\n  validateData(data, ['id'], optionals);\n\n  const args = [\n    'size=' + data.width + 'x' + data.height,\n    'id=' + encodeURIComponent(data.id),\n  ];\n\n  for (let i = 0; i < optionals.length; i++) {\n    const optional = optionals[i];\n    if (optional in data) {\n      args.push(optional + '=' + encodeURIComponent(data[optional]));\n    }\n  }\n\n  writeScript(global, 'https://s.ato.mx/p.js#' + args.join('&'));\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function baidu(global, data) {\n  validateData(data, ['cproid']);\n\n  const id = '_' + Math.random().toString(36).slice(2);\n  const container = global.document.createElement('div');\n  container.id = id;\n  global.document.getElementById('c').appendChild(container);\n\n  global.slotbydup = global.slotbydup || [];\n  global.slotbydup.push({\n    id: data['cproid'],\n    container: id,\n    display: 'inlay-fix',\n    async: true,\n  });\n\n  global.addEventListener('message', () => {\n    global.context.renderStart();\n  });\n\n  loadScript(\n    global,\n    'https://dup.baidustatic.com/js/dm.js',\n    () => {},\n    () => {\n      // noContentAvailable should be called,\n      // if parent iframe receives no message.\n      // setTimeout can work, but it's not that reliable.\n      // So, only the faliure of JS loading is dealed with for now.\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function beaverads(global, data) {\n  validateData(data, ['blockId']);\n\n  const url =\n    'https://code.beaverads.com/data/' +\n    encodeURIComponent(data['blockId']) +\n    '.js?async=1&div=c';\n\n  loadScript(\n    global,\n    url,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function bidtellect(global, data) {\n  const requiredParams = ['t', 'pid', 'sid'];\n  const optionalParams = [\n    'sname',\n    'pubid',\n    'pubname',\n    'renderid',\n    'bestrender',\n    'autoplay',\n    'playbutton',\n    'videotypeid',\n    'videocloseicon',\n    'targetid',\n    'bustframe',\n  ];\n  validateData(data, requiredParams, optionalParams);\n  let params = '?t=' + encodeURIComponent(data.t);\n  params += '&pid=' + encodeURIComponent(data.pid);\n  params += '&sid=' + encodeURIComponent(data.sid);\n  if (data.width) {\n    params += '&w=' + encodeURIComponent(data.width);\n  }\n  if (data.height) {\n    params += '&h=' + encodeURIComponent(data.height);\n  }\n  optionalParams.forEach(function (param) {\n    if (data[param]) {\n      params += '&' + param + '=' + encodeURIComponent(data[param]);\n    }\n  });\n  const url = 'https://cdn.bttrack.com/js/infeed/2.0/infeed.min.js' + params;\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {tryParseJson} from '../../src/core/types/object/json';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function blade(global, data) {\n  // ensure mandatory fields\n  validateData(data, [\n    'width',\n    'height',\n    'blade_api_key',\n    'blade_player_id',\n    'blade_player_type',\n  ]);\n\n  const marcosObj = tryParseJson(data['blade_macros']) || {};\n  marcosObj['rand'] = Math.random().toString();\n  marcosObj['page_url'] = marcosObj['page_url'] || global.context.canonicalUrl;\n  const macros = {...marcosObj};\n  macros.width = data.width;\n  macros.height = data.height;\n\n  const containerId = `player-${data['blade_api_key']}-${data['blade_player_id']}`;\n  createContainer(containerId);\n\n  const bladeConfig = `_bladeConfig-${containerId}`;\n  global[bladeConfig] = {\n    playerId: data['blade_player_id'],\n    apiKey: data['blade_api_key'],\n    version: '1.0',\n    macros,\n  };\n  const ctx = global.context;\n\n  const bladeOnLoad = `_bladeOnLoad-${containerId}`;\n  global[bladeOnLoad] = function (error, player) {\n    if (error) {\n      global.context.noContentAvailable();\n      return;\n    }\n    ctx.reportRenderedEntityIdentifier(containerId);\n    ctx.renderStart({\n      width: player.width,\n      height: player.height,\n    });\n  };\n\n  const servingDomain = data.servingDomain\n    ? encodeURIComponent(data.servingDomain)\n    : 'ssr.streamrail.net';\n\n  loadScript(\n    global,\n    `https://${servingDomain}/js/${data['blade_api_key']}/${data['blade_player_id']}/player.js?t=${data['blade_player_type']}&callback=${bladeOnLoad}&config=${bladeConfig}&c=${containerId}`,\n    undefined,\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n  /**\n   * @param {string} elemId\n   */\n  function createContainer(elemId) {\n    const d = global.document.createElement('div');\n    d.id = elemId;\n    d.classList.add('blade');\n    global.document.getElementById('c').appendChild(d);\n  }\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function brainy(global, data) {\n  validateData(data, [], ['aid', 'slotId']);\n\n  const url =\n    'https://proparm.jp/ssp/p/js1' +\n    '?_aid=' +\n    encodeURIComponent(data['aid']) +\n    '&amp;_slot=' +\n    encodeURIComponent(data['slotId']);\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function bringhub(global, data) {\n  global._bringhub = global._bringhub || {\n    viewId: global.context.pageViewId,\n    htmlURL: data['htmlurl'] || global.context.canonicalUrl,\n    ampURL: data['ampurl'] || global.context.sourceUrl,\n    referrer: data['referrer'] || global.context.referrer,\n  };\n\n  writeScript(\n    global,\n    `https://static.bh-cdn.com/msf/amp-loader.js?v=${Date.now()}`,\n    function () {\n      loadScript(\n        global,\n        `https://static.bh-cdn.com/msf/amp-widget.js?v=${global._bringhub.hash}`\n      );\n    }\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function broadstreetads(global, data) {\n  validateData(\n    data,\n    ['network', 'zone', 'width', 'height'],\n    ['keywords', 'place']\n  );\n\n  data.place = data.place || 0;\n\n  const placeholderID = 'placement_' + data.zone + '_' + data.place;\n\n  // placeholder div\n  const d = global.document.createElement('div');\n  d.setAttribute('id', placeholderID);\n  global.document.getElementById('c').appendChild(d);\n\n  global.broadstreet = global.broadstreet || {};\n  global.broadstreet.loadAMPZone =\n    global.broadstreet.loadAMPZone || (() => ({}));\n  global.broadstreet.run = global.broadstreet.run || [];\n  global.broadstreet.run.push(() => {\n    global.broadstreet.loadAMPZone(d, {\n      amp: true,\n      ampGlobal: global,\n      ampData: data,\n      height: data.height,\n      keywords: data.keywords,\n      networkId: data.network,\n      place: data.place,\n      softKeywords: true,\n      width: data.width,\n      zoneId: data.zone,\n    });\n  });\n  loadScript(global, 'https://cdn.broadstreetads.com/init-2.min.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function byplay(global, data) {\n  validateData(data, ['vastUrl']);\n\n  global.BYPLAY_VAST_URL = data['vastUrl'];\n\n  loadScript(global, 'https://cdn.byplay.net/amp-byplay-v2.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function caajainfeed(global, data) {\n  validateData(\n    data,\n    [],\n    [\n      'adSpot',\n      'format',\n      'test',\n      'optout',\n      'offset',\n      'ipv4',\n      'ipv6',\n      'networkReachability',\n      'osName',\n      'osVersion',\n      'osLang',\n      'osTimezone',\n      'deviceVersion',\n      'appId',\n      'appVersion',\n      'kv',\n      'uids',\n      'template',\n      'protocol',\n      'fields',\n    ]\n  );\n\n  global.caAjaInfeedConfig = data;\n  loadScript(global, 'https://cdn.amanad.adtdp.com/sdk/ajaamp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function capirs(global, data) {\n  validateData(data, ['begunAutoPad', 'begunBlockId']);\n\n  if (data['customCss']) {\n    const style = global.document.createElement('style');\n\n    if (style.styleSheet) {\n      style.styleSheet.cssText = data['customCss'];\n    } else {\n      style.appendChild(global.document.createTextNode(data['customCss']));\n    }\n\n    global.document.getElementById('c').appendChild(style);\n  }\n\n  global['begun_callbacks'] = {\n    lib: {\n      init: () => {\n        const block = global.document.createElement('div');\n        block.id = 'x-' + Math.round(Math.random() * 1e8).toString(36);\n\n        global.document.getElementById('c').appendChild(block);\n\n        global['Adf']['banner']['ssp'](block.id, data['params'], {\n          'begun-auto-pad': data['begunAutoPad'],\n          'begun-block-id': data['begunBlockId'],\n        });\n      },\n    },\n    block: {\n      draw: (feed) => {\n        const banner = feed['banners']['graph'][0];\n\n        global.context.renderStart({\n          width: getWidth(global, banner),\n          height: banner.height,\n        });\n\n        const reportId = 'capirs-' + banner['banner_id'];\n        global.context.reportRenderedEntityIdentifier(reportId);\n      },\n      unexist: function () {\n        global.context.noContentAvailable();\n      },\n    },\n  };\n\n  loadScript(global, '//ssp.rambler.ru/capirs_async.js');\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} banner\n * @return {*} TODO(#23582): Specify return type\n */\nfunction getWidth(global, banner) {\n  let width;\n\n  if (isResponsiveAd(banner)) {\n    width = Math.max(\n      global.document.documentElement./*OK*/ clientWidth,\n      global.window./*OK*/ innerWidth || 0\n    );\n  } else {\n    width = banner.width;\n  }\n\n  return width;\n}\n\n/**\n * @param {!Object} banner\n * @return {boolean}\n */\nfunction isResponsiveAd(banner) {\n  return banner.width.indexOf('%') !== -1;\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function caprofitx(global, data) {\n  global.caprofitxConfig = data;\n  loadScript(global, 'https://cdn.caprofitx.com/tags/amp/profitx_amp.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseUrlDeprecated} from '../../src/url';\nimport {setStyles} from '../../src/style';\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function cedato(global, data) {\n  const requiredParams = ['id'];\n  const optionalParams = [\n    'domain',\n    'servingDomain',\n    'subid',\n    'version',\n    'extraParams',\n  ];\n  validateData(data, requiredParams, optionalParams);\n\n  if (!data || !data.id) {\n    global.context.noContentAvailable();\n    return;\n  }\n\n  const cb = Math.floor(Math.random() * 10000);\n  const domain =\n    data.domain || parseUrlDeprecated(global.context.sourceUrl).origin;\n\n  /* Create div for ad to target */\n  const playerDiv = global.document.createElement('div');\n  playerDiv.id = 'video' + data.id + cb;\n  setStyles(playerDiv, {\n    width: '100%',\n    height: '100%',\n  });\n  const playerScript = global.document.createElement('script');\n  const servingDomain = data.servingDomain\n    ? encodeURIComponent(data.servingDomain)\n    : 'algovid.com';\n  const srcParams = [\n    'https://p.' + servingDomain + '/player/player.js',\n    '?p=' + encodeURIComponent(data.id),\n    '&cb=' + cb,\n    '&w=' + encodeURIComponent(data.width),\n    '&h=' + encodeURIComponent(data.height),\n    data.version ? '&pv=' + encodeURIComponent(data.version) : '',\n    data.subid ? '&subid=' + encodeURIComponent(data.subid) : '',\n    domain ? '&d=' + encodeURIComponent(domain) : '',\n    data.extraParams || '', // already encoded url query string\n  ];\n\n  playerScript.onload = () => {\n    global.context.renderStart();\n  };\n\n  playerScript.src = srcParams.join('');\n  playerDiv.appendChild(playerScript);\n  global.document.getElementById('c').appendChild(playerDiv);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateSrcPrefix, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function nws(global, data) {\n  const {src} = data;\n  validateSrcPrefix(\n    [\n      'https://tags.nws.ai/',\n      'https://echo.nws.press/',\n      'https://stories.nws.ai/',\n    ],\n    src\n  );\n  writeScript(global, src);\n}\n\n// Keep the following for backwards compatibility\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function chargeads(global, data) {\n  const {src} = data;\n  validateSrcPrefix(\n    ['https://www.chargeplatform.com/', 'https://tags.chargeplatform.com/'],\n    src\n  );\n  writeScript(global, src);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function colombia(global, data) {\n  validateData(data, [\n    'clmb_slot',\n    'clmb_position',\n    'clmb_section',\n    'clmb_divid',\n    'loadingStrategy',\n  ]);\n  // push the two object into the '_colombia' global\n  (global._colombia = global._colombia || []).push({\n    clmbslot: data.clmb_slot,\n    clmbposition: data.clmb_position,\n    clmbsection: data.clmb_section,\n    clmbdivid: data.clmb_divid,\n  });\n  // install observation on entering/leaving the view\n  global.context.observeIntersection(function (newrequest) {\n    /** @type {!Array} */ (newrequest).forEach(function (d) {\n      if (d.intersectionRect.height > 0) {\n        global._colombia.push({\n          visible: true,\n          rect: d,\n        });\n      }\n    });\n  });\n  loadScript(\n    global,\n    'https://static.clmbtech.com/ad/commons/js/colombia-amp.js'\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function conative(global, data) {\n  validateData(data, ['domain', 'adslot', 'height'], ['preview']);\n\n  data.domain = data.domain || null;\n  data.adslot = data.adslot || null;\n  data.preview = data.preview || null;\n\n  window.dmConativeData = window.dmConativeData || {};\n  window.dmConativeData.domain = window.dmConativeData.domain || data.domain;\n  window.dmConativeData.adslot = window.dmConativeData.adslot || data.adslot;\n  window.dmConativeData.preview = window.dmConativeData.preview || data.preview;\n  window.dmConativeData.visibility = window.dmConativeData.visibility || 0;\n\n  window.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      window.dmConativeData.visibility = parseInt(\n        (c.intersectionRect.height / c.boundingClientRect.height) * 100,\n        10\n      );\n    });\n  });\n\n  if (data.domain) {\n    writeScript(\n      global,\n      '//s3-eu-west-1.amazonaws.com/ccc-adscript/serve/domain/' +\n        data.domain +\n        '/config.js'\n    );\n  }\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {tryParseJson} from '../../src/core/types/object/json';\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function connatix(global, data) {\n  validateData(data, ['connatix']);\n\n  // Because 3p's loadScript does not allow for data attributes,\n  // we will write the JS tag ourselves.\n  const script = global.document.createElement('script');\n  const cnxData = Object.assign(Object(tryParseJson(data['connatix'])));\n  global.cnxAmpAd = true;\n  for (const key in cnxData) {\n    if (hasOwn(cnxData, key)) {\n      script.setAttribute(key, cnxData[key]);\n    }\n  }\n\n  window.addEventListener(\n    'connatix_no_content',\n    function () {\n      window.context.noContentAvailable();\n    },\n    false\n  );\n\n  script.onload = () => {\n    global.context.renderStart();\n  };\n\n  script.src = 'https://cdn.connatix.com/min/connatix.renderer.infeed.min.js';\n  global.document.getElementById('c').appendChild(script);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseUrlDeprecated} from '../../src/url';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function contentad(global, data) {\n  validateData(data, [], ['id', 'd', 'wid', 'url']);\n  global.id = data.id;\n  global.d = data.d;\n  global.wid = data.wid;\n  global.url = data.url;\n\n  /* Create div for ad to target */\n  const cadDiv = window.document.createElement('div');\n  cadDiv.id = 'contentad' + global.wid;\n  window.document.body.appendChild(cadDiv);\n\n  /* Pass Source URL */\n  let {sourceUrl} = window.context;\n  if (data.url) {\n    const domain = data.url || window.atob(data.d);\n    sourceUrl = sourceUrl.replace(parseUrlDeprecated(sourceUrl).host, domain);\n  }\n\n  /* Build API URL */\n  const cadApi =\n    'https://api.content-ad.net/Scripts/widget2.aspx' +\n    '?id=' +\n    encodeURIComponent(global.id) +\n    '&d=' +\n    encodeURIComponent(global.d) +\n    '&wid=' +\n    global.wid +\n    '&url=' +\n    encodeURIComponent(sourceUrl) +\n    '&cb=' +\n    Date.now();\n\n  /* Call Content.ad Widget */\n  writeScript(global, cadApi);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {dev} from '../../src/log';\nimport {loadScript} from '../../3p/3p';\n\n/* global Criteo: false */\n\n/** @const {string} */\nconst TAG = 'CRITEO';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function criteo(global, data) {\n  loadScript(global, 'https://static.criteo.net/js/ld/publishertag.js', () => {\n    if (!data.tagtype || data.tagtype === 'passback') {\n      Criteo.DisplayAd({\n        zoneid: data.zone,\n        containerid: 'c',\n        integrationmode: 'amp',\n      });\n    } else if (data.tagtype === 'rta' || data.tagtype === 'standalone') {\n      dev().error(\n        TAG,\n        'You are using a deprecated Criteo integration',\n        data.tagtype\n      );\n    } else {\n      dev().error(\n        TAG,\n        'You are using an unknown Criteo integration',\n        data.tagtype\n      );\n    }\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {devAssert} from '../../src/log';\nimport {getStyle, setStyle, setStyles} from '../../src/style';\nimport {loadScript, validateData} from '../../3p/3p';\nimport {tryParseJson} from '../../src/core/types/object/json';\n\n// Keep track of current height of AMP iframe\nlet currentAmpHeight = null;\n\n// Height of overflow element\nconst overflowHeight = 40;\n\n/**\n * Enum for different AdSense Products\n * @enum {number}\n * @visibleForTesting\n */\nexport const AD_TYPE = {\n  /** Value if we can't determine which product to request */\n  UNSUPPORTED: 0,\n  /** AdSense for Search */\n  AFS: 1,\n  /** AdSense for Shopping */\n  AFSH: 2,\n  /** AdSense for Shopping, backfilled with AdSense for Search */\n  AFSH_BACKFILL: 3,\n};\n\n/**\n * Request Custom Search Ads (Adsense for Search or AdSense for Shopping).\n * @param {!Window} global The window object of the iframe\n * @param {!Object} data\n */\nexport function csa(global, data) {\n  // Get parent width in case we want to override\n  const width = global.document.body./*OK*/ clientWidth;\n\n  validateData(\n    data,\n    [],\n    [\n      'afshPageOptions',\n      'afshAdblockOptions',\n      'afsPageOptions',\n      'afsAdblockOptions',\n      'ampSlotIndex',\n    ]\n  );\n\n  // Add the ad container to the document\n  const containerDiv = global.document.createElement('div');\n  const containerId = 'csacontainer';\n  containerDiv.id = containerId;\n  global.document.getElementById('c').appendChild(containerDiv);\n\n  const pageOptions = {source: 'amp', referer: global.context.referrer};\n  const adblockOptions = {container: containerId};\n\n  // Parse all the options\n  const afshPage = Object.assign(\n    Object(tryParseJson(data['afshPageOptions'])),\n    pageOptions\n  );\n  const afsPage = Object.assign(\n    Object(tryParseJson(data['afsPageOptions'])),\n    pageOptions\n  );\n  const afshAd = Object.assign(\n    Object(tryParseJson(data['afshAdblockOptions'])),\n    adblockOptions\n  );\n  const afsAd = Object.assign(\n    Object(tryParseJson(data['afsAdblockOptions'])),\n    adblockOptions\n  );\n\n  // Special case for AFSh when \"auto\" is the requested width\n  if (afshAd['width'] == 'auto') {\n    afshAd['width'] = width;\n  }\n\n  // Event listener needed for iOS9 bug\n  global.addEventListener(\n    'orientationchange',\n    orientationChangeHandler.bind(null, global, containerDiv)\n  );\n\n  // Only call for ads once the script has loaded\n  loadScript(\n    global,\n    'https://www.google.com/adsense/search/ads.js',\n    requestCsaAds.bind(null, global, data, afsPage, afsAd, afshPage, afshAd)\n  );\n}\n\n/**\n * Resize the AMP iframe if the CSA container changes in size upon rotation.\n * This is needed for an iOS bug found in versions 10.0.1 and below that\n * doesn't properly reflow the iframe upon orientation change.\n * @param {!Window} global The window object of the iframe\n * @param {!Element} containerDiv The CSA container\n */\nfunction orientationChangeHandler(global, containerDiv) {\n  // Save the height of the container before the event listener triggers\n  const oldHeight = getStyle(containerDiv, 'height');\n  global.setTimeout(() => {\n    // Force DOM reflow and repaint.\n    // eslint-disable-next-line no-unused-vars\n    const ignore = global.document.body./*OK*/ offsetHeight;\n    // Capture new height.\n    const newHeight = getStyle(containerDiv, 'height');\n    // In older versions of iOS, this height will be different because the\n    // container height is resized.\n    // In Chrome and iOS 10.0.2 the height is the same because\n    // the container isn't resized.\n    if (oldHeight != newHeight && newHeight != currentAmpHeight) {\n      // style.height returns \"60px\" (for example), so turn this into an int\n      const newHeightPx = parseInt(newHeight, 10);\n      // Also update the onclick function to resize to the right height.\n      const overflow = global.document.getElementById('overflow');\n      if (overflow) {\n        overflow.onclick = () =>\n          requestResizeInternal(global, containerDiv, newHeightPx);\n      }\n      // Resize the container to the correct height.\n      requestResizeInternal(global, containerDiv, newHeightPx);\n    }\n  }, 250); /* 250 is time in ms to wait before executing orientation */\n}\n\n/**\n * Hanlder for when a resize request succeeds\n * Hide the overflow and resize the container\n * @param {!Window} global The window object of the iframe\n * @param {!Element} container The CSA container\n * @param {number} requestedHeight The height of the resize request\n * @visibleForTesting\n */\nexport function resizeSuccessHandler(global, container, requestedHeight) {\n  currentAmpHeight = requestedHeight;\n  const overflow = global.document.getElementById('overflow');\n  if (overflow) {\n    setStyle(overflow, 'display', 'none');\n    resizeCsa(container, requestedHeight);\n  }\n}\n\n/**\n * Hanlder for When a resize request is denied\n * If the container is larger than the AMP container and an overflow already\n * exists, show the overflow and resize the container to fit inside the AMP\n * container.  If an overflow doesn't exist, create one.\n * @param {!Window} global The window object of the iframe\n * @param {!Element} container The CSA container\n * @param {number} requestedHeight The height of the resize request\n * @visibleForTesting\n */\nexport function resizeDeniedHandler(global, container, requestedHeight) {\n  const overflow = global.document.getElementById('overflow');\n  const containerHeight = parseInt(getStyle(container, 'height'), 10);\n  if (containerHeight > currentAmpHeight) {\n    if (overflow) {\n      setStyle(overflow, 'display', '');\n      resizeCsa(container, currentAmpHeight - overflowHeight);\n    } else {\n      createOverflow(global, container, requestedHeight);\n    }\n  }\n}\n\n/**\n * Make a request for either AFS or AFSh\n * @param {!Window} global The window object of the iframe\n * @param {!Object} data The data passed in by the partner\n * @param {!Object} afsP The parsed AFS page options object\n * @param {!Object} afsA The parsed AFS adblock options object\n * @param {!Object} afshP The parsed AFSh page options object\n * @param {!Object} afshA The parsed AFSh adblock options object\n */\nfunction requestCsaAds(global, data, afsP, afsA, afshP, afshA) {\n  const type = getAdType(data);\n  const callback = callbackWithNoBackfill.bind(null, global);\n  const callbackBackfill = callbackWithBackfill.bind(null, global, afsP, afsA);\n\n  switch (type) {\n    case AD_TYPE.AFS:\n      /** Do not backfill, request AFS */\n      afsA['adLoadedCallback'] = callback;\n      global._googCsa('ads', afsP, afsA);\n      break;\n    case AD_TYPE.AFSH:\n      /** Do not backfill, request AFSh */\n      afshA['adLoadedCallback'] = callback;\n      global._googCsa('plas', afshP, afshA);\n      break;\n    case AD_TYPE.AFSH_BACKFILL:\n      /** Backfill with AFS, request AFSh */\n      afshA['adLoadedCallback'] = callbackBackfill;\n      global._googCsa('plas', afshP, afshA);\n      break;\n  }\n}\n\n/**\n * Helper function to determine which product to request\n * @param {!Object} data The data passed in by the partner\n * @return {number} Enum of ad type\n */\nfunction getAdType(data) {\n  if (data['afsPageOptions'] != null && data['afshPageOptions'] == null) {\n    return AD_TYPE.AFS;\n  }\n  if (data['afsPageOptions'] == null && data['afshPageOptions'] != null) {\n    return AD_TYPE.AFSH;\n  }\n  if (data['afsPageOptions'] != null && data['afshPageOptions'] != null) {\n    return AD_TYPE.AFSH_BACKFILL;\n  } else {\n    return AD_TYPE.UNSUPPORTED;\n  }\n}\n\n/**\n * The adsLoadedCallback for requests without a backfill.  If ads were returned,\n * resize the iframe.  If ads weren't returned, tell AMP we don't have ads.\n * @param {!Window} global The window object of the iframe\n * @param {string} containerName The name of the CSA container\n * @param {boolean} hasAd Whether or not CSA returned an ad\n * @visibleForTesting\n */\nexport function callbackWithNoBackfill(global, containerName, hasAd) {\n  if (hasAd) {\n    resizeIframe(global, containerName);\n  } else {\n    global.context.noContentAvailable();\n  }\n}\n\n/**\n * The adsLoadedCallback for requests with a backfill.  If ads were returned,\n * resize the iframe.  If ads weren't returned, backfill the ads.\n * @param {!Window} global The window object of the iframe\n * @param {!Object} page The parsed AFS page options to backfill the unit with\n * @param {!Object} ad The parsed AFS page options to backfill the unit with\n * @param {string} containerName The name of the CSA container\n * @param {boolean} hasAd Whether or not CSA returned an ad\n * @visibleForTesting\n */\nexport function callbackWithBackfill(global, page, ad, containerName, hasAd) {\n  if (hasAd) {\n    resizeIframe(global, containerName);\n  } else {\n    ad['adLoadedCallback'] = callbackWithNoBackfill.bind(null, global);\n    global['_googCsa']('ads', page, ad);\n  }\n}\n\n/**\n * CSA callback function to resize the iframe when ads were returned\n * @param {!Window} global\n * @param {string} containerName Name of the container ('csacontainer')\n * @visibleForTesting\n */\nexport function resizeIframe(global, containerName) {\n  // Get actual height of container\n  const container = global.document.getElementById(containerName);\n  const height = container./*OK*/ offsetHeight;\n  // Set initial AMP height\n  currentAmpHeight =\n    global.context.initialIntersection.boundingClientRect.height;\n\n  // If the height of the container is larger than the height of the\n  // initially requested AMP tag, add the overflow element\n  if (height > currentAmpHeight) {\n    createOverflow(global, container, height);\n  }\n  // Attempt to resize to actual CSA container height\n  requestResizeInternal(global, devAssert(container), height);\n}\n\n/**\n * Helper function to call requestResize\n * @param {!Window} global\n * @param {!Element} container\n * @param {number} height\n */\nfunction requestResizeInternal(global, container, height) {\n  global.context\n    .requestResize(undefined, height)\n    .then(() => {\n      resizeSuccessHandler(global, container, height);\n    })\n    .catch(() => {\n      resizeDeniedHandler(global, container, height);\n    });\n}\n\n/**\n * Helper function to create an overflow element\n * @param {!Window} global The window object of the iframe\n * @param {!Element} container HTML element of the CSA container\n * @param {number} height The full height the CSA container should be when the\n * overflow element is clicked.\n */\nfunction createOverflow(global, container, height) {\n  const overflow = getOverflowElement(global);\n  // When overflow is clicked, resize to full height\n  overflow.onclick = () => requestResizeInternal(global, container, height);\n  global.document.getElementById('c').appendChild(overflow);\n  // Resize the CSA container to not conflict with overflow\n  resizeCsa(container, currentAmpHeight - overflowHeight);\n}\n\n/**\n * Helper function to create the base overflow element\n * @param {!Window} global The window object of the iframe\n * @return {!Element}\n */\nfunction getOverflowElement(global) {\n  const overflow = global.document.createElement('div');\n  overflow.id = 'overflow';\n  setStyles(overflow, {\n    position: 'absolute',\n    height: overflowHeight + 'px',\n    width: '100%',\n  });\n  overflow.appendChild(getOverflowLine(global));\n  overflow.appendChild(getOverflowChevron(global));\n  return overflow;\n}\n\n/**\n * Helper function to create a line element for the overflow element\n * @param {!Window} global The window object of the iframe\n * @return {!Element}\n */\nfunction getOverflowLine(global) {\n  const line = global.document.createElement('div');\n  setStyles(line, {\n    background: 'rgba(0,0,0,.16)',\n    height: '1px',\n  });\n  return line;\n}\n\n/**\n * Helper function to create a chevron element for the overflow element\n * @param {!Window} global The window object of the iframe\n * @return {!Element}\n */\nfunction getOverflowChevron(global) {\n  const svg =\n    '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"36px\" ' +\n    'height=\"36px\" viewBox=\"0 0 48 48\" fill=\"#757575\"><path d=\"M14.83' +\n    ' 16.42L24 25.59l9.17-9.17L36 19.25l-12 12-12-12z\"/>' +\n    '<path d=\"M0-.75h48v48H0z\" fill=\"none\"/> </svg>';\n\n  const chevron = global.document.createElement('div');\n  setStyles(chevron, {\n    width: '36px',\n    height: '36px',\n    marginLeft: 'auto',\n    marginRight: 'auto',\n    display: 'block',\n  });\n  chevron./*OK*/ innerHTML = svg;\n  return chevron;\n}\n\n/**\n * Helper function to resize the height of a CSA container and its child iframe\n * @param {!Element} container HTML element of the CSA container\n * @param {number} height Height to resize, in pixels\n */\nfunction resizeCsa(container, height) {\n  const iframe = container.firstElementChild;\n  if (iframe) {\n    setStyles(iframe, {\n      height: height + 'px',\n      width: '100%',\n    });\n  }\n  setStyle(container, 'height', height + 'px');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function dable(global, data) {\n  // check required props\n  validateData(data, ['widgetId']);\n\n  global.dable =\n    global.dable ||\n    function () {\n      (global.dable.q = global.dable.q || []).push(arguments);\n    };\n  global.dable(\n    'setService',\n    data['serviceName'] || global.window.context.location.hostname\n  );\n  global.dable('setURL', global.window.context.sourceUrl);\n  global.dable('setRef', global.window.context.referrer);\n\n  const slot = global.document.createElement('div');\n  slot.id = '_dbl_' + Math.floor(Math.random() * 100000);\n  slot.setAttribute('data-widget_id', data['widgetId']);\n\n  const divContainer = global.document.getElementById('c');\n  if (divContainer) {\n    divContainer.appendChild(slot);\n  }\n\n  const itemId = data['itemId'] || '';\n  const opts = {};\n\n  if (itemId) {\n    global.dable('sendLog', 'view', {id: itemId});\n  } else {\n    opts.ignoreItems = true;\n  }\n\n  // call render widget\n  global.dable('renderWidget', slot.id, itemId, opts, function (hasAd) {\n    if (hasAd) {\n      global.context.renderStart();\n    } else {\n      global.context.noContentAvailable();\n    }\n  });\n\n  // load the Dable script asynchronously\n  loadScript(global, 'https://static.dable.io/dist/plugin.min.js');\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function digiteka(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._digiteka_amp = {\n    allowed_data: ['mdtk', 'zone', 'adunit', 'params'],\n    mandatory_data: ['mdtk', 'zone'],\n    data,\n  };\n\n  validateData(\n    data,\n    global._digiteka_amp.mandatory_data,\n    global._digiteka_amp.allowed_data\n  );\n\n  loadScript(global, 'https://ot.digiteka.com/amp.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {serializeQueryString} from '../../src/url';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function directadvert(global, data) {\n  validateData(data, ['blockId']);\n\n  const params = /** @type {!JsonObject} */ ({\n    'async': 1,\n    'div': 'c',\n  });\n\n  if (global.context.referrer) {\n    params['amp_rref'] = encodeURIComponent(global.context.referrer);\n  }\n\n  if (global.context.canonicalUrl) {\n    params['amp_rurl'] = encodeURIComponent(global.context.canonicalUrl);\n  }\n\n  const serverName = data['serverName'] || 'code.directadvert.ru';\n\n  const url =\n    '//' +\n    encodeURIComponent(serverName) +\n    '/data/' +\n    encodeURIComponent(data['blockId']) +\n    '.js?' +\n    serializeQueryString(params);\n\n  loadScript(\n    global,\n    url,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function distroscale(global, data) {\n  validateData(data, ['pid'], ['zid', 'tid']);\n  let src = '//c.jsrdn.com/s/cs.js?p=' + encodeURIComponent(data.pid);\n\n  if (data.zid) {\n    src += '&z=' + encodeURIComponent(data.zid);\n  } else {\n    src += '&z=amp';\n  }\n\n  if (data.tid) {\n    src += '&t=' + encodeURIComponent(data.tid);\n  }\n\n  let srcUrl = global.context.sourceUrl;\n\n  srcUrl = srcUrl.replace(/#.+/, '').replace(/\\?.+/, '');\n\n  src += '&f=' + encodeURIComponent(srcUrl);\n\n  global.dsAMPCallbacks = {\n    renderStart: global.context.renderStart,\n    noContentAvailable: global.context.noContentAvailable,\n  };\n  loadScript(\n    global,\n    src,\n    () => {},\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function dotandads(global, data) {\n  global.data = data;\n  writeScript(global, 'https://amp.ad.dotandad.com/dotandadsAmp.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  validateData,\n  validateSrcContains,\n  validateSrcPrefix,\n  writeScript,\n} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function dynad(global, data) {\n  validateData(data, ['src'], []);\n  validateSrcPrefix('https:', data.src);\n  validateSrcContains('/t.dynad.net/', data.src);\n  writeScript(global, data.src);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function eadv(global, data) {\n  validateData(data, ['x', 'u'], []);\n  writeScript(\n    global,\n    'https://www.eadv.it/track/?x=' + data.x + '&u=' + data.u\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function empower(global, data) {\n  validateData(data, ['site', 'zone'], ['category']);\n  global.category = data.category || 'general';\n  global.site = data.site + ':general';\n  global.zone = data.zone;\n  global.iwidth = data.width;\n  global.iheight = data.height;\n  writeScript(global, 'https://cdn.empower.net/sdk/amp-ad.min.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function engageya(global, data) {\n  validateData(data, ['widgetids']);\n\n  global._engageya = global._engageya || {\n    viewId: global.context.pageViewId,\n    widgetIds: data['widgetids'],\n    websiteId: data['websiteid'],\n    publisherId: data['publisherid'],\n    url: data['url'] || global.context.canonicalUrl,\n    ampURL: data['ampurl'] || global.context.sourceUrl,\n    mode: data['mode'] || 1,\n    style: data['stylecss'] || '',\n    referrer: global.context.referrer,\n  };\n\n  loadScript(global, 'https://widget.engageya.com/engageya_amp_loader.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function epeex(global, data) {\n  global._epeex = global._epeex || {\n    account: data['account'] || 'demoepeex',\n    channel: data['channel'] || '1',\n    htmlURL: data['htmlurl'] || encodeURIComponent(global.context.canonicalUrl),\n    ampURL: data['ampurl'] || encodeURIComponent(global.context.sourceUrl),\n    testMode: data['testmode'] || 'false',\n  };\n\n  // load the epeex AMP remote js file\n  loadScript(global, 'https://epeex.com/related/service/widget/amp/remote.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function eplanning(global, data) {\n  validateData(data, [\n    'epl_si',\n    'epl_isv',\n    'epl_sv',\n    'epl_sec',\n    'epl_kvs',\n    'epl_e',\n  ]);\n  // push the two object into the '_eplanning' global\n  (global._eplanning = global._eplanning || []).push({\n    sI: data.epl_si,\n    isV: data.epl_isv,\n    sV: data.epl_sv,\n    sec: data.epl_sec,\n    kVs: data.epl_kvs,\n    e: data.epl_e,\n  });\n  loadScript(global, 'https://us.img.e-planning.net/layers/epl-amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ezoic(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['slot', 'targeting', 'extras']);\n  loadScript(global, 'https://g.ezoic.net/ezoic/ampad.js', () => {\n    loadScript(\n      global,\n      'https://www.googletagservices.com/tag/js/gpt.js',\n      () => {\n        global.googletag.cmd.push(() => {\n          new window.EzoicAmpAd(global, data).createAd();\n        });\n      }\n    );\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function f1e(global, data) {\n  validateData(data, ['url', 'target'], []);\n  global.f1eData = data;\n  writeScript(global, 'https://img.ak.impact-ad.jp/util/f1e_amp.min.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function f1h(global, data) {\n  validateData(data, ['sectionId', 'slot']);\n\n  const scriptUrl =\n    data['debugsrc'] || 'https://img.ak.impact-ad.jp/fh/f1h_amp.js';\n\n  global.f1hData = data;\n  loadScript(global, scriptUrl);\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {setStyles} from '../../src/style';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function fakeDelayed(global, data) {\n  validateData(data, ['src', 'bootstrapScript']);\n\n  const iframe = global.document.createElement('iframe');\n  iframe.setAttribute('id', 'creative');\n  iframe.setAttribute('frameborder', '0');\n  iframe.setAttribute('marginheight', '0');\n  iframe.setAttribute('marginwidth', '0');\n  iframe.setAttribute('scrolling', 'no');\n  iframe.setAttribute('src', data['src']);\n  setStyles(iframe, {\n    border: '0 none transparent',\n    position: 'relative',\n    height: '100%',\n    width: '100%',\n  });\n  global.document.getElementById('c').appendChild(iframe);\n\n  writeScript(global, data['bootstrapScript']);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS-IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {setStyle} from '../../src/style';\n\n/**\n * @typedef FeedAdGlobal\n * @private\n *\n * @property {FeedAdAsync} feedad\n */\n\n/**\n * @typedef {Object} FeedAdAsync\n * @private\n *\n * @property {FeedAd} [sdk]\n * @property {!Function[]} cmd\n */\n\n/**\n * @typedef {Object} FeedAd\n * @private\n *\n * @property {function(string)} init\n * @property {function(string):Promise<FeedAdResponse>} requestAd\n */\n\n/**\n * @typedef {Object} FeedAdResponse\n * @private\n *\n * @property {function():HTMLElement} createAdContainer()\n */\n\n/**\n * @typedef {Object} FeedAdData\n * @private\n *\n * @property {string} clientToken\n * @property {string} placementId\n * @property {string} [background]\n */\n\n/**\n * @param {!FeedAdGlobal} global\n * @param {!FeedAdData} data\n */\nexport function feedad(global, data) {\n  validateData(data, ['clientToken', 'placementId'], ['background']);\n\n  global.feedad = global.feedad || {cmd: []};\n  global.feedad.cmd.push(() => {\n    global.feedad.sdk\n      .init(data.clientToken)\n      .then(() => global.feedad.sdk.requestAd(data.placementId))\n      .then((response) => {\n        const ad = response.createAdContainer();\n        const container = global.document.getElementById('c');\n        applyContainerStyle(container, data);\n        container.appendChild(ad);\n        global.context.renderStart();\n        global.context.reportRenderedEntityIdentifier('FeedAd');\n        return response.promise;\n      })\n      .catch(() => {\n        global.context.noContentAvailable();\n      });\n  });\n  loadScript(global, 'https://web.feedad.com/sdk/feedad-async.js');\n}\n\n/**\n * Centers the ad container within the AMP container.\n * Applies the optional background color for the unfilled space.\n *\n * @param {HTMLElement} container\n * @param {!FeedAdData} data\n */\nfunction applyContainerStyle(container, data) {\n  setStyle(container, 'display', 'flex');\n  setStyle(container, 'flexDirection', 'row');\n  setStyle(container, 'justifyContent', 'stretch');\n  setStyle(container, 'alignItems', 'center');\n  if (data.background) {\n    setStyle(container, 'backgroundColor', data.background);\n  }\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function felmat(global, data) {\n  validateData(data, ['host', 'fmt', 'fmk', 'fmp']);\n  global.fmParam = data;\n  writeScript(\n    global,\n    'https://t.' + encodeURIComponent(data.host) + '/js/fmamp.js'\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function finative(global, data) {\n  writeScript(\n    global,\n    'https://d.finative.cloud/cds/delivery/init?url=' +\n      encodeURIComponent(data.url)\n  );\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseQueryString} from '../../src/core/types/string/url';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function firstimpression(global, data) {\n  validateData(data, ['zoneId', 'websiteId']);\n\n  const {hash, search} = global.context.location;\n  const parameters = Object.assign(\n    parseQueryString(hash),\n    parseQueryString(search)\n  );\n\n  const cdnHost =\n    'https://' + (parameters['fi_ecdnhost'] || 'ecdn.firstimpression.io');\n\n  const cdnpath = parameters['fi_ecdnpath'] || '/static/js/fiamp.js';\n\n  global.params = data;\n\n  writeScript(global, cdnHost + cdnpath);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function flite(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['guid', 'mixins']);\n  const {guid} = data,\n    o = global,\n    e = encodeURIComponent,\n    x = 0;\n  let r = '',\n    dep = '';\n  o.FLITE = o.FLITE || {};\n  o.FLITE.config = o.FLITE.config || {};\n  o.FLITE.config[guid] = o.FLITE.config[guid] || {};\n  o.FLITE.config[guid].cb = Math.random();\n  o.FLITE.config[guid].ts = +Number(new Date());\n  r = global.context.location.href;\n  const m = r.match(new RegExp('[A-Za-z]+:[/][/][A-Za-z0-9.-]+'));\n  dep = data.mixins ? '&dep=' + data.mixins : '';\n  const url = [\n    'https://r.flite.com/syndication/uscript.js?i=',\n    e(guid),\n    '&v=3',\n    dep,\n    '&x=us',\n    x,\n    '&cb=',\n    o.FLITE.config[guid].cb,\n    '&d=',\n    e((m && m[0]) || r),\n    '&tz=',\n    new Date().getTimezoneOffset(),\n  ].join('');\n  loadScript(o, url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\n/* global adingoFluct: false */\n/* global fluctAdScript: false */\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function fluct(global, data) {\n  validateData(data, ['g', 'u']);\n\n  if (data['tagtype'] === 'api') {\n    const cls = `fluct-unit-${data['u']}`;\n    const d = global.document.createElement('div');\n    d.setAttribute('class', cls);\n    global.document.getElementById('c').appendChild(d);\n\n    loadScript(global, 'https://pdn.adingo.jp/p.js', function () {\n      fluctAdScript.cmd.push(function (cmd) {\n        cmd.loadByGroup(data['g']);\n        cmd.display(`.${cls}`, data['u']);\n      });\n    });\n  } else {\n    writeScript(\n      global,\n      `https://cdn-fluct.sh.adingo.jp/f.js?G=${encodeURIComponent(data['g'])}`,\n      function () {\n        adingoFluct.showAd(data['u']);\n      }\n    );\n  }\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function forkmedia(global, data) {\n  let src = null;\n  if (data.product === 'contextads') {\n    switch (data.format) {\n      case 'inread':\n        src = 'https://amp.contextads.live/inread/inread.js';\n        break;\n      case 'vibe':\n        src = 'https://amp.contextads.live/vibe/iav_ia.js';\n        break;\n      case 'display':\n        src = 'https://amp.contextads.live/display/display.js';\n        break;\n      case 'impulse':\n        src = 'https://amp.contextads.live/impulse/impulse.js';\n        break;\n      case 'interscroller':\n        src = 'https://amp.contextads.live/interscroller/fis.js';\n        break;\n      case 'spark':\n        src = 'https://amp.contextads.live/spark/spark.js';\n        break;\n      default:\n        src = 'https://amp.contextads.live/default.js';\n    }\n  } else {\n    src = 'https://amp.contextads.live/default.js';\n  }\n\n  loadScript(\n    global,\n    src,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function freewheel(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._freewheel_amp = {\n    data,\n  };\n\n  validateData(\n    data,\n    ['zone'],\n    [\n      'zone',\n      'gdpr',\n      'gdpr_consent',\n      'gdpr_consented_providers',\n      'useCCPA_USPAPI',\n      '_fw_us_privacy',\n      'useCMP',\n      'zIndex',\n      'blurDisplay',\n      'timeline',\n      'soundButton',\n      'defaultMute',\n      'onOver',\n      'closeAction',\n      'errorAction',\n      'pauseRatio',\n      'label',\n      'vastUrlParams',\n    ]\n  );\n\n  loadScript(global, 'https://cdn.stickyadstv.com/prime-time/fw-amp.min.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {string=} input\n * @return {JsonObject|undefined}\n */\nfunction queryParametersToObject(input) {\n  if (!input) {\n    return undefined;\n  }\n  return input\n    .split('&')\n    .filter(Boolean)\n    .reduce((obj, val) => {\n      const kv = val.split('=');\n      return Object.assign(obj, {[kv[0]]: kv[1] || true});\n    }, {});\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function fusion(global, data) {\n  validateData(\n    data,\n    [],\n    ['mediaZone', 'layout', 'adServer', 'space', 'parameters']\n  );\n\n  const container = global.document.getElementById('c');\n  const ad = global.document.createElement('div');\n  ad.setAttribute('data-fusion-space', data.space);\n  container.appendChild(ad);\n  const parameters = queryParametersToObject(data.parameters);\n\n  writeScript(\n    global,\n    'https://assets.adtomafusion.net/fusion/latest/fusion-amp.min.js',\n    () => {\n      global.Fusion.apply(container, global.Fusion.loadAds(data, parameters));\n\n      global.Fusion.on.warning.run((ev) => {\n        if (ev.msg === 'Space not present in response.') {\n          global.context.noContentAvailable();\n        }\n      });\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function genieessp(global, data) {\n  validateData(data, ['vid', 'zid']);\n\n  global.data = data;\n  writeScript(global, 'https://js.gsspcln.jp/l/amp.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function giraff(global, data) {\n  validateData(data, ['blockName']);\n\n  const serverName = data['serverName'] || 'code.giraff.io';\n  const url =\n    '//' +\n    encodeURIComponent(serverName) +\n    '/data/widget-' +\n    encodeURIComponent(data['blockName']) +\n    '.js';\n\n  loadScript(\n    global,\n    url,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n\n  const anchorEl = global.document.createElement('div');\n  const widgetId = data['widgetId'] ? '_' + data['widgetId'] : '';\n  anchorEl.id = 'grf_' + data['blockName'] + widgetId;\n  global.document.getElementById('c').appendChild(anchorEl);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function glomex(global, data) {\n  validateData(data, ['integrationId']);\n  loadScript(global, 'https://player.glomex.com/integration/1/amp-embed.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\nconst gmosspFields = ['id'];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function gmossp(global, data) {\n  validateData(data, gmosspFields, []);\n\n  global.gmosspParam = data;\n  writeScript(global, 'https://cdn.gmossp-sp.jp/ads/amp.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {setStyles} from '../../src/style';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function gumgum(global, data) {\n  validateData(data, ['zone', 'slot']);\n\n  const win = window,\n    ctx = win.context,\n    dom = global.document.getElementById('c'),\n    ampWidth = parseInt(data.width || '0', 10),\n    ampHeight = parseInt(data.height || '0', 10),\n    ggevents = global.ggevents || [];\n\n  const {max} = Math,\n    slotId = parseInt(data.slot, 10),\n    onLoad = function (type) {\n      return function (evt) {\n        const ad = {width: 0, height: 0, ...(evt.ad || {})},\n          identifier = ['GUMGUM', type, evt.id].join('_');\n        ctx.reportRenderedEntityIdentifier(identifier);\n        ctx.renderStart({\n          width: max(ampWidth, ad.width),\n          height: max(ampHeight, ad.height),\n        });\n      };\n    },\n    noFill = function () {\n      ctx.noContentAvailable();\n    };\n\n  // Ads logic starts\n  global.ggv2id = data.zone;\n  global.ggevents = ggevents;\n  global.sourceUrl = context.sourceUrl;\n  global.sourceReferrer = context.referrer;\n\n  if (slotId) {\n    // Slot Ad\n    const ins = global.document.createElement('div');\n    setStyles(ins, {\n      display: 'block',\n      width: '100%',\n      height: '100%',\n    });\n    ins.setAttribute('data-gg-slot', slotId);\n    ins.setAttribute('pl', 2);\n    dom.appendChild(ins);\n    // Events\n    ggevents.push({\n      'slot.nofill': noFill,\n      'slot.close': noFill,\n      'slot.load': onLoad('SLOT'),\n    });\n    // Main script\n    loadScript(global, 'https://js.gumgum.com/slot.js');\n  } else {\n    // No valid configuration\n    ctx.noContentAvailable();\n  }\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function holder(global, data) {\n  validateData(data, ['block'], []);\n  const wcl = global.context.location;\n  const n = navigator.userAgent;\n  let l = '&r' + Math.round(Math.random() * 10000000) + '&h' + wcl.href;\n  if (!(n.indexOf('Safari') != -1 && n.indexOf('Chrome') == -1)) {\n    l += '&c1';\n  }\n  data.queue = l;\n  writeScript(global, 'https://i.holder.com.ua/js2/holder/ajax/ampv1.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, validateSrcPrefix, writeScript} from '../../3p/3p';\n\nconst validHosts = [\n  'https://go.eu.bbelements.com',\n  'https://go.idnes.bbelements.com',\n  'https://go.goldbachpoland.bbelements.com',\n  'https://go.pol.bbelements.com',\n  'https://go.idmnet.bbelements.com',\n];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ibillboard(global, data) {\n  validateData(data, ['src']);\n  const {src} = data;\n  validateSrcPrefix(validHosts, src);\n\n  writeScript(global, src);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function idealmedia(global, data) {\n  validateData(data, ['publisher', 'widget', 'container'], ['url', 'options']);\n\n  const scriptRoot = document.createElement('div');\n  scriptRoot.id = data.container;\n\n  document.body.appendChild(scriptRoot);\n\n  /**\n   * Returns path for provided js filename\n   * @param {string} publisher The first number.\n   * @return {string} Path to provided filename.\n   */\n  function getResourceFilePath(publisher) {\n    const publisherStr = publisher.replace(/[^A-z0-9]/g, '');\n    return `${publisherStr[0]}/${publisherStr[1]}`;\n  }\n\n  const url =\n    `https://jsc.idealmedia.io/${getResourceFilePath(data.publisher)}/` +\n    `${encodeURIComponent(data.publisher)}.` +\n    `${encodeURIComponent(data.widget)}.js?t=` +\n    Math.floor(Date.now() / 36e5);\n\n  global.uniqId = (\n    '00000' + Math.round(Math.random() * 100000).toString(16)\n  ).slice(-5);\n  window['ampOptions' + data.widget + '_' + global.uniqId] = data.options;\n\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      window['intersectionRect' + data.widget + '_' + global.uniqId] =\n        c.intersectionRect;\n      window['boundingClientRect' + data.widget + '_' + global.uniqId] =\n        c.boundingClientRect;\n    });\n  });\n\n  loadScript(global, data.url || url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport class ImaPlayerData {\n  /**\n   * Create a new ImaPlayerData object.\n   */\n  constructor() {\n    /* {!Number} */\n    this.currentTime = 0;\n\n    /* {!Number} */\n    this.duration = 1;\n\n    /* {!Array} */\n    this.playedRanges = [];\n  }\n\n  /**\n   * Update from the provided video player.\n   *\n   * @param {!Element} videoPlayer\n   */\n  update(videoPlayer) {\n    this.currentTime = videoPlayer.currentTime;\n    this.duration = videoPlayer.duration;\n\n    // Adapt videoPlayer.played for the playedRanges format AMP wants.\n    const {played} = videoPlayer;\n    const {length} = played;\n    this.playedRanges = [];\n    for (let i = 0; i < length; i++) {\n      this.playedRanges.push([played.start(i), played.end(i)]);\n    }\n  }\n}\n\n/**\n * Unique identifier for messages from the implementation iframe with data\n * about the player.\n * @const\n */\nImaPlayerData.IMA_PLAYER_DATA = 'imaPlayerData';\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {devAssert} from './log';\nimport {map} from './core/types/object';\n\nlet htmlContainer;\nlet svgContainer;\n\n/**\n * Creates the html helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function htmlFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!htmlContainer || htmlContainer.ownerDocument !== doc) {\n    htmlContainer = doc.createElement('div');\n  }\n\n  return html;\n}\n\n/**\n * Creates the svg helper for the doc.\n *\n * @param {!Element|!Document} nodeOrDoc\n * @return {function(!Array<string>):!Element}\n */\nexport function svgFor(nodeOrDoc) {\n  const doc = nodeOrDoc.ownerDocument || nodeOrDoc;\n  if (!svgContainer || svgContainer.ownerDocument !== svgContainer) {\n    svgContainer = doc.createElementNS('http://www.w3.org/2000/svg', 'svg');\n  }\n\n  return svg;\n}\n\n/**\n * A tagged template literal helper to generate static SVG trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const circle = svg`<circle cx=\"60\" cy=\"60\" r=\"22\"></circle>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction svg(strings) {\n  return createNode(svgContainer, strings);\n}\n\n/**\n * A tagged template literal helper to generate static DOM trees.\n * This must be used as a tagged template, ie\n *\n * ```\n * const div = html`<div><span></span></div>`;\n * ```\n *\n * Only the root element and its subtree will be returned. DO NOT use this to\n * render subtree's with dynamic content, it WILL result in an error!\n *\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction html(strings) {\n  return createNode(htmlContainer, strings);\n}\n\n/**\n * Helper used by html and svg string literal functions.\n * @param {!Element} container\n * @param {!Array<string>} strings\n * @return {!Element}\n */\nfunction createNode(container, strings) {\n  devAssert(strings.length === 1, 'Improper html template tag usage.');\n  container./*OK*/ innerHTML = strings[0];\n\n  const el = container.firstElementChild;\n  devAssert(el, 'No elements in template');\n  devAssert(!el.nextElementSibling, 'Too many root elements in template');\n\n  // Clear to free memory.\n  container.removeChild(el);\n\n  return el;\n}\n\n/**\n * Queries an element for all elements with a \"ref\" attribute, removing\n * the attribute afterwards.\n * Returns a named map of all ref elements.\n *\n * @param {!Element} root\n * @return {!Object<string, !Element>}\n */\nexport function htmlRefs(root) {\n  const elements = root.querySelectorAll('[ref]');\n  const refs = map();\n\n  for (let i = 0; i < elements.length; i++) {\n    const element = elements[i];\n    const ref = devAssert(element.getAttribute('ref'), 'Empty ref attr');\n    element.removeAttribute('ref');\n    devAssert(refs[ref] === undefined, 'Duplicate ref');\n    refs[ref] = element;\n  }\n\n  return refs;\n}\n", "export const cssText = \"[hidden]{display:none!important}.video,body{background:#000}.fill,.video{width:100%;height:100%}.fill{position:absolute;top:0;left:0}button{cursor:pointer;-webkit-appearance:none;appearance:none;padding:0;border:none;background:transparent;display:block}.controls{position:absolute;bottom:0;width:100%;background-color:rgba(7,20,30,0.7);background:linear-gradient(0,rgba(7,20,30,0.7),rgba(7,20,30,0));box-sizing:border-box;padding:60px 10px 10px;color:#fff;display:-ms-flexbox;display:flex;font-family:Helvetica,Arial,Sans-serif;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center;-webkit-user-select:none;-ms-user-select:none;user-select:none;z-index:1}.controls>:not(:last-child){margin-right:20px}button>svg{width:100%;height:100%;filter:drop-shadow(0 0 14px rgba(0,0,0,0.4));fill:#fff}.countdownWrapper{-ms-flex-align:center;align-items:center;box-sizing:border-box;display:none;-ms-flex-positive:1;flex-grow:1;font-size:12px;height:20px;overflow:hidden;padding:5px;white-space:nowrap}.countdownWrapper,.time{text-shadow:0 0 10px #000}.time{text-align:center;font-size:14px}.progress,.time{margin-right:20px}.progress{height:30px;-ms-flex-positive:1;flex-grow:1;position:relative}.progress:after{display:block;content:\\\"\\\";background-color:hsla(0,0%,100%,0.45);height:2px;width:100%;margin-top:14px}.progressLine{background-color:#fff;height:2px;margin-top:14px;width:0%;float:left}.progressMarker{height:14px;width:14px;position:absolute;left:0%;top:50%;margin-top:-7px;cursor:pointer;border-radius:14px;background:#fff}.controls>button{width:30px;height:30px;-ms-flex-negative:0;flex-shrink:0}.overlayButton{display:-ms-flexbox;display:flex;-ms-flex-pack:center;justify-content:center;-ms-flex-align:center;align-items:center}.overlayButton>svg{max-width:120px;max-height:120px}.root:not([data-muted]) .muteButton>svg:last-child,.root:not([data-playing]) .playButton>svg:last-child,.root[data-muted] .muteButton>svg:first-child,.root[data-playing] .playButton>svg:first-child{display:none}.root[data-ad]>.controls{height:30px;-ms-flex-pack:end;justify-content:flex-end;padding:10px}.root[data-ad]>.controls>button{height:22px}.root[data-ad]>.controls .muteButton{margin-right:10px}@media screen and (max-width:400){.root[data-skippable]>.controls{height:20px}.root[data-skippable]>.controls>button{height:18px}}.root[data-ad]>.controls>.countdownWrapper{display:-ms-flexbox;display:flex}.root[data-ad]>.controls>.progress,.root[data-ad]>.controls>.time{display:none}\\n/*# sourceURL=/css/amp-ima-video-iframe.css*/\"", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CONSENT_POLICY_STATE} from '../../../src/core/constants/consent-state';\nimport {ImaPlayerData} from './ima-player-data';\nimport {camelCaseToTitleCase, setStyle, toggle} from '../../../src/style';\nimport {getData} from '../../../src/event-helper';\nimport {htmlFor, htmlRefs, svgFor} from '../../../src/static-template';\nimport {isArray, isObject} from '../../../src/core/types';\nimport {loadScript} from '../../../3p/3p';\nimport {throttle} from '../../../src/core/types/function';\nimport {tryParseJson} from '../../../src/core/types/object/json';\n// Source for this constant is css/amp-ima-video-iframe.css\nimport {cssText} from '../../../build/amp-ima-video-iframe.css';\n\n/**\n * Possible player states.\n * @enum {number}\n * @private\n */\nconst PlayerStates = {\n  PLAYING: 1,\n  PAUSED: 2,\n};\n\n/**\n * Icons from Google Material Icons\n * https://material.io/tools/icons\n */\nconst icons = {\n  play: (svg) => svg`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M8 5v14l11-7z\"></path>\n    </svg>\n  `,\n  pause: (svg) => svg`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M6 19h4V5H6v14zm8-14v14h4V5h-4z\"></path>\n      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n    </svg>\n  `,\n  fullscreen: (svg) => svg`\n    <svg viewBox=\"0 0 24 24\">\n      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n      <path\n        d=\"M7 14H5v5h5v-2H7v-3zm-2-4h2V7h3V5H5v5zm12 7h-3v2h5v-5h-2v3zM14 5v2h3v3h2V5h-5z\"\n      ></path>\n    </svg>\n  `,\n  muted: (svg) => svg`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"M16.5 12c0-1.77-1.02-3.29-2.5-4.03v2.21l2.45 2.45c.03-.2.05-.41.05-.63zm2.5 0c0 .94-.2 1.82-.54 2.64l1.51 1.51C20.63 14.91 21 13.5 21 12c0-4.28-2.99-7.86-7-8.77v2.06c2.89.86 5 3.54 5 6.71zM4.27 3L3 4.27 7.73 9H3v6h4l5 5v-6.73l4.25 4.25c-.67.52-1.42.93-2.25 1.18v2.06c1.38-.31 2.63-.95 3.69-1.81L19.73 21 21 19.73l-9-9L4.27 3zM12 4L9.91 6.09 12 8.18V4z\"\n      ></path>\n      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n    </svg>\n  `,\n  volumeMax: (svg) => svg`\n    <svg viewBox=\"0 0 24 24\">\n      <path\n        d=\"M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z\"\n      ></path>\n      <path d=\"M0 0h24v24H0z\" fill=\"none\"></path>\n    </svg>\n  `,\n};\n\n// References to rendered elements. See renderElements().\nlet elements;\n\n// Event indicating user interaction.\nlet interactEvent;\n\n// Event for mouse down.\nlet mouseDownEvent;\n\n// Event for mouse move.\nlet mouseMoveEvent;\n\n// Event for mouse up.\nlet mouseUpEvent;\n\n// Percent of the way through the video the user has seeked. Used for seek\n// events.\nlet seekPercent;\n\n// Flag tracking whether or not content has played to completion.\nlet contentComplete;\n\n// Flag tracking whether or not all ads have been played and been completed.\nlet allAdsCompleted;\n\n// Flag tracking if an ad request has failed.\nlet adRequestFailed;\n\n// IMA SDK Ad object\nlet currentAd;\n\n// IMA SDK AdDisplayContainer object.\nlet adDisplayContainer;\n\n// IMA SDK AdsRequest object.\nlet adsRequest;\n\n// IMA SDK AdsLoader object.\nlet adsLoader;\n\n// IMA SDK AdsManager object;\nlet adsManager;\n\n// Timer for UI updates.\nlet uiTicker;\n\n// Tracks the current state of the player.\nlet playerState;\n\n// Flag for whether or not we are currently in fullscreen mode.\nlet fullscreen;\n\n// Width the player should be in fullscreen mode.\nlet fullscreenWidth;\n\n// Height the player should be in fullscreen mode.\nlet fullscreenHeight;\n\n// \"Ad\" label used in ad controls.\nlet adLabel;\n\n// Flag tracking if ads are currently active.\nlet adsActive;\n\n// Flag tracking if playback has started.\nlet playbackStarted;\n\n// Flag for video's controls first being shown.\nlet showControlsFirstCalled;\n\n// Flag to indicate that showControls() should\n// not take immediate effect: i.e. the case when\n// hideControls() is called before controls are\n// visible.\nlet hideControlsQueued;\n\n// Boolean tracking if controls are hidden or shown\nlet controlsVisible;\n\n// Timer used to hide controls after user action.\nlet hideControlsTimeout;\n\n// Flag tracking if we need to mute the ads manager once it loads. Used for\n// autoplay.\nlet muteAdsManagerOnLoaded;\n\n// Flag tracking if we are in native fullscreen mode. Used for iPhone.\nlet nativeFullscreen;\n\n// Flag tracking if the IMA library was allowed to load. Will be set to false\n// when e.g. a user is using an ad blocker.\nlet imaLoadAllowed;\n\n// Used if the adsManager needs to be resized on load.\nlet adsManagerWidthOnLoad, adsManagerHeightOnLoad;\n\n// Initial video dimensions.\nlet videoWidth, videoHeight;\n\n// IMASettings provided via <script> tag in parent element.\nlet imaSettings;\n\n// Player data used for video analytics.\nconst playerData = new ImaPlayerData();\n\n// Flag used to track if ads have been requested or not.\nlet adsRequested;\n\n// Flag that tracks if the user tapped and dragged on the overlay button.\nlet userTappedAndDragged;\n\n// User consent state.\nlet consentState;\n\n// Throttle for the showControls() function\nlet showControlsThrottled = throttle(window, showControls, 1000);\n\n/**\n * @param {!Node} parent\n * @param {string} css\n */\nfunction insertCss(parent, css) {\n  const style = parent.ownerDocument.createElement('style');\n  style./*OK*/ textContent = css;\n  parent.appendChild(style);\n}\n\n/**\n * @param {string} state\n * @param {boolean} active\n */\nfunction toggleRootDataAttribute(state, active) {\n  const {'root': root} = elements;\n  const attributeName = `data-${state}`;\n  if (active) {\n    root.setAttribute(attributeName, '');\n  } else {\n    root.removeAttribute(attributeName);\n  }\n}\n\n/**\n * @param {Document} elementOrDoc\n * @return {!Object<string, !Element>}\n */\nfunction renderElements(elementOrDoc) {\n  const html = htmlFor(elementOrDoc);\n\n  // Elements annotated with `ref=\"name\"` are referenced as `elements['name']`.\n  // They also have their `ref` copied as a classname, so they can be selected\n  // from CSS using that exact value.\n  const root = html`\n    <div class=\"fill\">\n      <div class=\"fill\">\n        <video\n          ref=\"video\"\n          playsinline\n          controlslist=\"nodownload nofullscreen noremoteplayback\"\n        >\n          <!-- Video children are later propagated from the iframe's name. -->\n        </video>\n      </div>\n\n      <div ref=\"adContainer\" class=\"fill\" hidden>\n        <!-- This subtree may be modified by the IMA SDK. -->\n      </div>\n\n      <div ref=\"controls\" hidden>\n        <button ref=\"playButton\"></button>\n\n        <div class=\"countdownWrapper\">\n          <div ref=\"countdown\">\n            <!-- Text content updated using data-ad-label onAdProgress(). -->\n          </div>\n        </div>\n\n        <div ref=\"time\">\n          <!-- Text content must match format in updateTime(). -->\n          -:- / 0:00\n        </div>\n\n        <div ref=\"progress\">\n          <div ref=\"progressLine\"></div>\n          <div ref=\"progressMarker\"></div>\n        </div>\n\n        <button ref=\"muteButton\"></button>\n        <button ref=\"fullscreenButton\"></button>\n      </div>\n\n      <button ref=\"overlayButton\" class=\"fill\"></button>\n    </div>\n  `;\n\n  const elements = htmlRefs(root);\n\n  // The root element cannot be referenced by `ref=\"root\"`, so we insert it.\n  elements['root'] = root;\n\n  // For a smaller template, we copy each element's `ref` value as a classname.\n  for (const ref in elements) {\n    elements[ref].classList.add(ref);\n  }\n\n  // Adding SVGs separately because they require a different namespace, and the\n  // HTML template must be static.\n  const svg = svgFor(elementOrDoc);\n\n  elements['overlayButton'].appendChild(icons.play(svg));\n  elements['fullscreenButton'].appendChild(icons.fullscreen(svg));\n\n  // Buttons toggle SVGs by including two each, one is displayed at a time.\n  // See CSS selectors for buttons under .root[data-*].\n  const {'muteButton': muteButton, 'playButton': playButton} = elements;\n\n  playButton.appendChild(icons.play(svg));\n  playButton.appendChild(icons.pause(svg));\n\n  muteButton.appendChild(icons.volumeMax(svg));\n  muteButton.appendChild(icons.muted(svg));\n\n  return elements;\n}\n\n/**\n * @param {!Document} document\n * @param {!Element} parent\n * @param {?Array<Array<string|Object>>} childrenDef\n *   an array of [tagName, attributes] items like:\n *     [\n *       ['SOURCE', {'src': 'foo.mp4'}],\n *       ['TRACK', {'src': 'bar.mp4'}],\n *     ]\n */\nfunction maybeAppendChildren(document, parent, childrenDef) {\n  if (!isArray(childrenDef)) {\n    return;\n  }\n  childrenDef.forEach((child) => {\n    const tagName = child[0];\n    const attributes = child[1];\n    if (\n      !(\n        typeof tagName === 'string' &&\n        typeof attributes === 'object' &&\n        attributes != null\n      )\n    ) {\n      throw new Error(child);\n    }\n    const element = document.createElement(tagName);\n    for (const attr in attributes) {\n      element.setAttribute(attr, attributes[attr]);\n    }\n    parent.appendChild(element);\n  });\n}\n\n/**\n * @param {!Object} global\n * @param {!Object} data\n */\nexport function imaVideo(global, data) {\n  insertCss(global.document.head, cssText);\n\n  videoWidth = global./*OK*/ innerWidth;\n  videoHeight = global./*OK*/ innerHeight;\n  adLabel = data.adLabel || 'Ad (%s of %s)';\n\n  elements = renderElements(global.document);\n\n  controlsVisible = false;\n\n  // Propagate settings and video element's children.\n  const {'video': video} = elements;\n  video.setAttribute('poster', data.poster);\n  if (data['crossorigin'] != null) {\n    video.setAttribute('crossorigin', data['crossorigin']);\n  }\n  if (data.src) {\n    const sourceElement = document.createElement('source');\n    sourceElement.setAttribute('src', data.src);\n    video.appendChild(sourceElement);\n  }\n  maybeAppendChildren(\n    global.document,\n    video,\n    tryParseJson(data['sourceChildren'])\n  );\n\n  if (data.imaSettings) {\n    imaSettings = tryParseJson(data.imaSettings);\n  }\n\n  global.document.getElementById('c').appendChild(elements['root']);\n\n  // Attach events and configure IMA SDK.\n\n  window.addEventListener('message', onMessage.bind(null, global));\n\n  hideControlsQueued = false;\n  showControlsFirstCalled = false;\n  contentComplete = false;\n  adsActive = false;\n  allAdsCompleted = false;\n  playbackStarted = false;\n  nativeFullscreen = false;\n  imaLoadAllowed = true;\n\n  const {\n    'fullscreenButton': fullscreenButton,\n    'muteButton': muteButton,\n    'playButton': playButton,\n    'progress': progress,\n  } = elements;\n\n  let mobileBrowser = false;\n  interactEvent = 'click';\n  mouseDownEvent = 'mousedown';\n  mouseMoveEvent = 'mousemove';\n  mouseUpEvent = 'mouseup';\n  if (\n    navigator.userAgent.match(/iPhone/i) ||\n    navigator.userAgent.match(/iPad/i) ||\n    navigator.userAgent.match(/Android/i)\n  ) {\n    mobileBrowser = true;\n    interactEvent = 'touchend';\n    mouseDownEvent = 'touchstart';\n    mouseMoveEvent = 'touchmove';\n    mouseUpEvent = 'touchend';\n  }\n  const {'overlayButton': overlayButton} = elements;\n  if (mobileBrowser) {\n    // Create our own tap listener that ignores tap and drag.\n    overlayButton.addEventListener(mouseMoveEvent, onOverlayButtonTouchMove);\n    overlayButton.addEventListener(mouseUpEvent, onOverlayButtonTouchEnd);\n    overlayButton.addEventListener(\n      'tapwithoutdrag',\n      onOverlayButtonInteract.bind(null, global)\n    );\n  } else {\n    overlayButton.addEventListener(\n      interactEvent,\n      onOverlayButtonInteract.bind(null, global)\n    );\n  }\n  playButton.addEventListener(interactEvent, onPlayPauseClick);\n  progress.addEventListener(mouseDownEvent, onProgressClick);\n  muteButton.addEventListener(interactEvent, onMuteUnmuteClick);\n  fullscreenButton.addEventListener(\n    interactEvent,\n    toggleFullscreen.bind(null, global)\n  );\n\n  // Timeout is 1s, because showControls will hide after 3s\n  showControlsThrottled = throttle(window, showControls, 1000);\n\n  const fullScreenEvents = [\n    'fullscreenchange',\n    'mozfullscreenchange',\n    'webkitfullscreenchange',\n  ];\n  fullScreenEvents.forEach((fsEvent) => {\n    global.document.addEventListener(\n      fsEvent,\n      onFullscreenChange.bind(null, global),\n      false\n    );\n  });\n\n  consentState = global.context.initialConsentState;\n\n  if (consentState == 4) {\n    // UNKNOWN\n    // On unknown consent state, do not load IMA. Treat this the same as if IMA\n    // failed to load.\n    onImaLoadFail();\n  } else {\n    // Set-up code that can't run until the IMA lib loads.\n    loadScript(\n      /** @type {!Window} */ (global),\n      'https://imasdk.googleapis.com/js/sdkloader/ima3.js',\n      () => onImaLoadSuccess(global, data),\n      onImaLoadFail\n    );\n  }\n}\n\n/**\n * Adds the appropriate event listener to an element\n * to represent a hover state.\n *\n * NOTE: This does not add a throttler,\n * since this is applied per element,\n * and would require wrapping the callback.\n * Thus, the callback passed should be,\n * appropriately throttled. See showControlsThrottled.\n *\n * @param {!Element} element\n * @param {!Function} callback\n */\nexport function addHoverEventToElement(element, callback) {\n  element.addEventListener(interactEvent, callback);\n  element.addEventListener(mouseMoveEvent, callback);\n}\n\n/**\n * Removes the appropriate event listener from an element\n * that represented a hover state.\n * @param {!Element} element\n * @param {!Function} callback\n */\nexport function removeHoverEventFromElement(element, callback) {\n  element.removeEventListener(interactEvent, callback);\n  element.removeEventListener(mouseMoveEvent, callback);\n}\n\n/**\n * @param {!Object} global\n * @param {!Object} data\n */\nfunction onImaLoadSuccess(global, data) {\n  // This is the first place where we have access to any IMA objects.\n\n  // Handle settings that need to be set before the AdDisplayContainer is\n  // created.\n  if (imaSettings) {\n    if (imaSettings['locale']) {\n      global.google.ima.settings.setLocale(imaSettings['locale']);\n    }\n    if (imaSettings['vpaidMode']) {\n      global.google.ima.settings.setVpaidMode(imaSettings['vpaidMode']);\n    }\n  }\n\n  const {'adContainer': adContainer, 'video': video} = elements;\n\n  adDisplayContainer = new global.google.ima.AdDisplayContainer(\n    adContainer,\n    video\n  );\n\n  adsLoader = new global.google.ima.AdsLoader(adDisplayContainer);\n  adsLoader.getSettings().setPlayerType('amp-ima');\n  adsLoader.getSettings().setPlayerVersion('0.1');\n  // Propogate settings provided via child script tag.\n  // locale and vpaidMode are set above, as they must be set before we create\n  // an AdDisplayContainer.\n  // playerType and playerVersion are used by the developers to track usage,\n  // so we do not want to allow users to overwrite those values.\n  const skippedSettings = [\n    'locale',\n    'vpaidMode',\n    'playerType',\n    'playerVersion',\n  ];\n  for (const setting in imaSettings) {\n    if (!skippedSettings.includes(setting)) {\n      // Change e.g. 'ppid' to 'setPpid'.\n      const methodName = 'set' + camelCaseToTitleCase(setting);\n      if (typeof adsLoader.getSettings()[methodName] === 'function') {\n        adsLoader.getSettings()[methodName](imaSettings[setting]);\n      }\n    }\n  }\n  adsLoader.addEventListener(\n    global.google.ima.AdsManagerLoadedEvent.Type.ADS_MANAGER_LOADED,\n    onAdsManagerLoaded.bind(null, global),\n    false\n  );\n  adsLoader.addEventListener(\n    global.google.ima.AdErrorEvent.Type.AD_ERROR,\n    onAdsLoaderError,\n    false\n  );\n\n  video.addEventListener('ended', onContentEnded);\n\n  adsRequest = new global.google.ima.AdsRequest();\n  adsRequest.adTagUrl = data.tag;\n  adsRequest.linearAdSlotWidth = videoWidth;\n  adsRequest.linearAdSlotHeight = videoHeight;\n  adsRequest.nonLinearAdSlotWidth = videoWidth;\n  adsRequest.nonLinearAdSlotHeight = videoHeight / 3;\n\n  if (!data['delayAdRequest']) {\n    requestAds();\n  } else {\n    // Let amp-ima-video know that we are done set-up.\n    postMessage({event: VideoEvents.LOAD});\n  }\n}\n\n/**\n * Handler for on fail.\n */\nfunction onImaLoadFail() {\n  // Something blocked ima3.js from loading - ignore all IMA stuff and just play\n  // content.\n  addHoverEventToElement(\n    /** @type {!Element} */ (elements['video']),\n    showControlsThrottled\n  );\n  imaLoadAllowed = false;\n  postMessage({event: VideoEvents.LOAD});\n}\n\n/**\n * Triggered when the user clicks on the overlay button.\n * @param {!Object} global\n * @visibleForTesting\n */\nexport function onOverlayButtonInteract(global) {\n  const {'overlayButton': overlayButton, 'video': video} = elements;\n  if (playbackStarted) {\n    // Resart the video\n    playVideo();\n  } else {\n    // Play the video for the first time\n    playbackStarted = true;\n    uiTicker = setInterval(uiTickerClick, 500);\n    setInterval(playerDataTick, 1000);\n    if (adDisplayContainer) {\n      adDisplayContainer.initialize();\n    }\n    video.load();\n    playAds(global);\n  }\n\n  toggle(overlayButton, false);\n}\n\n// TODO(alanorozco): Update name on test's end.\nexport const onBigPlayClick = onOverlayButtonInteract;\n\n/**\n * Triggered when the user ends a tap on the overlay button.\n * @param {Event} event\n */\nfunction onOverlayButtonTouchEnd(event) {\n  if (userTappedAndDragged) {\n    // Reset state and ignore this tap.\n    userTappedAndDragged = false;\n  } else {\n    const tapWithoutDragEvent = new Event('tapwithoutdrag');\n    event.currentTarget.dispatchEvent(tapWithoutDragEvent);\n  }\n}\n\n/**\n * Triggered when the user moves a tap on the overlay button.\n */\nfunction onOverlayButtonTouchMove() {\n  userTappedAndDragged = true;\n}\n\n/**\n * Requests ads.\n */\nexport function requestAds() {\n  adsRequested = true;\n  adRequestFailed = false;\n  if (consentState == CONSENT_POLICY_STATE.UNKNOWN) {\n    // We're unaware of the user's consent state - do not request ads.\n    imaLoadAllowed = false;\n    return;\n  } else if (consentState == CONSENT_POLICY_STATE.INSUFFICIENT) {\n    // User has provided consent state but has not consented to personalized\n    // ads.\n    adsRequest.adTagUrl += '&npa=1';\n  }\n  adsLoader.requestAds(adsRequest);\n}\n\n/**\n * Starts ad playback. If the ad request has not yet resolved, calls itself\n * again after 250ms.\n * @param {!Object} global\n * @visibleForTesting\n */\nexport function playAds(global) {\n  if (!imaLoadAllowed) {\n    playVideo();\n    return;\n  }\n\n  if (!adsRequested) {\n    requestAds();\n    playAds(global);\n    return;\n  } else if (adsManager) {\n    // Ad request resolved.\n    try {\n      adsManager.init(\n        videoWidth,\n        videoHeight,\n        global.google.ima.ViewMode.NORMAL\n      );\n      adsManager.start();\n    } catch (adError) {\n      playVideo();\n    }\n  } else if (!adRequestFailed) {\n    // Ad request did not yet resolve but also did not yet fail.\n    setTimeout(playAds.bind(null, global), 250);\n  } else {\n    // Ad request failed.\n    playVideo();\n  }\n}\n\n/**\n * Called when the content completes.\n *\n * @visibleForTesting\n */\nexport function onContentEnded() {\n  contentComplete = true;\n  if (adsLoader) {\n    adsLoader.contentComplete();\n  }\n\n  // If all ads are not completed,\n  // onContentResume will show the elements['overlayButton']\n  if (allAdsCompleted) {\n    toggle(elements['overlayButton'], true);\n  }\n\n  postMessage({event: VideoEvents.PAUSE});\n  postMessage({event: VideoEvents.ENDED});\n}\n\n/**\n * Called when the IMA SDK has an AdsManager ready for us.\n * @param {!Object} global\n * @param {*} adsManagerLoadedEvent\n * @visibleForTesting\n */\nexport function onAdsManagerLoaded(global, adsManagerLoadedEvent) {\n  const adsRenderingSettings = new global.google.ima.AdsRenderingSettings();\n  adsRenderingSettings.restoreCustomPlaybackStateOnAdBreakComplete = true;\n  adsManager = adsManagerLoadedEvent.getAdsManager(\n    elements['video'],\n    adsRenderingSettings\n  );\n  adsManager.addEventListener(\n    global.google.ima.AdErrorEvent.Type.AD_ERROR,\n    onAdError\n  );\n  adsManager.addEventListener(global.google.ima.AdEvent.Type.LOADED, onAdLoad);\n  adsManager.addEventListener(\n    global.google.ima.AdEvent.Type.PAUSED,\n    onAdPaused\n  );\n  adsManager.addEventListener(\n    global.google.ima.AdEvent.Type.RESUMED,\n    onAdResumed\n  );\n  adsManager.addEventListener(\n    global.google.ima.AdEvent.Type.AD_PROGRESS,\n    onAdProgress\n  );\n  adsManager.addEventListener(\n    global.google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,\n    onContentPauseRequested.bind(null, global)\n  );\n  adsManager.addEventListener(\n    global.google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,\n    onContentResumeRequested\n  );\n  adsManager.addEventListener(\n    global.google.ima.AdEvent.Type.ALL_ADS_COMPLETED,\n    onAllAdsCompleted\n  );\n  if (muteAdsManagerOnLoaded) {\n    adsManager.setVolume(0);\n  }\n  postMessage({event: VideoEvents.LOAD});\n}\n\n/**\n * Called when we encounter an error trying to load ads.\n *\n * @visibleForTesting\n */\nexport function onAdsLoaderError() {\n  adRequestFailed = true;\n  // Send this message to trigger auto-play for failed pre-roll requests -\n  // failing to load an ad is just as good as loading one as far as starting\n  // playback is concerned because our content will be ready to play.\n  postMessage({event: VideoEvents.LOAD});\n  addHoverEventToElement(\n    /** @type {!Element} */ (elements['video']),\n    showControlsThrottled\n  );\n  if (playbackStarted) {\n    playVideo();\n  }\n}\n\n/**\n * Called when we encounter an error trying to play ads.\n *\n * @visibleForTesting\n */\nexport function onAdError() {\n  postMessage({event: VideoEvents.AD_END});\n  currentAd = null;\n  if (adsManager) {\n    adsManager.destroy();\n  }\n  addHoverEventToElement(\n    /** @type {!Element} */ (elements['video']),\n    showControlsThrottled\n  );\n  playVideo();\n}\n\n/**\n * Called each time a new ad loads. Sets currentAd\n * @param {!Object} global\n * @visibleForTesting\n */\nexport function onAdLoad(global) {\n  currentAd = global.getAd();\n}\n\n/**\n * Called intermittently as the ad plays, allowing us to display ad counter.\n * @param {!Object} unusedEvent\n * @visibleForTesting\n */\nexport function onAdProgress(unusedEvent) {\n  const adPodInfo = currentAd.getAdPodInfo();\n  const adPosition = adPodInfo.getAdPosition();\n  const totalAds = adPodInfo.getTotalAds();\n  const remainingTime = adsManager.getRemainingTime();\n  const remainingMinutes = Math.floor(remainingTime / 60);\n  let remainingSeconds = Math.floor(remainingTime % 60);\n  if (remainingSeconds.toString().length < 2) {\n    remainingSeconds = '0' + remainingSeconds;\n  }\n  const label = adLabel.replace('%s', adPosition).replace('%s', totalAds);\n  const {'countdown': countdown} = elements;\n  countdown.textContent = `${label}: ${remainingMinutes}:${remainingSeconds}`;\n}\n\n/**\n * Called by the IMA SDK. Pauses the content and readies the player for ads.\n * @param {!Object} global\n * @visibleForTesting\n */\nexport function onContentPauseRequested(global) {\n  if (adsManagerWidthOnLoad) {\n    adsManager.resize(\n      adsManagerWidthOnLoad,\n      adsManagerHeightOnLoad,\n      global.google.ima.ViewMode.NORMAL\n    );\n    adsManagerWidthOnLoad = null;\n    adsManagerHeightOnLoad = null;\n  }\n  adsActive = true;\n  playerState = PlayerStates.PLAYING;\n  postMessage({event: VideoEvents.AD_START});\n  toggle(elements['adContainer'], true);\n  showAdControls();\n\n  const {'video': video} = elements;\n  video.removeEventListener('ended', onContentEnded);\n  video.pause();\n  removeHoverEventFromElement(\n    /** @type {!Element} */ (video),\n    showControlsThrottled\n  );\n}\n\n/**\n * Called by the IMA SDK. Resumes content after an ad break.\n *\n * @visibleForTesting\n */\nexport function onContentResumeRequested() {\n  const {'overlayButton': overlayButton, 'video': video} = elements;\n  adsActive = false;\n  addHoverEventToElement(\n    /** @type {!Element} */ (video),\n    showControlsThrottled\n  );\n  postMessage({event: VideoEvents.AD_END});\n  resetControlsAfterAd();\n  if (!contentComplete) {\n    // CONTENT_RESUME will fire after post-rolls as well, and we don't want to\n    // resume content in that case.\n    playVideo();\n  } else {\n    toggle(overlayButton, true);\n  }\n\n  video.addEventListener('ended', onContentEnded);\n}\n\n/**\n * Called when the IMA SDK emmitts the event: AdEvent.Type.PAUSED.\n * Sets the (ads) controls to reflect a paused state.\n * Does not need to set the big play pause since that is handled\n * by the SDK generally.\n * @visibleForTesting\n */\nexport function onAdPaused() {\n  toggleRootDataAttribute('playing', false);\n  playerState = PlayerStates.PAUSE;\n}\n\n/**\n * Called when the IMA SDK emmitts the event: AdEvent.Type.RESUMED.\n * Sets the (ads) controls to reflect a paused state.\n * Does not need to set the big play pause since that is handled\n * by the SDK generally.\n * @visibleForTesting\n */\nexport function onAdResumed() {\n  toggleRootDataAttribute('playing', true);\n  playerState = PlayerStates.PLAYING;\n}\n\n/**\n * Called by the IMA SDK. Signifies all ads have been played for the video.\n *\n * @visibleForTesting\n */\nexport function onAllAdsCompleted() {\n  currentAd = null;\n  allAdsCompleted = true;\n}\n\n/**\n * Called when our ui timer goes off. Updates the player UI.\n */\nfunction uiTickerClick() {\n  const {currentTime, duration} = elements['video'];\n  updateTime(currentTime, duration);\n}\n\n/**\n *  Called when our player data timer goes off. Sends a message to the parent\n *  iframe to update the player data.\n */\nfunction playerDataTick() {\n  // Skip while ads are active in case of custom playback. No harm done for\n  // non-custom playback because content won't be progressing while ads are\n  // playing.\n  const {'video': video} = elements;\n  if (video && !adsActive) {\n    playerData.update(video);\n    postMessage({\n      event: ImaPlayerData.IMA_PLAYER_DATA,\n      data: playerData,\n    });\n  }\n}\n\n/**\n * Updates the time and progress.\n * @param {number} currentTime\n * @param {number} duration\n * @visibleForTesting\n */\nexport function updateTime(currentTime, duration) {\n  const {\n    'progressLine': progressLine,\n    'progressMarker': progressMarker,\n    'time': time,\n  } = elements;\n  time.textContent = formatTime(currentTime) + ' / ' + formatTime(duration);\n  const progressPercent = Math.floor((currentTime / duration) * 100);\n  setStyle(progressLine, 'width', progressPercent + '%');\n  setStyle(progressMarker, 'left', progressPercent - 1 + '%');\n}\n\n/**\n * Formats an int in seconds into a string of the format X:XX:XX. Omits the\n * hour if the content is less than one hour.\n * @param {number} time\n * @return {*} TODO(#23582): Specify return type\n * @visibleForTesting\n */\nexport function formatTime(time) {\n  if (isNaN(time)) {\n    return '0:00';\n  }\n  let timeString = '';\n  const hours = Math.floor(time / 3600);\n  if (hours > 0) {\n    timeString += hours + ':';\n  }\n  const minutes = Math.floor((time % 3600) / 60);\n  if (hours > 0) {\n    timeString += zeroPad(minutes) + ':';\n  } else {\n    timeString += minutes + ':';\n  }\n  const seconds = Math.floor(time - (hours * 3600 + minutes * 60));\n  timeString += zeroPad(seconds);\n  return timeString;\n}\n\n/**\n * Zero-pads the provided int and returns a string of length 2.\n * @param {string|number} input\n * @return {*} TODO(#23582): Specify return type\n * @visibleForTesting\n */\nexport function zeroPad(input) {\n  input = String(input);\n  return input.length == 1 ? '0' + input : input;\n}\n\n/**\n * Detects clicks on the progress bar.\n * @param {!Event} event\n */\nfunction onProgressClick(event) {\n  // Call this logic once to make sure we still seek if the user just clicks\n  // instead of clicking and dragging.\n  clearTimeout(hideControlsTimeout);\n  onProgressMove(event);\n  event.preventDefault();\n  event.stopPropagation();\n  clearInterval(uiTicker);\n  document.addEventListener(mouseMoveEvent, onProgressMove);\n  document.addEventListener(mouseUpEvent, onProgressClickEnd);\n}\n\n/**\n * Detects the end of interaction on the progress bar.\n */\nfunction onProgressClickEnd() {\n  document.removeEventListener(mouseMoveEvent, onProgressMove);\n  document.removeEventListener(mouseUpEvent, onProgressClickEnd);\n  uiTicker = setInterval(uiTickerClick, 500);\n  const {'video': video} = elements;\n  video.currentTime = video.duration * seekPercent;\n  // Reset hide controls timeout.\n  showControls();\n}\n\n/**\n * Detects when the user clicks and drags on the progress bar.\n * @param {!Event} event\n */\nfunction onProgressMove(event) {\n  const {'progress': progress, 'video': video} = elements;\n  const progressWrapperPosition = getPagePosition(progress);\n  const progressListStart = progressWrapperPosition.x;\n  const progressListWidth = progress./*OK*/ offsetWidth;\n\n  // Handle Android Chrome touch events.\n  const eventX = event.clientX || event.touches[0].pageX;\n\n  seekPercent = (eventX - progressListStart) / progressListWidth;\n  if (seekPercent < 0) {\n    seekPercent = 0;\n  } else if (seekPercent > 1) {\n    seekPercent = 1;\n  }\n  updateTime(video.duration * seekPercent, video.duration);\n}\n\n/**\n * Returns the x,y coordinates of the given element relative to the window.\n * @param {!Element} el\n * @return {{x: number, y: number}}\n */\nfunction getPagePosition(el) {\n  let lx, ly;\n  for (\n    lx = 0, ly = 0;\n    el != null;\n    lx += el./*OK*/ offsetLeft,\n      ly += el./*OK*/ offsetTop,\n      el = el./*OK*/ offsetParent\n  ) {}\n  return {x: lx, y: ly};\n}\n\n/**\n * Called when the user clicks on the play / pause button.\n *\n * @visibleForTesting\n */\nexport function onPlayPauseClick() {\n  if (playerState == PlayerStates.PLAYING) {\n    pauseVideo();\n  } else {\n    playVideo();\n  }\n}\n\n/**\n * Plays the content video.\n *\n * @visibleForTesting\n */\nexport function playVideo() {\n  const {'adContainer': adContainer, 'video': video} = elements;\n  if (adsActive) {\n    adsManager.resume();\n  } else {\n    toggle(adContainer, false);\n    // Kick off the hide controls timer.\n    showControls();\n    video.play();\n  }\n  playerState = PlayerStates.PLAYING;\n  postMessage({event: VideoEvents.PLAYING});\n  toggleRootDataAttribute('playing', true);\n}\n\n/**\n * Pauses the video player.\n * @param {?Event} event\n * @visibleForTesting\n */\nexport function pauseVideo(event = null) {\n  if (adsActive) {\n    adsManager.pause();\n  } else {\n    const {'video': video} = elements;\n    video.pause();\n    // Show controls and keep them there because we're paused.\n    clearTimeout(hideControlsTimeout);\n    showControls();\n    if (event && event.type == 'webkitendfullscreen') {\n      // Video was paused because we exited fullscreen.\n      video.removeEventListener('webkitendfullscreen', pauseVideo);\n      fullscreen = false;\n    }\n  }\n  playerState = PlayerStates.PAUSED;\n  postMessage({event: VideoEvents.PAUSE});\n  toggleRootDataAttribute('playing', false);\n}\n\n/**\n * Handler when the mute/unmute button is clicked\n */\nexport function onMuteUnmuteClick() {\n  if (elements['video'].muted) {\n    unmuteVideo();\n  } else {\n    muteVideo();\n  }\n}\n\n/**\n * Function to mute the video\n */\nexport function muteVideo() {\n  toggleMuted(elements['video'], true);\n}\n\n/**\n * Function to unmute the video\n */\nexport function unmuteVideo() {\n  toggleMuted(elements['video'], false);\n}\n\n/**\n * Mutes or unmutes the video.\n * @param {!HTMLMediaElement} video\n * @param {boolean} muted\n */\nexport function toggleMuted(video, muted) {\n  if (video.muted == muted) {\n    return;\n  }\n  const volume = muted ? 0 : 1;\n  video.volume = volume;\n  video.muted = muted;\n  if (adsManager) {\n    adsManager.setVolume(volume);\n  } else {\n    muteAdsManagerOnLoaded = muted;\n  }\n  toggleRootDataAttribute('muted', muted);\n  postMessage({event: muted ? VideoEvents.MUTED : VideoEvents.UNMUTED});\n}\n\n/**\n * @param {Object} global\n */\nfunction exitFullscreen(global) {\n  // The video is currently in fullscreen mode\n  const cancelFullscreen =\n    global.document.exitFullscreen ||\n    global.document.exitFullScreen ||\n    global.document.webkitCancelFullScreen ||\n    global.document.mozCancelFullScreen;\n  if (cancelFullscreen) {\n    cancelFullscreen.call(document);\n  }\n}\n\n/**\n * @param {Object} global\n */\nfunction enterFullscreen(global) {\n  // Try to enter fullscreen mode in the browser\n  const requestFullscreen =\n    global.document.documentElement.requestFullscreen ||\n    global.document.documentElement.webkitRequestFullscreen ||\n    global.document.documentElement.mozRequestFullscreen ||\n    global.document.documentElement.requestFullScreen ||\n    global.document.documentElement.webkitRequestFullScreen ||\n    global.document.documentElement.mozRequestFullScreen;\n  if (requestFullscreen) {\n    fullscreenWidth = window.screen.width;\n    fullscreenHeight = window.screen.height;\n    requestFullscreen.call(global.document.documentElement);\n  } else {\n    const {'video': video} = elements;\n    // Use native fullscreen (iPhone)\n    video.webkitEnterFullscreen();\n    // Pause the video when we leave fullscreen. iPhone does this\n    // automatically, but we still use pauseVideo as an event handler to\n    // sync the UI.\n    video.addEventListener('webkitendfullscreen', pauseVideo);\n    nativeFullscreen = true;\n    onFullscreenChange(global);\n  }\n}\n\n/**\n * @param {Object} global\n */\nfunction toggleFullscreen(global) {\n  if (fullscreen) {\n    exitFullscreen(global);\n    return;\n  }\n  enterFullscreen(global);\n}\n\n/**\n * Called when the fullscreen mode of the browser or content player changes.\n * @param {Object} global\n */\nfunction onFullscreenChange(global) {\n  if (fullscreen) {\n    if (adsManager) {\n      // Resize the ad container\n      adsManager.resize(\n        videoWidth,\n        videoHeight,\n        global.google.ima.ViewMode.NORMAL\n      );\n      adsManagerWidthOnLoad = null;\n      adsManagerHeightOnLoad = null;\n    }\n    fullscreen = false;\n  } else {\n    // The user just entered fullscreen\n    if (!nativeFullscreen) {\n      if (adsManager) {\n        // Resize the ad container\n        adsManager.resize(\n          fullscreenWidth,\n          fullscreenHeight,\n          global.google.ima.ViewMode.FULLSCREEN\n        );\n        adsManagerWidthOnLoad = null;\n        adsManagerHeightOnLoad = null;\n      }\n      hideControls();\n    }\n    fullscreen = true;\n  }\n  postMessage({event: 'fullscreenchange', isFullscreen: fullscreen});\n}\n\n/**\n * Show a subset of controls when ads are playing.\n * See CSS for selectors affected by -controls-ads and -controls-ads-mini\n *\n * @visibleForTesting\n */\nexport function showAdControls() {\n  showControls(true);\n  toggleRootDataAttribute('playing', true);\n  toggleRootDataAttribute('ad', true);\n  toggleRootDataAttribute(\n    'skippable',\n    currentAd ? currentAd?.getSkipTimeOffset() !== -1 : false\n  );\n}\n\n/**\n * Reinstate access to all controls when ads have ended.\n *\n * @visibleForTesting\n */\nexport function resetControlsAfterAd() {\n  toggleRootDataAttribute('ad', false);\n  toggleRootDataAttribute('skippable', false);\n}\n\n/**\n * Show video controls and reset hide controls timeout.\n * @param {boolean} opt_adsForce\n * @visibleForTesting\n */\nexport function showControls(opt_adsForce) {\n  showControlsFirstCalled = true;\n  if (!controlsVisible) {\n    // Bail out if hideControls signal was queued before\n    // showControls (does not matter for ads case)\n    if (hideControlsQueued && !opt_adsForce) {\n      hideControlsQueued = false;\n      return;\n    }\n    toggle(elements['controls'], true);\n    controlsVisible = true;\n  }\n\n  // Hide controls after 3 seconds\n  if (playerState == PlayerStates.PLAYING) {\n    // Reset hide controls timer.\n    // Be sure to keep the timer greater than showControlsThrottled.\n    clearTimeout(hideControlsTimeout);\n    hideControlsTimeout = setTimeout(hideControls, 3000);\n  }\n}\n\n/**\n * Hide video controls, except when ads are active.\n *\n * @visibleForTesting\n */\nexport function hideControls() {\n  if (controlsVisible && !adsActive) {\n    toggle(elements['controls'], false);\n    controlsVisible = false;\n  } else if (!showControlsFirstCalled) {\n    // showControls has not been called yet,\n    // so set flag to indicate first showControls\n    // should not take precedence.\n    hideControlsQueued = true;\n  }\n}\n\n/**\n * Handles messages from the top window.\n * @param {!Object} global\n * @param {!Event} event\n */\nfunction onMessage(global, event) {\n  const eventData = getData(event);\n  if (!eventData) {\n    return;\n  }\n  const msg = isObject(eventData) ? eventData : tryParseJson(eventData);\n  if (!msg) {\n    return; // We only process valid JSON.\n  }\n  if (!msg['event'] || !msg['func']) {\n    return;\n  }\n  switch (msg['func']) {\n    case 'play':\n      if (adsActive || playbackStarted) {\n        playVideo();\n      } else {\n        // Auto-play support\n        onOverlayButtonInteract(global);\n      }\n      break;\n    case 'pause':\n      pauseVideo();\n      break;\n    case 'mute':\n      muteVideo();\n      break;\n    case 'unmute':\n      unmuteVideo();\n      break;\n    case 'hideControls':\n      if (!adsActive) {\n        hideControls();\n      }\n      break;\n    case 'showControls':\n      if (!adsActive) {\n        showControls();\n      }\n      break;\n    case 'resize':\n      const args = msg['args'];\n      if (args && args.width && args.height) {\n        if (adsActive && !fullscreen) {\n          adsManager.resize(\n            args.width,\n            args.height,\n            global.google.ima.ViewMode.NORMAL\n          );\n        } else {\n          adsManagerWidthOnLoad = args.width;\n          adsManagerHeightOnLoad = args.height;\n        }\n      }\n      break;\n    case 'onFirstScroll':\n    case 'onAdRequestDelayTimeout':\n      if (!adsRequested && imaLoadAllowed) {\n        requestAds();\n      }\n      break;\n    case 'requestFullscreen':\n      if (fullscreen) {\n        return;\n      }\n      enterFullscreen(global);\n      break;\n    case 'exitFullscreen':\n      if (!fullscreen) {\n        return;\n      }\n      exitFullscreen(global);\n      break;\n  }\n}\n\n/**\n * @param {!Object} data\n */\nfunction postMessage(data) {\n  window.parent./*OK*/ postMessage(data, '*');\n}\n\n/**\n * Returns the properties we need to access for testing.\n *\n * @return {*} TODO(#23582): Specify return type\n * @visibleForTesting\n */\nexport function getPropertiesForTesting() {\n  return {\n    allAdsCompleted,\n    adRequestFailed,\n    adsActive,\n    adsManagerWidthOnLoad,\n    adsManagerHeightOnLoad,\n    adsRequest,\n    contentComplete,\n    controlsVisible,\n    hideControlsTimeout,\n    imaLoadAllowed,\n    interactEvent,\n    playbackStarted,\n    playerState,\n    PlayerStates,\n    uiTicker,\n    hideControlsQueued,\n    icons,\n    // TODO(alanorozco): Update names on test's end to pass `elements` instead.\n    elements,\n    videoPlayer: elements['video'],\n    adContainerDiv: elements['adContainer'],\n    controlsDiv: elements['controls'],\n    playPauseDiv: elements['playButton'],\n    countdownDiv: elements['countdown'],\n    timeDiv: elements['time'],\n    progressBarWrapper: elements['progress'],\n    progressLine: elements['progressLine'],\n    progressMarkerDiv: elements['progressMarker'],\n    muteUnmuteDiv: elements['muteButton'],\n    fullscreenDiv: elements['fullscreenButton'],\n    bigPlayDiv: elements['overlayButton'],\n  };\n}\n\n/**\n * Gets the throttled show controls\n * @return {Function}\n * @visibleForTesting\n */\nexport function getShowControlsThrottledForTesting() {\n  return showControlsThrottled;\n}\n\n/**\n * Sets the overlay button.\n * @param {!Element} div\n * @visibleForTesting\n */\nexport function setBigPlayDivForTesting(div) {\n  elements['overlayButton'] = div;\n}\n\n/**\n * Sets the ad display container.\n * @param {!Element} adc\n * @visibleForTesting\n */\nexport function setAdDisplayContainerForTesting(adc) {\n  adDisplayContainer = adc;\n}\n\n/**\n * Sets the video width and height.\n * @param {number} width\n * @param {number} height\n * @visibleForTesting\n */\nexport function setVideoWidthAndHeightForTesting(width, height) {\n  videoWidth = width;\n  videoHeight = height;\n}\n\n/**\n * Sets the video muted state\n * @param {boolean} shouldMute\n * @visibleForTesting\n */\nexport function setVideoPlayerMutedForTesting(shouldMute) {\n  elements['video'].muted = shouldMute;\n}\n\n/**\n * Sets the allAdsCompleted flag.\n * @param {boolean} newValue\n * @visibleForTesting\n */\nexport function setAllAdsCompletedForTesting(newValue) {\n  allAdsCompleted = newValue;\n}\n\n/**\n * Sets the ad request failed flag.\n * @param {boolean} newValue\n * @visibleForTesting\n */\nexport function setAdRequestFailedForTesting(newValue) {\n  adRequestFailed = newValue;\n}\n\n/**\n * Sets the ads loader.\n * @param {*} newAdsLoader\n * @visibleForTesting\n */\nexport function setAdsLoaderForTesting(newAdsLoader) {\n  adsLoader = newAdsLoader;\n}\n\n/**\n * Sets the ads request.\n * @param {*} newAdsRequest\n * @visibleForTesting\n */\nexport function setAdsRequestForTesting(newAdsRequest) {\n  adsRequest = newAdsRequest;\n}\n\n/**\n * Sets the flag to mute the ads manager when it loads.\n * @param {boolean} shouldMute\n * @visibleForTesting\n */\nexport function setMuteAdsManagerOnLoadedForTesting(shouldMute) {\n  muteAdsManagerOnLoaded = shouldMute;\n}\n\n/**\n * Sets the ads manager.\n * @param {*} newAdsManager\n * @visibleForTesting\n */\nexport function setAdsManagerForTesting(newAdsManager) {\n  adsManager = newAdsManager;\n}\n\n/**\n * Sets the ads manager dimensions on load.\n * @param {number} width\n * @param {number} height\n * @visibleForTesting\n */\nexport function setAdsManagerDimensionsOnLoadForTesting(width, height) {\n  adsManagerWidthOnLoad = width;\n  adsManagerHeightOnLoad = height;\n}\n\n/**\n * Sets the content complete flag.\n * @param {*} newContentComplete\n * @visibleForTesting\n */\nexport function setContentCompleteForTesting(newContentComplete) {\n  contentComplete = newContentComplete;\n}\n\n/**\n * Sets the video player.\n * @param {*} newPlayer\n * @visibleForTesting\n */\nexport function setVideoPlayerForTesting(newPlayer) {\n  elements['video'] = newPlayer;\n}\n\n/**\n * Sets the player state.\n * @param {*} newState\n * @visibleForTesting\n */\nexport function setPlayerStateForTesting(newState) {\n  playerState = newState;\n}\n\n/**\n * Sets the hideControlsTimeout\n * @param {number} newTimeout\n * @visibleForTesting\n */\nexport function setHideControlsTimeoutForTesting(newTimeout) {\n  hideControlsTimeout = newTimeout;\n}\n\n/**\n * Sets the consent state.\n * @param {*} newConsentState\n * @visibleForTesting\n */\nexport function setConsentStateForTesting(newConsentState) {\n  consentState = newConsentState;\n}\n\n/**\n * Events\n *\n * Copied from src/video-interface.js.\n *\n * @const {!Object<string, string>}\n */\n// TODO(aghassemi, #9216): Use video-interface.js\nconst VideoEvents = {\n  /**\n   * load\n   *\n   * Fired when the video player is loaded and calls to methods such as `play()`\n   * are allowed.\n   *\n   * @event load\n   */\n  LOAD: 'load',\n\n  /**\n   * play\n   *\n   * Fired when the video plays.\n   *\n   * @event play\n   */\n  PLAYING: 'playing',\n\n  /**\n   * pause\n   *\n   * Fired when the video pauses.\n   *\n   * @event pause\n   */\n  PAUSE: 'pause',\n\n  /**\n   * ended\n   *\n   * Fired when the video ends.\n   *\n   * This event should be fired in addition to `pause` when video ends.\n   *\n   * @event ended\n   */\n  ENDED: 'ended',\n\n  /**\n   * muted\n   *\n   * Fired when the video is muted.\n   *\n   * @event play\n   */\n  MUTED: 'muted',\n\n  /**\n   * unmuted\n   *\n   * Fired when the video is unmuted.\n   *\n   * @event unmuted\n   */\n  UNMUTED: 'unmuted',\n\n  /**\n   * amp:video:visibility\n   *\n   * Fired when the video's visibility changes.\n   *\n   * @event amp:video:visibility\n   * @property {boolean} visible Whether the video player is visible or not.\n   */\n  VISIBILITY: 'amp:video:visibility',\n\n  /**\n   * reload\n   *\n   * Fired when the video's src changes.\n   *\n   * @event reload\n   */\n  RELOAD: 'reloaded',\n  /**\n   * pre/mid/post Ad start\n   *\n   * Fired when an Ad starts playing.\n   *\n   * This is used to remove any overlay shims during Ad play during autoplay\n   * or minimized-to-corner version of the player.\n   *\n   * @event ad_start\n   */\n  AD_START: 'ad_start',\n\n  /**\n   * pre/mid/post Ad ends\n   *\n   * Fired when an Ad ends playing.\n   *\n   * This is used to restore any overlay shims during Ad play during autoplay\n   * or minimized-to-corner version of the player.\n   *\n   * @event ad_end\n   */\n  AD_END: 'ad_end',\n};\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function imedia(global, data) {\n  validateData(data, ['id', 'positions']);\n  const positions = JSON.parse(data.positions);\n  const mW = context.isMaster ? global : context.master;\n\n  // create parent element\n  const parentElement = document.createElement('div');\n  parentElement.id = data.id;\n  global.document.getElementById('c').appendChild(parentElement);\n\n  // array of all ad elements and matching contexts through all iframes\n  if (!mW.inPagePositions) {\n    mW.inPagePositions = [];\n  }\n  mW.inPagePositions.push({parentElement, context: global.context});\n\n  computeInMasterFrame(\n    global,\n    'imedia-load',\n    (done) => {\n      loadScript(global, 'https://i.imedia.cz/js/im3.js', () => {\n        if (global.im != null) {\n          mW.im = global.im;\n          mW.im.conf.referer = context.canonicalUrl;\n\n          // send request to get all ads\n          mW.im.getAds(positions, {\n            AMPcallback: (ads) => {\n              mW.ads = ads;\n              done(null);\n            },\n          });\n        }\n      });\n    },\n    () => {\n      mW.inPagePositions = mW.inPagePositions.filter((inPagePostion) => {\n        let used = true;\n        positions.filter((position, index) => {\n          // match right element and zone to write advert from adserver\n          if (inPagePostion.parentElement.id == position.id) {\n            used = false;\n            position.id = inPagePostion.parentElement; // right element \"c\" to position obj.\n            if (mW.im.writeAd) {\n              mW.im.writeAd(mW.ads[index], position);\n\n              // inform AMP runtime when the ad starts rendering\n              if (mW.ads[index].impress) {\n                inPagePostion.context.renderStart();\n              } else {\n                inPagePostion.context.noContentAvailable();\n              }\n            }\n            return false;\n          }\n        });\n        return used; // remove (filter) element filled with add\n      });\n    }\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {writeScript} from '../../3p/3p';\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function imobile(global, data) {\n  global.imobileParam = data;\n  writeScript(global, 'https://spamp.i-mobile.co.jp/script/amp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {dev} from '../../src/log';\n\nconst TAG = 'DOUBLECLICK - DEPRECATED';\n/**\n * @param {!Window} opt_global\n * @param {!Object} opt_data\n */\nexport function doubleclick(opt_global, opt_data) {\n  dev().error(\n    TAG,\n    'The use of doubleclick.js has been deprecated. Please ' +\n      'switch to Fast Fetch. See documentation here: ' +\n      'https://github.com/ampproject/amphtml/issues/11834'\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {doubleclick} from '../../ads/google/doubleclick';\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, writeScript} from '../../3p/3p';\n\nconst DEFAULT_TIMEOUT = 500; // ms\nconst EVENT_SUCCESS = 0;\nconst EVENT_TIMEOUT = 1;\nconst EVENT_ERROR = 2;\nconst EVENT_BADTAG = 3;\nconst imonomyData = ['pid', 'subId', 'timeout'];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function imonomy(global, data) {\n  if (!('slot' in data)) {\n    global.CasaleArgs = data;\n    writeScript(global, `//tag.imonomy.com/${data.pid}/indexJTag.js`);\n  } else {\n    //DFP ad request call\n    let calledDoubleclick = false;\n    data.timeout = isNaN(data.timeout) ? DEFAULT_TIMEOUT : data.timeout;\n    const timer = setTimeout(() => {\n      callDoubleclick(EVENT_TIMEOUT);\n    }, data.timeout);\n    const callDoubleclick = function (code) {\n      if (calledDoubleclick) {\n        return;\n      }\n      calledDoubleclick = true;\n      clearTimeout(timer);\n      reportStats(data, code);\n      prepareData(data);\n      doubleclick(global, data);\n    };\n\n    if (typeof data.pid === 'undefined' || isNaN(data.pid)) {\n      callDoubleclick(EVENT_BADTAG);\n      return;\n    }\n\n    global.IndexArgs = {\n      ampCallback: callDoubleclick,\n      ampSuccess: EVENT_SUCCESS,\n      ampError: EVENT_ERROR,\n    };\n\n    loadScript(\n      global,\n      `//tag.imonomy.com/amp/${data.pid}/amp.js`,\n      () => {\n        global.context.renderStart();\n      },\n      () => {\n        global.context.noContentAvailable();\n      }\n    );\n  }\n}\n\n/**\n * @param {*} data\n */\nfunction prepareData(data) {\n  for (const attr in data) {\n    if (hasOwn(data, attr) && imonomyData.indexOf(attr) >= 0) {\n      delete data[attr];\n    }\n  }\n  data.targeting = data.targeting || {};\n  data.targeting['IMONOMY_AMP'] = '1';\n}\n\n/**\n * @param {*} data\n * @param {number} code\n */\nfunction reportStats(data, code) {\n  try {\n    if (code == EVENT_BADTAG) {\n      return;\n    }\n    const xhttp = new XMLHttpRequest();\n    xhttp.withCredentials = true;\n    let unitFormat = '';\n    let pageLocation = '';\n    if (typeof window.context.location.href !== 'undefined') {\n      pageLocation = encodeURIComponent(window.context.location.href);\n    }\n    const {pid, subId} = data,\n      trackId = 'AMP',\n      notFirst = true,\n      cid = '',\n      abLabel = '',\n      rand = Math.random();\n    if (!isNaN(data.width) && !isNaN(data.height)) {\n      unitFormat = `${data.width}x${data.height}`;\n    }\n    const uid = '',\n      isLocked = false,\n      isTrackable = false,\n      isClient = false,\n      tier = 0;\n    const baseUrl = '//srv.imonomy.com/internal/reporter';\n    let unitCodeUrl = `${baseUrl}?v=2&subid=${subId}&sid=${pid}&`;\n    unitCodeUrl = unitCodeUrl + `format=${unitFormat}&ai=`;\n    unitCodeUrl = unitCodeUrl + `${trackId}&ctxu=${pageLocation}&`;\n    unitCodeUrl = unitCodeUrl + `fb=${notFirst}&`;\n    unitCodeUrl = unitCodeUrl + `cid=${cid} &ab=${abLabel}&cbs=${rand}`;\n    if (uid) {\n      unitCodeUrl = unitCodeUrl + `&uid=${uid}`;\n    }\n    if (isLocked) {\n      unitCodeUrl = unitCodeUrl + `&is_locked=${isLocked}`;\n    }\n    if (isTrackable) {\n      unitCodeUrl = unitCodeUrl + `&istrk=${isTrackable}`;\n    }\n    if (isClient) {\n      unitCodeUrl = unitCodeUrl + `&is_client=${isClient}`;\n      if (tier) {\n        unitCodeUrl = unitCodeUrl + `&tier=${tier}`;\n      }\n    }\n\n    xhttp.open('GET', unitCodeUrl, true);\n    xhttp.setRequestHeader('Content-Type', 'application/json');\n    xhttp.send();\n  } catch (e) {}\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function improvedigital(global, data) {\n  validateData(data, ['placement'], ['width', 'height', 'optin', 'keyvalue']);\n\n  let url =\n    'https://ad.360yield.com' +\n    '/adj?' +\n    'p=' +\n    encodeURIComponent(data.placement) +\n    '&w=' +\n    encodeURIComponent(data.width) +\n    '&h=' +\n    encodeURIComponent(data.height) +\n    '&optin=' +\n    encodeURIComponent(data.optin) +\n    '&tz=' +\n    new Date().getTimezoneOffset();\n\n  const value = data.keyvalue;\n  let newData = '';\n  const amps = '&';\n  let validKey = 0;\n\n  if (value && value.length > 0) {\n    const keys = value.split('&');\n    for (let i = 0; i < keys.length; i++) {\n      if (!keys[i]) {\n        continue;\n      }\n      const segment = keys[i].split('=');\n      const segment1 = segment[1] ? encodeURIComponent(segment[1]) : '';\n      if (validKey > 0) {\n        newData += amps;\n      }\n      validKey++;\n      newData += segment[0] + '=' + segment1;\n    }\n  }\n  if (newData) {\n    url += '&' + newData;\n  }\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {setStyle} from '../../src/style';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function inmobi(global, data) {\n  validateData(data, ['siteid', 'slotid'], []);\n\n  const inmobiConf = {\n    siteid: data.siteid,\n    slot: data.slotid,\n    manual: true,\n    onError: (code) => {\n      if (code == 'nfr') {\n        global.context.noContentAvailable();\n        setStyle(document.getElementById('my-ad-slot'), 'display', 'none');\n      }\n    },\n    onSuccess: () => {\n      global.context.renderStart();\n    },\n  };\n\n  writeScript(global, 'https://cf.cdn.inmobi.com/ad/inmobi.secure.js', () => {\n    global.document.write(\"<div id='my-ad-slot'></div>\");\n    global._inmobi.getNewAd(document.getElementById('my-ad-slot'), inmobiConf);\n  });\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function innity(global, data) {\n  validateData(data, ['pub', 'zone'], ['channel']);\n  writeScript(global, 'https://cdn.innity.net/admanager.js', () => {\n    const innityAMPZone = global.innity_adZone;\n    const innityAMPTag = new innityAMPZone(\n      encodeURIComponent(data.pub),\n      encodeURIComponent(data.zone),\n      {\n        width: data.width,\n        height: data.height,\n        channel: data.channel ? encodeURIComponent(data.channel) : '',\n      }\n    );\n    // AMP handling or noContentAvailable\n    innityAMPTag.amp(global.context);\n    // else renderStart (with at least house ad)\n    global.context.renderStart();\n  });\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function insticator(global, data) {\n  // validate passed data attributes\n  validateData(data, ['siteId', 'embedId']);\n\n  // create insticator markup\n  global.document\n    .getElementById('c')\n    .appendChild(createTemplate(data['embedId']));\n\n  // create ads and embed\n  createAdsAndEmbed(data['siteId'], data['embedId']);\n}\n\n/**\n * Create HTML template to be populated later\n * @param {string} embedId The Unique Identifier of this particular Embed\n * @return {Element} HTML template\n */\nfunction createTemplate(embedId) {\n  const template = document.createElement('template');\n  template./*OK*/ innerHTML = `\n    <div id=\"insticator-container\">\n      <div id=\"div-insticator-ad-1\"></div>\n      <div id=\"insticator-embed\" embed-id=\"${embedId}\"></div>\n      <div id=\"div-insticator-ad-2\"></div>\n    </div>\n  `;\n  return template.content;\n}\n\n/**\n * Generates Ads and Embed\n * @param {string} siteId Used to grab the ads file\n * @param {string} embedId Used to grab the unique embed requested\n */\nfunction createAdsAndEmbed(siteId, embedId) {\n  // helper vars\n  const a = window;\n  const c = document;\n  const s = 'script';\n  const u = `//d3lcz8vpax4lo2.cloudfront.net/ads-code/${siteId}.js`; // vars from preconnect urls and data attributes on amp-embed tag\n\n  // create insticator object on the window\n  'Insticator' in a ||\n    (a.Insticator = {\n      ad: {\n        loadAd: function (b) {\n          a.Insticator.ad.q.push(b);\n        },\n        q: [],\n      },\n      helper: {},\n      embed: {},\n      version: '4.0',\n      q: [],\n      amp: null, // this will get set to window.context which is the AMP API so we can access from our ads code\n      load: function (t, o) {\n        a.Insticator.amp = window.context; // set the Insticator object property amp to window.context which is the AMP API so we can access from our ads code\n        a.Insticator.q.push({t, o});\n      },\n    });\n\n  // load ads code\n  const b = c.createElement(s);\n  b.src = u;\n  b.async = !0;\n  const d = c.getElementsByTagName(s)[0];\n  d.parentNode.insertBefore(b, d);\n\n  // execute functions of insticator object on the window (load ads and embed)\n  a.Insticator.ad.loadAd('div-insticator-ad-1');\n  a.Insticator.ad.loadAd('div-insticator-ad-2');\n  a.Insticator.load('em', {id: embedId});\n\n  // now tell AMP runtime to start rendering ads\n  window.context.renderStart();\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function invibes(global, data) {\n  global.invibesAmp = {\n    allowedData: ['adCateg', 'pid', 'customEndpoint'],\n    mandatoryData: [],\n    data,\n  };\n\n  validateData(\n    data,\n    global.invibesAmp.mandatoryData,\n    global.invibesAmp.allowedData\n  );\n\n  let url = data.customEndpoint || 'https://k.r66net.com/GetAmpLink';\n\n  if (data.adCateg) {\n    url = addQueryParam(url, 'adCateg', data.adCateg);\n  }\n\n  if (data.pid) {\n    url = addQueryParam(url, 'pid', data.pid);\n  }\n\n  if (\n    window &&\n    window.context &&\n    window.context.location &&\n    window.context.location.href\n  ) {\n    url = addQueryParam(url, 'referrerUrl', window.context.location.href);\n  }\n\n  loadScript(global, url);\n}\n\n/**\n * @param {string} url\n * @param {string} param\n * @param {string} value\n * @return {string}\n */\nfunction addQueryParam(url, param, value) {\n  const paramValue =\n    encodeURIComponent(param) + '=' + encodeURIComponent(value);\n  if (url.indexOf('?') > -1) {\n    url += '&' + paramValue;\n  } else {\n    url += '?' + paramValue;\n  }\n  return url;\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseJson} from '../../src/core/types/object/json';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function iprom(global, data) {\n  validateData(data, ['zone', 'sitepath'], ['keywords', 'channels']);\n\n  const ampdata = {\n    sitepath: '[]',\n    zone: [],\n    keywords: '',\n    channels: '',\n    ...data,\n  };\n\n  /**\n   * Callback for WriteScript\n   */\n  function namespaceLoaded() {\n    const ipromNS = window.ipromNS || {};\n\n    ipromNS.AdTag = ipromNS.AdTag || {};\n\n    const config = {\n      sitePath: parseJson(ampdata.sitepath),\n      containerId: 'c',\n      zoneId: ampdata.zone,\n      prebid: true,\n      amp: true,\n      keywords: ampdata.keywords ? ampdata.keywords.split(',') : [],\n      channels: ampdata.channels ? ampdata.channels.split(',') : [],\n    };\n\n    const tag = new ipromNS.AdTag(config);\n    tag.init();\n  }\n\n  writeScript(global, 'https://cdn.ipromcloud.com/ipromNS.js', namespaceLoaded);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {doubleclick} from '../../ads/google/doubleclick';\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, writeScript} from '../../3p/3p';\n\nconst DEFAULT_TIMEOUT = 500; // ms\nconst EVENT_SUCCESS = 0;\nconst EVENT_TIMEOUT = 1;\nconst EVENT_ERROR = 2;\nconst EVENT_BADTAG = 3;\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ix(global, data) {\n  if (!('slot' in data)) {\n    global.CasaleArgs = data;\n    writeScript(global, 'https://js-sec.indexww.com/indexJTag.js');\n  } else {\n    //DFP ad request call\n\n    const start = Date.now();\n    let calledDoubleclick = false;\n    data.ixTimeout = isNaN(data.ixTimeout) ? DEFAULT_TIMEOUT : data.ixTimeout;\n    const timer = setTimeout(() => {\n      callDoubleclick(EVENT_TIMEOUT);\n    }, data.ixTimeout);\n\n    const callDoubleclick = function (code) {\n      if (calledDoubleclick) {\n        return;\n      }\n      calledDoubleclick = true;\n      clearTimeout(timer);\n      reportStats(data.ixId, data.ixSlot, data.slot, start, code);\n      prepareData(data);\n      doubleclick(global, data);\n    };\n\n    if (typeof data.ixId === 'undefined' || isNaN(data.ixId)) {\n      callDoubleclick(EVENT_BADTAG);\n      return;\n    }\n\n    global.IndexArgs = {\n      ampCallback: callDoubleclick,\n      ampSuccess: EVENT_SUCCESS,\n      ampError: EVENT_ERROR,\n    };\n\n    loadScript(\n      global,\n      'https://js-sec.indexww.com/apl/amp.js',\n      undefined,\n      () => {\n        callDoubleclick(EVENT_ERROR);\n      }\n    );\n  }\n}\n\n/**\n * @param {!Object} data\n */\nfunction prepareData(data) {\n  for (const attr in data) {\n    if (hasOwn(data, attr) && /^ix[A-Z]/.test(attr)) {\n      delete data[attr];\n    }\n  }\n  data.targeting = data.targeting || {};\n  data.targeting['IX_AMP'] = '1';\n}\n\n/**\n * @param {string} siteID\n * @param {string} slotID\n * @param {string} dfpSlot\n * @param {number} start\n * @param {number} code\n */\nfunction reportStats(siteID, slotID, dfpSlot, start, code) {\n  try {\n    if (code == EVENT_BADTAG) {\n      return;\n    }\n    const xhttp = new XMLHttpRequest();\n    xhttp.withCredentials = true;\n\n    const deltat = Date.now() - start;\n    const ts = (start / 1000) >> 0;\n    const ets = (Date.now() / 1000) >> 0;\n    let url = 'https://as-sec.casalemedia.com/headerstats?s=' + siteID;\n    if (typeof window.context.location.href !== 'undefined') {\n      url += '&u=' + encodeURIComponent(window.context.location.href);\n    }\n    let stats = '{\"p\":\"display\",\"d\":\"mobile\",\"t\":' + ts + ',';\n    stats += '\"sl\":[{\"s\": \"' + slotID + '\",';\n    stats += '\"t\":' + ets + ',';\n    stats += '\"e\": [{';\n    if (code == EVENT_SUCCESS) {\n      stats += '\"n\":\"amp-s\",';\n    } else if (code == EVENT_TIMEOUT) {\n      stats += '\"n\":\"amp-t\",';\n    } else {\n      stats += '\"n\":\"amp-e\",';\n    }\n    stats += '\"v\":\"' + deltat + '\",';\n    stats += '\"b\": \"INDX\",\"x\": \"' + dfpSlot.substring(0, 64) + '\"}]}]}';\n\n    xhttp.open('POST', url, true);\n    xhttp.setRequestHeader('Content-Type', 'application/json');\n    xhttp.send(stats);\n  } catch (e) {}\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function jubna(global, data) {\n  validateData(data, ['wid', 'pid']);\n  global._jubna = global._jubna || {\n    widgetID: data['wid'],\n    pubID: data['pid'],\n    referrer: global.context.referrer,\n  };\n  loadScript(global, 'https://cdn.jubna.com/adscripts/jb_amp_loader.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function kargo(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n\n  validateData(data, ['site', 'slot'], ['options']);\n\n  // Kargo AdTag url\n  const kargoScriptUrl =\n    'https://storage.cloud.kargo.com/ad/network/tag/v3/' + data.site + '.js';\n\n  // parse extra ad call options (optional)\n  let options = {};\n  if (data.options != null) {\n    try {\n      options = JSON.parse(data.options);\n    } catch (e) {}\n  }\n\n  // Add window source reference to ad options\n  options.source_window = global;\n\n  computeInMasterFrame(\n    global,\n    'kargo-load',\n    function (done) {\n      // load AdTag in Master window\n      loadScript(global, kargoScriptUrl, () => {\n        let success = false;\n        if (global.Kargo != null && global.Kargo.loaded) {\n          success = true;\n        }\n\n        done(success);\n      });\n    },\n    (success) => {\n      if (success) {\n        const w = options.source_window;\n\n        // Add reference to Kargo api to this window if it's not the Master window\n        if (!w.context.isMaster) {\n          w.Kargo = w.context.master.Kargo;\n        }\n\n        w.Kargo.getAd(data.slot, options);\n      } else {\n        throw new Error('Kargo AdTag failed to load');\n      }\n    }\n  );\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ketshwa(global, data) {\n  validateData(data, ['widgetid', 'externalid'], []);\n\n  const {externalid, widgetid} = data;\n  const skey = `widget_${widgetid}`;\n\n  const dv = global.document.createElement('div');\n  dv.id = skey;\n  global.document.getElementById('c').appendChild(dv);\n\n  writeScript(\n    global,\n    `https://widget-cdn.ketshwa.com/m/p/${widgetid}/${externalid}.js`,\n    () => {\n      global.KetshwaSDK.showWidget(widgetid, skey);\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function kiosked(global, data) {\n  let scriptId;\n  validateData(data, ['scriptid'], []);\n  if (hasOwn(data, 'scriptid')) {\n    scriptId = data['scriptid'];\n  }\n  window.addEventListener(\n    'kioskedAdRender',\n    function () {\n      global.context.renderStart();\n    },\n    false\n  );\n\n  window.addEventListener(\n    'kioskedAdNoFill',\n    function () {\n      global.context.noContentAvailable();\n    },\n    false\n  );\n\n  writeScript(\n    global,\n    'https://scripts.kiosked.com/loader/kiosked-ad.js?staticTagId=' + scriptId\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseUrlDeprecated} from '../../src/url';\n\n/* global\n__kxamp: false,\n__kx_ad_slots: false,\n__kx_ad_start: false,\n__kx_viewability: false,\n*/\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function kixer(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n\n  validateData(data, ['adslot'], []);\n\n  let inView = false;\n  let viewed = false;\n  let viewTimer = null;\n\n  const d = global.document.createElement('div');\n  d.id = '__kx_ad_' + data.adslot;\n  global.document.getElementById('c').appendChild(d);\n\n  const kxload = function () {\n    d.removeEventListener('load', kxload, false);\n    if (d.childNodes.length > 0) {\n      global.context.renderStart();\n    } else {\n      global.context.noContentAvailable();\n    }\n  };\n  d.addEventListener('load', kxload, false); // Listen for the kixer load event\n\n  const kxviewCheck = function (intersectionEntry) {\n    inView = intersectionEntry.intersectionRatio > 0.5; // Half of the unit is in the viewport\n    if (inView) {\n      if (!viewed && viewTimer == null) {\n        // If the ad hasn't been viewed and the timer is not set\n        viewTimer = setTimeout(kxviewFire, 900); // Set a Timeout to check the ad in 900ms and fire the view\n      }\n    } else {\n      if (viewTimer) {\n        // If the Timeout is set\n        clearTimeout(viewTimer); // Clear the Timeout\n        viewTimer = null;\n      }\n    }\n  };\n\n  const kxviewFire = function () {\n    if (inView) {\n      // if the ad is still in the viewport\n      if (typeof __kx_viewability.process_locked === 'function') {\n        viewed = true;\n        __kx_viewability.process_locked(data.adslot); // Fire kixer view\n      }\n    }\n  };\n\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      kxviewCheck(c);\n    });\n  });\n\n  loadScript(global, 'https://cdn.kixer.com/ad/load.js', () => {\n    global.__kx_domain = parseUrlDeprecated(global.context.sourceUrl).hostname; // Get domain\n    __kxamp[data.adslot] = 1;\n    __kx_ad_slots.push(data.adslot);\n    __kx_ad_start();\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function kuadio(global, data) {\n  validateData(\n    data,\n    ['widgetId'],\n    ['region', 'baseUrl', 'betaMode', 'debugMode', 'fastParse', 'ref']\n  );\n\n  global._pvmax = {\n    region: data.region,\n    baseUrl: data.baseUrl,\n    betaMode: data.betaMode === 'true',\n    debugMode: data.debugMode === 'true',\n    fastParse: data.fastParse !== 'false',\n  };\n\n  const e = global.document.createElement('div');\n  e.className = '_pvmax_recommend';\n  e.setAttribute('data-widget-id', data.widgetId);\n  e.setAttribute('data-ref', data.ref || global.context.canonicalUrl);\n  global.document.getElementById('c').appendChild(e);\n\n  loadScript(global, 'https://api.pvmax.net/v1.0/pvmax.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function lentainform(global, data) {\n  validateData(data, ['publisher', 'widget', 'container'], ['url', 'options']);\n\n  const scriptRoot = document.createElement('div');\n  scriptRoot.id = data.container;\n\n  document.body.appendChild(scriptRoot);\n\n  const publisherStr = data.publisher.replace(/[^A-z0-9]/g, '');\n\n  const url =\n    `https://jsc.lentainform.com/${encodeURIComponent(publisherStr[0])}/` +\n    `${encodeURIComponent(publisherStr[1])}/` +\n    `${encodeURIComponent(data.publisher)}.` +\n    `${encodeURIComponent(data.widget)}.js?t=` +\n    Math.floor(Date.now() / 36e5);\n\n  global.uniqId = (\n    '00000' + Math.round(Math.random() * 100000).toString(16)\n  ).slice(-5);\n  window['ampOptions' + data.widget + '_' + global.uniqId] = data.options;\n\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      window['intersectionRect' + data.widget + '_' + global.uniqId] =\n        c.intersectionRect;\n      window['boundingClientRect' + data.widget + '_' + global.uniqId] =\n        c.boundingClientRect;\n    });\n  });\n\n  loadScript(global, data.url || url);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateSrcPrefix, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ligatus(global, data) {\n  const {src} = data;\n  validateSrcPrefix('https://a-ssl.ligatus.com/', src);\n  writeScript(global, src);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function lockerdome(global, data) {\n  validateData(data, ['slot']);\n  global.SLOT = data.slot;\n  loadScript(global, 'https://cdn2.lockerdomecdn.com/_js/amp.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function logly(global, data) {\n  validateData(data, ['adspotid']);\n\n  const d = global.document.createElement('div');\n  d.id = 'logly-lift-' + data['adspotid'];\n  global.document.getElementById('c').appendChild(d);\n\n  const url =\n    'https://l.logly.co.jp/lift_widget.js' +\n    `?adspot_id=${encodeURIComponent(data['adspotid'])}`;\n\n  loadScript(global, url);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function loka(global, data) {\n  validateData(data, ['unitParams'], []);\n\n  global.lokaParams = data;\n\n  const container = global.document.querySelector('#c');\n  container.addEventListener('lokaUnitLoaded', (e) => {\n    if (e.detail.isReady) {\n      global.context.renderStart();\n    } else {\n      global.context.noContentAvailable();\n    }\n  });\n\n  loadScript(global, 'https://loka-cdn.akamaized.net/scene/amp.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function luckyads(global, data) {\n  validateData(data, ['src', 'laBlock']);\n  const {src} = data;\n  createContainer(global, data);\n  loadScript(global, src);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction createContainer(global, data) {\n  const d = global.document.createElement('div');\n  d.setAttribute('data-la-block', data['laBlock']);\n  global.document.getElementById('c').appendChild(d);\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function macaw(global, data) {\n  validateData(data, ['blockId']);\n\n  const url =\n    'https://code.macaw.is/data/' +\n    encodeURIComponent(data['blockId']) +\n    '.js?async=1&div=c';\n\n  loadScript(\n    global,\n    url,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mads(global, data) {\n  validateData(data, ['adrequest'], []);\n\n  writeScript(global, 'https://eu2.madsone.com/js/tags.js', function () {\n    window.MADSAdrequest.adrequest(JSON.parse(data.adrequest));\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mantisDisplay(global, data) {\n  validateData(data, ['property', 'zone'], []);\n\n  global.mantis = global.mantis || [];\n  global.mantis.push([\n    'display',\n    'load',\n    {\n      property: data['property'],\n    },\n  ]);\n\n  const d = global.document.createElement('div');\n  d.setAttribute('data-mantis-zone', data['zone']);\n  global.document.getElementById('c').appendChild(d);\n\n  loadScript(global, 'https://assets.mantisadnetwork.com/mantodea.min.js');\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mantisRecommend(global, data) {\n  validateData(data, ['property'], ['css']);\n\n  global.mantis = global.mantis || [];\n  global.mantis.push([\n    'recommend',\n    'load',\n    {\n      property: data['property'],\n      render: 'recommended',\n      css: data['css'],\n    },\n  ]);\n\n  const d = global.document.createElement('div');\n  d.setAttribute('id', 'recommended');\n  global.document.getElementById('c').appendChild(d);\n\n  loadScript(global, 'https://assets.mantisadnetwork.com/recommend.min.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function marfeel(global, data) {\n  validateData(data, ['tenant']);\n\n  const {tenant, version} = data;\n  const versionQS = version ? `?v=${version}` : '';\n\n  loadScript(global, `https://live.mrf.io/amp-ad/${tenant}/index${versionQS}`);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mediaad(global, data) {\n  // ensure we have vlid publisher, placement and mode\n  // and exactly one page-type\n  validateData(data, ['medtag', 'publisher']);\n\n  const d = document.getElementById('c');\n  const meddiv = document.createElement('div');\n  meddiv.setAttribute('id', data['medtag']);\n  d.appendChild(meddiv);\n\n  global._mediaad = global._mediaad || [];\n\n  // install observation on entering/leaving the view\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      if (c.intersectionRect.height) {\n        global._mediaad.push({\n          medtag: data['medtag'],\n          publisher: data.publisher,\n        });\n      }\n    });\n  });\n\n  loadScript(\n    global,\n    `https://s1.mediaad.org/serve/${encodeURIComponent(\n      data.publisher\n    )}/loader.js`\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, validateData, writeScript} from '../../3p/3p';\nimport {getSourceUrl, parseUrlDeprecated} from '../../src/url';\nimport {hasOwn} from '../../src/core/types/object';\n\nconst mandatoryParams = ['tagtype', 'cid'],\n  optionalParams = [\n    'timeout',\n    'crid',\n    'misc',\n    'slot',\n    'targeting',\n    'categoryExclusions',\n    'tagForChildDirectedTreatment',\n    'cookieOptions',\n    'overrideWidth',\n    'overrideHeight',\n    'loadingStrategy',\n    'consentNotificationId',\n    'useSameDomainRenderingUntilDeprecated',\n    'experimentId',\n    'multiSize',\n    'multiSizeValidation',\n  ];\n// useSameDomainRenderingUntilDeprecated is included to ensure publisher\n// amp-tags don't break before 29th March\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function medianet(global, data) {\n  validateData(data, mandatoryParams, optionalParams);\n\n  const publisherUrl =\n      global.context.canonicalUrl || getSourceUrl(global.context.location.href),\n    referrerUrl = global.context.referrer;\n\n  if (data.tagtype === 'headerbidder') {\n    //parameter tagtype is used to identify the product the publisher is using. Going ahead we plan to support more product types.\n    loadHBTag(global, data, publisherUrl, referrerUrl);\n  } else if (data.tagtype === 'cm' && data.crid) {\n    loadCMTag(global, data, publisherUrl, referrerUrl);\n  } else {\n    global.context.noContentAvailable();\n  }\n}\n\n/**\n * @return {{renderStartCb: (function(*=)), reportRenderedEntityIdentifierCb: (function(*=)), noContentAvailableCb: (function())}}\n */\nfunction getCallbacksObject() {\n  return {\n    renderStartCb: (opt_data) => {\n      global.context.renderStart(opt_data);\n    },\n    reportRenderedEntityIdentifierCb: (ampId) => {\n      global.context.reportRenderedEntityIdentifier(ampId);\n    },\n    noContentAvailableCb: () => {\n      global.context.noContentAvailable();\n    },\n  };\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @param {string} publisherUrl\n * @param {?string} referrerUrl\n */\nfunction loadCMTag(global, data, publisherUrl, referrerUrl) {\n  /**\n   * Sets macro type.\n   * @param {string} type\n   */\n  function setMacro(type) {\n    if (!type) {\n      return;\n    }\n    const name = 'medianet_' + type;\n    if (hasOwn(data, type)) {\n      global[name] = data[type];\n    }\n  }\n\n  /**\n   * Sets additional data.\n   */\n  function setAdditionalData() {\n    data.requrl = publisherUrl || '';\n    data.refurl = referrerUrl || '';\n    data.versionId = '211213';\n\n    setMacro('width');\n    setMacro('height');\n    setMacro('crid');\n    setMacro('requrl');\n    setMacro('refurl');\n    setMacro('versionId');\n    setMacro('misc');\n  }\n\n  /**\n   * Sets callback.\n   */\n  function setCallbacks() {\n    global._mNAmp = getCallbacksObject();\n  }\n\n  /**\n   * Loads the script.\n   */\n  function loadScript() {\n    let url = 'https://contextual.media.net/ampnmedianet.js?';\n    url += 'cid=' + encodeURIComponent(data.cid);\n    url += '&https=1';\n    url += '&requrl=' + encodeURIComponent(data.requrl);\n    url += '&refurl=' + encodeURIComponent(data.refurl);\n    writeScript(global, url);\n  }\n\n  /**\n   * Initializer.\n   */\n  function init() {\n    setAdditionalData();\n    setCallbacks();\n    loadScript();\n  }\n\n  init();\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @param {string} publisherUrl\n * @param {?string} referrerUrl\n */\nfunction loadHBTag(global, data, publisherUrl, referrerUrl) {\n  /**\n   * Loads MNETAd.\n   */\n  function loadMNETAd() {\n    if (loadMNETAd.alreadyCalled) {\n      return;\n    }\n    loadMNETAd.alreadyCalled = true;\n\n    global.advBidxc = global.context.master.advBidxc;\n    if (global.advBidxc && typeof global.advBidxc.renderAmpAd === 'function') {\n      global.addEventListener('message', (event) => {\n        global.advBidxc.renderAmpAd(event, global);\n      });\n    }\n\n    data.targeting = data.targeting || {};\n\n    if (\n      global.advBidxc &&\n      typeof global.advBidxc.setAmpTargeting === 'function'\n    ) {\n      global.advBidxc.setAmpTargeting(global, data);\n    }\n    global.advBidxc.loadAmpAd(global, data);\n  }\n\n  /**\n   * Handler for mnet.\n   */\n  function mnetHBHandle() {\n    global.advBidxc = global.context.master.advBidxc;\n    if (\n      global.advBidxc &&\n      typeof global.advBidxc.registerAmpSlot === 'function'\n    ) {\n      global.advBidxc.registerAmpSlot({\n        cb: loadMNETAd,\n        data,\n        winObj: global,\n      });\n    }\n  }\n\n  computeInMasterFrame(\n    global,\n    'medianet-hb-load',\n    (done) => {\n      /*eslint \"google-camelcase/google-camelcase\": 0*/\n      global.advBidxc_requrl = publisherUrl;\n      global.advBidxc_refurl = referrerUrl;\n      global.advBidxc = {\n        registerAmpSlot: () => {},\n        setAmpTargeting: () => {},\n        renderAmpAd: () => {},\n        loadAmpAd: () => {\n          global.context.noContentAvailable();\n        },\n      };\n      global.advBidxc.amp = getCallbacksObject();\n      const publisherDomain = parseUrlDeprecated(publisherUrl).hostname;\n      writeScript(\n        global,\n        'https://contextual.media.net/bidexchange.js?https=1&amp=1&cid=' +\n          encodeURIComponent(data.cid) +\n          '&dn=' +\n          encodeURIComponent(publisherDomain),\n        () => {\n          done(null);\n        }\n      );\n    },\n    mnetHBHandle\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mediavine(global, data) {\n  validateData(data, ['site']);\n  global.$mediavine = {\n    slug: data.site,\n  };\n  loadScript(global, 'https://amp.mediavine.com/wrapper.min.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {setStyles} from '../../src/style';\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function medyanet(global, data) {\n  validateData(data, ['slot', 'domain']);\n\n  global.adunit = data.slot;\n  global.size = '[' + data.width + ',' + data.height + ']';\n  global.domain = data.domain;\n\n  medyanetAds(global, data);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction medyanetAds(global, data) {\n  const f = global.document.createElement('iframe');\n  f.setAttribute('id', 'adframe');\n  f.setAttribute('width', data.width);\n  f.setAttribute('height', data.height);\n  f.setAttribute('frameborder', '0');\n  f.setAttribute('marginheight', '0');\n  f.setAttribute('marginwidth', '0');\n  f.setAttribute('allowfullscreen', 'true');\n  f.setAttribute('scrolling', 'no');\n  setStyles(f, {\n    border: '0 none transparent',\n    position: 'relative',\n  });\n  f.onload = function () {\n    window.context.renderStart();\n  };\n  f.src = `https://app.medyanetads.com/amp/medyanetads.html?bidderData=${global.domain}&adunit=${global.adunit}&size=${global.size}`;\n  const url = window.top.location.search.substring(1);\n  if (url && url.indexOf('hb=true') !== -1) {\n    f.src = f.src + '&hb=true';\n  }\n  global.document.body.appendChild(f);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function meg(global, data) {\n  validateData(data, ['code']);\n  const {code} = data;\n  const lang = global.encodeURIComponent(global.navigator.language);\n  const ref = global.encodeURIComponent(global.context.referrer);\n  const params = ['lang=' + lang, 'ref=' + ref].join('&');\n  const url = 'https://apps.meg.com/embedjs/' + code + '?' + params;\n  global._megAdsLoaderCallbacks = {\n    onSuccess: () => {\n      global.context.renderStart();\n    },\n    onError: () => {\n      global.context.noContentAvailable();\n    },\n  };\n  loadScript(\n    global,\n    url,\n    () => {\n      // Meg has been loaded\n    },\n    () => {\n      // Cannot load meg embed.js\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mgid(global, data) {\n  validateData(data, ['publisher', 'widget', 'container'], ['url', 'options']);\n\n  const scriptRoot = document.createElement('div');\n  scriptRoot.id = data.container;\n\n  document.body.appendChild(scriptRoot);\n\n  /**\n   * Returns path for provided js filename\n   * @param {string} publisher js filename\n   * @return {string} Path to provided filename.\n   */\n  function getResourceFilePath(publisher) {\n    const publisherStr = publisher.replace(/[^A-z0-9]/g, '');\n    return `${publisherStr[0]}/${publisherStr[1]}`;\n  }\n\n  const url =\n    `https://jsc.mgid.com/${getResourceFilePath(data.publisher)}/` +\n    `${encodeURIComponent(data.publisher)}.` +\n    `${encodeURIComponent(data.widget)}.js?t=` +\n    Math.floor(Date.now() / 36e5);\n\n  global.uniqId = (\n    '00000' + Math.round(Math.random() * 100000).toString(16)\n  ).slice(-5);\n  window['ampOptions' + data.widget + '_' + global.uniqId] = data.options;\n\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      window['intersectionRect' + data.widget + '_' + global.uniqId] =\n        c.intersectionRect;\n      window['boundingClientRect' + data.widget + '_' + global.uniqId] =\n        c.boundingClientRect;\n    });\n  });\n\n  loadScript(global, data.url || url);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/* global MicroAd: false */\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function microad(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['spot', 'url', 'referrer', 'ifa', 'appid', 'geo']);\n\n  global.document.getElementById('c').setAttribute('id', data.spot);\n  loadScript(global, 'https://j.microad.net/js/camp.js', () => {\n    MicroAd.Compass.showAd(data);\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function miximedia(global, data) {\n  validateData(data, ['blockid']);\n  global._miximedia = global._miximedia || {\n    viewId: global.context.pageViewId,\n    blockId: data['blockid'],\n    htmlURL: data['canonical'] || global.context.canonicalUrl,\n    ampURL: data['ampurl'] || global.context.sourceUrl,\n    testMode: data['testmode'] || 'false',\n    referrer: data['referrer'] || global.context.referrer,\n    hostname: global.window.context.location.hostname,\n    clientId: window.context.clientId,\n    domFingerprint: window.context.domFingerprint,\n    location: window.context.location,\n    startTime: window.context.startTime,\n  };\n  global._miximedia.AMPCallbacks = {\n    renderStart: global.context.renderStart,\n    noContentAvailable: global.context.noContentAvailable,\n  };\n  // load the miximedia  AMP JS file script asynchronously\n  const rand = Math.round(Math.random() * 100000000);\n  loadScript(\n    global,\n    'https://amp.mixi.media/ampclient/mixi.js?rand=' + rand,\n    () => {},\n    global.context.noContentAvailable\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mixpo(global, data) {\n  validateData(data, ['guid', 'subdomain']);\n\n  const g = global,\n    cdnSubdomain = data.subdomain == 'www' ? 'cdn' : data.subdomain + '-cdn',\n    url = data.loader || `https://${cdnSubdomain}.mixpo.com/js/loader.js`;\n\n  g.mixpoAd = {\n    amp: true,\n    noflash: true,\n    width: data.width,\n    height: data.height,\n    guid: data.guid,\n    subdomain: data.subdomain,\n    embedv: data.embedv,\n    clicktag: data.clicktag,\n    customTarget: data.customtarget,\n    dynClickthrough: data.dynclickthrough,\n    viewTracking: data.viewtracking,\n    customCSS: data.customcss,\n    local: data.local,\n    enableMRAID: data.enablemraid,\n    jsPlayer: data.jsplayer,\n  };\n\n  writeScript(g, url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function monetizer101(global, data) {\n  validateData(data, ['widget', 'config']);\n  global.widget = data.widget;\n  global.config = data.config;\n  writeScript(global, 'https://link.monetizer101.com/widget/amp/amp.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} config\n */\nexport function mox(global, config) {\n  validateData(config, ['z', 'w', 'h'], ['u']);\n\n  global.config = config;\n\n  loadScript(global, config.u || 'https://ad.mox.tv/js/amp.min.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function my6sense(global, data) {\n  validateData(data, ['widgetKey']);\n\n  const widgetTag = global.document.createElement('script');\n  widgetTag.src = `//web-clients.mynativeplatform.com/web-clients/bootloaders/${data['widgetKey']}/bootloader.js`;\n  const url =\n    data['url'] && data['url'] !== '[PAGE_URL]'\n      ? data['url']\n      : global.context.sourceUrl;\n  widgetTag.setAttribute('async', 'true');\n  widgetTag.setAttribute('data-version', '3');\n  widgetTag.setAttribute('data-url', url);\n  widgetTag.setAttribute('data-zone', data['zone'] || '[ZONE]');\n  widgetTag.setAttribute('data-google-amp', 'true');\n  widgetTag.setAttribute(\n    'data-organic-clicks',\n    data['organicClicks'] || '[ORGANIC_TRACKING_PIXEL]'\n  );\n  widgetTag.setAttribute(\n    'data-paid-clicks',\n    data['paidClicks'] || '[PAID_TRACKING_PIXEL]'\n  );\n  widgetTag.setAttribute('data-display-within-iframe', 'true');\n  global.document.body.appendChild(widgetTag);\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\nconst mandatoryFields = ['adType'];\n\nconst adUrl = 'https://www.myfinance.com/amp/ad';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function myfinance(global, data) {\n  validateData(data, mandatoryFields);\n  if (!data['mf_referrer']) {\n    data['mf_referrer'] =\n      global.context.canonicalUrl || global.context.sourceUrl;\n  }\n  if (!data['ampClientId']) {\n    data['ampClientId'] = global.context.clientId;\n  }\n  const url = buildUrl(data);\n  global.MF_AMP_DATA = data;\n  writeScript(global, url);\n}\n\n/**\n * Generates the url to call for the script content\n * @param {!Object} data\n * @return {string}\n */\nfunction buildUrl(data) {\n  const url = new URL(adUrl);\n  Object.entries(data).forEach((entry) =>\n    url.searchParams.set(entry[0], entry[1])\n  );\n  return url.toString();\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function myoffrz(global, data) {\n  validateData(data, ['config'], ['script']);\n  global.config = data.config;\n  global.sourceUrl = global.context.sourceUrl;\n\n  // create an expected placeholder\n  const d = global.document.createElement('div');\n  d.setAttribute('id', 'myoffrz');\n  global.document.getElementById('c').appendChild(d);\n\n  writeScript(global, data.script || 'https://cdn.myoffrz.io/amp/script.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {setStyles} from '../../src/style';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mytarget(global, data) {\n  validateData(data, ['adSlot'], ['adQuery']);\n\n  // Create ad tag placeholder\n  const container = global.document.createElement('ins');\n\n  container.setAttribute('class', 'mrg-tag');\n  container.setAttribute('data-ad-slot', data['adSlot']);\n  if (data['adQuery']) {\n    container.setAttribute('data-ad-query', data['adQuery']);\n  }\n  setStyles(container, {\n    display: 'inline-block',\n    width: '100%',\n    height: '100%',\n  });\n  global.document.getElementById('c').appendChild(container);\n\n  // Add tag and callbacks to queue\n  (global.MRGtag = global.MRGtag || []).push({\n    onNoAds: () => global.context.noContentAvailable(),\n    onAdsSuccess: () => global.context.renderStart(),\n  });\n\n  // Load main js asynchronously\n  loadScript(global, 'https://ad.mail.ru/static/ads-async.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function mywidget(global, data) {\n  validateData(data, ['cid']);\n  global.myWidgetInit = data;\n\n  // load the myWidget initializer asynchronously\n  loadScript(global, 'https://likemore-go.imgsmail.ru/widget_amp.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function nativeroll(global, data) {\n  validateData(data, ['gid']);\n  loadScript(\n    global,\n    'https://cdn01.nativeroll.tv/js/seedr-player.min.js',\n    () => {\n      initPlayer(global, data);\n    }\n  );\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction initPlayer(global, data) {\n  const config = {\n    container: '#c',\n    desiredOffset: 50,\n    gid: data.gid,\n    onError: () => {\n      global.context.noContentAvailable();\n    },\n    onLoad: () => {\n      const height =\n        global.document.getElementsByClassName('nr-player')[0]\n          ./* OK */ offsetHeight;\n      global.context.requestResize(undefined, height);\n    },\n    onDestroy: () => {\n      global.context.noContentAvailable();\n    },\n  };\n  // eslint-disable-next-line no-undef\n  SeedrPlayer(config);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {toArray} from '../../src/core/types/array';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function nativery(global, data) {\n  validateData(data, ['wid']);\n  const params = {...data};\n\n  // push the two object into the '_nativery' global\n  global._nativery = global._nativery || {\n    wid: data.wid,\n    referrer: data.referrer || global.context.referrer,\n    url: data.url || global.context.canonicalUrl,\n    viewId: global.context.pageViewId,\n    visible: 0,\n    params,\n  };\n\n  // must add listener for resize\n  global.addEventListener('amp-widgetCreated', function (e) {\n    if (e && e.detail) {\n      global.context.requestResize(undefined, e.detail.height);\n    }\n  });\n\n  // install observation to check if is in viewport\n  const unlisten = global.context.observeIntersection(function (changes) {\n    toArray(changes).forEach(function (c) {\n      global._nativery.visible = Math.floor(\n        (c.intersectionRect.height / c.boundingClientRect.height) * 100\n      );\n      if (global._nativery.visible) {\n        unlisten();\n      }\n    });\n  });\n\n  // load the nativery loader asynchronously\n  writeScript(global, `https://cdn.nativery.com/widget/js/natamp.js`);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS-IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function nativo(global, data) {\n  let ntvAd;\n  (function (ntvAd, global, data) {\n    global.history.replaceState(\n      null,\n      '',\n      location.pathname + location.hash.replace(/({).*(})/, '')\n    );\n    // Private\n    let delayedAdLoad = false;\n    let percentageOfadViewed;\n    const loc = global.context.location;\n    /**\n     * @param {number} delay\n     * @return {boolean}\n     */\n    function isValidDelayTime(delay) {\n      return (\n        typeof delay != 'undefined' && !isNaN(delay) && parseInt(delay, 10) >= 0\n      );\n    }\n    /**\n     * @param {!Object} data\n     * @return {boolean}\n     */\n    function isDelayedTimeStart(data) {\n      return (\n        isValidDelayTime(data.delayByTime) &&\n        'delay' in data &&\n        !('delayByView' in data)\n      );\n    }\n    /**\n     * @param {!Object} data\n     * @return {boolean}\n     */\n    function isDelayedViewStart(data) {\n      return isValidDelayTime(data.delayByTime) && 'delayByView' in data;\n    }\n    /**\n     * Loads ad when done.\n     */\n    function loadAdWhenViewed() {\n      const g = global;\n      global.context.observeIntersection(function (positions) {\n        const coordinates = getLastPositionCoordinates(positions);\n        if (\n          typeof coordinates.rootBounds != 'undefined' &&\n          coordinates.intersectionRect.top ==\n            coordinates.rootBounds.top + coordinates.boundingClientRect.y\n        ) {\n          if (isDelayedViewStart(data) && !delayedAdLoad) {\n            g.PostRelease.Start();\n            delayedAdLoad = true;\n          }\n        }\n      });\n    }\n    /**\n     * Loads ad when timeouts.\n     */\n    function loadAdWhenTimedout() {\n      const g = global;\n      setTimeout(function () {\n        g.PostRelease.Start();\n        delayedAdLoad = true;\n      }, parseInt(data.delayByTime, 10));\n    }\n    /**\n     * @param {*} positions\n     * @return {*} TODO(#23582): Specify return type\n     */\n    function getLastPositionCoordinates(positions) {\n      return positions[positions.length - 1];\n    }\n    /**\n     * @param {number} percentage\n     */\n    function setPercentageOfadViewed(percentage) {\n      percentageOfadViewed = percentage;\n    }\n    /**\n     * Used to track ad during scrolling event and trigger checkIsAdVisible\n     * method on PostRelease instance\n     * @param {*} positions\n     */\n    function viewabilityConfiguration(positions) {\n      const coordinates = getLastPositionCoordinates(positions);\n      setPercentageOfadViewed(\n        (coordinates.intersectionRect.height * 100) /\n          coordinates.boundingClientRect.height /\n          100\n      );\n      global.PostRelease.checkIsAdVisible();\n    }\n    // Public\n    ntvAd.getPercentageOfadViewed = function () {\n      return percentageOfadViewed;\n    };\n    ntvAd.getScriptURL = function () {\n      return 'https://s.ntv.io/serve/load.js';\n    };\n    // Configuration setup is based on the parameters/attributes associated with\n    // the amp-ad node\n    ntvAd.setupAd = function () {\n      global._prx = [['cfg.Amp']];\n      global._prx.push(['cfg.RequestUrl', data['requestUrl'] || loc.href]);\n      for (const key in data) {\n        switch (key) {\n          case 'premium':\n            global._prx.push(['cfg.SetUserPremium']);\n            break;\n          case 'debug':\n            global._prx.push(['cfg.Debug']);\n            break;\n          case 'delay':\n            if (isValidDelayTime(data.delayByTime)) {\n              global._prx.push(['cfg.SetNoAutoStart']);\n            }\n            break;\n        }\n      }\n    };\n    // Used to Delay Start and Initalize Tracking. This is a callback AMP will\n    // use once script is loaded\n    ntvAd.Start = function () {\n      if (isDelayedTimeStart(data)) {\n        loadAdWhenTimedout();\n      } else if (isDelayedViewStart(data)) {\n        loadAdWhenViewed();\n      }\n      global.PostRelease.checkAmpViewability = function () {\n        return ntvAd.getPercentageOfadViewed();\n      };\n      // ADD TRACKING HANDLER TO OBSERVER\n      global.context.observeIntersection(viewabilityConfiguration);\n    };\n  })(ntvAd || (ntvAd = {}), global, data);\n  // Setup Configurations\n  ntvAd.setupAd();\n  // Load Nativo Script\n  loadScript(global, ntvAd.getScriptURL(), ntvAd.Start);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {doubleclick} from '../../ads/google/doubleclick';\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function navegg(global, data) {\n  validateData(data, ['acc']);\n  const {acc} = data;\n  let seg,\n    nvg = function () {};\n  delete data.acc;\n  nvg.prototype.getProfile = function () {};\n  data.targeting = data.targeting || {};\n  loadScript(global, 'https://tag.navdmp.com/amp.1.0.0.min.js', () => {\n    nvg = global[`nvg${acc}`] = new global['AMPNavegg']({\n      acc,\n    });\n    nvg.getProfile((nvgTargeting) => {\n      for (seg in nvgTargeting) {\n        data.targeting[seg] = nvgTargeting[seg];\n      }\n      doubleclick(global, data);\n    });\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\nconst nendFields = ['nend_params'];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function nend(global, data) {\n  validateData(data, nendFields, []);\n\n  global.nendParam = data;\n  writeScript(global, 'https://js1.nend.net/js/amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {addParamsToUrl, assertHttpsUrl} from '../../src/url';\nimport {dev} from '../../src/log.js';\nimport {dict} from '../../src/core/types/object';\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\nconst NX_URL_HOST = 'https://call.adadapter.netzathleten-media.de';\nconst NX_URL_PATHPREFIX = '/pb/';\nconst NX_URL_FULL = NX_URL_HOST + NX_URL_PATHPREFIX;\nconst DEFAULT_NX_KEY = 'default';\nconst DEFAULT_NX_UNIT = 'default';\nconst DEFAULT_NX_WIDTH = 'fluid';\nconst DEFAULT_NX_HEIGHT = 'fluid';\nconst DEFAULT_NX_V = '0002';\nconst DEFAULT_NX_SITE = 'none';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function netletix(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._netletix_amp = {\n    allowed_data: ['nxasync', 'nxv', 'nxsite', 'nxid', 'nxscript'],\n    mandatory_data: ['nxkey', 'nxunit', 'nxwidth', 'nxheight'],\n    data,\n  };\n\n  validateData(\n    data,\n    global._netletix_amp.mandatory_data,\n    global._netletix_amp.allowed_data\n  );\n\n  const nxh = data.nxheight || DEFAULT_NX_HEIGHT;\n  const nxw = data.nxwidth || DEFAULT_NX_WIDTH;\n  const url = assertHttpsUrl(\n    addParamsToUrl(\n      NX_URL_FULL + encodeURIComponent(data.nxkey || DEFAULT_NX_KEY),\n      dict({\n        'unit': data.nxunit || DEFAULT_NX_UNIT,\n        'width': data.nxwidth || DEFAULT_NX_WIDTH,\n        'height': data.nxheight || DEFAULT_NX_HEIGHT,\n        'v': data.nxv || DEFAULT_NX_V,\n        'site': data.nxsite || DEFAULT_NX_SITE,\n        'ord': Math.round(Math.random() * 100000000),\n      })\n    ),\n    data.ampSlotIndex\n  );\n\n  window.addEventListener('message', (event) => {\n    if (\n      event.data.type &&\n      dev().assertString(event.data.type).startsWith('nx-')\n    ) {\n      switch (event.data.type) {\n        case 'nx-resize':\n          const renderconfig = {\n            'width': event.data.width,\n            'height': event.data.height,\n          };\n          global.context.renderStart(renderconfig);\n          if (\n            event.data.width &&\n            event.data.height &&\n            (event.data.width != nxw || event.data.height != nxh)\n          ) {\n            global.context.requestResize(event.data.width, event.data.height);\n          }\n          break;\n        case 'nx-empty':\n          global.context.noContentAvailable();\n          break;\n        case 'nx-identifier':\n          global.context.reportRenderedEntityIdentifier(event.data.identifier);\n          break;\n        default:\n          break;\n      }\n    }\n  });\n\n  if (data.async && data.async.toLowerCase() === 'true') {\n    loadScript(global, url);\n  } else {\n    writeScript(global, url);\n  }\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function noddus(global, data) {\n  validateData(data, ['token']);\n\n  global.noddus = data;\n\n  writeScript(global, 'https://noddus.com/amp_loader.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function nokta(global, data) {\n  validateData(data, ['category', 'site', 'zone']);\n  global.category = data.category;\n  global.site = data.site;\n  global.zone = data.zone;\n  global.iwidth = data.width;\n  global.iheight = data.height;\n  writeScript(\n    global,\n    'https://static.virgul.com/theme/mockups/noktaamp/ampjs.js'\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\nconst oblivkiFields = ['id'];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function oblivki(global, data) {\n  validateData(data, oblivkiFields, []);\n\n  global.oblivkiParam = data;\n  writeScript(global, 'https://oblivki.biz/ads/amp.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function onead(global, data) {\n  validateData(data, [], ['playmode', 'uid', 'pid', 'host']);\n  global.Guoshi = {\n    queryAd: {\n      amp: {},\n    },\n  };\n  global.ONEAD_AMP = {\n    playmode: data.playmode,\n    uid: data.uid,\n    pid: data.pid,\n    host: data.host,\n  };\n  createOneadSlot(global);\n  createAdUnit(global);\n}\n/**\n * @param {!Window} win\n */\nfunction createOneadSlot(win) {\n  const slot = document.createElement('div');\n  slot.id = 'onead-amp';\n  win.document.getElementById('c').appendChild(slot);\n}\n/**\n * @param {!Window} win\n */\nfunction createAdUnit(win) {\n  win.ONEAD_AMP.isAMP = true;\n  const src = 'https://ad-specs.guoshipartners.com/static/js/onead-amp.min.js';\n  const jsLoadCb = () => {\n    win.Guoshi.queryAd.amp.setup({\n      playMode: win.ONEAD_AMP.playMode,\n      uid: win.ONEAD_AMP.uid,\n      pid: win.ONEAD_AMP.pid,\n      host: win.ONEAD_AMP.host,\n    });\n  };\n\n  loadScript(win, src, jsLoadCb);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, validateSrcPrefix, writeScript} from '../../3p/3p';\n\n// Valid OnNetwork movie and ad source hosts\nconst hosts = {\n  video: 'https://video.onnetwork.tv',\n  cdn: 'https://cdn.onnetwork.tv',\n  cdnx: 'https://cdnx.onnetwork.tv',\n  vast: 'https://vast.onnetwork.tv',\n};\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function onnetwork(global, data) {\n  validateData(data, [['src', 'sid', 'mid']]);\n  global.onnetwork = {ampData: data};\n  const {mid, sid, src} = data;\n  let url;\n\n  // Custom movie url using \"data-src\" attribute\n  if (src) {\n    validateSrcPrefix(\n      Object.keys(hosts).map((type) => hosts[type]),\n      src\n    );\n    url = src;\n  }\n  // Movie tag using \"data-sid\" attribute\n  else if (sid) {\n    url = hosts.video + '/embed.php?ampsrc=1&sid=' + encodeURIComponent(sid);\n    // Movie placement using \"data-mid\" attribute\n  } else if (mid) {\n    url = hosts.video + '/embed.php?ampsrc=1&mid=' + encodeURIComponent(mid);\n  }\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function openadstream(global, data) {\n  validateData(data, ['adhost', 'sitepage', 'pos'], ['query']);\n\n  let url =\n    'https://' +\n    encodeURIComponent(data.adhost) +\n    '/3/' +\n    data.sitepage +\n    '/1' +\n    String(Math.random()).substring(2, 11) +\n    '@' +\n    data.pos;\n\n  if (data.query) {\n    url = url + '?' + data.query;\n  }\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {doubleclick} from '../../ads/google/doubleclick';\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\nconst {hasOwnProperty} = Object.prototype;\n\n/**\n * Sort of like Object.assign.\n * @param {!Object} target\n * @param {!Object} source\n * @return {!Object}\n */\nfunction assign(target, source) {\n  for (const prop in source) {\n    if (hasOwnProperty.call(source, prop)) {\n      target[prop] = source[prop];\n    }\n  }\n\n  return target;\n}\n\n/* global OX: false */\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function openx(global, data) {\n  const openxData = ['host', 'nc', 'auid', 'dfpSlot', 'dfp', 'openx'];\n  const dfpData = assign({}, data); // Make a copy for dfp.\n\n  // TODO: check mandatory fields\n  validateData(data, [], openxData);\n  // Consolidate Doubleclick inputs for forwarding -\n  // conversion rules are explained in openx.md.\n  if (data.dfpSlot) {\n    // Anything starting with 'dfp' gets promoted.\n    openxData.forEach((openxKey) => {\n      if (openxKey in dfpData && openxKey !== 'dfp') {\n        if (openxKey.startsWith('dfp')) {\n          // Remove 'dfp' prefix, lowercase the first letter.\n          let fixKey = openxKey.substring(3);\n          fixKey = fixKey.substring(0, 1).toLowerCase() + fixKey.substring(1);\n          dfpData[fixKey] = data[openxKey];\n        }\n        delete dfpData[openxKey];\n      }\n    });\n\n    // Promote the whole 'dfp' object.\n    if ('dfp' in data) {\n      assign(dfpData, dfpData.dfp);\n      delete dfpData['dfp'];\n    }\n  }\n\n  // Decide how to render.\n  if (data.host) {\n    let jssdk = `https://${data.host}/mw/1.0/jstag`;\n\n    if (data.nc && data.dfpSlot) {\n      jssdk += '?nc=' + encodeURIComponent(data.nc);\n      if (data.auid) {\n        advanceImplementation(global, jssdk, dfpData, data);\n      } else {\n        standardImplementation(global, jssdk, dfpData);\n      }\n    } else if (data.auid) {\n      // Just show an ad.\n      global.OX_cmds = [\n        () => {\n          const oxRequest = OX();\n          const oxAnchor = global.document.createElement('div');\n          global.document.body.appendChild(oxAnchor);\n          /*eslint \"google-camelcase/google-camelcase\": 0*/\n          OX._requestArgs['bc'] = 'amp';\n          oxRequest.addAdUnit(data.auid);\n          oxRequest.setAdSizes([data.width + 'x' + data.height]);\n          if (data.openx && data.openx.customVars) {\n            setCustomVars(oxRequest, filterCustomVar(data.openx.customVars));\n          }\n          oxRequest.getOrCreateAdUnit(data.auid).set('anchor', oxAnchor);\n          global.context.renderStart();\n          oxRequest.load();\n        },\n      ];\n      loadScript(global, jssdk);\n    }\n  } else if (data.dfpSlot) {\n    // Fall back to a DFP ad.\n    doubleclick(global, dfpData);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {string} jssdk\n * @param {!Object} dfpData\n */\nfunction standardImplementation(global, jssdk, dfpData) {\n  writeScript(global, jssdk, () => {\n    /*eslint \"google-camelcase/google-camelcase\": 0*/\n    doubleclick(global, dfpData);\n  });\n}\n\n/**\n * @param {!Window} global\n * @param {string} jssdk\n * @param {!Object} dfpData\n * @param {*} data\n */\nfunction advanceImplementation(global, jssdk, dfpData, data) {\n  const size = [data.width + 'x' + data.height];\n  let customVars = {};\n  if (data.openx && data.openx.customVars) {\n    customVars = filterCustomVar(data.openx.customVars);\n  }\n  global.OX_bidder_options = {\n    bidderType: 'hb_amp',\n    callback: () => {\n      const priceMap = global.oxhbjs && global.oxhbjs.getPriceMap();\n      const slot = priceMap && priceMap['c'];\n      const targeting = slot\n        ? `${slot.size}_${slot.price},hb-bid-${slot.bid_id}`\n        : 'none_t';\n      dfpData.targeting = dfpData.targeting || {};\n      assign(dfpData.targeting, {oxb: targeting});\n      doubleclick(global, dfpData);\n    },\n  };\n  global.OX_bidder_ads = [[data.dfpSlot, size, 'c', customVars]];\n  loadScript(global, jssdk);\n}\n\n/**\n * @param {*} oxRequest\n * @param {!Object} customVars\n */\nfunction setCustomVars(oxRequest, customVars) {\n  const customVarKeys = Object.keys(customVars);\n  customVarKeys.forEach((customVarKey) => {\n    const customVarValue = customVars[customVarKey];\n    if (Array.isArray(customVarValue)) {\n      /** @type {!Array} */ (customVarValue).forEach((value) => {\n        oxRequest.addVariable(customVarKey, value);\n      });\n    } else {\n      oxRequest.addVariable(customVarKey, customVarValue);\n    }\n  });\n}\n\n/**\n * @param {!Object} customVars\n * @return {!Object}\n */\nfunction filterCustomVar(customVars) {\n  const filterPattern = /^[A-Za-z0-9._]{1,20}$/;\n  const filteredKeys = Object.keys(customVars).filter((key) =>\n    filterPattern.test(key)\n  );\n  const filteredCustomVar = {};\n  filteredKeys.forEach((key) => {\n    filteredCustomVar[key.toLowerCase()] = customVars[key];\n  });\n  return filteredCustomVar;\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @description Make canonicalUrl available from iframe\n */\nfunction addCanonicalLinkTag(global) {\n  if (global.context.canonicalUrl) {\n    const link = global.document.createElement('link');\n    link.setAttribute('rel', 'canonical');\n    link.setAttribute('href', global.context.canonicalUrl);\n    global.document.head.appendChild(link);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @return {?Node}\n */\nfunction createContainer(global, data) {\n  // create div\n  const div = global.document.createElement('div');\n  if (data.poll) {\n    div.className = 'opinary-widget-embed';\n    div.dataset.customer = data.client;\n    div.dataset.poll = data.poll;\n  } else {\n    div.setAttribute('id', 'opinary-automation-placeholder');\n  }\n\n  return div;\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function opinary(global, data) {\n  validateData(data, ['client']);\n\n  addCanonicalLinkTag(global);\n\n  // c element is created by AMP\n  const c = global.document.getElementById('c');\n\n  // create div to detect if we are in AMP context\n  const isAmp = global.document.createElement('div');\n  isAmp.setAttribute('id', 'opinaryAMP');\n  c.appendChild(isAmp);\n\n  // create div where poll should be shown\n  c.appendChild(createContainer(global, data));\n\n  // load script\n  if (data.poll) {\n    loadScript(global, `https://widgets.opinary.com/embed.js`);\n  } else {\n    loadScript(global, `https://widgets.opinary.com/a/${data.client}.js`);\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function outbrain(global, data) {\n  // ensure we have valid widgetIds value\n  validateData(data, ['widgetids']);\n\n  global._outbrain = global._outbrain || {\n    viewId: global.context.pageViewId,\n    widgetIds: data['widgetids'],\n    htmlURL: data['htmlurl'] || global.context.canonicalUrl,\n    ampURL: data['ampurl'] || global.context.sourceUrl,\n    fbk: data['fbk'] || '',\n    testMode: data['testmode'] || 'false',\n    styleFile: data['stylefile'] || '',\n    referrer: data['referrer'] || global.context.referrer,\n  };\n\n  // load the Outbrain AMP JS file\n  loadScript(\n    global,\n    'https://widgets.outbrain.com/widgetAMP/outbrainAMP.min.js'\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pixels(global, data) {\n  validateData(data, ['origin', 'sid', 'tag'], ['clickTracker', 'viewability']);\n  data.tag = data.tag.toString().toLowerCase();\n  global._pixelsParam = data;\n  if (data.tag === 'sync') {\n    writeScript(\n      global,\n      'https://cdn.adsfactor.net/amp/pixels-amp.min.js',\n      () => {\n        const pixelsAMPAd = global.pixelsAd;\n        const pixelsAMPTag = new pixelsAMPAd(data);\n        pixelsAMPTag.renderAmp(global.context);\n        global.context.renderStart();\n      }\n    );\n  } else {\n    global.context.noContentAvailable();\n  }\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst mandatoryParams = ['id'];\nconst optionalParams = ['fluid'];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function playstream(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global.playstream = {\n    unitData: data['id'],\n    fluid: data['fluid'],\n  };\n  validateData(data, mandatoryParams, optionalParams);\n  const searchParams = new URLSearchParams(data);\n  loadScript(\n    global,\n    'https://app.playstream.media/js/amp.js?' + searchParams.toString()\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function plista(global, data) {\n  // TODO: check mandatory fields\n  validateData(\n    data,\n    [],\n    [\n      'publickey',\n      'widgetname',\n      'urlprefix',\n      'item',\n      'geo',\n      'categories',\n      'countrycode',\n    ]\n  );\n  const div = global.document.createElement('div');\n  div.setAttribute('data-display', 'plista_widget_' + data.widgetname);\n  // container with id \"c\" is provided by amphtml\n  global.document.getElementById('c').appendChild(div);\n  window.PLISTA = {\n    publickey: data.publickey,\n    widgets: [\n      {\n        name: data.widgetname,\n        pre: data.urlprefix,\n      },\n    ],\n    item: data.item,\n    geo: data.geo,\n    categories: data.categories,\n    noCache: true,\n    useDocumentReady: false,\n    dataMode: 'data-display',\n  };\n\n  // load the plista modules asynchronously\n  loadScript(\n    global,\n    'https://static' +\n      (data.countrycode ? '-' + encodeURIComponent(data.countrycode) : '') +\n      '.plista.com/async.js'\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function polymorphicads(global, data) {\n  validateData(data, ['adunit', 'params']);\n  global.polyParam = data;\n  writeScript(global, 'https://www.polymorphicads.jp/js/amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function popin(global, data) {\n  validateData(data, ['mediaid']);\n\n  const d = global.document.createElement('div');\n  d.id = '_popIn_amp_recommend';\n  global.document.getElementById('c').appendChild(d);\n\n  const url =\n    'https://api.popin.cc/searchbox/' +\n    encodeURIComponent(data['mediaid']) +\n    '.js';\n\n  loadScript(global, url);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function postquare(global, data) {\n  validateData(data, ['widgetids']);\n\n  global._postquare = global._postquare || {\n    viewId: global.context.pageViewId,\n    widgetIds: data['widgetids'],\n    websiteId: data['websiteid'],\n    publisherId: data['publisherid'],\n    url: data['url'] || global.context.canonicalUrl,\n    ampURL: data['ampurl'] || global.context.sourceUrl,\n    mode: data['mode'] || 1,\n    style: data['stylecss'] || '',\n    referrer: global.context.referrer,\n  };\n\n  if (data['mode'] == 100) {\n    loadScript(global, 'https://widget.engageya.com/pos_amp_loader.js');\n  } else {\n    loadScript(global, 'https://widget.postquare.com/postquare_amp_loader.js');\n  }\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ppstudio(global, data) {\n  validateData(data, ['crid', 'width', 'height', 'holderScript'], []);\n\n  global._ppstudio = {\n    crid: data.crid,\n    width: data.width,\n    height: data.height,\n    holderScript: data.holderScript,\n  };\n\n  const e = global.document.createElement('script');\n  e.id = 'pps-script-' + data.crid;\n  e.setAttribute('data-width', data.width);\n  e.setAttribute('data-height', data.height);\n  e.setAttribute('data-click-url', '');\n  e.src = data.holderScript;\n  global.document.getElementById('c').appendChild(e);\n\n  const i = global.document.createElement('ins');\n  i.classList.add('ppstudio');\n  i.setAttribute('data-pps-target-id', 'cr-' + data.crid);\n  global.document.getElementById('c').appendChild(i);\n\n  loadScript(global, 'https://ads-cdn.tenmax.io/code/ppstudio.js', () => {\n    global.context.renderStart();\n  });\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pressboard(global, data) {\n  validateData(data, ['media']);\n  data.baseUrl = 'https://sr.studiostack.com';\n  global.pbParams = data;\n  loadScript(\n    global,\n    data.baseUrl + '/js/amp-ad.js',\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\nimport {user} from '../../src/log';\n\nconst TAG = 'PROMOTEIQ';\nconst mandatoryDataFields = ['src', 'params', 'sfcallback'];\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function promoteiq(global, data) {\n  validateData(data, mandatoryDataFields, []);\n  const sfInputs = parseJson(data['params']);\n\n  loadScript(global, data['src'], () => {\n    if (!!global['TagDeliveryContent']) {\n      const sfCallback = new Function('response', data['sfcallback']);\n      global['TagDeliveryContent']['request'](sfInputs, sfCallback);\n    } else {\n      user().error(TAG, 'TagDeliveryContent object not loaded on page');\n    }\n  });\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pubexchange(global, data) {\n  // ensure we have valid widgetIds value\n  validateData(data, ['publication', 'moduleId', 'moduleNum'], ['test']);\n\n  global.PUBX = global.PUBX || {\n    pub: data['publication'],\n    modNum: data['moduleNum'],\n    modId: data['moduleId'],\n    test: data['test'],\n  };\n\n  // load the Outbrain AMP JS file\n  loadScript(global, 'https://main.pubexchange.com/loader-amp.min.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pubguru(global, data) {\n  validateData(data, ['publisher', 'slot']);\n\n  global.$pubguru = data;\n\n  const el = global.document.createElement('div');\n  el.setAttribute('id', 'the-ad-unit');\n\n  global.document.getElementById('c').appendChild(el);\n  loadScript(\n    global,\n    'https://amp.pubguru.org/amp.' +\n      encodeURIComponent(data.publisher) +\n      '.min.js'\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/* global PubMatic: false */\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pubmatic(global, data) {\n  loadScript(global, 'https://ads.pubmatic.com/AdServer/js/amp.js', () => {\n    data.kadpageurl = global.context.sourceUrl || global.context.location.href;\n    PubMatic.showAd(data);\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {CONSENT_POLICY_STATE} from '../../src/core/constants/consent-state';\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst pubmineOptional = ['section', 'pt', 'ht', 'npaOnUnknownConsent'],\n  pubmineRequired = ['siteid'],\n  pubmineURL = 'https://s.pubmine.com/head.js';\n\n/**\n * @param {!Object} data\n * @param {!Window} global\n */\nfunction initMasterFrame(data, global) {\n  /*\n   * INSUFFICIENT and UNKNOWN should be treated as INSUFFICIENT\n   * unless state is UNKNOWN and `data-npa-on-unknown-consent=false`\n   */\n  const paUnknown =\n    data['npaOnUnknownConsent'] !== undefined &&\n    'false' == data['npaOnUnknownConsent'];\n  const ctxt = global.context;\n  const consent =\n    ctxt.initialConsentState === null ||\n    ctxt.initialConsentState === CONSENT_POLICY_STATE.SUFFICIENT ||\n    ctxt.initialConsentState === CONSENT_POLICY_STATE.UNKNOWN_NOT_REQUIRED ||\n    (ctxt.initialConsentState === CONSENT_POLICY_STATE.UNKNOWN && paUnknown);\n\n  global['__ATA_PP'] = {\n    pt: data['pt'] || 1,\n    ht: data['ht'] || 1,\n    tn: 'amp',\n    amp: true,\n    consent: consent ? 1 : 0,\n    siteid: Number(data['siteid']) || undefined,\n  };\n  global['__ATA'] = global['__ATA'] || {};\n  global['__ATA']['cmd'] = global['__ATA']['cmd'] || [];\n  loadScript(global, pubmineURL);\n}\n\n/**\n * @param {string} slotId\n * @param {!Window} global\n */\nfunction createSlot(slotId, global) {\n  const containerEl = global.document.getElementById('c');\n  const adSlot = global.document.createElement('div');\n  adSlot.setAttribute('id', slotId);\n  containerEl.appendChild(adSlot);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pubmine(global, data) {\n  validateData(data, pubmineRequired, pubmineOptional);\n\n  const sectionId = data['siteid'] + (data['section'] || '1');\n\n  const slotConfig = {\n    sectionId,\n    height: data.height == 250 ? 250 : data.height - 15,\n    width: data.width,\n    window: global,\n  };\n\n  const slotId = `atatags-${sectionId}`;\n\n  createSlot(slotId, global);\n  const {isMaster} = global.context;\n  if (isMaster) {\n    initMasterFrame(data, global);\n  }\n  const master = isMaster ? global : global.context.master;\n  master['__ATA']['cmd']['push'](function () {\n    master['__ATA']['insertStyles'](global);\n    master['__ATA']['initSlot'](slotId, slotConfig);\n  });\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function puffnetwork(global, data) {\n  validateData(data, ['chid']);\n  global.pn = data;\n  writeScript(global, 'https://static.puffnetwork.com/amp_ad.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pulse(global, data) {\n  validateData(data, ['sid']);\n  global.pulseInit = data;\n  // load the pulse initializer asynchronously\n  loadScript(global, 'https://static.pulse.mail.ru/pulse-widget-amp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {doubleclick} from '../../ads/google/doubleclick';\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function pulsepoint(global, data) {\n  // TODO: check mandatory fields\n  validateData(data, [], ['pid', 'tagid', 'tagtype', 'slot', 'timeout']);\n  if (data.tagtype === 'hb') {\n    headerBidding(global, data);\n  } else {\n    tag(global, data);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction tag(global, data) {\n  writeScript(\n    global,\n    'https://tag.contextweb.com/getjs.aspx?action=VIEWAD' +\n      '&cwpid=' +\n      encodeURIComponent(data.pid) +\n      '&cwtagid=' +\n      encodeURIComponent(data.tagid) +\n      '&cwadformat=' +\n      encodeURIComponent(data.width + 'X' + data.height)\n  );\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction headerBidding(global, data) {\n  loadScript(global, 'https://ads.contextweb.com/ht.js', () => {\n    const hbConfig = {\n      timeout: data.timeout || 1000,\n      slots: [\n        {\n          cp: data.pid,\n          ct: data.tagid,\n          cf: data.width + 'x' + data.height,\n          placement: data.slot,\n          elementId: 'c',\n        },\n      ],\n      done(targeting) {\n        doubleclick(global, {\n          width: data.width,\n          height: data.height,\n          slot: data.slot,\n          targeting: targeting[data.slot],\n        });\n      },\n    };\n    new window.PulsePointHeaderTag(hbConfig).init();\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, validateSrcPrefix, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function purch(global, data) {\n  validateData(data, [], ['pid', 'divid', 'config']);\n  global.data = data;\n\n  const adsrc = 'https://ramp.purch.com/serve/creative_amp.js';\n  validateSrcPrefix('https:', adsrc);\n  writeScript(global, adsrc);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function quoraad(global, data) {\n  validateData(data, ['adid']);\n  global.ampAdParam = data;\n  writeScript(global, 'https://a.quora.com/amp_ad.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function rakutenunifiedads(global, data) {\n  validateData(data, ['id']);\n  if (hasOwn(data, 'env')) {\n    data.env = `${data.env}-`;\n  } else {\n    data.env = '';\n  }\n  global.runa = data;\n  writeScript(global, `https://${data.env}s-cdn.rmp.rakuten.co.jp/js/amp.js`);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript, validateData, validateSrcPrefix} from '../../3p/3p';\n\nconst jsnPrefix = 'https://rb.infox.sg/';\nconst n = 'infoxContextAsyncCallbacks';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function rbinfox(global, data) {\n  validateData(data, ['src']);\n  const {src} = data;\n  validateSrcPrefix(jsnPrefix, src);\n\n  addToQueue(global, src);\n  loadScript(global, src);\n}\n\n/**\n * @param {!Window} global\n * @param {string} renderTo\n */\nfunction createContainer(global, renderTo) {\n  const d = global.document.createElement('div');\n  d.id = renderTo;\n  global.document.getElementById('c').appendChild(d);\n}\n\n/**\n * @param {string} src\n * @return {string}\n */\nfunction getBlockId(src) {\n  const parts = src.split('/');\n  return parts[parts.length - 1];\n}\n\n/**\n * @param {!Window} global\n * @param {string} src\n */\nfunction addToQueue(global, src) {\n  const blockId = getBlockId(src);\n  const ctx = n + blockId;\n  global[ctx] = global[ctx] || [];\n  global[ctx].push(() => {\n    const renderTo = 'infox_' + blockId;\n    // Create container\n    createContainer(global, renderTo);\n    global['INFOX' + blockId].renderTo(renderTo);\n  });\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst WIDGET_DEFAULT_NODE_ID = 'rcm-widget';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function rcmwidget(global, data) {\n  validateData(\n    data,\n    ['rcmId', 'nodeId', 'blockId', 'templateName', 'projectId'],\n    ['contextItemId']\n  );\n\n  global.rcmWidgetInit = data;\n\n  createContainer(global, data.nodeId);\n\n  // load the rcmwidget initializer asynchronously\n  loadScript(global, 'https://rcmjs.rambler.ru/static/rcmw/rcmw-amp.js');\n}\n\n/**\n * @param {!Window} global\n * @param {string} nodeId\n */\nfunction createContainer(global, nodeId = WIDGET_DEFAULT_NODE_ID) {\n  const container = global.document.createElement('div');\n  container.id = nodeId;\n\n  global.document.getElementById('c').appendChild(container);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function readmo(global, data) {\n  validateData(data, ['section']);\n\n  const config = {\n    container: '#c',\n    amp: true,\n  };\n\n  if (data.url) {\n    global.publisherUrl = data.url;\n  }\n\n  Object.keys(data).forEach((property) => {\n    config[property] = data[property];\n  });\n\n  (global.readmo = global.readmo || []).push(config);\n\n  loadScript(global, 'https://s.yimg.com/dy/ads/readmo.js', () =>\n    global.context.renderStart()\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function realclick(global, data) {\n  validateData(data, ['mcode']);\n  global.rcParams = data;\n  loadScript(global, 'https://ssp.realclick.co.kr/amp/ad.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * Add a container for the recomAD widget,\n * which will be discovered by the script automatically.\n *\n * @param {Element} container\n * @param {string} appId\n * @param {string} widgetId\n * @param {string} searchTerm\n * @param {string} origin\n * @param {string} baseUrl\n * @param {string} puid\n */\nfunction createWidgetContainer(\n  container,\n  appId,\n  widgetId,\n  searchTerm,\n  origin,\n  baseUrl,\n  puid\n) {\n  container.className = 's24widget';\n\n  container.setAttribute('data-app-id', appId);\n  container.setAttribute('data-widget-id', widgetId);\n  searchTerm && container.setAttribute('data-search-term', searchTerm);\n  origin && container.setAttribute('data-origin', origin);\n  baseUrl && container.setAttribute('data-base-url', baseUrl);\n  puid && container.setAttribute('data-puid', puid);\n\n  window.document.body.appendChild(container);\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function recomad(global, data) {\n  validateData(data, ['appId', 'widgetId', ['searchTerm', 'origin']]);\n\n  createWidgetContainer(\n    window.document.createElement('div'),\n    data['appId'],\n    data['widgetId'],\n    data['searchTerm'] || '',\n    data['origin'] || '',\n    data['baseUrl'] || '',\n    data['puid'] || ''\n  );\n\n  loadScript(window, 'https://widget.s24.com/js/s24widget.min.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function recreativ(global, data) {\n  validateData(data, ['bn']);\n  const target = global.document.createElement('div');\n  target.id = 'bn_' + data['bn'];\n  global.document.getElementById('c').appendChild(target);\n\n  loadScript(\n    global,\n    'https://go.rcvlink.com/static/amp.js',\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function relap(global, data) {\n  validateData(data, [], ['token', 'url', 'anchorid', 'version']);\n\n  const urlParam = data['url'] || window.context.canonicalUrl;\n\n  if (data['version'] === 'v7') {\n    window.onRelapAPIReady = function (relapAPI) {\n      relapAPI['init']({\n        token: data['token'],\n        url: urlParam,\n      });\n    };\n\n    window.onRelapAPIInit = function (relapAPI) {\n      relapAPI['addWidget']({\n        cfgId: data['anchorid'],\n        anchorEl: global.document.getElementById('c'),\n        position: 'append',\n        events: {\n          onReady: function () {\n            window.context.renderStart();\n          },\n          onNoContent: function () {\n            window.context.noContentAvailable();\n          },\n        },\n      });\n    };\n\n    loadScript(global, 'https://relap.io/v7/relap.js');\n  } else {\n    window.relapV6WidgetReady = function () {\n      window.context.renderStart();\n    };\n\n    window.relapV6WidgetNoSimilarPages = function () {\n      window.context.noContentAvailable();\n    };\n\n    const anchorEl = global.document.createElement('div');\n    anchorEl.id = data['anchorid'];\n    global.document.getElementById('c').appendChild(anchorEl);\n\n    const url = `https://relap.io/api/v6/head.js?token=${encodeURIComponent(\n      data['token']\n    )}&url=${encodeURIComponent(urlParam)}`;\n    loadScript(global, url);\n  }\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function relappro(global, data) {\n  validateData(data, [], ['slotId', 'nameAdUnit', 'requirements']);\n  global.params = data;\n\n  loadScript(\n    global,\n    'https://cdn.relappro.com/adservices/amp/relappro.amp.min.js'\n  );\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS-IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function remixd(global, data) {\n  global._rmxd = {};\n  global._rmxd.url = data.url || global.context.sourceUrl;\n  global._rmxd.amp = true;\n  const sriptVersion = data.version || '5';\n  const tagUrl =\n    'https://tags.remixd.com/player/v' +\n    sriptVersion +\n    '/index.js?cb=' +\n    Math.random();\n\n  document.write(\n    '<' +\n      'script src=\"' +\n      encodeURI(tagUrl) +\n      '\" id=\"remixd-audio-player-script\"><' +\n      '/script>'\n  );\n  global.context.renderStart();\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function revcontent(global, data) {\n  let endpoint =\n    'https://labs-cdn.revcontent.com/build/amphtml/revcontent.amp.min.js';\n\n  if (typeof data.revcontent !== 'undefined') {\n    if (typeof data.env === 'undefined') {\n      endpoint = 'https://assets.revcontent.com/master/delivery.js';\n    } else if (data.env == 'dev') {\n      endpoint = 'https://performante.revcontent.dev/delivery.js';\n    } else {\n      endpoint = 'https://assets.revcontent.com/' + data.env + '/delivery.js';\n    }\n  }\n\n  const required = ['id', 'height'];\n  const optional = [\n    'wrapper',\n    'subIds',\n    'revcontent',\n    'env',\n    'loadscript',\n    'api',\n    'key',\n    'ssl',\n    'adxw',\n    'adxh',\n    'rows',\n    'cols',\n    'domain',\n    'source',\n    'testing',\n    'endpoint',\n    'publisher',\n    'branding',\n    'font',\n    'css',\n    'sizer',\n    'debug',\n    'ampcreative',\n    'gdpr',\n    'gdprConsent',\n    'usPrivacy',\n  ];\n\n  data.endpoint = data.endpoint ? data.endpoint : 'trends.revcontent.com';\n\n  validateData(data, required, optional);\n  global.data = data;\n  if (data.loadscript) {\n    loadScript(window, endpoint);\n  } else {\n    writeScript(window, endpoint);\n  }\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function revjet(global, data) {\n  validateData(data, ['tag', 'key'], ['plc', 'opts', 'params']);\n\n  global._revjetData = {...data};\n\n  loadScript(\n    global,\n    'https://cdn.revjet.com/~cdn/JS/03/amp.js',\n    /* opt_cb */ undefined,\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function rfp(global, data) {\n  validateData(data, ['adspotId'], ['stylesheetUrl', 'country']);\n  global.rfpData = data;\n  writeScript(global, 'https://js.rfp.fout.jp/rfp-amp.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData, validateSrcPrefix} from '../../3p/3p';\n\nconst jsnPrefix = 'https://api.rnet.plus/';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function rnetplus(global, data) {\n  validateData(data, ['src']);\n  const {src} = data;\n  validateSrcPrefix(jsnPrefix, src);\n  createContainer(global, 'rnetplus_' + getBlockId(src));\n  loadScript(global, src);\n}\n\n/**\n * @param {!Window} global\n * @param {string} renderTo\n */\nfunction createContainer(global, renderTo) {\n  const d = global.document.createElement('div');\n  d.id = renderTo;\n  global.document.getElementById('c').appendChild(d);\n}\n\n/**\n * @param {string} src\n * @return {string}\n */\nfunction getBlockId(src) {\n  const parts = src.split('?');\n  const vars = parts[1].split('&');\n  for (let j = 0; j < vars.length; ++j) {\n    const pair = vars[j].split('=');\n    if (pair[0] == 'blockId') {\n      return pair[1];\n    }\n  }\n  return '660';\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function rubicon(global, data) {\n  // TODO: check mandatory fields\n  validateData(\n    data,\n    [],\n    [\n      'account',\n      'site',\n      'zone',\n      'size',\n      'kw',\n      'visitor',\n      'inventory',\n      'method',\n      'callback',\n    ]\n  );\n\n  if (data.method === 'smartTag') {\n    smartTag(global, data);\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction smartTag(global, data) {\n  /* eslint-disable */\n  global.rp_account = data.account;\n  global.rp_site = data.site;\n  global.rp_zonesize = data.zone + '-' + data.size;\n  global.rp_adtype = 'js';\n  global.rp_page = context.sourceUrl;\n  global.rp_kw = data.kw;\n  global.rp_visitor = data.visitor;\n  global.rp_inventory = data.inventory;\n  global.rp_amp = 'st';\n  global.rp_callback = data.callback;\n  /* eslint-enable */\n  writeScript(\n    global,\n    'https://ads.rubiconproject.com/ad/' +\n      encodeURIComponent(data.account) +\n      '.js'\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\nconst requiredParams = ['spot'];\nconst optionsParams = [\n  'keywords',\n  'adType',\n  'param1',\n  'param2',\n  'param3',\n  'subid',\n  'cols',\n  'rows',\n  'title',\n  'titlePosition',\n  'adsByPosition',\n];\nconst adContainerId = 'runative_id';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function runative(global, data) {\n  // ensure we have valid widgetIds value\n  validateData(data, requiredParams, optionsParams);\n\n  const adContainer = global.document.getElementById('c');\n  const adNativeContainer = getAdContainer(global);\n  const initScript = getInitAdScript(global, data);\n\n  adContainer.appendChild(adNativeContainer);\n\n  // load the RUNative AMP JS file\n  loadScript(global, '//cdn.run-syndicate.com/sdk/v1/n.js', () => {\n    global.document.body.appendChild(initScript);\n  });\n}\n\n/**\n * @param {!Object} data\n * @return {JsonObject}\n */\nfunction getInitData(data) {\n  const initKeys = requiredParams.concat(optionsParams);\n  const initParams = {};\n\n  initKeys.forEach((key) => {\n    if (key in data) {\n      const initKey = key === 'adType' ? 'type' : key;\n\n      initParams[initKey] = data[key];\n    }\n  });\n\n  initParams['element_id'] = adContainerId;\n\n  return parseJson(initParams);\n}\n\n/**\n * @param {!Window} global\n * @return {?Node}\n */\nfunction getAdContainer(global) {\n  const container = global.document.createElement('div');\n\n  container['id'] = adContainerId;\n\n  return container;\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @return {?Node}\n */\nfunction getInitAdScript(global, data) {\n  const scriptElement = global.document.createElement('script');\n  const initData = getInitData(data);\n  const initScript = global.document.createTextNode(\n    `NativeAd(${JSON.stringify(initData)});`\n  );\n\n  scriptElement.appendChild(initScript);\n\n  return scriptElement;\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview CoRe responsive functions that are shared with Google tag code.\n * This file must not depend on any AMP-specific libraries, e.g. log. If\n * there is a need to pass any things for logging/reporting - the values\n * must be returned from exported functions.\n */\n\n/**\n * Layout types for Content Recommendation responsive.\n * @enum {string}\n */\nexport const LayoutType = {\n  IMAGE_STACKED: 'image_stacked',\n  IMAGE_SIDEBYSIDE: 'image_sidebyside',\n  MOBILE_BANNER_IMAGE_SIDEBYSIDE: 'mobile_banner_image_sidebyside',\n  PUB_CONTROL_IMAGE_STACKED: 'pub_control_image_stacked',\n  PUB_CONTROL_IMAGE_SIDEBYSIDE: 'pub_control_image_sidebyside',\n  PUB_CONTROL_IMAGE_CARD_STACKED: 'pub_control_image_card_stacked',\n  PUB_CONTROL_IMAGE_CARD_SIDEBYSIDE: 'pub_control_image_card_sidebyside',\n  PUB_CONTROL_TEXT: 'pub_control_text',\n  PUB_CONTROL_TEXT_CARD: 'pub_control_text_card',\n  PEDESTAL: 'pedestal',\n};\n\n/**\n * The external name of Core Pub Control UI pub vars, which are used by\n * publishers directly.\n * @enum {string}\n */\nexport const ExternalCorePubVars = {\n  UI_TYPE: 'data-matched-content-ui-type',\n  COLUMNS_NUM: 'data-matched-content-columns-num',\n  ROWS_NUM: 'data-matched-content-rows-num',\n};\n\n/**\n * Minimum width of desktop responsive slot in CoRe responsive. We have\n * different logic for desktop and mobile slots. Any slot width equal or larger\n * than this will be adapted to the desktop logic while any slot width smaller\n * than this will be adapted to the mobile logic.\n * @const {number}\n */\nexport const MIN_PUB_CONTROL_WIDTH_OF_DESKTOP = 468;\n\n/**\n * The px padding.\n * @const {number}\n */\nconst PADDING = 8;\n\n/**\n * The maximum dimension for CoRe Pub Control UI layout.\n * @const {number}\n */\nconst MAX_PUB_CONTROL_DIMENSION = 1500;\n\n/**\n * The layout - aspect ratio map to calculate the size of each content\n * recommendation.\n * image_stacked: https://screenshot.googleplex.com/74S09gFO82b\n * image_sidebyside: https://screenshot.googleplex.com/FUgDSDvwcVo\n * image_card_stacked: https://screenshot.googleplex.com/vedjTonVaDT\n * image_card_sidebyside: https://screenshot.googleplex.com/v3qOZY61tFm\n * text: https://screenshot.googleplex.com/taeRQn7DUhq\n * text_card: https://screenshot.googleplex.com/ur45m96Tv0D\n * @const {!Object<!LayoutType, number>}\n */\nconst LAYOUT_ASPECT_RATIO_MAP = {\n  [LayoutType.IMAGE_STACKED]: 1 / 1.91,\n  [LayoutType.IMAGE_SIDEBYSIDE]: 1 / 3.82,\n  [LayoutType.MOBILE_BANNER_IMAGE_SIDEBYSIDE]: 1 / 3.82,\n  [LayoutType.PUB_CONTROL_IMAGE_STACKED]: 1 / 1.91,\n  [LayoutType.PUB_CONTROL_IMAGE_SIDEBYSIDE]: 1 / 3.82,\n  [LayoutType.PUB_CONTROL_IMAGE_CARD_STACKED]: 1 / 1.91,\n  [LayoutType.PUB_CONTROL_IMAGE_CARD_SIDEBYSIDE]: 1 / 3.74,\n  [LayoutType.PUB_CONTROL_TEXT]: 0,\n  [LayoutType.PUB_CONTROL_TEXT_CARD]: 0,\n};\n\n/**\n * The layout - height map to evaluate the height of title + url. Notice, this\n * mainly works only for stacked mode. In sidebyside mode, this height is\n * decided by the height of image. It equals to:\n * FontSize * LineHeight * NumTitle + Padding * 2 + UrlBoxHeight.\n * image_stacked: https://screenshot.googleplex.com/74S09gFO82b\n * image_card_stacked: https://screenshot.googleplex.com/vedjTonVaDT\n * @const {!Object<!LayoutType, number>}\n */\nconst LAYOUT_TEXT_HEIGHT_MAP = {\n  [LayoutType.IMAGE_STACKED]: 80,\n  [LayoutType.IMAGE_SIDEBYSIDE]: 0,\n  [LayoutType.MOBILE_BANNER_IMAGE_SIDEBYSIDE]: 0,\n  [LayoutType.PUB_CONTROL_IMAGE_STACKED]: 80,\n  [LayoutType.PUB_CONTROL_IMAGE_SIDEBYSIDE]: 0,\n  [LayoutType.PUB_CONTROL_IMAGE_CARD_STACKED]: 85,\n  [LayoutType.PUB_CONTROL_IMAGE_CARD_SIDEBYSIDE]: 0,\n  [LayoutType.PUB_CONTROL_TEXT]: 80,\n  [LayoutType.PUB_CONTROL_TEXT_CARD]: 80,\n};\n\n/**\n * The layout - minimal width map for pub control UIs. We will adjust column\n * numbers according to minimal width.\n * @const {!Object<!LayoutType, number>}\n */\nconst LAYOUT_AD_WIDTH_MAP = {\n  [LayoutType.PUB_CONTROL_IMAGE_STACKED]: 100,\n  [LayoutType.PUB_CONTROL_IMAGE_SIDEBYSIDE]: 200,\n  [LayoutType.PUB_CONTROL_IMAGE_CARD_STACKED]: 150,\n  [LayoutType.PUB_CONTROL_IMAGE_CARD_SIDEBYSIDE]: 250,\n  [LayoutType.PUB_CONTROL_TEXT]: 100,\n  [LayoutType.PUB_CONTROL_TEXT_CARD]: 150,\n};\n\nconst PUB_CONTROL_LAYOUT_PREFIX = 'pub_control_';\n\nconst PUB_CONTROL_EXAMPLE =\n  '\\n ' +\n  'data-matched-content-rows-num=\"4,2\"\\n' +\n  'data-matched-content-columns-num=\"1,6\"\\n' +\n  'data-matched-content-ui-type=\"image_stacked,image_card_sidebyside\"';\n\n/**\n * Configuration of content recommendation unit for current slot. This is the\n * result of running CoRe responsive logic and values from this config\n * will be used in ad request.\n * @record\n */\nexport class CoReConfig {\n  /** see comment on class */\n  constructor() {\n    /** @const {number} */\n    this.slotWidth;\n\n    /** @const {number} */\n    this.slotHeight;\n\n    /**\n     * Number of rows to return in matched content unit. Corresponds to\n     * \"cr_col\" url param.\n     * @const {number}\n     */\n    this.numberOfRows;\n\n    /**\n     * Number of columns to return in matched content unit. Corresponds to\n     * \"cr_row\" url param.\n     * @const {number}\n     */\n    this.numberOfColumns;\n\n    /**\n     * Layout type to use for currect matched content slot. Corresponds to\n     * \"crui\" url param.\n     * @const {!LayoutType}\n     */\n    this.layoutType;\n\n    /**\n     * If not null then it contains an error that some of the provided\n     * parameters are incorrect. The error is intended to be displayed to\n     * developers who setup ad tag. For example it can displayed in console\n     * or thrown as js error. If validation is set other params should be\n     * ignored.\n     * @const {string|undefined}\n     */\n    this.validationError;\n  }\n}\n\n/**\n * @param {number} availableWidth\n * @param {boolean} isMobile\n * @return {!CoReConfig}\n */\nexport function getAutoConfig(availableWidth, isMobile) {\n  if (availableWidth < MIN_PUB_CONTROL_WIDTH_OF_DESKTOP) {\n    if (isMobile) {\n      const layoutType = LayoutType.MOBILE_BANNER_IMAGE_SIDEBYSIDE;\n      const numColumns = 1;\n      const numRows = 12;\n      const slotSize = getLargerAdOneColumnSidebysideSize(\n        availableWidth,\n        layoutType,\n        numColumns,\n        numRows\n      );\n      return {\n        slotWidth: slotSize.width,\n        slotHeight: slotSize.height,\n        numberOfColumns: numColumns,\n        numberOfRows: numRows,\n        layoutType,\n      };\n    } else {\n      const slotSize = getAutoSlotSize(availableWidth);\n      return {\n        slotWidth: slotSize.width,\n        slotHeight: slotSize.height,\n        numberOfColumns: 1,\n        numberOfRows: 13,\n        layoutType: LayoutType.IMAGE_SIDEBYSIDE,\n      };\n    }\n  } else {\n    const slotSize = getAutoSlotSize(availableWidth);\n    return {\n      slotWidth: slotSize.width,\n      slotHeight: slotSize.height,\n      numberOfColumns: 4,\n      numberOfRows: 2,\n      layoutType: LayoutType.IMAGE_STACKED,\n    };\n  }\n}\n\n/**\n * Parameters for matched content unit provided pub publisher. These\n * parameters are read from ad tag. These are unparsed parameters so they\n * might be invalid.\n *\n * @typedef {{\n *   numberOfRows: (string|undefined),\n *   numberOfColumns: (string|undefined),\n *   layoutType: (string|undefined),\n * }}\n */\nexport let RawPublisherControlParams;\n\n/**\n * Get CoRe Pub Control UI Sizes.\n * @param {number} availableWidth\n * @param {!RawPublisherControlParams} rawPubControlParams\n * @return {!CoReConfig}\n */\nexport function getPubControlConfig(availableWidth, rawPubControlParams) {\n  const pubParams = validateAndParsePubControlParams(rawPubControlParams);\n  if (pubParams.validationError) {\n    return {\n      slotWidth: 0,\n      slotHeight: 0,\n      numberOfColumns: 0,\n      numberOfRows: 0,\n      // set any layout, doesn't matter because it's error and it won't be used\n      // anyway\n      layoutType: LayoutType.IMAGE_STACKED,\n      validationError: pubParams.validationError,\n    };\n  }\n\n  let index;\n  if (\n    pubParams.layoutTypes.length === 2 &&\n    availableWidth >= MIN_PUB_CONTROL_WIDTH_OF_DESKTOP\n  ) {\n    // Publisher provided settings for both mobile and desktop and screen is\n    // wide - use desktop.\n    index = 1;\n  } else {\n    // Either publisher provided only one setting or screen is small so use\n    // first setting.\n    index = 0;\n  }\n\n  const layout = convertToPubControlLayoutType(pubParams.layoutTypes[index]);\n  const numColumns = getOptimizedNumColumns(\n    availableWidth,\n    pubParams.numberOfColumns[index],\n    layout\n  );\n  const numRows = pubParams.numberOfRows[index];\n\n  const slotSize = getPubControlSlotSize(\n    availableWidth,\n    numColumns,\n    numRows,\n    layout\n  );\n  if (slotSize.sizeError) {\n    return {\n      slotWidth: 0,\n      slotHeight: 0,\n      numberOfColumns: 0,\n      numberOfRows: 0,\n      layoutType: layout,\n      validationError: slotSize.sizeError,\n    };\n  }\n  return {\n    slotWidth: slotSize.width,\n    slotHeight: slotSize.height,\n    numberOfColumns: numColumns,\n    numberOfRows: numRows,\n    layoutType: layout,\n  };\n}\n\n/**\n * Validates and parses parameters that publisher specified on the ad tag via\n * data-matched-content-foo attributes.\n * @param {!RawPublisherControlParams} params\n * @return {{\n *   numberOfRows: (!Array<number>|undefined),\n *   numberOfColumns: (!Array<number>|undefined),\n *   layoutTypes: (!Array<!LayoutType>|undefined),\n *   validationError: (string|undefined),\n * }} parsed params or null if they were invalid.\n */\nfunction validateAndParsePubControlParams(params) {\n  // Verify that either all three parameters passed or none.\n  let numberOfPubControlParams = 0;\n  if (params.layoutType) {\n    numberOfPubControlParams++;\n  }\n  if (params.numberOfColumns) {\n    numberOfPubControlParams++;\n  }\n  if (params.numberOfRows) {\n    numberOfPubControlParams++;\n  }\n  if (numberOfPubControlParams < 3) {\n    return {\n      validationError: `Tags ${ExternalCorePubVars.UI_TYPE}, ${ExternalCorePubVars.COLUMNS_NUM} and ${ExternalCorePubVars.ROWS_NUM} should be set together.`,\n    };\n  }\n\n  const /** !Array<!LayoutType> */ layoutTypes = params.layoutType.split(',');\n  const /** !Array<string> */ numberOfRows = params.numberOfRows.split(',');\n  const /** !Array<string> */ numberOfColumns =\n      params.numberOfColumns.split(',');\n\n  // Check all params have same length.\n  if (\n    layoutTypes.length !== numberOfRows.length ||\n    layoutTypes.length !== numberOfColumns.length\n  ) {\n    return {\n      validationError: `Lengths of parameters ${ExternalCorePubVars.UI_TYPE}, ${ExternalCorePubVars.COLUMNS_NUM} and ${ExternalCorePubVars.ROWS_NUM} must match. Example: ${PUB_CONTROL_EXAMPLE}`,\n    };\n  }\n\n  if (layoutTypes.length > 2) {\n    return {\n      validationError:\n        `The parameter length of attribute ${ExternalCorePubVars.UI_TYPE}, ${ExternalCorePubVars.COLUMNS_NUM} and ${ExternalCorePubVars.ROWS_NUM} is too long. At most 2 parameters for each ` +\n        'attribute are needed: one for mobile and one for desktop, while ' +\n        `you are providing ${layoutTypes.length} parameters. Example: ${PUB_CONTROL_EXAMPLE}.`,\n    };\n  }\n\n  const /** !Array<number> */ numberOfRowsAsNumbers = [];\n  const /** !Array<number> */ numberOfColumnsAsNumbers = [];\n  for (let i = 0; i < layoutTypes.length; i++) {\n    const row = Number(numberOfRows[i]);\n    if (isNaN(row) || row === 0) {\n      return {\n        validationError: `Wrong value '${numberOfRows[i]}' for ${ExternalCorePubVars.ROWS_NUM}.`,\n      };\n    }\n    numberOfRowsAsNumbers.push(row);\n    const col = Number(numberOfColumns[i]);\n    if (isNaN(col) || col === 0) {\n      return {\n        validationError: `Wrong value '${numberOfColumns[i]}' for ${ExternalCorePubVars.COLUMNS_NUM}.`,\n      };\n    }\n    numberOfColumnsAsNumbers.push(col);\n  }\n  return {\n    numberOfRows: numberOfRowsAsNumbers,\n    numberOfColumns: numberOfColumnsAsNumbers,\n    layoutTypes,\n  };\n}\n\n/**\n * @param {number} availableWidth\n * @return {{width: number, height: number}}\n */\nfunction getAutoSlotSize(availableWidth) {\n  if (availableWidth >= 1200) {\n    return {width: 1200, height: 600};\n  } else if (availableWidth >= 850) {\n    return {width: availableWidth, height: Math.floor(availableWidth * 0.5)};\n  } else if (availableWidth >= 550) {\n    return {width: availableWidth, height: Math.floor(availableWidth * 0.6)};\n  } else if (availableWidth >= 468) {\n    return {width: availableWidth, height: Math.floor(availableWidth * 0.7)};\n  } else {\n    return {width: availableWidth, height: Math.floor(availableWidth * 3.44)};\n  }\n}\n\n/**\n * Calculate the ad height according to the layout and ad width.\n * @param {number} adWidth\n * @param {!LayoutType} layout\n * @return {number}\n */\nfunction getAdHeight(adWidth, layout) {\n  return (\n    adWidth * LAYOUT_ASPECT_RATIO_MAP[layout] + LAYOUT_TEXT_HEIGHT_MAP[layout]\n  );\n}\n\n/**\n * Calculate the core width according to the slot width and number\n * of columns.\n * @param {number} slotWidth\n * @param {number} numColumns\n * @return {number}\n */\nfunction getAdWidth(slotWidth, numColumns) {\n  return (slotWidth - PADDING * numColumns - PADDING) / numColumns;\n}\n\n/**\n * Calculate the core slot height according to the core height and\n * number of rows.\n * @param {number} adHeight\n * @param {number} numRows\n * @return {number}\n */\nfunction getSlotHeight(adHeight, numRows) {\n  return Math.floor(adHeight * numRows + PADDING * numRows + PADDING);\n}\n\n/**\n * Calculate the slot size for Pub Control UI.\n * @param {number} slotWidth\n * @param {number} numColumns\n * @param {number} numRows\n * @param {!LayoutType} layout\n * @return {{\n *   width: number,\n *   height: number,\n *   sizeError: (string|undefined),\n * }}\n */\nfunction getPubControlSlotSize(slotWidth, numColumns, numRows, layout) {\n  const adWidth = getAdWidth(slotWidth, numColumns);\n  const adHeight = getAdHeight(adWidth, layout);\n  const slotHeight = getSlotHeight(adHeight, numRows);\n\n  if (slotWidth > MAX_PUB_CONTROL_DIMENSION) {\n    return {\n      width: 0,\n      height: 0,\n      sizeError: 'Calculated slot width is too large: ' + slotWidth,\n    };\n  }\n  if (slotHeight > MAX_PUB_CONTROL_DIMENSION) {\n    return {\n      width: 0,\n      height: 0,\n      sizeError: 'Calculated slot height is too large: ' + slotHeight,\n    };\n  }\n\n  return {width: slotWidth, height: slotHeight};\n}\n\n/**\n * @param {number} availableWidth\n * @param {!LayoutType} layoutType\n * @param {number} numColumns\n * @param {number} numRows\n * @return {{width: number, height: number}}\n */\nfunction getLargerAdOneColumnSidebysideSize(\n  availableWidth,\n  layoutType,\n  numColumns,\n  numRows\n) {\n  const adWidth = getAdWidth(availableWidth, numColumns);\n  // The title height of first ad slot 70px, should be consistent with what we\n  // define in rendering js.\n  const firstAdHeight = Math.floor(adWidth / 1.91 + 70);\n  const restAdHeight = getAdHeight(adWidth, layoutType);\n  const slotHeight = firstAdHeight + getSlotHeight(restAdHeight, numRows - 1);\n\n  return {width: availableWidth, height: slotHeight};\n}\n\n/**\n * Adds 'pub_control_' prefix to Pub Control UI layout name if the layout name\n * does not have 'pub_control_' prefix. This is to differentiate Pub Control UI\n * from responsive auto UI.\n * @param {!LayoutType} layout\n * @return {!LayoutType} the new layout name with 'pub_control_' prefix.\n */\nfunction convertToPubControlLayoutType(layout) {\n  return layout.indexOf(PUB_CONTROL_LAYOUT_PREFIX) === 0\n    ? layout\n    : /** @type {!LayoutType} */ (PUB_CONTROL_LAYOUT_PREFIX + layout);\n}\n\n/**\n * Gets optimized number of columns. If the publisher specified value of\n * 'data-matched-content-columns-num' is too large, it may result in a very\n * small ad width and broken layout. We will adjust the column number to ensure\n * that ad width is larger than certain threshold and print out some warning\n * message to the console.\n * @param {number} availableWidth\n * @param {number} numColumns\n * @param {!LayoutType} layout\n * @return {number} optimized number of columns\n */\nfunction getOptimizedNumColumns(availableWidth, numColumns, layout) {\n  const minWidth = LAYOUT_AD_WIDTH_MAP[layout];\n  let optimizedNumColumns = numColumns;\n  while (\n    availableWidth / optimizedNumColumns < minWidth &&\n    optimizedNumColumns > 1\n  ) {\n    optimizedNumColumns--;\n  }\n  return optimizedNumColumns;\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {\n  ExternalCorePubVars,\n  MIN_PUB_CONTROL_WIDTH_OF_DESKTOP,\n  getAutoConfig,\n  getPubControlConfig,\n} from './a4a/shared/content-recommendation.js';\nimport {user} from '../../src/log';\n\n/**\n * Approved height for AdSense full-width responsive ads.\n * @const {number}\n */\nexport const ADSENSE_RSPV_ALLOWED_HEIGHT = 320;\n\n/**\n * The attribute value for AdSense data-auto-format tag.\n * For full-width responsive ad: data-auto-format='rspv'.\n * For full-width matched content responsive ad: data-auto-format='mcrspv'\n * @const {string}\n */\nexport const ADSENSE_RSPV_TAG = 'rspv';\nexport const ADSENSE_MCRSPV_TAG = 'mcrspv';\n\n/**\n * Given the amp-ad data attribute containing the multi-size dimensions, and a\n * set of primary dimensions, this function will return all valid multi-size\n * [width, height] pairs in an array.\n *\n * @param {string} multiSizeDataStr The amp-ad data attribute containing the\n *   multi-size dimensions.\n * @param {number} primaryWidth The primary width of the ad slot.\n * @param {number} primaryHeight The primary height of the ad slot.\n * @param {boolean} multiSizeValidation A flag that if set to true will enforce\n *   the rule that ensures multi-size dimensions are no less than 2/3rds of\n *   their primary dimension's counterpart.\n * @param {boolean=} isFluidPrimary Indicates whether the ad slot's primary\n *   size is fluid.\n * @return {?Array<!Array<number>>} An array of dimensions.\n */\nexport function getMultiSizeDimensions(\n  multiSizeDataStr,\n  primaryWidth,\n  primaryHeight,\n  multiSizeValidation,\n  isFluidPrimary = false\n) {\n  const dimensions = [];\n  const arrayOfSizeStrs = multiSizeDataStr.split(',');\n\n  for (let i = 0; i < arrayOfSizeStrs.length; i++) {\n    const sizeStr = arrayOfSizeStrs[i];\n    if (sizeStr.toLowerCase() == 'fluid') {\n      // Fluid dummy sizes should be appended to the front of the request\n      // parameter, so they must be handled elsewhere.\n      continue;\n    }\n    const size = sizeStr.split('x');\n\n    // Make sure that each size is specified in the form WxH.\n    if (size.length != 2) {\n      user().error('AMP-AD', `Invalid multi-size data format '${sizeStr}'.`);\n      continue;\n    }\n\n    const width = Number(size[0]);\n    const height = Number(size[1]);\n\n    // Make sure that both dimensions given are positive numbers.\n    if (\n      !validateDimensions(\n        width,\n        height,\n        (w) => isNaN(w) || w <= 0,\n        (h) => isNaN(h) || h <= 0,\n        (badParams) =>\n          badParams\n            .map(\n              (badParam) =>\n                `Invalid ${badParam.dim} of ${badParam.val} ` +\n                'given for secondary size.'\n            )\n            .join(' ')\n      )\n    ) {\n      continue;\n    }\n\n    // Check that secondary size is not larger than primary size.\n    if (\n      !isFluidPrimary &&\n      !validateDimensions(\n        width,\n        height,\n        (w) => w > primaryWidth,\n        (h) => h > primaryHeight,\n        (badParams) =>\n          badParams\n            .map(\n              (badParam) =>\n                `Secondary ${badParam.dim} ${badParam.val} ` +\n                `can't be larger than the primary ${badParam.dim}.`\n            )\n            .join(' ')\n      )\n    ) {\n      continue;\n    }\n\n    // Check that if multi-size-validation is on, that the secondary sizes\n    // are at least minRatio of the primary size.\n    if (multiSizeValidation) {\n      // The minimum ratio of each secondary dimension to its corresponding\n      // primary dimension.\n      const minRatio = 2 / 3;\n      const minWidth = minRatio * primaryWidth;\n      const minHeight = minRatio * primaryHeight;\n      if (\n        !validateDimensions(\n          width,\n          height,\n          (w) => w < minWidth,\n          (h) => h < minHeight,\n          (badParams) =>\n            badParams\n              .map(\n                (badParam) =>\n                  `Secondary ${badParam.dim} ${badParam.val} is ` +\n                  `smaller than 2/3rds of the primary ${badParam.dim}.`\n              )\n              .join(' ')\n        )\n      ) {\n        continue;\n      }\n    }\n\n    // Passed all checks! Push additional size to dimensions.\n    dimensions.push([width, height]);\n  }\n\n  return dimensions;\n}\n\n/**\n * A helper function for determining whether a given width or height violates\n * some condition.\n *\n * Checks the width and height against their corresponding conditions. If\n * either of the conditions fail, the errorBuilder function will be called with\n * the appropriate arguments, its result will be logged to user().error, and\n * validateDimensions will return false. Otherwise, validateDimensions will\n * only return true.\n *\n * @param {(number|string)} width\n * @param {(number|string)} height\n * @param {function((number|string)): boolean} widthCond\n * @param {function((number|string)): boolean} heightCond\n * @param {function(!Array<{dim: string, val: (number|string)}>): string=} errorBuilder\n * A function that will produce an informative error message.\n * @return {boolean}\n */\nfunction validateDimensions(\n  width,\n  height,\n  widthCond,\n  heightCond,\n  errorBuilder\n) {\n  const badParams = [];\n  if (widthCond(width)) {\n    badParams.push({dim: 'width', val: width});\n  }\n  if (heightCond(height)) {\n    badParams.push({dim: 'height', val: height});\n  }\n  if (badParams.length) {\n    user().warn('AMP-AD', errorBuilder(badParams));\n  }\n  return !badParams.length;\n}\n\n/**\n * Calculates height of responsive matched content slot based on its width.\n * This logic should be kept as close to possible to the logic inside\n * adsbygoogle.js.\n *\n * @param {number} availableWidth\n * @param {!Element} element <amp-ad> tag which contains publisher settings\n *     if any.\n * @return {number} height to use for the matched content slot.\n */\nexport function getMatchedContentResponsiveHeightAndUpdatePubParams(\n  availableWidth,\n  element\n) {\n  const pubControlParams = {\n    numberOfRows: element.getAttribute(ExternalCorePubVars.ROWS_NUM),\n    numberOfColumns: element.getAttribute(ExternalCorePubVars.COLUMNS_NUM),\n    layoutType: element.getAttribute(ExternalCorePubVars.UI_TYPE),\n  };\n  let config;\n  if (\n    pubControlParams.numberOfRows ||\n    pubControlParams.numberOfColumns ||\n    pubControlParams.layoutType\n  ) {\n    // Publisher provided at least 1 param  which means we are in\n    // \"pub controlled matched content\" mode.\n    config = getPubControlConfig(availableWidth, pubControlParams);\n  } else {\n    // Publisher didn't provide any matched content params so use auto mode.\n    config = getAutoConfig(\n      availableWidth,\n      availableWidth <= MIN_PUB_CONTROL_WIDTH_OF_DESKTOP\n    );\n  }\n  if (config.validationError) {\n    user().error('AMP-AD', config.validationError);\n    // There was an error in pub params and we logged it in console.\n    // Return 0 as height to hide slot.\n    return 0;\n  }\n  element.setAttribute(ExternalCorePubVars.ROWS_NUM, config.numberOfRows);\n  element.setAttribute(ExternalCorePubVars.COLUMNS_NUM, config.numberOfColumns);\n  element.setAttribute(ExternalCorePubVars.UI_TYPE, config.layoutType);\n\n  return config.slotHeight;\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMultiSizeDimensions} from '../../ads/google/utils';\nimport {parseJson} from '../../src/core/types/object/json';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sas(global, data) {\n  let url, adHost, whSize;\n  const plainFields = ['site', 'area', 'mid'];\n  validateData(\n    data,\n    ['customerName'],\n    ['adHost', 'site', 'size', 'area', 'mid', 'tags', 'multiSize']\n  );\n\n  if (typeof data.adHost === 'undefined') {\n    adHost = encodeURIComponent(data['customerName']) + '-ads.aimatch.com';\n  } else {\n    adHost = encodeURIComponent(data['adHost']);\n  }\n\n  url = '//' + adHost + '/' + data['customerName'] + '/jserver';\n\n  const {multiSize} = data;\n  const primaryWidth = parseInt(data.width, 10);\n  const primaryHeight = parseInt(data.height, 10);\n  let dimensions;\n  let multiSizeValid = false;\n\n  if (multiSize) {\n    try {\n      dimensions = getMultiSizeDimensions(\n        multiSize,\n        primaryWidth,\n        primaryHeight,\n        true\n      );\n      multiSizeValid = true;\n      dimensions.unshift([primaryWidth, primaryHeight]);\n    } catch (e) {\n      // okay to error here\n    }\n  }\n\n  for (let idx = 0; idx < plainFields.length; idx++) {\n    if (data[plainFields[idx]]) {\n      if (typeof data[plainFields[idx]] !== 'undefined') {\n        url +=\n          '/' +\n          plainFields[idx] +\n          '=' +\n          encodeURIComponent(data[plainFields[idx]]);\n      }\n    }\n  }\n\n  //Size and multi-size\n  if (typeof data.size !== 'undefined') {\n    url += '/SIZE=' + encodeURIComponent(data.size);\n    if (typeof multiSize !== 'undefined' && multiSizeValid) {\n      url += ',' + encodeURIComponent(multiSize);\n    }\n  } else if (typeof multiSize !== 'undefined' && multiSizeValid) {\n    whSize = primaryWidth + 'x' + primaryHeight;\n    url +=\n      '/SIZE=' +\n      encodeURIComponent(whSize) +\n      ',' +\n      encodeURIComponent(multiSize);\n  }\n\n  // Tags\n  if (typeof data.tags !== 'undefined') {\n    const tags = parseJson(data.tags);\n    for (const tag in tags) {\n      url += '/' + tag + '=' + encodeURIComponent(tags[tag]);\n    }\n  }\n  writeScript(global, url, () => {\n    global.context.renderStart();\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function seedingalliance(global, data) {\n  writeScript(\n    global,\n    'https://d.nativendo.de/cds/delivery/init?url=' +\n      encodeURIComponent(data.url)\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sekindo(global, data) {\n  validateData(data, ['spaceid']);\n  const pubUrl = encodeURIComponent(global.context.sourceUrl);\n  const excludesSet = {ampSlotIndex: 1, type: 1};\n  const customParamMap = {spaceid: 's', width: 'x', height: 'y'};\n  let query =\n    'isAmpProject=1&pubUrl=' +\n    pubUrl +\n    '&cbuster=' +\n    global.context.startTime +\n    '&';\n  let getParam = '';\n  for (const key in data) {\n    if (hasOwn(data, key)) {\n      if (typeof excludesSet[key] == 'undefined') {\n        getParam =\n          typeof customParamMap[key] == 'undefined' ? key : customParamMap[key];\n        query += getParam + '=' + encodeURIComponent(data[key]) + '&';\n      }\n    }\n  }\n  loadScript(\n    global,\n    'https://live.sekindo.com/live/liveView.php?' + query,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sharethrough(global, data) {\n  validateData(data, ['pkey'], []);\n  global.pkey = data.pkey;\n  writeScript(global, 'https://sdk.sharethrough.com/amp.js');\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function shemedia(global, data) {\n  validateData(data, ['slotType', 'boomerangPath']);\n\n  loadScript(global, 'https://ads.shemedia.com/static/amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/* global sklikProvider: false */\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sklik(global, data) {\n  loadScript(global, 'https://c.imedia.cz/js/amp.js', () => {\n    const parentId = 'sklik_parent';\n\n    const parentElement = document.createElement('div');\n    parentElement.id = parentId;\n    window.document.body.appendChild(parentElement);\n\n    data.elm = parentId;\n    data.url = global.context.canonicalUrl;\n\n    sklikProvider.show(data);\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function slimcutmedia(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._scm_amp = {\n    allowed_data: ['pid', 'ffc'],\n    mandatory_data: ['pid'],\n    data,\n  };\n\n  validateData(\n    data,\n    global._scm_amp.mandatory_data,\n    global._scm_amp.allowed_data\n  );\n\n  loadScript(\n    global,\n    'https://static.freeskreen.com/publisher/' +\n      encodeURIComponent(data.pid) +\n      '/freeskreen.min.js'\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function smartadserver(global, data) {\n  // For more flexibility, we construct the call to SmartAdServer's URL in the\n  // external loader, based on the data received from the AMP tag.\n  loadScript(global, 'https://ec-ns.sascdn.com/diff/js/amp.v0.js', () => {\n    global.sas.callAmpAd(data);\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function smartclip(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._smartclip_amp = {\n    allowed_data: ['extra'],\n    mandatory_data: ['plc', 'sz'],\n    data,\n  };\n\n  validateData(\n    data,\n    global._smartclip_amp.mandatory_data,\n    global._smartclip_amp.allowed_data\n  );\n\n  const rand = Math.round(Math.random() * 100000000);\n\n  loadScript(\n    global,\n    'https://des.smartclip.net/ads?type=dyn&plc=' +\n      encodeURIComponent(data.plc) +\n      '&sz=' +\n      encodeURIComponent(data.sz) +\n      (data.extra ? '&' + encodeURI(data.extra) : '') +\n      '&rnd=' +\n      rand\n  );\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function smi2(global, data) {\n  validateData(data, ['blockid']);\n  global._smi2 = global._smi2 || {\n    viewId: global.context.pageViewId,\n    blockId: data['blockid'],\n    htmlURL: data['canonical'] || global.context.canonicalUrl,\n    ampURL: data['ampurl'] || global.context.sourceUrl,\n    testMode: data['testmode'] || 'false',\n    referrer: data['referrer'] || global.context.referrer,\n    hostname: global.window.context.location.hostname,\n    clientId: window.context.clientId,\n    domFingerprint: window.context.domFingerprint,\n    location: window.context.location,\n    startTime: window.context.startTime,\n  };\n  global._smi2.AMPCallbacks = {\n    renderStart: global.context.renderStart,\n    noContentAvailable: global.context.noContentAvailable,\n  };\n  // load the smi2  AMP JS file script asynchronously\n  const rand = Math.round(Math.random() * 100000000);\n  loadScript(\n    global,\n    'https://amp.smi2.ru/ampclient/ampfecth.js?rand=' + rand,\n    () => {},\n    global.context.noContentAvailable\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function smilewanted(global, data) {\n  // For more flexibility, we construct the call to SmileWanted's URL in the external loader, based on the data received from the AMP tag.\n  global.smilewantedConfig = data;\n  loadScript(global, 'https://prebid.smilewanted.com/amp/amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sogouad(global, data) {\n  validateData(data, ['slot', 'w', 'h'], ['responsive']);\n  const slot = global.document.getElementById('c');\n  const ad = global.document.createElement('div');\n  const sogouUn = 'sogou_un';\n  global[sogouUn] = window[sogouUn] || [];\n  if (data.w === '100%') {\n    global[sogouUn].push({\n      id: data.slot,\n      ele: ad,\n    });\n  } else {\n    global[sogouUn].push({\n      id: data.slot,\n      ele: ad,\n      w: data.w,\n      h: data.h,\n    });\n  }\n  slot.appendChild(ad);\n  loadScript(global, 'https://theta.sogoucdn.com/wap/js/aw.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sona(global, data) {\n  validateData(data, ['config'], ['responsive']);\n\n  // Additional validation\n  const dataConfig = data['config'];\n  const adConfig = parseJson(dataConfig);\n\n  // Add configuration\n  const configScript = global.document.createElement('SCRIPT');\n  const config = global.document.createTextNode(\n    '(sona = window.sona || ' + JSON.stringify(adConfig) + ')'\n  );\n  configScript.appendChild(config);\n\n  // Set up amp-ad\n  const slot = global.document.getElementById('c');\n  const ad = global.document.createElement('SONA-WIDGET');\n  ad.setAttribute('auto-responsive', '');\n  ad.className = 'ad-tag';\n\n  // setup ad from sona\n  slot.appendChild(ad);\n  slot.appendChild(configScript);\n\n  // Initialise sona widget and get Image/Video\n  const scriptUrl = 'https://cdn.sonaserve.com/v1.1/dist.js';\n  loadScript(global, scriptUrl);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sortable(global, data) {\n  validateData(data, ['site', 'name'], ['responsive']);\n\n  const slot = global.document.getElementById('c');\n  const ad = global.document.createElement('div');\n  const size =\n    data.responsive === 'true' ? 'auto' : data.width + 'x' + data.height;\n  ad.className = 'ad-tag';\n  ad.setAttribute('data-ad-name', data.name);\n  ad.setAttribute('data-ad-size', size);\n  slot.appendChild(ad);\n  loadScript(\n    global,\n    'https://tags-cdn.deployads.com/a/' + encodeURIComponent(data.site) + '.js'\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/*\n *********\n * Existing sovrn customers feel free to contact amp-implementations@sovrn.com\n * for assistance with setting up your amp-ad tagid New customers please see\n * www.sovrn.com to sign up and get started!\n *********\n */\nimport {writeScript} from '../../3p/3p';\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sovrn(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global.width = data.width;\n  global.height = data.height;\n  global.domain = data.domain;\n  global.u = data.u;\n  global.iid = data.iid;\n  global.aid = data.aid;\n  global.z = data.z;\n  global.tf = data.tf;\n  writeScript(global, 'https://ap.lijit.com/www/sovrn_amp/sovrn_ads.js');\n}\n", "/* eslint-disable require-jsdoc */\n/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\n\nexport function speakol(global, data) {\n  validateData(data, ['widgetid']);\n\n  (global.spksdk = global.spksdk || []).push({\n    // eslint-disable-next-line google-camelcase/google-camelcase\n    widget_id: `wi-${data['widgetid']}`,\n    element: `wi-${data['widgetid']}`,\n  });\n  const d = global.document.createElement('div');\n  d.classList.add('speakol-widget');\n  d.id = 'wi-' + data['widgetid'];\n\n  global.document.getElementById('c').appendChild(d);\n\n  loadScript(global, 'https://cdn.speakol.com/widget/js/speakol-widget-v2.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function spotx(global, data) {\n  // ensure we have valid channel id\n  validateData(data, ['spotx_channel_id', 'width', 'height']);\n\n  // Because 3p's loadScript does not allow for data attributes,\n  // we will write the JS tag ourselves.\n  const script = global.document.createElement('script');\n\n  data['spotx_content_width'] = data.spotx_content_width || data.width;\n  data['spotx_content_height'] = data.spotx_content_height || data.height;\n  data['spotx_content_page_url'] =\n    global.context.location.href || global.context.sourceUrl;\n\n  // Add data-* attribute for each data value passed in.\n  for (const key in data) {\n    if (hasOwn(data, key) && key.startsWith('spotx_')) {\n      script.setAttribute(`data-${key}`, data[key]);\n    }\n  }\n\n  global['spotx_ad_done_function'] = function (spotxAdFound) {\n    if (!spotxAdFound) {\n      global.context.noContentAvailable();\n    }\n  };\n\n  // TODO(KenneyE): Implement AdLoaded callback in script to accurately trigger\n  // renderStart()\n  script.onload = global.context.renderStart;\n\n  script.src = `//js.spotx.tv/easi/v1/${data['spotx_channel_id']}.js`;\n  global.document.body.appendChild(script);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, loadScript} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\n/**\n * @param context\n */\n\nconst initSlotList = (context) => {\n  context.master.availableSlots = context.master.availableSlots || {};\n};\n\nconst registerSlot = (slot) => {\n  context.master.availableSlots[slot.slotName] = slot;\n};\n\n// eslint-disable-next-line require-jsdoc\nexport function springAds(global, data) {\n  computeInMasterFrame(\n    global,\n    'springAds',\n    () => {\n      initSlotList(context);\n    },\n    () => {}\n  );\n  if (data.adssetup) {\n    const adSSetup = parseJson(data.adssetup);\n    adSSetup['isAMP'] = !0;\n    adSSetup['availableSlots'] = context.master.availableSlots;\n    context.master.adSSetup = global.adSSetup = adSSetup;\n    const sitename = adSSetup['publisher'].match(/(.*)\\..*/)[1];\n    loadScript(\n      global,\n      'https://www.asadcdn.com/adlib/pages/' + sitename + '_amp.js'\n    );\n  } else {\n    registerSlot({\n      global,\n      document,\n      context,\n      slotName: data['adslot'],\n    });\n    const adlib = window.ASCDP || context.master.ASCDP || '';\n    adlib && adlib.adS.renderAd(data.adslot);\n  }\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\nimport {setStyle, setStyles} from '../../src/style';\n\n/*\n * How to develop:\n * https://github.com/ampproject/amphtml/blob/main/docs/getting-started-e2e.md\n */\n\n/**\n * @param {!Array.<!Object>} array\n * @param {!Function} iteratee\n *\n * @return {Object}\n */\nexport function keyBy(array, iteratee) {\n  return array.reduce(\n    (itemById, item) => Object.assign(itemById, {[iteratee(item)]: item}),\n    {}\n  );\n}\n\n/**\n * @param {!Object} fetchingSSPs\n * @param {!Function} cb\n */\nexport function runWhenFetchingSettled(fetchingSSPs, cb) {\n  const sspCleanupInterval = setInterval(() => {\n    if (!Object.keys(fetchingSSPs).length) {\n      clearInterval(sspCleanupInterval);\n      cb();\n    }\n  }, 100);\n}\n\n/**\n * @param {!Element} element\n * @param {boolean} center\n * @param {Object} dimensions\n */\nexport function handlePosition(element, center, dimensions) {\n  const styles = {\n    ...(center\n      ? {\n          position: 'absolute',\n          top: '50%',\n          left: '50%',\n          'max-width': '100%',\n          transform: 'translate(-50%, -50%)',\n          '-ms-transform': 'translate(-50%, -50%)',\n        }\n      : {}),\n    ...(dimensions || {}),\n  };\n  setStyles(element, styles);\n}\n\n/**\n * @param {!MessageEvent} e\n * @param {!Element} element\n */\nexport function handlePositionResponsive(e, element) {\n  try {\n    const {height} = JSON.parse(e.data);\n    if (height) {\n      handlePosition(element, true, {\n        height: `${height}px`,\n      });\n    }\n  } catch (e) {\n    // no-op\n  }\n}\n\n/**\n * @param {number} availableWidth\n * @param {!Object} data\n * @return {?Object}\n */\nexport function sizeAgainstWindow(availableWidth, data) {\n  if (data.width > availableWidth) {\n    const newWidth = availableWidth;\n    const newHeight = data.height / (data.width / availableWidth);\n    return {width: newWidth, height: newHeight};\n  }\n}\n\n/**\n * @param {!Element} element\n */\nexport function forceElementReflow(element) {\n  // force reflow\n  setStyle(element, 'display', 'none');\n  element./*OK*/ offsetHeight;\n  setStyle(element, 'display', 'block');\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ssp(global, data) {\n  // validate AMP input data- attributes\n  validateData(data, ['position'], ['site']);\n\n  let position = {id: -1};\n\n  try {\n    position = parseJson(data.position);\n\n    if (position['id'] === undefined) {\n      position = {id: -1};\n    }\n  } catch (error) {\n    global.context.noContentAvailable();\n    return;\n  }\n\n  if (position['id'] === -1) {\n    global.context.noContentAvailable();\n    return;\n  }\n\n  // This is super important. Without this any variables on context are not shared\n  const mW = global.context.isMaster ? global : global.context.master;\n\n  // create parent element\n  const parentElement = document.createElement('div');\n\n  parentElement.id = position['id'];\n\n  // https://github.com/ampproject/amphtml/tree/main/ads#the-iframe-sandbox\n  global.document.getElementById('c').appendChild(parentElement);\n\n  // validate dimensions against available space (window)\n  const sizing = sizeAgainstWindow(parentElement./*OK*/ clientWidth, data);\n\n  // https://github.com/ampproject/amphtml/blob/main/3p/3p.js#L186\n  computeInMasterFrame(\n    global,\n    'ssp-load',\n    (done) => {\n      loadScript(global, 'https://ssp.imedia.cz/static/js/ssp.js', () => {\n        // This callback is run just once for amp-ad with same type\n        // Script will inject \"sssp\" object on Window\n        if (!global['sssp']) {\n          done(false);\n          return;\n        }\n\n        /** @type {{config: Function, getAds: Function, writeAd: Function}} */\n        const sssp = global['sssp'];\n\n        sssp.config({\n          site: data.site || global.context.canonicalUrl,\n        });\n\n        // propagate relevant data across all ad units\n        mW.sssp = sssp;\n        mW.fetchingSSPs = {};\n\n        done(true);\n      });\n    },\n    (loaded) => {\n      if (!loaded) {\n        global.context.noContentAvailable();\n        return;\n      }\n\n      // perform cleanup only after all SSP XHRs are settled\n      const noContent = () => {\n        runWhenFetchingSettled(mW.fetchingSSPs, () =>\n          global.context.noContentAvailable()\n        );\n      };\n\n      // register XHR and start fetching\n      mW.fetchingSSPs[position.zoneId] = true;\n\n      mW.sssp.getAds([position], {\n        // todo on SSP side (option to register error callback)\n        // requestErrorCallback: () => {},\n        AMPcallback: (ads) => {\n          /** @suppress {checkTypes} */\n          const adById = keyBy(ads, (item) => item.id);\n          const ad = adById[position['id']];\n\n          if (!ad || ['error', 'empty'].includes(ad.type)) {\n            noContent();\n          } else {\n            // listen to message with \"height\" property -> for responsive ads (111x111) -> set new height / center\n            if (ad.responsive) {\n              global.addEventListener('message', (e) => {\n                handlePositionResponsive(e, parentElement);\n              });\n            }\n\n            // listen to intersections and force element reflow (external DSPs)\n            if (['APPNEXUS', 'PUBMATIC'].includes(ad.dsp)) {\n              global.context.observeIntersection(() => {\n                forceElementReflow(parentElement);\n              });\n            }\n\n            // SSP need parentElement as value in \"position.id\"\n            mW.sssp.writeAd(ad, {...position, id: parentElement});\n\n            // init dimensions / centering\n            const d = ad.responsive ? {width: '100%', height: '100%'} : null;\n            handlePosition(parentElement, true, d);\n            global.context.renderStart(sizing);\n          }\n\n          // unregister XHR\n          delete mW.fetchingSSPs[position.zoneId];\n        },\n      });\n    }\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst renderTo = 'strossle-widget';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function strossle(global, data) {\n  validateData(data, ['widgetid']);\n  global._strossle = global._strossle || {\n    widgetId: data['widgetid'],\n  };\n\n  createContainer(global, data);\n  loadScript(\n    global,\n    'https://widgets.sprinklecontent.com/v2/sprinkle.js',\n    () => {}\n  );\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction createContainer(global, data) {\n  const d = global.document.createElement('div');\n  d.className = renderTo;\n  d.setAttribute('data-spklw-widget', data['widgetid']);\n  global.document.getElementById('c').appendChild(d);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sulvo(global, data) {\n  global.sulvoAmpAdData = data;\n  loadScript(global, 'https://live.demand.supply/up.amp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function sunmedia(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._sunmedia_amp = {\n    allowed_data: ['cskp', 'crst', 'cdb', 'cid'],\n    mandatory_data: ['cid'],\n    data,\n  };\n\n  validateData(\n    data,\n    global._sunmedia_amp.mandatory_data,\n    global._sunmedia_amp.allowed_data\n  );\n\n  loadScript(\n    global,\n    'https://vod.addevweb.com/sunmedia/amp/ads/SMIntextAMP.js'\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function svknative(global, data) {\n  // ensure we have valid widgetid value\n  validateData(data, ['widgetid']);\n\n  const s = global.document.createElement('script');\n  const scriptKey =\n    'svknativeampwidget_' + Math.floor(Math.random() * 10000000);\n\n  s.setAttribute('data-key', scriptKey);\n  global.document.getElementById('c').appendChild(s);\n\n  (function (w, a) {\n    (w[a] = w[a] || []).push({\n      'script_key': scriptKey,\n      'settings': {\n        'w': data['widgetid'],\n        'amp': true,\n      },\n    });\n  })(global, '_svk_n_widgets');\n\n  // load the SVK Native AMP JS file\n  loadScript(global, 'https://widget.svk-native.ru/js/embed.js');\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function swoop(global, data) {\n  // Required properties\n  validateData(data, ['layout', 'placement', 'publisher', 'slot']);\n\n  computeInMasterFrame(\n    global,\n    'swoop-load',\n    (done) => {\n      global.swoopIabConfig = data;\n\n      loadScript(global, 'https://www.swoop-amp.com/amp.js', () =>\n        done(global.Swoop != null)\n      );\n    },\n    (success) => {\n      if (success) {\n        if (!global.context.isMaster) {\n          global.context.master.Swoop.announcePlace(global, data);\n        }\n      } else {\n        global.context.noContentAvailable();\n        throw new Error('Swoop failed to load');\n      }\n    }\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function taboola(global, data) {\n  // do not copy the following attributes from the 'data' object\n  // to _tablloa global object\n  const denylist = ['height', 'type', 'width', 'placement', 'mode'];\n\n  // ensure we have vlid publisher, placement and mode\n  // and exactly one page-type\n  validateData(data, [\n    'publisher',\n    'placement',\n    'mode',\n    ['article', 'video', 'photo', 'search', 'category', 'homepage', 'other'],\n  ]);\n\n  // setup default values for referrer and url\n  const params = {\n    referrer: data.referrer || global.context.referrer,\n    url: data.url || global.context.canonicalUrl,\n  };\n\n  // copy none denylisted attribute to the 'params' map\n  Object.keys(data).forEach((k) => {\n    if (denylist.indexOf(k) === -1) {\n      params[k] = data[k];\n    }\n  });\n\n  // push the two object into the '_taboola' global\n  (global._taboola = global._taboola || []).push([\n    {\n      viewId: global.context.pageViewId,\n      publisher: data.publisher,\n      placement: data.placement,\n      mode: data.mode,\n      framework: 'amp',\n      container: 'c',\n    },\n    params,\n    {flush: true},\n  ]);\n\n  // install observation on entering/leaving the view\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      if (c.intersectionRect.height) {\n        global._taboola.push({\n          visible: true,\n          rects: c,\n          placement: data.placement,\n        });\n      }\n    });\n  });\n\n  // load the taboola loader asynchronously\n  loadScript(\n    global,\n    `https://cdn.taboola.com/libtrc/${encodeURIComponent(\n      data.publisher\n    )}/loader.js`\n  );\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function tail(global, data) {\n  validateData(data, [], ['account']);\n\n  global._ttprofiles = {};\n  data.targeting = data.targeting || {};\n\n  const CATEGORIES = {\n    'E': 'equipment',\n    'A': 'age',\n    'X': 'expandedage',\n    'G': 'gender',\n    'U': 'keywordsubject',\n    'T': 'soccerteam',\n    'C': 'socialclass',\n    'S': 'subject',\n  };\n\n  /**\n   * Convertes array [\"E:V\",\"A:V1, V2\"...] where P is the profile key and V is the profile\n   * into {'equipment'\u001d: [V1], '\u001dage': [V1, V2]..} and set them into data.targeting object.\n   *\n   * @param {*} profiles - Array of profiles\n   */\n  global._ttprofiles._setTTProfile = function (profiles) {\n    const profileVars = profiles[0].split('_');\n    if (\n      typeof profileVars === 'undefined' ||\n      typeof profileVars[0] === 'undefined' ||\n      profileVars[0] === 'disabled'\n    ) {\n      return;\n    }\n    const parts = profileVars[0].split('|');\n    for (let i = 0; i < parts.length; i++) {\n      const part = parts[i].split(':');\n      if (part.length === 2) {\n        switch (part[0]) {\n          case 'S':\n          case 'U':\n            const tmpValues = part[1].split(',');\n            const value = [];\n            for (let j = 0; j < tmpValues.length; j++) {\n              const valueAndOccurrences = tmpValues[j].split('.');\n              if (valueAndOccurrences.length >= 2) {\n                value.push(valueAndOccurrences[0]);\n              } else {\n                value.push(tmpValues[j]);\n              }\n              data.targeting[CATEGORIES[part[0]]] = value;\n            }\n            break;\n          default:\n            data.targeting[CATEGORIES[part[0]]] = [part[1]];\n        }\n      }\n    }\n  };\n\n  /**\n   * Sets data.targeting object with profile values.\n   * @param {*} args - Profile value.\n   */\n  global._ttprofiles._setProfile = function (args) {\n    if (args.length > 0 && args[0] !== 'disabled') {\n      data.targeting['lifestyle'] = args[0].split(',');\n    }\n  };\n\n  /**\n   * Sets data.targeting object with custom audience values.\n   * @param {*} args - Array of custom audience.\n   */\n  global._ttprofiles._setCustomAudience = function (args) {\n    if (args.length > 1) {\n      let cas = args.slice(1);\n      const values = [];\n      if (cas.length > 0) {\n        cas = cas[0].split(',');\n        for (let i = 0; i < cas.length; i++) {\n          const ca = cas[i].split('_');\n          if (ca[0].length > 0) {\n            values.push(ca[0]);\n          }\n        }\n      }\n      if (values.length > 0) {\n        data.targeting['customaudience'] = values;\n      }\n    }\n  };\n\n  /**\n   *  It's called automatically when we load scripts.\n   *  These are examples of return from apis\n   *  _ttprofiles.push(['_setTTProfile', 'E:2|X:4|G:1|C:1|U:68.1.16124,55.1.16131_salvador_bahia_br_1615216037705_3216960592']);\n   *  _ttprofiles.push(['_setProfile','61,64,24,52,54'])\n   *  _ttprofiles.push(['_setCustomAudience','TT-0000-0','CA00000,CA00001,C00002_1234567891']);\n   *  The first argument is the function name that we will call to transform and set data in data.targeting object.\n   *  @param {*} args - Values to be pushed.\n   */\n  global._ttprofiles.push = function (args) {\n    if (args.length > 1) {\n      const fn = args[0];\n      const fnArgs = args.slice(1);\n      if (fnArgs.length > 0 && fnArgs[0].length > 0) {\n        global._ttprofiles[fn](fnArgs);\n      }\n    }\n  };\n\n  loadScript(global, 'https://d.t.tailtarget.com/profile');\n\n  if (data.account) {\n    loadScript(\n      global,\n      `https://${data.account}.seg.t.tailtarget.com/ca?env=_ttprofiles`\n    );\n  }\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {validateData, writeScript} from '../../3p/3p';\n/**\n * @param {!Window} global\n * @param {!Object} d\n */\nexport function tcsemotion(global, d) {\n  validateData(d, ['zone', 'delhost']);\n  global.djaxData = d;\n  if (d.hb && d.hb == 'true') {\n    global.djaxData.hb = true;\n  } else {\n    global.djaxData.hb = false;\n  }\n  writeScript(global, 'https://ads.tcsemotion.com/www/delivery/amphb.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function teads(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._teads_amp = {\n    allowed_data: ['pid', 'tag'],\n    mandatory_data: ['pid'],\n    mandatory_tag_data: ['tta', 'ttp'],\n    data,\n  };\n\n  validateData(\n    data,\n    global._teads_amp.mandatory_data,\n    global._teads_amp.allowed_data\n  );\n\n  if (data.tag) {\n    validateData(data.tag, global._teads_amp.mandatory_tag_data);\n    global._tta = data.tag.tta;\n    global._ttp = data.tag.ttp;\n\n    loadScript(\n      global,\n      'https://s8t.teads.tv/media/format/' +\n        encodeURI(data.tag.js || 'v3/teads-format.min.js')\n    );\n  } else {\n    loadScript(\n      global,\n      'https://a.teads.tv/page/' + encodeURIComponent(data.pid) + '/tag'\n    );\n  }\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function temedya(global, data) {\n  validateData(data, ['widgetid']);\n  global._temedya = global._temedya || {\n    widgetId: data['widgetid'],\n  };\n  global._temedya.AMPCallbacks = {\n    renderStart: global.context.renderStart,\n    noContentAvailable: global.context.noContentAvailable,\n  };\n  // load the temedya  AMP JS file script asynchronously\n  loadScript(\n    global,\n    'https://widget.cdn.vidyome.com/builds/loader-amp.js',\n    () => {},\n    global.context.noContentAvailable\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {parseJson} from '../../src/core/types/object/json';\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function torimochi(global, data) {\n  validateData(data, ['area', 'adtype']);\n\n  if (data.width < global.width) {\n    global.width = data.width;\n  }\n  global.height = data.height;\n  global.area = data['area'];\n  global.adtype = data['adtype'];\n  global.tcid = data['tcid'];\n  global.wid = data['wid'];\n  global.extra = parseJson(data['extra'] || '{}');\n  global.context.renderStart({width: global.width, height: global.height});\n\n  const url =\n    'https://asset.torimochi-ad.net/js/torimochi_ad_amp.min.js?v=' + Date.now();\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function tracdelight(global, data) {\n  const mandatoryFields = ['widget_id', 'access_key'];\n  const optionalFields = ['mode'];\n\n  validateData(data, mandatoryFields, optionalFields);\n\n  global.tdData = data;\n  writeScript(global, 'https://scripts.tracdelight.io/amp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateSrcPrefix} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function triplelift(global, data) {\n  const {src} = data;\n  validateSrcPrefix('https://ib.3lift.com/', src);\n  loadScript(global, src);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n */\nexport function trugaze(global) {\n  // For simplicity and flexibility, all validations are performed in the\n  // Trugaze's URL based on the data received\n  loadScript(global, 'https://cdn.trugaze.io/amp-init-v1.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *  http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {hasOwn} from '../../src/core/types/object';\nimport {loadScript, validateData} from '../../3p/3p';\nimport {setStyles} from '../../src/style';\n\n/**\n * @param {!Object} theObject\n * @param {!Function} callback\n */\nfunction forEachOnObject(theObject, callback) {\n  if (typeof theObject === 'object' && theObject !== null) {\n    if (typeof callback === 'function') {\n      for (const key in theObject) {\n        if (hasOwn(theObject, key)) {\n          callback(key, theObject[key]);\n        }\n      }\n    }\n  }\n}\n\n/**\n * @param {!Window} global\n */\nfunction centerAd(global) {\n  const e = global.document.getElementById('c');\n  if (e) {\n    setStyles(e, {\n      top: '50%',\n      left: '50%',\n      bottom: '',\n      right: '',\n      transform: 'translate(-50%, -50%)',\n    });\n  }\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function uas(global, data) {\n  validateData(\n    data,\n    ['accId', 'adUnit', 'sizes'],\n    [\n      'locLat',\n      'locLon',\n      'locSrc',\n      'pageURL',\n      'targetings',\n      'extraParams',\n      'visibility',\n    ]\n  );\n  global.Phoenix = {EQ: []};\n  const uasDivId = 'uas-amp-slot';\n  global.document.write('<div id=\"' + uasDivId + '\"></div>');\n  loadScript(global, 'https://ads.pubmatic.com/AdServer/js/phoenix.js', () => {\n    global.Phoenix.EQ.push(function () {\n      global.Phoenix.enableSingleRequestCallMode();\n      global.Phoenix.setInfo('AMP', 1); // Need to set the AMP flag\n      global.Phoenix.setInfo('ACCID', data.accId);\n      // Reading PAGEURL from sourceUrl or location.href\n      global.Phoenix.setInfo(\n        'PAGEURL',\n        global.context.sourceUrl || global.context.location.href\n      );\n      data.pageURL && global.Phoenix.setInfo('PAGEURL', data.pageURL);\n      data.locLat && global.Phoenix.setInfo('LAT', data.locLat);\n      data.locLon && global.Phoenix.setInfo('LON', data.locLon);\n      data.locSrc && global.Phoenix.setInfo('LOC_SRC', data.locSrc);\n      const slot = global.Phoenix.defineAdSlot(\n        data.adUnit,\n        data.sizes,\n        uasDivId\n      );\n      slot.setVisibility(1);\n      forEachOnObject(data.targetings, function (key, value) {\n        slot.setTargeting(key, value);\n      });\n      forEachOnObject(data.extraParams, function (key, value) {\n        slot.setExtraParameters(key, value);\n      });\n      global.Phoenix.display(uasDivId);\n    });\n  });\n  centerAd(global);\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function ucfunnel(global, data) {\n  validateData(data, ['siteId']);\n  loadScript(window, 'https://ads.aralego.com/ampsdk');\n  window.context.renderStart();\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n * @param {!Function} [scriptLoader=loadScript]\n */\nexport function unruly(global, data, scriptLoader = loadScript) {\n  validateData(data, ['siteId']);\n\n  global.unruly = global.unruly || {};\n  global.unruly.native = {\n    siteId: data.siteId,\n  };\n\n  scriptLoader(global, 'https://video.unrulymedia.com/native/native-loader.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function uzou(global, data) {\n  validateData(data, ['widgetParams'], []);\n\n  const prefixMap = {\n    test: 'dev-',\n    development: 'dev-',\n    staging: 'staging-',\n    production: '',\n  };\n\n  const widgetParams = parseJson(data['widgetParams']);\n  const akamaiHost = widgetParams['akamaiHost'] || 'speee-ad.akamaized.net';\n  const placementCode = widgetParams['placementCode'];\n  const mode = widgetParams['mode'] || 'production';\n  const entryPoint = `https://${prefixMap[mode]}${akamaiHost}/tag/${placementCode}/js/outer-frame.min.js`;\n\n  const d = global.document.createElement('div');\n  d.className = `uz-${placementCode} uz-ny`;\n\n  const container = global.document.getElementById('c');\n  container.appendChild(d);\n\n  const uzouInjector = {\n    url: fixedEncodeURIComponent(\n      widgetParams['url'] ||\n        global.context.canonicalUrl ||\n        global.context.sourceUrl\n    ),\n    referer: widgetParams['referer'] || global.context.referrer,\n  };\n  ['adServerHost', 'akamaiHost', 'iframeSrcPath'].forEach(function (elem) {\n    if (widgetParams[elem]) {\n      uzouInjector[elem] = widgetParams[elem];\n    }\n  });\n  global.UzouInjector = uzouInjector;\n\n  loadScript(global, entryPoint, () => {\n    global.context.renderStart();\n  });\n}\n\n/**\n * encode URI based on RFC 3986\n * @param {string} str url string\n * @return {*} TODO(#23582): Specify return type\n */\nfunction fixedEncodeURIComponent(str) {\n  return encodeURIComponent(str).replace(/[!'()*]/g, function (c) {\n    return '%' + c.charCodeAt(0).toString(16);\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function valuecommerce(global, data) {\n  validateData(data, ['pid'], ['sid', 'vcptn', 'om']);\n  global.vcParam = data;\n  writeScript(global, 'https://amp.valuecommerce.com/amp_bridge.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function vdoai(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global.vdo_ai_ = {\n    unitData: data['unitid'],\n    unitTagname: data['tagname'],\n  };\n  loadScript(global, 'https://a.vdo.ai/core/dependencies_amp/remote.js');\n}\n", "/**\n * Copyright 2021 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n/**\n * @param {!Window} global\n * @param {{config: string}} data\n */\nexport function verizonmedia(global, data) {\n  validateData(data, ['config']);\n  global.jacData = data;\n  writeScript(global, 'https://jac.yahoosandbox.com/amp/jac.js');\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function videointelligence(global, data) {\n  validateData(data, ['publisherId', 'channelId']);\n\n  loadScript(global, 'https://s.vi-serve.com/tagLoaderAmp.js');\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\nimport {tryDecodeUriComponent} from '../../src/core/types/string/url';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function videonow(global, data) {\n  const mandatoryAttributes = ['pid'];\n  const optionalAttributes = ['kind', 'src'];\n\n  let customTag = '';\n  let logLevel = null;\n  let vnModule = '';\n\n  if (global && global.name) {\n    const p = parseJson(global.name);\n    if (\n      p &&\n      p['attributes'] &&\n      p['attributes']['_context'] &&\n      p['attributes']['_context']['location'] &&\n      p['attributes']['_context']['location']['href']\n    ) {\n      const {href} = p['attributes']['_context']['location'];\n      const logLevelParsed = /[?&]vn_debug\\b(?:=(\\d+))?/.exec(href);\n      const vnModuleParsed = /vn_module=([^&]*)/.exec(href);\n      const customTagParsed = /vn_init_module=([^&]*)/.exec(href);\n\n      logLevel = (logLevelParsed && logLevelParsed[1]) || null;\n      vnModule = (vnModuleParsed && vnModuleParsed[1]) || '';\n      customTag = (customTagParsed && customTagParsed[1]) || '';\n    }\n  }\n  validateData(data, mandatoryAttributes, optionalAttributes);\n\n  const profileId = data.pid || 1;\n\n  // production version by default\n  let script =\n    (customTag && tryDecodeUriComponent(customTag)) ||\n    (data.src && tryDecodeUriComponent(data.src)) ||\n    'https://cdn.videonow.ru/vn_init_module.js';\n\n  script = addParam(script, 'amp', 1);\n  script = addParam(script, 'profileId', profileId);\n  if (logLevel !== null) {\n    script = addParam(script, 'vn_debug', String(logLevel));\n  }\n  if (vnModule) {\n    script = addParam(script, 'vn_module', vnModule);\n  }\n\n  loadScript(global, script);\n}\n\n/**\n * @param {string} script\n * @param {string} name\n * @param {string|number}value\n * @return {string}\n */\nfunction addParam(script, name, value) {\n  if (script.indexOf(name) < 0) {\n    script += (~script.indexOf('?') ? '&' : '?') + name + '=' + value;\n  }\n  return script;\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {addParamsToUrl} from '../../src/url';\nimport {loadScript, validateData} from '../../3p/3p';\nimport {parseJson} from '../../src/core/types/object/json';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function viralize(global, data) {\n  const endpoint = 'https://ads.viralize.tv/display/';\n  const required = ['zid'];\n  const optional = ['extra'];\n\n  validateData(data, required, optional);\n\n  const defaultLocation = 'sel-#c>script';\n  const pubPlatform = 'amp';\n\n  const queryParams = parseJson(data.extra || '{}');\n  queryParams['zid'] = data.zid;\n  queryParams['pub_platform'] = pubPlatform;\n  if (!queryParams['location']) {\n    queryParams['location'] = defaultLocation;\n  }\n  if (!queryParams['u']) {\n    queryParams['u'] = global.context.sourceUrl;\n  }\n\n  const scriptUrl = addParamsToUrl(endpoint, queryParams);\n\n  loadScript(\n    global,\n    scriptUrl,\n    () => global.context.renderStart(),\n    () => global.context.noContentAvailable()\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n/* eslint-disable require-jsdoc */\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function vlyby(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global._vlyby_amp = {\n    allowed_data: ['publisherid', 'placementid', 'pubref'],\n    mandatory_data: ['publisherid', 'placementid'],\n    data: {\n      pubref: '',\n      publisherid: '',\n      placementid: '',\n      ...data,\n    },\n  };\n\n  validateData(data, global._vlyby_amp.mandatory_data);\n\n  const rand = Math.round(Math.random() * 100000000);\n\n  // install observation on entering/leaving the view\n  global.context.observeIntersection(function (changes) {\n    /** @type {!Array} */ (changes).forEach(function (c) {\n      if (global._vlyby_amp) {\n        global._vlyby_amp.rects = c;\n      }\n    });\n  });\n\n  //create Container\n  const containerId = 'qad' + rand;\n  createContainer(global, containerId);\n\n  //create Script\n  createScript(global, containerId);\n\n  function createScript(global, id) {\n    const s = global.document.createElement('script');\n    const referrer = data['pubref'] || global.context.canonicalUrl;\n\n    s.setAttribute('type', 'text/javascript');\n    s.setAttribute('async', 'true');\n    s.setAttribute('src', '//cdn.vlyby.com/amp/qad/qad-outer2.js');\n    s.setAttribute('data-PubId', data['publisherid']);\n    s.setAttribute('data-PlacementId', data['placementid']);\n    s.setAttribute('data-DivId', id);\n    s.setAttribute('data-PubRef', referrer);\n    global.document.getElementById('c').appendChild(s);\n  }\n  function createContainer(global, id) {\n    const d = global.document.createElement('div');\n    d.id = id;\n    global.document.getElementById('c').appendChild(d);\n  }\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function vmfive(global, data) {\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  const mandatory_fields = ['appKey', 'placementId', 'adType'];\n  const optional_fields = [];\n\n  const {adType, appKey, placementId} = data;\n\n  global._vmfive_amp = {appKey, placementId, adType};\n\n  validateData(data, mandatory_fields, optional_fields);\n\n  createAdUnit(global, placementId, adType);\n  setupSDKReadyCallback(global, appKey);\n  parallelDownloadScriptsAndExecuteInOrder(global);\n}\n\n/**\n * @param {!Window} win\n */\nfunction parallelDownloadScriptsAndExecuteInOrder(win) {\n  [\n    'https://vawpro.vm5apis.com/man.js',\n    'https://man.vm5apis.com/dist/adn-web-sdk.js',\n  ].forEach(function (src) {\n    const script = document.createElement('script');\n    script.src = src;\n    script.async = false;\n    win.document.head.appendChild(script);\n  });\n}\n\n/**\n * @param {!Window} win\n * @param {string} placementId\n * @param {string} adType\n */\nfunction createAdUnit(win, placementId, adType) {\n  const el = document.createElement('vmfive-ad-unit');\n  el.setAttribute('placement-id', placementId);\n  el.setAttribute('ad-type', adType);\n  win.document.getElementById('c').appendChild(el);\n}\n\n/**\n * @param {!Window} win\n * @param {string} appKey\n */\nfunction setupSDKReadyCallback(win, appKey) {\n  win.onVM5AdSDKReady = (sdk) => sdk.init({appKey});\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * Created by Webedia on 07/03/16 - last updated on 11/10/16\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function webediads(global, data) {\n  validateData(data, ['site', 'page', 'position'], ['query']);\n  loadScript(global, 'https://eu1.wbdds.com/amp.min.js', () => {\n    global.wads.amp.init({\n      'site': data.site,\n      'page': data.page,\n      'position': data.position,\n      'query': data.query ? data.query : '',\n    });\n  });\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function weboramaDisplay(global, data) {\n  const mandatoryFields = [\n    'width',\n    'height',\n    'wbo_account_id',\n    'wbo_tracking_element_id',\n    'wbo_fullhost',\n  ];\n\n  const optionalFields = [\n    'wbo_bid_price',\n    'wbo_price_paid',\n    'wbo_random',\n    'wbo_debug',\n    'wbo_host',\n    'wbo_publisherclick',\n    // 'wbo_clicktrackers',\n    // 'wbo_imptrackers',\n    // 'wbo_zindex',\n    'wbo_customparameter',\n    'wbo_disable_unload_event',\n    'wbo_donottrack',\n    'wbo_script_variant',\n    'wbo_is_mobile',\n    'wbo_vars',\n    'wbo_weak_encoding',\n  ];\n\n  validateData(data, mandatoryFields, optionalFields);\n\n  /*eslint \"google-camelcase/google-camelcase\": 0*/\n  global.weborama_display_tag = {\n    // Default settings to work with AMP\n    forcesecure: true,\n    bursttarget: 'self',\n    burst: 'never',\n\n    // Settings taken from component config\n    width: data.width,\n    height: data.height,\n    account_id: data.wbo_account_id,\n    customparameter: data.wbo_customparameter,\n    tracking_element_id: data.wbo_tracking_element_id,\n    host: data.wbo_host,\n    fullhost: data.wbo_fullhost,\n    bid_price: data.wbo_bid_price,\n    price_paid: data.wbo_price_paid,\n    random: data.wbo_random,\n    debug: data.wbo_debug,\n    publisherclick: data.wbo_publisherclick,\n    // clicktrackers: data.wbo_clicktrackers,\n    // imptrackers: data.wbo_imptrackers,\n    // This is actually quite useless for now, since we are launced in a\n    // non-friendly iframe.\n    // zindex: data.wbo_zindex,\n    disable_unload_event: data.wbo_disable_unload_event,\n    donottrack: data.wbo_donottrack,\n    script_variant: data.wbo_script_variant,\n    is_mobile: data.wbo_is_mobile,\n    vars: data.wbo_vars,\n    weak_encoding: data.wbo_weak_encoding,\n  };\n\n  writeScript(\n    global,\n    'https://cstatic.weborama.fr/js/advertiserv2/adperf_launch_1.0.0_scrambled.js'\n  );\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function whopainfeed(global, data) {\n  validateData(data, ['siteid']);\n\n  global._whopainfeed = global._whopainfeed || {\n    viewId: global.context.pageViewId,\n    siteId: data['siteid'],\n    testMode: data['testmode'] || 'false',\n    template: data['template'] || 'default',\n  };\n\n  loadScript(global, 'https://widget.infeed.com.ar/widget/widget-amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function widespace(global, data) {\n  const WS_AMP_CODE_VER = '1.0.1';\n  // Optional demography parameters.\n  let demo = [];\n\n  demo = ['Gender', 'Country', 'Region', 'City', 'Postal', 'Yob'].map((d) => {\n    return 'demo' + d;\n  });\n\n  validateData(data, ['sid'], demo);\n\n  const url =\n    'https://engine.widespace.com/map/engine/dynamic?isamp=1' +\n    '&ampver=' +\n    WS_AMP_CODE_VER +\n    '&#sid=' +\n    encodeURIComponent(data.sid);\n\n  writeScript(global, url);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function wisteria(global, data) {\n  const d = global.document.createElement('div');\n  d.id = '_wisteria_recommend_contents';\n  global.document.getElementById('c').appendChild(d);\n  //get canonical url\n  const originalUrl = global.context.canonicalUrl;\n  validateData(data, ['siteId', 'templateNumber']);\n  loadScript(\n    global,\n    'https://wisteria-js.excite.co.jp/wisteria.js?site_id=' +\n      data['siteId'] +\n      '&template_no=' +\n      data['templateNumber'] +\n      '&original_url=' +\n      originalUrl\n  );\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function wpmedia(global, data) {\n  validateData(data, ['slot', 'bunch'], ['sn', 'slots']);\n\n  // const url = 'http://localhost/wpjslib.js';\n  const url = 'https://std.wpcdn.pl/wpjslib/wpjslib-amp.js';\n\n  writeScript(global, url, function () {\n    window.run(data);\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function xlift(global, data) {\n  validateData(data, ['mediaid']);\n\n  global.xliftParams = data;\n  const d = global.document.createElement('div');\n  d.id = '_XL_recommend';\n  global.document.getElementById('c').appendChild(d);\n\n  d.addEventListener('SuccessLoadedXliftAd', function (e) {\n    e.detail = e.detail || {adSizeInfo: {}};\n    global.context.renderStart(e.detail.adSizeInfo);\n  });\n  d.addEventListener('FailureLoadedXliftAd', function () {\n    global.context.noContentAvailable();\n  });\n\n  //assign XliftAmpHelper property to global(window)\n  global.XliftAmpHelper = null;\n\n  loadScript(\n    global,\n    'https://cdn.x-lift.jp/resources/common/xlift_amp.js',\n    () => {\n      if (!global.XliftAmpHelper) {\n        global.context.noContentAvailable();\n      } else {\n        global.XliftAmpHelper.show();\n      }\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yahoo(global, data) {\n  validateData(data, ['sid', 'site', 'sa']);\n  global.yadData = data;\n  writeScript(global, 'https://s.yimg.com/aaq/ampad/display.js');\n}\n", "/**\n * Copyright 2020 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yahoofedads(global, data) {\n  validateData(data, [\n    'adUnit',\n    'site',\n    'region',\n    'lang',\n    'sa',\n    'spaceId',\n    'url',\n  ]);\n\n  global.amp = true;\n  global.adConfig = {\n    'adPositionOverride': data.adPositionOverride,\n    'adUnit': data.adUnit,\n    'forceSource': data.forceSource,\n    'height': data.height,\n    'lang': data.lang,\n    'publisherUrl': data.url,\n    'region': data.region,\n    'sa': data.sa,\n    'sectionId': data.sectionId,\n    'site': data.site,\n    'spaceId': data.spaceId,\n    'width': data.width,\n  };\n\n  loadScript(\n    global,\n    'https://s.yimg.com/aaq/ampyahoofedads/yahoofedads.js',\n    () => global.context.renderStart()\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yahoojp(global, data) {\n  validateData(data, ['yadsid'], []);\n  global.yahoojpParam = data;\n  writeScript(\n    global,\n    'https://s.yimg.jp/images/listing/tool/yads/ydn/amp/amp.js'\n  );\n}\n", "/**\n * Copyright 2019 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yahoonativeads(global, data) {\n  validateData(data, ['code', 'url']);\n\n  global.publisherUrl = data.url;\n  global.amp = true;\n\n  const config = {};\n\n  if (data.key) {\n    config.apiKey = data.key;\n  }\n\n  Object.keys(data).forEach((property) => {\n    config[property] = data[property];\n  });\n\n  (global.native = global.native || []).push(config);\n\n  loadScript(global, 'https://s.yimg.com/dy/ads/native.js', () =>\n    global.context.renderStart()\n  );\n}\n", "/**\n * Copyright 2018 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yektanet(global, data) {\n  validateData(data, ['publisherName', 'scriptName', 'posId'], ['adType']);\n\n  const isBanner = data['adType'] === 'banner';\n\n  const container = document.getElementById('c');\n  const adDiv = document.createElement('div');\n  adDiv.setAttribute('id', data['posId']);\n  if (isBanner) {\n    adDiv.setAttribute('class', 'yn-bnr');\n  }\n  container.appendChild(adDiv);\n\n  const now = new Date();\n  const version = [\n    now.getFullYear(),\n    now.getMonth(),\n    now.getDate(),\n    now.getHours(),\n  ].join('0');\n\n  const scriptSrc = isBanner\n    ? 'https://cdn.yektanet.com/template/bnrs/yn_bnr.min.js'\n    : `https://cdn.yektanet.com/js/${encodeURIComponent(\n        data['publisherName']\n      )}/${encodeURIComponent(data['scriptName'])}`;\n\n  loadScript(global, `${scriptSrc}?v=${version}`);\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yengo(global, data) {\n  validateData(data, ['blockId']);\n\n  const url =\n    'https://code.yengo.com/data/' +\n    encodeURIComponent(data['blockId']) +\n    '.js?async=1&div=c';\n\n  loadScript(\n    global,\n    url,\n    () => {\n      global.context.renderStart();\n    },\n    () => {\n      global.context.noContentAvailable();\n    }\n  );\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {getMultiSizeDimensions} from '../../ads/google/utils';\nimport {loadScript, validateData} from '../../3p/3p';\nimport {rethrowAsync} from '../../src/core/error';\nimport {user} from '../../src/log';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yieldbot(global, data) {\n  validateData(data, ['psn', 'ybSlot', 'slot']);\n\n  global.ybotq = global.ybotq || [];\n\n  loadScript(global, 'https://cdn.yldbt.com/js/yieldbot.intent.amp.js', () => {\n    global.ybotq.push(() => {\n      try {\n        const multiSizeDataStr = data.multiSize || null;\n        const primaryWidth = parseInt(data.overrideWidth || data.width, 10);\n        const primaryHeight = parseInt(data.overrideHeight || data.height, 10);\n        let dimensions;\n\n        if (multiSizeDataStr) {\n          dimensions = getMultiSizeDimensions(\n            multiSizeDataStr,\n            primaryWidth,\n            primaryHeight,\n            false\n          );\n          dimensions.unshift([primaryWidth, primaryHeight]);\n        } else {\n          dimensions = [[primaryWidth, primaryHeight]];\n        }\n\n        global.yieldbot.psn(data.psn);\n        global.yieldbot.enableAsync();\n        if (window.context.isMaster) {\n          global.yieldbot.defineSlot(data.ybSlot, {sizes: dimensions});\n          global.yieldbot.go();\n        } else {\n          const slots = {};\n          slots[data.ybSlot] = dimensions;\n          global.yieldbot.nextPageview(slots);\n        }\n      } catch (e) {\n        rethrowAsync(e);\n      }\n    });\n\n    global.ybotq.push(() => {\n      try {\n        const targeting = global.yieldbot.getSlotCriteria(data['ybSlot']);\n        data['targeting'] = data['targeting'] || {};\n        for (const key in targeting) {\n          data.targeting[key] = targeting[key];\n        }\n      } catch (e) {\n        rethrowAsync(e);\n      }\n      user().warn(\n        'AMP-AD',\n        'type=\"yieldbot\" will no longer ' +\n          'be supported starting on March 29, 2018.' +\n          ' Please use your amp-ad-network and RTC to configure a' +\n          ' Yieldbot callout vendor. Refer to' +\n          ' https://github.com/ampproject/amphtml/blob/main/' +\n          'extensions/amp-a4a/rtc-publisher-implementation-guide.md' +\n          '#setting-up-rtc-config for more information.'\n      );\n    });\n  });\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yieldmo(global, data) {\n  const ymElem = global.document.createElement('div');\n  ymElem.id = 'ym_' + data.ymid;\n  ymElem.className = 'ym';\n  ymElem.dataset['ampEnabled'] = true;\n  global.document.getElementById('c').appendChild(ymElem);\n\n  const swimLane = Math.round((5 * Math.random()) / 3);\n  const ymJs = 'https://static.yieldmo.com/ym.' + swimLane + '.js';\n\n  loadScript(global, ymJs);\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yieldone(global, data) {\n  validateData(data, ['pubid', 'pid', 'width', 'height'], []);\n\n  global.yieldoneParam = data;\n  writeScript(\n    global,\n    'https://img.ak.impact-ad.jp/ic/pone/commonjs/yone-amp.js'\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {computeInMasterFrame, loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function yieldpro(global, data) {\n  validateData(\n    data,\n    ['sectionId', 'slot', 'pubnetwork'],\n    [\n      'instance',\n      'custom',\n      'adServerUrl',\n      'cacheSafe',\n      'pageIdModifier',\n      'click3rd',\n      'debugsrc',\n    ]\n  );\n  //TODO support dmp and cookie\n\n  const SCRIPT_HOST = 'creatives.yieldpro.eu/showad_';\n\n  let scriptUrl = 'https://' + SCRIPT_HOST + data['pubnetwork'] + '.js';\n\n  if (data['debugsrc']) {\n    scriptUrl = data['debugsrc'];\n  }\n\n  computeInMasterFrame(\n    global,\n    'yieldpro-request',\n    (done) => {\n      let success = false;\n      if (!global.showadAMPAdapter) {\n        global.showadAMPAdapter = {\n          registerSlot: () => {},\n        };\n        loadScript(global, scriptUrl, () => {\n          if (global.showadAMPAdapter.inited) {\n            success = true;\n          }\n          done(success);\n        });\n      } else {\n        done(true);\n      }\n    },\n    (success) => {\n      if (success) {\n        global.showadAMPAdapter = global.context.master.showadAMPAdapter;\n        global.showadAMPAdapter.registerSlot(data, global);\n      } else {\n        throw new Error('Yieldpro AdTag failed to load');\n      }\n    }\n  );\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function zedo(global, data) {\n  // check mandatory fields\n  validateData(\n    data,\n    ['superId', 'network', 'placementId', 'channel', 'publisher', 'dim'],\n    ['charset', 'callback', 'renderer']\n  );\n\n  loadScript(global, 'https://ss3.zedo.com/gecko/tag/Gecko.amp.min.js', () => {\n    const {ZGTag} = global;\n    const charset = data.charset || '';\n    const callback = data.callback || function () {};\n    const geckoTag = new ZGTag(\n      data.superId,\n      data.network,\n      '',\n      '',\n      charset,\n      callback\n    );\n    geckoTag.setAMP();\n    // define placement\n    const placement = geckoTag.addPlacement(\n      data.placementId,\n      data.channel,\n      data.publisher,\n      data.dim,\n      data.width,\n      data.height\n    );\n    if (data.renderer) {\n      for (const key in data.renderer) {\n        placement.includeRenderer(\n          data.renderer[key].name,\n          data.renderer[key].value\n        );\n      }\n    } else {\n      placement.includeRenderer('display', {});\n    }\n    //create a slot div to display ad\n    const slot = global.document.createElement('div');\n    slot.id = 'zdt_' + data.placementId;\n\n    const divContainer = global.document.getElementById('c');\n    if (divContainer) {\n      divContainer.appendChild(slot);\n    }\n\n    // call load ads\n    geckoTag.loadAds();\n\n    // call div ready\n    geckoTag.placementReady(data.placementId);\n  });\n}\n", "/**\n * Copyright 2017 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nimport {loadScript, validateData} from '../../3p/3p';\n\nconst n = 'yandexZenAsyncCallbacks';\nconst renderTo = 'zen-widget';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function zen(global, data) {\n  validateData(\n    data,\n    ['clid'],\n    ['size', 'orientation', 'successCallback', 'failCallback']\n  );\n\n  addToQueue(global, data);\n  loadScript(global, 'https://zen.yandex.ru/widget-loader');\n}\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nfunction addToQueue(global, data) {\n  global[n] = global[n] || [];\n  global[n].push(() => {\n    // Create container\n    createContainer(global, renderTo);\n\n    const {YandexZen} = global;\n    const config = Object.assign(data, {\n      clid: JSON.parse(data.clid),\n      container: `#${renderTo}`,\n      isAMP: true,\n      successCallback: () => {\n        if (typeof data.successCallback === 'function') {\n          data.successCallback();\n        }\n      },\n      failCallback: () => {\n        if (typeof data.failCallback === 'function') {\n          data.failCallback();\n        }\n      },\n    });\n\n    YandexZen.renderWidget(config);\n  });\n}\n\n/**\n * @param {!Window} global\n * @param {string} id\n */\nfunction createContainer(global, id) {\n  const d = global.document.createElement('div');\n  d.id = id;\n  global.document.getElementById('c').appendChild(d);\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function zergnet(global, data) {\n  validateData(data, ['zergid'], []);\n  global.zergnetWidgetId = data.zergid;\n  writeScript(global, 'https://www.zergnet.com/zerg-amp.js');\n}\n", "/**\n * Copyright 2016 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport {loadScript, validateData, writeScript} from '../../3p/3p';\n\n/**\n * @param {!Window} global\n * @param {!Object} data\n */\nexport function zucks(global, data) {\n  validateData(data, ['frameId']);\n  if (data['adtype'] === 'zoe') {\n    loadScript(global, 'https://j.zoe.zucks.net/zoe.min.js', function () {\n      const frameId = data['frameId'];\n      const elementId = 'zucks-widget-parent';\n\n      const d = global.document.createElement('ins');\n      d.id = elementId;\n      global.document.getElementById('c').appendChild(d);\n\n      if (data['zoeMultiAd'] !== 'true') {\n        (global.gZgokZoeQueue = global.gZgokZoeQueue || []).push({frameId});\n      }\n\n      (global.gZgokZoeWidgetQueue = global.gZgokZoeWidgetQueue || []).push({\n        frameId,\n        parent: `#${elementId}`,\n      });\n    });\n  } else if (data['adtype'] === 'native') {\n    const s = global.document.createElement('script');\n    s.src = `https://j.zucks.net.zimg.jp/n?f=${data['frameId']}`;\n    global.document.getElementById('c').appendChild(s);\n  } else {\n    writeScript(global, `https://j.zucks.net.zimg.jp/j?f=${data['frameId']}`);\n  }\n}\n", "/**\n * Copyright 2015 The AMP HTML Authors. All Rights Reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS-IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @fileoverview Registers all known ad network factories and then executes\n * one of them.\n *\n * This files gets minified and published to\n * https://3p.ampproject.net/$version/f.js\n */\n\n// src/polyfills.js must be the first import.\nimport './polyfills';\n\nimport {draw3p, init} from './integration-lib';\nimport {getMode} from '../src/mode';\nimport {register} from './3p';\n\n// 3P - please keep in alphabetic order\nimport {beopinion} from './beopinion';\nimport {bodymovinanimation} from './bodymovinanimation';\nimport {embedly} from './embedly';\nimport {facebook} from './facebook';\nimport {github} from './github';\nimport {gltfViewer} from './3d-gltf/index';\nimport {mathml} from './mathml';\nimport {reddit} from './reddit';\nimport {twitter} from './twitter';\nimport {viqeoplayer} from './viqeoplayer';\nimport {yotpo} from './yotpo';\n\nimport {_ping_} from '../ads/vendors/_ping_';\n\n// 3P Ad Networks - please keep in alphabetic order\nimport {_1wo} from '../ads/vendors/1wo';\nimport {_24smi} from '../ads/vendors/24smi';\nimport {a8} from '../ads/vendors/a8';\nimport {a9} from '../ads/vendors/a9';\nimport {accesstrade} from '../ads/vendors/accesstrade';\nimport {adagio} from '../ads/vendors/adagio';\nimport {adblade, industrybrains} from '../ads/vendors/adblade';\nimport {adbutler} from '../ads/vendors/adbutler';\nimport {adform} from '../ads/vendors/adform';\nimport {adfox} from '../ads/vendors/adfox';\nimport {adgeneration} from '../ads/vendors/adgeneration';\nimport {adglare} from '../ads/vendors/adglare';\nimport {adhese} from '../ads/vendors/adhese';\nimport {adincube} from '../ads/vendors/adincube';\nimport {adition} from '../ads/vendors/adition';\nimport {adman} from '../ads/vendors/adman';\nimport {admanmedia} from '../ads/vendors/admanmedia';\nimport {admixer} from '../ads/vendors/admixer';\nimport {adnuntius} from '../ads/vendors/adnuntius';\nimport {adocean} from '../ads/vendors/adocean';\nimport {adop} from '../ads/vendors/adop';\nimport {adpicker} from '../ads/vendors/adpicker';\nimport {adplugg} from '../ads/vendors/adplugg';\nimport {adpon} from '../ads/vendors/adpon';\nimport {adpushup} from '../ads/vendors/adpushup';\nimport {adreactor} from '../ads/vendors/adreactor';\nimport {adsensor} from '../ads/vendors/adsensor';\nimport {adservsolutions} from '../ads/vendors/adservsolutions';\nimport {adsloom} from '../ads/vendors/adsloom';\nimport {adsnative} from '../ads/vendors/adsnative';\nimport {adspeed} from '../ads/vendors/adspeed';\nimport {adspirit} from '../ads/vendors/adspirit';\nimport {adstir} from '../ads/vendors/adstir';\nimport {adstyle} from '../ads/vendors/adstyle';\nimport {adtech} from '../ads/vendors/adtech';\nimport {adtelligent} from '../ads/vendors/adtelligent';\nimport {adthrive} from '../ads/vendors/adthrive';\nimport {adunity} from '../ads/vendors/adunity';\nimport {aduptech} from '../ads/vendors/aduptech';\nimport {adventive} from '../ads/vendors/adventive';\nimport {adverline} from '../ads/vendors/adverline';\nimport {adverticum} from '../ads/vendors/adverticum';\nimport {advertserve} from '../ads/vendors/advertserve';\nimport {adyoulike} from '../ads/vendors/adyoulike';\nimport {affiliateb} from '../ads/vendors/affiliateb';\nimport {aja} from '../ads/vendors/aja';\nimport {amoad} from '../ads/vendors/amoad';\nimport {aniview} from '../ads/vendors/aniview';\nimport {anyclip} from '../ads/vendors/anyclip';\nimport {appnexus} from '../ads/vendors/appnexus';\nimport {appvador} from '../ads/vendors/appvador';\nimport {atomx} from '../ads/vendors/atomx';\nimport {baidu} from '../ads/vendors/baidu';\nimport {beaverads} from '../ads/vendors/beaverads';\nimport {bidtellect} from '../ads/vendors/bidtellect';\nimport {blade} from '../ads/vendors/blade';\nimport {brainy} from '../ads/vendors/brainy';\nimport {bringhub} from '../ads/vendors/bringhub';\nimport {broadstreetads} from '../ads/vendors/broadstreetads';\nimport {byplay} from '../ads/vendors/byplay';\nimport {caajainfeed} from '../ads/vendors/caajainfeed';\nimport {capirs} from '../ads/vendors/capirs';\nimport {caprofitx} from '../ads/vendors/caprofitx';\nimport {cedato} from '../ads/vendors/cedato';\nimport {chargeads, nws} from '../ads/vendors/nws';\nimport {colombia} from '../ads/vendors/colombia';\nimport {conative} from '../ads/vendors/conative';\nimport {connatix} from '../ads/vendors/connatix';\nimport {contentad} from '../ads/vendors/contentad';\nimport {criteo} from '../ads/vendors/criteo';\nimport {csa} from '../ads/vendors/csa';\nimport {dable} from '../ads/vendors/dable';\nimport {digiteka} from '../ads/vendors/digiteka';\nimport {directadvert} from '../ads/vendors/directadvert';\nimport {distroscale} from '../ads/vendors/distroscale';\nimport {dotandads} from '../ads/vendors/dotandads';\nimport {dynad} from '../ads/vendors/dynad';\nimport {eadv} from '../ads/vendors/eadv';\nimport {empower} from '../ads/vendors/empower';\nimport {engageya} from '../ads/vendors/engageya';\nimport {epeex} from '../ads/vendors/epeex';\nimport {eplanning} from '../ads/vendors/eplanning';\nimport {ezoic} from '../ads/vendors/ezoic';\nimport {f1e} from '../ads/vendors/f1e';\nimport {f1h} from '../ads/vendors/f1h';\nimport {fakeDelayed} from '../ads/vendors/_fakedelayed_';\nimport {feedad} from '../ads/vendors/feedad';\nimport {felmat} from '../ads/vendors/felmat';\nimport {finative} from '../ads/vendors/finative';\nimport {firstimpression} from '../ads/vendors/firstimpression';\nimport {flite} from '../ads/vendors/flite';\nimport {fluct} from '../ads/vendors/fluct';\nimport {forkmedia} from '../ads/vendors/forkmedia';\nimport {freewheel} from '../ads/vendors/freewheel';\nimport {fusion} from '../ads/vendors/fusion';\nimport {genieessp} from '../ads/vendors/genieessp';\nimport {giraff} from '../ads/vendors/giraff';\nimport {glomex} from '../ads/vendors/glomex';\nimport {gmossp} from '../ads/vendors/gmossp';\nimport {gumgum} from '../ads/vendors/gumgum';\nimport {holder} from '../ads/vendors/holder';\nimport {ibillboard} from '../ads/vendors/ibillboard';\nimport {idealmedia} from '../ads/vendors/idealmedia';\nimport {imaVideo} from '../ads/google/ima/ima-video';\nimport {imedia} from '../ads/vendors/imedia';\nimport {imobile} from '../ads/vendors/imobile';\nimport {imonomy} from '../ads/vendors/imonomy';\nimport {improvedigital} from '../ads/vendors/improvedigital';\nimport {inmobi} from '../ads/vendors/inmobi';\nimport {innity} from '../ads/vendors/innity';\nimport {insticator} from '../ads/vendors/insticator';\nimport {invibes} from '../ads/vendors/invibes';\nimport {iprom} from '../ads/vendors/iprom';\nimport {ix} from '../ads/vendors/ix';\nimport {jubna} from '../ads/vendors/jubna';\nimport {kargo} from '../ads/vendors/kargo';\nimport {ketshwa} from '../ads/vendors/ketshwa';\nimport {kiosked} from '../ads/vendors/kiosked';\nimport {kixer} from '../ads/vendors/kixer';\nimport {kuadio} from '../ads/vendors/kuadio';\nimport {lentainform} from '../ads/vendors/lentainform';\nimport {ligatus} from '../ads/vendors/ligatus';\nimport {lockerdome} from '../ads/vendors/lockerdome';\nimport {logly} from '../ads/vendors/logly';\nimport {loka} from '../ads/vendors/loka';\nimport {luckyads} from '../ads/vendors/luckyads';\nimport {macaw} from '../ads/vendors/macaw';\nimport {mads} from '../ads/vendors/mads';\nimport {mantisDisplay, mantisRecommend} from '../ads/vendors/mantis';\nimport {marfeel} from '../ads/vendors/marfeel';\nimport {mediaad} from '../ads/vendors/mediaad';\nimport {medianet} from '../ads/vendors/medianet';\nimport {mediavine} from '../ads/vendors/mediavine';\nimport {medyanet} from '../ads/vendors/medyanet';\nimport {meg} from '../ads/vendors/meg';\nimport {mgid} from '../ads/vendors/mgid';\nimport {microad} from '../ads/vendors/microad';\nimport {miximedia} from '../ads/vendors/miximedia';\nimport {mixpo} from '../ads/vendors/mixpo';\nimport {monetizer101} from '../ads/vendors/monetizer101';\nimport {mox} from '../ads/vendors/mox';\nimport {my6sense} from '../ads/vendors/my6sense';\nimport {myfinance} from '../ads/vendors/myfinance';\nimport {myoffrz} from '../ads/vendors/myoffrz';\nimport {mytarget} from '../ads/vendors/mytarget';\nimport {mywidget} from '../ads/vendors/mywidget';\nimport {nativeroll} from '../ads/vendors/nativeroll';\nimport {nativery} from '../ads/vendors/nativery';\nimport {nativo} from '../ads/vendors/nativo';\nimport {navegg} from '../ads/vendors/navegg';\nimport {nend} from '../ads/vendors/nend';\nimport {netletix} from '../ads/vendors/netletix';\nimport {noddus} from '../ads/vendors/noddus';\nimport {nokta} from '../ads/vendors/nokta';\nimport {oblivki} from '../ads/vendors/oblivki';\nimport {onead} from '../ads/vendors/onead';\nimport {onnetwork} from '../ads/vendors/onnetwork';\nimport {openadstream} from '../ads/vendors/openadstream';\nimport {openx} from '../ads/vendors/openx';\nimport {opinary} from '../ads/vendors/opinary';\nimport {outbrain} from '../ads/vendors/outbrain';\nimport {pixels} from '../ads/vendors/pixels';\nimport {playstream} from '../ads/vendors/playstream';\nimport {plista} from '../ads/vendors/plista';\nimport {polymorphicads} from '../ads/vendors/polymorphicads';\nimport {popin} from '../ads/vendors/popin';\nimport {postquare} from '../ads/vendors/postquare';\nimport {ppstudio} from '../ads/vendors/ppstudio';\nimport {pressboard} from '../ads/vendors/pressboard';\nimport {promoteiq} from '../ads/vendors/promoteiq';\nimport {pubexchange} from '../ads/vendors/pubexchange';\nimport {pubguru} from '../ads/vendors/pubguru';\nimport {pubmatic} from '../ads/vendors/pubmatic';\nimport {pubmine} from '../ads/vendors/pubmine';\nimport {puffnetwork} from '../ads/vendors/puffnetwork';\nimport {pulse} from '../ads/vendors/pulse';\nimport {pulsepoint} from '../ads/vendors/pulsepoint';\nimport {purch} from '../ads/vendors/purch';\nimport {quoraad} from '../ads/vendors/quoraad';\nimport {rakutenunifiedads} from '../ads/vendors/rakutenunifiedads';\nimport {rbinfox} from '../ads/vendors/rbinfox';\nimport {rcmwidget} from '../ads/vendors/rcmwidget';\nimport {readmo} from '../ads/vendors/readmo';\nimport {realclick} from '../ads/vendors/realclick';\nimport {recomad} from '../ads/vendors/recomad';\nimport {recreativ} from '../ads/vendors/recreativ';\nimport {relap} from '../ads/vendors/relap';\nimport {relappro} from '../ads/vendors/relappro';\nimport {remixd} from '../ads/vendors/remixd';\nimport {revcontent} from '../ads/vendors/revcontent';\nimport {revjet} from '../ads/vendors/revjet';\nimport {rfp} from '../ads/vendors/rfp';\nimport {rnetplus} from '../ads/vendors/rnetplus';\nimport {rubicon} from '../ads/vendors/rubicon';\nimport {runative} from '../ads/vendors/runative';\nimport {sas} from '../ads/vendors/sas';\nimport {seedingalliance} from '../ads/vendors/seedingalliance';\nimport {sekindo} from '../ads/vendors/sekindo';\nimport {sharethrough} from '../ads/vendors/sharethrough';\nimport {shemedia} from '../ads/vendors/shemedia';\nimport {sklik} from '../ads/vendors/sklik';\nimport {slimcutmedia} from '../ads/vendors/slimcutmedia';\nimport {smartadserver} from '../ads/vendors/smartadserver';\nimport {smartclip} from '../ads/vendors/smartclip';\nimport {smi2} from '../ads/vendors/smi2';\nimport {smilewanted} from '../ads/vendors/smilewanted';\nimport {sogouad} from '../ads/vendors/sogouad';\nimport {sona} from '../ads/vendors/sona';\nimport {sortable} from '../ads/vendors/sortable';\nimport {sovrn} from '../ads/vendors/sovrn';\nimport {speakol} from '../ads/vendors/speakol';\nimport {spotx} from '../ads/vendors/spotx';\nimport {springAds} from '../ads/vendors/springAds';\nimport {ssp} from '../ads/vendors/ssp';\nimport {strossle} from '../ads/vendors/strossle';\nimport {sulvo} from '../ads/vendors/sulvo';\nimport {sunmedia} from '../ads/vendors/sunmedia';\nimport {svknative} from '../ads/vendors/svknative';\nimport {swoop} from '../ads/vendors/swoop';\nimport {taboola} from '../ads/vendors/taboola';\nimport {tail} from '../ads/vendors/tail';\nimport {tcsemotion} from '../ads/vendors/tcsemotion';\nimport {teads} from '../ads/vendors/teads';\nimport {temedya} from '../ads/vendors/temedya';\nimport {torimochi} from '../ads/vendors/torimochi';\nimport {tracdelight} from '../ads/vendors/tracdelight';\nimport {triplelift} from '../ads/vendors/triplelift';\nimport {trugaze} from '../ads/vendors/trugaze';\nimport {uas} from '../ads/vendors/uas';\nimport {ucfunnel} from '../ads/vendors/ucfunnel';\nimport {unruly} from '../ads/vendors/unruly';\nimport {uzou} from '../ads/vendors/uzou';\nimport {valuecommerce} from '../ads/vendors/valuecommerce';\nimport {vdoai} from '../ads/vendors/vdoai';\nimport {verizonmedia} from '../ads/vendors/verizonmedia';\nimport {videointelligence} from '../ads/vendors/videointelligence';\nimport {videonow} from '../ads/vendors/videonow';\nimport {viralize} from '../ads/vendors/viralize';\nimport {vlyby} from '../ads/vendors/vlyby';\nimport {vmfive} from '../ads/vendors/vmfive';\nimport {webediads} from '../ads/vendors/webediads';\nimport {weboramaDisplay} from '../ads/vendors/weborama';\nimport {whopainfeed} from '../ads/vendors/whopainfeed';\nimport {widespace} from '../ads/vendors/widespace';\nimport {wisteria} from '../ads/vendors/wisteria';\nimport {wpmedia} from '../ads/vendors/wpmedia';\nimport {xlift} from '../ads/vendors/xlift';\nimport {yahoo} from '../ads/vendors/yahoo';\nimport {yahoofedads} from '../ads/vendors/yahoofedads';\nimport {yahoojp} from '../ads/vendors/yahoojp';\nimport {yahoonativeads} from '../ads/vendors/yahoonativeads';\nimport {yandex} from '../ads/vendors/yandex';\nimport {yektanet} from '../ads/vendors/yektanet';\nimport {yengo} from '../ads/vendors/yengo';\nimport {yieldbot} from '../ads/vendors/yieldbot';\nimport {yieldmo} from '../ads/vendors/yieldmo';\nimport {yieldone} from '../ads/vendors/yieldone';\nimport {yieldpro} from '../ads/vendors/yieldpro';\nimport {zedo} from '../ads/vendors/zedo';\nimport {zen} from '../ads/vendors/zen';\nimport {zergnet} from '../ads/vendors/zergnet';\nimport {zucks} from '../ads/vendors/zucks';\n\ninit(window);\n\nif (getMode().test || getMode().localDev) {\n  register('_ping_', _ping_);\n  register('fake-delayed', fakeDelayed);\n}\n\n// Keep the list in alphabetic order\nregister('1wo', _1wo);\nregister('24smi', _24smi);\nregister('3d-gltf', gltfViewer);\nregister('a8', a8);\nregister('a9', a9);\nregister('accesstrade', accesstrade);\nregister('adagio', adagio);\nregister('adblade', adblade);\nregister('adbutler', adbutler);\nregister('adform', adform);\nregister('adfox', adfox);\nregister('adgeneration', adgeneration);\nregister('adglare', adglare);\nregister('adhese', adhese);\nregister('adincube', adincube);\nregister('adition', adition);\nregister('adman', adman);\nregister('admanmedia', admanmedia);\nregister('admixer', admixer);\nregister('adnuntius', adnuntius);\nregister('adocean', adocean);\nregister('adop', adop);\nregister('adpicker', adpicker);\nregister('adplugg', adplugg);\nregister('adpon', adpon);\nregister('adpushup', adpushup);\nregister('adreactor', adreactor);\nregister('adsensor', adsensor);\nregister('adservsolutions', adservsolutions);\nregister('adsloom', adsloom);\nregister('adsnative', adsnative);\nregister('adspeed', adspeed);\nregister('adspirit', adspirit);\nregister('adstir', adstir);\nregister('adstyle', adstyle);\nregister('adtech', adtech);\nregister('adtelligent', adtelligent);\nregister('adthrive', adthrive);\nregister('adunity', adunity);\nregister('aduptech', aduptech);\nregister('adventive', adventive);\nregister('adverline', adverline);\nregister('adverticum', adverticum);\nregister('advertserve', advertserve);\nregister('adyoulike', adyoulike);\nregister('affiliateb', affiliateb);\nregister('aja', aja);\nregister('amoad', amoad);\nregister('aniview', aniview);\nregister('anyclip', anyclip);\nregister('appnexus', appnexus);\nregister('appvador', appvador);\nregister('atomx', atomx);\nregister('baidu', baidu);\nregister('beaverads', beaverads);\nregister('beopinion', beopinion);\nregister('bidtellect', bidtellect);\nregister('blade', blade);\nregister('bodymovinanimation', bodymovinanimation);\nregister('brainy', brainy);\nregister('bringhub', bringhub);\nregister('broadstreetads', broadstreetads);\nregister('byplay', byplay);\nregister('caajainfeed', caajainfeed);\nregister('capirs', capirs);\nregister('caprofitx', caprofitx);\nregister('cedato', cedato);\nregister('chargeads', chargeads);\nregister('colombia', colombia);\nregister('conative', conative);\nregister('connatix', connatix);\nregister('contentad', contentad);\nregister('criteo', criteo);\nregister('csa', csa);\nregister('dable', dable);\nregister('digiteka', digiteka);\nregister('directadvert', directadvert);\nregister('distroscale', distroscale);\nregister('dotandads', dotandads);\nregister('dynad', dynad);\nregister('eadv', eadv);\nregister('embedly', embedly);\nregister('empower', empower);\nregister('engageya', engageya);\nregister('epeex', epeex);\nregister('eplanning', eplanning);\nregister('ezoic', ezoic);\nregister('f1e', f1e);\nregister('f1h', f1h);\nregister('facebook', facebook);\nregister('feedad', feedad);\nregister('felmat', felmat);\nregister('finative', finative);\nregister('firstimpression', firstimpression);\nregister('flite', flite);\nregister('fluct', fluct);\nregister('forkmedia', forkmedia);\nregister('freewheel', freewheel);\nregister('fusion', fusion);\nregister('genieessp', genieessp);\nregister('giraff', giraff);\nregister('github', github);\nregister('glomex', glomex);\nregister('gmossp', gmossp);\nregister('gumgum', gumgum);\nregister('holder', holder);\nregister('ibillboard', ibillboard);\nregister('idealmedia', idealmedia);\nregister('ima-video', imaVideo);\nregister('imedia', imedia);\nregister('imobile', imobile);\nregister('imonomy', imonomy);\nregister('improvedigital', improvedigital);\nregister('industrybrains', industrybrains);\nregister('inmobi', inmobi);\nregister('innity', innity);\nregister('insticator', insticator);\nregister('invibes', invibes);\nregister('iprom', iprom);\nregister('ix', ix);\nregister('jubna', jubna);\nregister('kargo', kargo);\nregister('ketshwa', ketshwa);\nregister('kiosked', kiosked);\nregister('kixer', kixer);\nregister('kuadio', kuadio);\nregister('lentainform', lentainform);\nregister('ligatus', ligatus);\nregister('lockerdome', lockerdome);\nregister('logly', logly);\nregister('loka', loka);\nregister('luckyads', luckyads);\nregister('macaw', macaw);\nregister('mads', mads);\nregister('mantis-display', mantisDisplay);\nregister('mantis-recommend', mantisRecommend);\nregister('marfeel', marfeel);\nregister('mathml', mathml);\nregister('mediaad', mediaad);\nregister('medianet', medianet);\nregister('mediavine', mediavine);\nregister('medyanet', medyanet);\nregister('meg', meg);\nregister('mgid', mgid);\nregister('microad', microad);\nregister('miximedia', miximedia);\nregister('mixpo', mixpo);\nregister('monetizer101', monetizer101);\nregister('mox', mox);\nregister('my6sense', my6sense);\nregister('myfinance', myfinance);\nregister('myoffrz', myoffrz);\nregister('mytarget', mytarget);\nregister('mywidget', mywidget);\nregister('nativeroll', nativeroll);\nregister('nativery', nativery);\nregister('nativo', nativo);\nregister('navegg', navegg);\nregister('nend', nend);\nregister('netletix', netletix);\nregister('noddus', noddus);\nregister('nokta', nokta);\nregister('nws', nws);\nregister('oblivki', oblivki);\nregister('onead', onead);\nregister('onnetwork', onnetwork);\nregister('openadstream', openadstream);\nregister('openx', openx);\nregister('opinary', opinary);\nregister('outbrain', outbrain);\nregister('pixels', pixels);\nregister('playstream', playstream);\nregister('plista', plista);\nregister('polymorphicads', polymorphicads);\nregister('popin', popin);\nregister('postquare', postquare);\nregister('ppstudio', ppstudio);\nregister('pressboard', pressboard);\nregister('promoteiq', promoteiq);\nregister('pubexchange', pubexchange);\nregister('pubguru', pubguru);\nregister('pubmatic', pubmatic);\nregister('pubmine', pubmine);\nregister('puffnetwork', puffnetwork);\nregister('pulse', pulse);\nregister('pulsepoint', pulsepoint);\nregister('purch', purch);\nregister('quoraad', quoraad);\nregister('rakutenunifiedads', rakutenunifiedads);\nregister('rbinfox', rbinfox);\nregister('rcmwidget', rcmwidget);\nregister('readmo', readmo);\nregister('realclick', realclick);\nregister('reddit', reddit);\nregister('recomad', recomad);\nregister('recreativ', recreativ);\nregister('relap', relap);\nregister('relappro', relappro);\nregister('remixd', remixd);\nregister('revcontent', revcontent);\nregister('revjet', revjet);\nregister('rfp', rfp);\nregister('rnetplus', rnetplus);\nregister('rubicon', rubicon);\nregister('runative', runative);\nregister('sas', sas);\nregister('seedingalliance', seedingalliance);\nregister('sekindo', sekindo);\nregister('sharethrough', sharethrough);\nregister('shemedia', shemedia);\nregister('sklik', sklik);\nregister('ssp', ssp);\nregister('slimcutmedia', slimcutmedia);\nregister('smartadserver', smartadserver);\nregister('smartclip', smartclip);\nregister('smi2', smi2);\nregister('smilewanted', smilewanted);\nregister('sogouad', sogouad);\nregister('sona', sona);\nregister('sortable', sortable);\nregister('sovrn', sovrn);\nregister('speakol', speakol);\nregister('spotx', spotx);\nregister('springAds', springAds);\nregister('strossle', strossle);\nregister('sulvo', sulvo);\nregister('sunmedia', sunmedia);\nregister('svknative', svknative);\nregister('swoop', swoop);\nregister('taboola', taboola);\nregister('tail', tail);\nregister('tcsemotion', tcsemotion);\nregister('teads', teads);\nregister('temedya', temedya);\nregister('torimochi', torimochi);\nregister('tracdelight', tracdelight);\nregister('triplelift', triplelift);\nregister('trugaze', trugaze);\nregister('twitter', twitter);\nregister('uas', uas);\nregister('ucfunnel', ucfunnel);\nregister('unruly', unruly);\nregister('uzou', uzou);\nregister('valuecommerce', valuecommerce);\nregister('vdoai', vdoai);\nregister('verizonmedia', verizonmedia);\nregister('videointelligence', videointelligence);\nregister('videonow', videonow);\nregister('viqeoplayer', viqeoplayer);\nregister('viralize', viralize);\nregister('vlyby', vlyby);\nregister('vmfive', vmfive);\nregister('webediads', webediads);\nregister('weborama-display', weboramaDisplay);\nregister('whopainfeed', whopainfeed);\nregister('widespace', widespace);\nregister('wisteria', wisteria);\nregister('wpmedia', wpmedia);\nregister('xlift', xlift);\nregister('yahoo', yahoo);\nregister('yahoofedads', yahoofedads);\nregister('yahoojp', yahoojp);\nregister('yahoonativeads', yahoonativeads);\nregister('yandex', yandex);\nregister('yektanet', yektanet);\nregister('yengo', yengo);\nregister('yieldbot', yieldbot);\nregister('yieldmo', yieldmo);\nregister('yieldone', yieldone);\nregister('yieldpro', yieldpro);\nregister('yotpo', yotpo);\nregister('zedo', zedo);\nregister('zen', zen);\nregister('zergnet', zergnet);\nregister('zucks', zucks);\n\nwindow.draw3p = draw3p;\n"],
  "mappings": "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",
  "names": []
}
