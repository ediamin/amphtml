(self.AMP=self.AMP||[]).push({n:"amp-access-laterpay",ev:"0.2",l:true,v:"2106040012000",m:0,f:function(AMP,_){"use strict";var g;function l(){return g?g:g=Promise.resolve(void 0)}function m(){var a=this;this.promise=new Promise((function(b,c){a.resolve=b;a.reject=c}))}var n=/(?:^[#?]?|&)([^=&]+)(?:=([^&]*))?/g;function p(a,b){var c=b=void 0===b?"":b;try{return decodeURIComponent(a)}catch(d){return c}}function q(a){var b=Object.create(null);if(!a)return b;for(var c;c=n.exec(a);){var d=p(c[1],c[1]);c=c[2]?p(c[2].replace(/\+/g," "),c[2]):"";b[d]=c}return b}var r="";var t=self.AMP_CONFIG||{},u=("string"==typeof t.cdnProxyRegex?new RegExp(t.cdnProxyRegex):t.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function v(a){if(self.document&&self.document.head&&(!self.location||!u.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}t.cdnUrl||v("runtime-host");t.geoApiUrl||v("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var w=self.__AMP_LOG;function x(){if(!w.user)throw Error("failed to call initLogConstructor");return w.user}function y(){if(w.dev)return w.dev;throw Error("failed to call initLogConstructor")}function z(a,b,c,d,e,f){return x().assert(a,b,c,d,e,f,void 0,void 0,void 0,void 0,void 0)}function A(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return B(a,b)}function C(a){var b=D(a);b=E(b);return B(b,"viewport")}function D(a){return a.nodeType?A((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function E(a){a=D(a);return a.isSingleDoc()?a.win:a}function B(a,b){a=F(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function G(a){var b=F(a).access;if(b){if(b.promise)return b.promise;B(a,"access");return b.promise=Promise.resolve(b.obj)}return null}function F(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function H(){var a=new m,b=a.promise,c=a.reject;a=a.resolve;b.catch((function(){}));return{obj:null,promise:b,resolve:a,reject:c,context:null,ctor:null}}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function I(a){return J(a).then((function(b){return z(b,"Service %s was requested to be provided through %s, but %s is not loaded in the current page. To fix this problem load the JavaScript file for %s in this page.","access","amp-access","amp-access","amp-access")}))}function J(a){var b=G(E(a));if(b)return b;var c=D(a);return c.whenExtensionsKnown().then((function(){var d=c.getExtensionVersion("amp-access");return d?A(c.win,"extensions").waitForExtension("amp-access",d):null})).then((function(d){if(d){var e=E(a);var f=G(e);f?e=f:(e=F(e),e.access=H(),e=e.access.promise)}else e=null;return e}))}function aa(a,b){var c=a.getHeadNode(),d=ba(c,ca(c));if(b){var e=a.getRootNode();if(K(e,d))b(d);else var f=setInterval((function(){K(e,d)&&(clearInterval(f),b(d))}),4)}}function ba(a,b){var c=a.__AMP_CSS_SM;c||(c=a.__AMP_CSS_SM=Object.create(null));var d=O(a,c,"amp-extension=amp-access-laterpay");if(d)return d.textContent!==b&&(d.textContent=b),d;var e=(a.ownerDocument||a).createElement("style");e.textContent=b;e.setAttribute("amp-extension","amp-access-laterpay");b=O(a,c,"amp-runtime");(b=void 0===b?null:b)?a.insertBefore(e,b.nextSibling):a.insertBefore(e,a.firstChild);return c["amp-extension=amp-access-laterpay"]=e}function O(a,b,c){return b[c]?b[c]:(a=a.querySelector("style["+c+"]"))?b[c]=a:null}function ca(a){return(a=a.__AMP_CSS_TR)?a(".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.2/amp-access-laterpay.css*/"):".amp-access-laterpay{position:relative}@media (min-width:420px){.amp-access-laterpay{width:420px}}.amp-access-laterpay ul{width:100%;padding:0;margin:0 0 40px}.amp-access-laterpay li{list-style:none;display:-ms-flexbox;display:flex;margin-bottom:20px}.amp-access-laterpay label{display:-ms-flexbox;display:flex;padding-right:10px}.amp-access-laterpay input{width:20px}.amp-access-laterpay-container{padding:16px 24px 16px 16px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;-ms-flex-align:center;align-items:center;border-radius:12px;box-shadow:0 0 10px -1px rgba(0,0,0,.25)}.amp-access-laterpay-sandbox{width:112%;padding:15px 10px;background-color:#f2902a;color:#fff;font-weight:700;text-align:center}.amp-access-laterpay-badge{text-align:center;color:#999}.amp-access-laterpay-badge a{color:#8db444}.amp-access-laterpay-header{font-size:1.2em;margin-bottom:40px}.amp-access-laterpay-metadata{width:92%}.amp-access-laterpay-title{font-size:1.1em;margin:0;padding:0}.amp-access-laterpay-description{font-size:0.9em;margin:0;padding:0}.amp-access-laterpay-price-container{margin-top:0;margin-left:auto}.amp-access-laterpay-price{font-size:1.5em}.amp-access-laterpay-currency{font-size:0.7em}.amp-access-laterpay-purchase-button{font-size:1.1em;padding:0.5em 0.8em;background-color:#8db444;border-radius:4px;border:0;color:#fff;width:70%}.amp-access-laterpay-already-purchased-link-container{font-size:0.9em}\n/*# sourceURL=/extensions/amp-access-laterpay/0.2/amp-access-laterpay.css*/"}function K(a,b){var c=a.styleSheets;for(a=0;a<c.length;a++)if(c[a].ownerNode==b)return!0;return!1}var P;function da(a,b,c){function d(k){try{return f(k)}catch(L){var M,N;null==(N=(M=self).__AMP_REPORT_ERROR)||N.call(M,L);throw L}}var e=a,f=c,h=ea();e.addEventListener(b,d,h?void 0:!1);return function(){var k;null==(k=e)||k.removeEventListener(b,d,h?void 0:!1);d=e=f=null}}function ea(){if(void 0!==P)return P;P=!1;try{var a={get capture(){P=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return P}function Q(a,b,c){return da(a,b,c)}var fa={eu:"https://connector.laterpay.net",us:"https://connector.uselaterpay.com"},ha={eu:"https://connector.sandbox.laterpaytest.net",us:"https://connector.sandbox.uselaterpaytest.com"},ia={payLaterButton:"Buy Now, Pay Later",payNowButton:"Buy Now",defaultButton:"Buy Now",alreadyPurchasedLink:"I already bought this",sandbox:"Site in test mode. No payment required.",laterpayBadgePrefix:"Powered by ",laterpayBadgeSuffix:""};function R(a,b){this.ampdoc=a.ampdoc;this.A=b;this.R=C(this.ampdoc);this.h=this.A.getAdapterConfig();this.D=this.F=this.G=this.J=null;this.K=[];this.H=!0;this.I=this.C=this.j=null;this.M=this.h.locale||"en";this.o=Object.assign({},ia,this.h.localeMessages||{});this.B=ja(this)+"/api/v2/fetch/amp/?article_url=CANONICAL_URL&amp_reader_id=READER_ID&return_url=RETURN_URL";var c=this.h.articleId;c&&(this.B+="&article_id="+encodeURIComponent(c));var d=this.h.jwt;d&&(this.B+="&jwt="+encodeURIComponent(d));this.P=B(this.ampdoc.win,"timer");this.L=A(this.ampdoc.win,"vsync");this.S=A(this.ampdoc.win,"xhr");aa(this.ampdoc,(function(){}))}function ja(a){var b=a.h.region||"eu",c=self;if(c.__AMP_MODE)c=c.__AMP_MODE;else{var d=q(c.location.originalHash||c.location.hash);r||(r=c.AMP_CONFIG&&c.AMP_CONFIG.v?c.AMP_CONFIG.v:"012106040012000");var e=q(c.location.originalHash||c.location.hash);d={localDev:!1,development:!(!["1","actions","amp","amp4ads","amp4email"].includes(e.development)&&!c.AMP_DEV_MODE),examiner:"2"==d.development,esm:!1,geoOverride:d["amp-geo"],minified:!0,test:!1,log:d.log,version:"2106040012000",rtvVersion:r};c=c.__AMP_MODE=d}return c.development&&a.h.configUrl?a.h.configUrl:a.h.sandbox?ha[b]:fa[b]}R.prototype.authorize=function(){var a=this;return ka(this).then((function(b){if(204===b.status)throw x().createError("No merchant domains have been matched for this article, or no paid content configurations are setup.");a.h.scrollToTopAfterAuth&&a.L.mutate((function(){return a.R.setScrollTop(0)}));S(a);return{access:b.access}}),(function(b){if(!b||!b.response)throw b;var c=b.response;if(402!==c.status)throw b;return c.json().catch((function(){})).then((function(d){a.J=d;a.G=la(a,d.purchase_options);S(a).then(a.O.bind(a));return{access:!1}}))}))};function ka(a){var b=a.B+"&article_title="+encodeURIComponent(T(a));return a.A.buildUrl(b,!1).then((function(c){return a.A.getLoginUrl(c)})).then((function(c){y().info("amp-access-laterpay","Authorization URL: ",c);return a.P.timeoutPromise(3e3,a.S.fetchJson(c,{credentials:"include"})).then((function(d){return d.json()}))}))}function la(a,b){var c=T(a),d={};d.singlePurchases=b.filter((function(e){return"single_purchase"===e.sales_model}));d.singlePurchases.forEach((function(e){return e.description=c}));d.timepasses=b.filter((function(e){return"timepass"===e.sales_model}));d.subscriptions=b.filter((function(e){return"subscription"===e.sales_model}));return d}function U(a,b){return a.ampdoc.win.document.createElement(b)}function T(a){var b=a.ampdoc.getRootNode().querySelector(a.h.articleTitleSelector);z(b,"No article title element found with selector %s",a.h.articleTitleSelector);return b.textContent.trim()}function V(a){var b=a.ampdoc.getElementById("amp-access-laterpay-dialog");return x().assertElement(b,"No element found with id amp-access-laterpay-dialog")}function S(a){if(a.H)return l();for(var b;b=a.K.shift();)b();a.F&&(a.F(),a.F=null);a.D&&(a.D(),a.D=null);return a.L.mutatePromise((function(){a.H=!0;a.j=null;for(var c=V(a);c.firstChild;)c.removeChild(c.firstChild)}))}R.prototype.O=function(){var a=this,b=V(this);this.j=U(this,"div");this.j.className="amp-access-laterpay-container";this.h.sandbox&&W(this,"sandbox");W(this,"header");var c=U(this,"ul");this.G.singlePurchases.forEach((function(e){c.appendChild(X(a,e))}));this.G.timepasses.forEach((function(e){c.appendChild(X(a,e))}));this.G.subscriptions.forEach((function(e){c.appendChild(X(a,e))}));var d=U(this,"button");d.className="amp-access-laterpay-purchase-button";d.textContent=this.o.defaultButton;this.I=d;this.F=Q(d,"click",(function(e){Y(a,e,a.C.value,a.C.dataset.purchaseType)}));this.j.appendChild(c);this.j.appendChild(d);this.j.appendChild(ma(this,this.J.identify_url));W(this,"footer");b.appendChild(this.j);b.appendChild(na(this));this.H=!1;oa(this,c.firstElementChild)};function oa(a,b){var c=b.querySelector('input[type="radio"]');c.checked=!0;Z(a,c)}function W(a,b){if(a.o[b]){var c=U(a,"p");c.className="amp-access-laterpay-"+b;c.textContent=a.o[b];a.j.appendChild(c)}}function na(a){var b=U(a,"a");b.href="https://blog.laterpay.net/laterpay-academy/what-is-laterpay";b.target="_blank";b.textContent="LaterPay";var c=U(a,"p"),d=U(a,"span");d.textContent=a.o.laterpayBadgePrefix;var e=U(a,"span");e.textContent=a.o.laterpayBadgeSuffix;c.className="amp-access-laterpay-badge";c.appendChild(d);c.appendChild(b);c.appendChild(e);return c}function X(a,b){var c=U(a,"li"),d=U(a,"label");d.for=b.title;var e=d.appendChild,f=U(a,"input");f.name="purchaseOption";f.type="radio";f.id=b.title;f.value=b.purchase_url;var h="pay_later"===b.price.payment_model?"payLater":"payNow";f.setAttribute("data-purchase-action-label",a.o[h+"Button"]);f.setAttribute("data-purchase-type",h);a.K.push(Q(f,"change",a.N.bind(a)));e.call(d,f);var k=U(a,"div");k.className="amp-access-laterpay-metadata";e=U(a,"span");e.className="amp-access-laterpay-title";e.textContent=b.title;k.appendChild(e);e=U(a,"p");e.className="amp-access-laterpay-description";e.textContent=b.description;k.appendChild(e);d.appendChild(k);c.appendChild(d);e=c.appendChild;f=b.price;h=(f.amount/100).toLocaleString(a.M,{style:"decimal",minimumFractionDigits:0});b=U(a,"span");b.className="amp-access-laterpay-price";b.textContent=h;h=U(a,"sup");h.className="amp-access-laterpay-currency";h.textContent=f.currency;a=U(a,"p");a.className="amp-access-laterpay-price-container";a.appendChild(b);a.appendChild(h);e.call(c,a);return c}function ma(a,b){var c=U(a,"p");c.className="amp-access-laterpay-already-purchased-link-container";var d=U(a,"a");d.href=b;d.textContent=a.o.alreadyPurchasedLink;a.D=Q(d,"click",(function(e){Y(a,e,b,"alreadyPurchased")}));c.appendChild(d);return c}R.prototype.N=function(a){a.preventDefault();Z(this,a.target)};function Z(a,b){var c=a.C,d=b.dataset.purchaseActionLabel;c&&c.classList.contains("amp-access-laterpay-selected")&&c.classList.remove("amp-access-laterpay-selected");a.C=b;a.C.classList.add("amp-access-laterpay-selected");a.I.textContent=d}function Y(a,b,c,d){b.preventDefault();a.A.buildUrl(c,!1).then((function(e){y().fine("amp-access-laterpay","Authorization URL: ",e);a.A.loginWithUrl(e,d)}))}R.prototype.pingback=function(){return l()};(function(a){a.registerServiceForDoc("laterpay",(function(b){b=b.getHeadNode();return I(b).then((function(c){var d=c.getVendorSource("laterpay"),e=new R(c,d);d.getAdapter().registerVendor(e);return e}))}))})(self.AMP)}});//# sourceMappingURL=amp-access-laterpay-0.2.js.map