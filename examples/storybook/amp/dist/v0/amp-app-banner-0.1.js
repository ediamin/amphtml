(self.AMP=self.AMP||[]).push({n:"amp-app-banner",ev:"0.1",l:true,v:"2106040012000",m:0,f:function(AMP,_){"use strict";function g(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var h="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function k(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object")})()}k(this);"function"===typeof Symbol&&Symbol("x");var l;if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var m;a:{var p={a:!0},q={};try{q.__proto__=p;m=q.a;break a}catch(a){}m=!1}l=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var r=l;function t(a,b){a.prototype=h(b.prototype);a.prototype.constructor=a;if(r)r(a,b);else for(var c in b)if("prototype"!=c)if(Object.defineProperties){var d=Object.getOwnPropertyDescriptor(b,c);d&&Object.defineProperty(a,c,d)}else a[c]=b[c];a.G=b.prototype}var u;function v(){return u?u:u=Promise.resolve(void 0)}function w(){var a=this;this.promise=new Promise((function(b,c){a.resolve=b;a.reject=c}))}function x(a){return a||{}}function y(a){var b=null,c="";var d=arguments;var e="undefined"!=typeof Symbol&&Symbol.iterator&&d[Symbol.iterator];d=e?e.call(d):{next:g(d)};for(e=d.next();!e.done;e=d.next())if(e=e.value,e instanceof Error&&!b){var f=b=void 0;if(null==(f=Object.getOwnPropertyDescriptor(e,"message"))?0:f.writable)b=e;else{f=e.stack;var n=Error(e.message);for(b in e)n[b]=e[b];n.stack=f;b=n}}else c&&(c+=" "),c+=e;b?c&&(b.message=c+": "+b.message):b=Error(c);return b}function z(a){var b=y.apply(null,arguments);setTimeout((function(){var c,d;null==(d=(c=self).__AMP_REPORT_ERROR)||d.call(c,b);throw b}))}var A=self.AMP_CONFIG||{},B=("string"==typeof A.cdnProxyRegex?new RegExp(A.cdnProxyRegex):A.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function C(a){if(self.document&&self.document.head&&(!self.location||!B.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}A.cdnUrl||C("runtime-host");A.geoApiUrl||C("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var D=self.__AMP_LOG;function E(){if(!D.user)throw Error("failed to call initLogConstructor");return D.user}function F(){if(D.dev)return D.dev;throw Error("failed to call initLogConstructor")}function G(a,b,c,d){return E().assert(a,b,c,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}function H(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return I(a,b)}function J(a,b){var c=K(a);c=L(c);return I(c,b)}function M(a){a=K(a);a=L(a);return N(a,"url")?I(a,"url"):null}function K(a){return a.nodeType?H((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function L(a){a=K(a);return a.isSingleDoc()?a.win:a}function I(a,b){N(a,b);a=O(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function P(a){var b;(b=O(a).storage)?b.promise?b=b.promise:(I(a,"storage"),b=b.promise=Promise.resolve(b.obj)):b=null;var c=b;if(c)return c;a=O(a);a.storage=aa();return a.storage.promise}function O(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function N(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor)}function aa(){var a=new w,b=a.promise,c=a.reject;a=a.resolve;b.catch((function(){}));return{obj:null,promise:b,resolve:a,reject:c,context:null,ctor:null}}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function Q(a,b){try{a.open(b,"_top",void 0)}catch(c){F().error("DOM","Failed to open url on target: ","_top",c)}}function R(a){a=AMP.BaseElement.call(this,a)||this;a.A=null;a.j=!1;return a}t(R,AMP.BaseElement);R.prototype.openButtonClicked=function(){};function S(a,b,c,d){b.addEventListener("click",(function(){a.openButtonClicked(c,d)}))}R.prototype.F=function(){this.getVsync().run({measure:void 0,mutate:ba},{element:this.element,viewport:this.getViewport(),storagePromise:P(L(this.getAmpDoc())),storageKey:T(this)})};function T(a){return"amp-app-banner:"+G(a.element.id,"amp-app-banner should have an id.")}R.prototype.isDismissed=function(){var a=this;return P(L(this.getAmpDoc())).then((function(b){return b.get(T(a))})).then((function(b){return!!b}),(function(b){F().error("amp-app-banner","Failed to read storage",b);return!1}))};function U(a){a.isDismissed().then((function(b){if(b)V(a);else{var c=a.win.document.createElement("i-amphtml-app-banner-top-padding");a.element.appendChild(c);c=a.win.document.createElement("button");c.classList.add("amp-app-banner-dismiss-button");c.setAttribute("aria-label",a.element.getAttribute("data-dismiss-button-aria-label")||"Dismiss");var d=a.F.bind(a);c.addEventListener("click",d);a.element.appendChild(c);a.getVsync().run({measure:ca,mutate:da},{element:a.element,viewport:a.getViewport()});a.expand()}}))}function V(a){return a.getVsync().runPromise({measure:void 0,mutate:W},{element:a.element,viewport:a.getViewport()})}function X(a){return R.call(this,a)||this}t(X,R);X.prototype.upgradeCallback=function(){var a=H(this.win,"platform");return a.isIos()?new Y(this.element):a.isAndroid()?new Z(this.element):null};X.prototype.layoutCallback=function(){E().info("amp-app-banner","Only iOS or Android platforms are currently supported.");return V(this)};function Y(a){a=R.call(this,a)||this;a.h=null;a.C=null;return a}t(Y,R);Y.prototype.preconnectCallback=function(a){this.element.parentNode&&H(this.win,"preconnect").url(this.getAmpDoc(),"https://itunes.apple.com",a)};Y.prototype.buildCallback=function(){this.h=J(this.getAmpDoc(),"viewer");var a=H(this.win,"platform");(this.j=!this.h.isEmbedded()&&a.isSafari())?(E().info("amp-app-banner","Browser supports builtin banners. Not rendering amp-app-banner."),V(this)):this.h.isEmbedded()&&!this.h.hasCapability("navigateTo")?V(this):(this.C=this.getAmpDoc().getMetaByName("apple-itunes-app"),null===this.C?V(this):(this.A=G(this.element.querySelector("button[open-button]"),"<button open-button> is required inside %s: %s","amp-app-banner",this.element),ea(this,this.C),U(this)))};Y.prototype.layoutCallback=function(){return v()};Y.prototype.openButtonClicked=function(a,b){var c=this;this.h.isEmbedded()?(I(this.win,"timer").delay((function(){c.h.sendMessage("navigateTo",x({url:b}))}),1500),this.h.sendMessage("navigateTo",x({url:a}))):(I(this.win,"timer").delay((function(){Q(c.win,b)}),1500),Q(this.win,a))};function ea(a,b){var c={};b.replace(/\s/,"").split(",").forEach((function(f){var n=f.split("=");c[n[0]]=n[1]}));var d=c["app-id"],e=c["app-argument"];e?G(M(a.element).isProtocolValid(e),"The url in app-argument has invalid protocol: %s",e):E().error("amp-app-banner",'<meta name="apple-itunes-app">\'s content should contain app-argument to allow opening an already installed application on iOS.');d="https://itunes.apple.com/us/app/id"+d;S(a,a.A,e||d,d)}function Z(a){a=R.call(this,a)||this;a.B=null;a.o="";a.D=!1;return a}t(Z,R);Z.prototype.preconnectCallback=function(a){this.element.parentNode&&(H(this.win,"preconnect").url(this.getAmpDoc(),"https://play.google.com",a),this.o&&H(this.win,"preconnect").preload(this.getAmpDoc(),this.o))};Z.prototype.buildCallback=function(){var a=this.element,b=this.win,c=J(this.getAmpDoc(),"viewer");this.B=b.document.head.querySelector("link[rel=manifest],link[rel=origin-manifest]");var d=H(b,"platform"),e=M(a),f=d.isAndroid()&&d.isChrome();(this.j=!e.isProxyOrigin(b.location)&&!c.isEmbedded()&&f)?(E().info("amp-app-banner","Browser supports builtin banners. Not rendering amp-app-banner."),V(this)):(this.D=d.isAndroid()&&!this.B)?V(this):(this.o=this.B.getAttribute("href"),e.assertHttpsUrl(this.o,a,"manifest href"),this.A=G(a.querySelector("button[open-button]"),"<button open-button> is required inside %s: %s","amp-app-banner",a),U(this))};Z.prototype.layoutCallback=function(){var a=this;return this.D||this.j?v():H(this.win,"xhr").fetchJson(this.o,{}).then((function(b){return b.json()})).then((function(b){var c;a:{if(c=b.related_applications){for(var d=0;d<c.length;d++){var e=c[d];if("play"==e.platform){c="https://play.google.com/store/apps/details?id="+e.id;e=e.id;d=a.element;var f=J(d,"documentInfo").get().canonicalUrl;d=M(d).parse(f);f=d.protocol.replace(":","");S(a,a.A,"android-app://"+e+"/"+f+"/"+d.host+d.pathname,c);c=void 0;break a}}E().warn("amp-app-banner","Could not find a platform=play app in manifest: %s",a.element)}else E().warn("amp-app-banner","related_applications is missing from manifest.json file: %s",a.element);c=void 0}return c})).catch((function(b){V(a);z(b)}))};Z.prototype.openButtonClicked=function(a,b){var c=this;I(this.win,"timer").delay((function(){c.win.top.location.assign(b)}),1500);Q(this.win,a)};function ba(a){W(a);a.storagePromise.then((function(b){b.set(a.storageKey,!0)}))}function W(a){a.viewport.removeFromFixedLayer(a.element);var b=a.element;b.parentElement&&b.parentElement.removeChild(b);a.viewport.updatePaddingBottom(0)}function ca(a){a.bannerHeight=a.viewport.getLayoutRect(a.element).height}function da(a){a.viewport.updatePaddingBottom(a.bannerHeight);a.viewport.addToFixedLayer(a.element)}(function(a){a.registerElement("amp-app-banner",X,"amp-app-banner{position:fixed!important;bottom:0!important;left:0;width:100%;max-height:100px!important;box-sizing:border-box;background:#fff;z-index:13;box-shadow:0 0 5px 0 rgba(0,0,0,0.2)!important}i-amphtml-app-banner-top-padding{position:absolute;top:0;left:0;right:0;background:#fff;height:4px;z-index:15}.amp-app-banner-dismiss-button{position:absolute;width:28px;height:28px;top:-28px;right:0;background-image:url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='13' height='13' viewBox='341 8 13 13' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath fill='%234F4F4F' d='M354 9.31 352.69 8l-5.19 5.19L342.31 8 341 9.31l5.19 5.19-5.19 5.19 1.31 1.31 5.19-5.19 5.19 5.19 1.31-1.31-5.19-5.19z' fill-rule='evenodd'/%3E%3C/svg%3E\");background-size:13px 13px;background-position:9px;background-color:#fff;background-repeat:no-repeat;z-index:14;box-shadow:0 -1px 1px 0 rgba(0,0,0,0.2);border:none;border-radius:12px 0 0 0}.amp-app-banner-dismiss-button:before{position:absolute;content:\"\";top:-20px;right:0;left:-20px;bottom:0}[dir=rtl] .amp-app-banner-dismiss-button{right:auto;left:0;border-top-left-radius:0;border-top-right-radius:12px;background-position:6px}[dir=rtl] .amp-app-banner-dismiss-button:before{right:-20px;left:0}\n/*# sourceURL=/extensions/amp-app-banner/0.1/amp-app-banner.css*/")})(self.AMP)}});//# sourceMappingURL=amp-app-banner-0.1.js.map