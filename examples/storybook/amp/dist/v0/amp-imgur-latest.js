(self.AMP=self.AMP||[]).push({n:"amp-imgur",ev:"0.1",l:true,v:"2106040012000",m:0,f:function(AMP,_){"use strict";var f="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function k(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object")})()}k(this);"function"===typeof Symbol&&Symbol("x");var l;if("function"==typeof Object.setPrototypeOf)l=Object.setPrototypeOf;else{var m;a:{var n={a:!0},p={};try{p.__proto__=n;m=p.a;break a}catch(a){}m=!1}l=m?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var q=l;function r(){var a=this;this.promise=new Promise((function(b,c){a.resolve=b;a.reject=c}))}var t=Object.prototype.toString;var u=self.AMP_CONFIG||{},v=("string"==typeof u.cdnProxyRegex?new RegExp(u.cdnProxyRegex):u.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function w(a){if(self.document&&self.document.head&&(!self.location||!v.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}u.cdnUrl||w("runtime-host");u.geoApiUrl||w("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var x=self.__AMP_LOG;function B(){if(!x.user)throw Error("failed to call initLogConstructor");return x.user}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function C(a,b){a=a.createElement("iframe");for(var c in b)a.setAttribute(c,b[c]);return a}var D;function E(a,b){function c(g){try{return h(g)}catch(y){var z,A;null==(A=(z=self).__AMP_REPORT_ERROR)||A.call(z,y);throw y}}var d=a,h=b,e=F();d.addEventListener("message",c,e?void 0:!1);return function(){var g;null==(g=d)||g.removeEventListener("message",c,e?void 0:!1);c=d=h=null}}function F(){if(void 0!==D)return D;D=!1;try{var a={get capture(){D=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return D}function G(a,b){return E(a,b)}function H(a){a=AMP.BaseElement.call(this,a)||this;a.h=null;a.j=null;a.o=null;return a}var I=AMP.BaseElement;H.prototype=f(I.prototype);H.prototype.constructor=H;if(q)q(H,I);else for(var J in I)if("prototype"!=J)if(Object.defineProperties){var K=Object.getOwnPropertyDescriptor(I,J);K&&Object.defineProperty(H,J,K)}else H[J]=I[J];H.B=I.prototype;H.prototype.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a||"fluid"==a||"intrinsic"==a};H.prototype.buildCallback=function(){var a=this.element.dataset.imgurId,b=this.element;B().assert(a,"The data-imgur-id attribute is required for <amp-imgur> %s",b,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)};H.prototype.layoutCallback=function(){var a=this;this.j=G(this.win,this.A.bind(this));var b=this.element.dataset.imgurId.replace(/^(a\/)?(.*)/,(function(c,d,h){return(d||"")+encodeURIComponent(h)}));return L(this,b).catch((function(c){if(b.startsWith("a/"))throw c;var d="a/"+b;return L(a,d).then((function(){B().warn("amp-imgur",'id should be prefixed with "a/", loaded album using data-imgur-id="'+d+'". This element should be updated to use "a/".')}))})).catch((function(){B().error("amp-imgur",'Failed to load. Is "'+b+'" a correct id?')}))};function L(a,b){var c=a.element,d=C(c.ownerDocument,{scrolling:"no",frameborder:"0",allowfullscreen:"true",title:c.title||"imgur post"});d.src="https://imgur.com/"+b+"/embed?pub=true";a.h&&c.removeChild(a.h);a.h=d;c.appendChild(d);a.applyFillContent(d);b=new r;var h=b.promise;a.o=b.resolve;return a.loadPromise(a.h).then((function(){var e=a.win,g=e.__AMP_SERVICES;g||(g=e.__AMP_SERVICES={});e=g.timer;e.obj||(e.obj=new e.ctor(e.context),e.context=null,e.resolve&&e.resolve(e.obj));return e.obj.timeoutPromise(500,h)}))}H.prototype.A=function(a){if("https://imgur.com"==a.origin&&a.source==this.h.contentWindow){var b=a.data;if(b&&("[object Object]"===t.call(b)||b.startsWith("{"))){null==this||this.o();if("[object Object]"===t.call(b))var c=b;else try{c=JSON.parse(b)}catch(d){c=null}a=c;"resize_imgur"==a.message&&this.attemptChangeHeight(a.height).catch((function(){}))}}};H.prototype.unlayoutCallback=function(){if(this.h){var a=this.h;a.parentElement&&a.parentElement.removeChild(a);this.h=null}this.j&&this.j();return!0};(function(a){a.registerElement("amp-imgur",H)})(self.AMP)}});//# sourceMappingURL=amp-imgur-0.1.js.map