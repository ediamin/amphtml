(self.AMP=self.AMP||[]).push({n:"amp-o2-player",ev:"0.1",l:true,v:"2106040012000",m:0,f:function(AMP,_){"use strict";function l(a){var b=0;return function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}}}var p="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function aa(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],d=0;d<b.length;++d){var c=b[d];if(c&&c.Math==Math)return}(function(){throw Error("Cannot find global object")})()}aa(this);"function"===typeof Symbol&&Symbol("x");var q;if("function"==typeof Object.setPrototypeOf)q=Object.setPrototypeOf;else{var r;a:{var ba={a:!0},t={};try{t.__proto__=ba;r=t.a;break a}catch(a){}r=!1}q=r?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var u=q;function ca(a,b){for(var d=[],c=0,e=0;e<a.length;e++){var f=a[e];b(f,e,a)?d.push(f):(c<e&&(a[c]=f),c++)}c<a.length&&(a.length=c)}function v(a){return a||{}}function da(a){var b=null,d="";var c=arguments;var e="undefined"!=typeof Symbol&&Symbol.iterator&&c[Symbol.iterator];c=e?e.call(c):{next:l(c)};for(e=c.next();!e.done;e=c.next())if(e=e.value,e instanceof Error&&!b){var f=b=void 0;if(null==(f=Object.getOwnPropertyDescriptor(e,"message"))?0:f.writable)b=e;else{f=e.stack;var g=Error(e.message);for(b in e)g[b]=e[b];g.stack=f;b=g}}else d&&(d+=" "),d+=e;b?d&&(b.message=d+": "+b.message):b=Error(d);return b}function ea(a){var b=da.apply(null,arguments);setTimeout((function(){var d,c;null==(c=(d=self).__AMP_REPORT_ERROR)||c.call(d,b);throw b}))}function w(a,b){for(var d=[],c=1;c<arguments.length;++c)d[c-1]=arguments[c];try{a.apply(null,d)}catch(e){ea(e)}}var x=self.AMP_CONFIG||{},fa=("string"==typeof x.cdnProxyRegex?new RegExp(x.cdnProxyRegex):x.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function z(a){if(self.document&&self.document.head&&(!self.location||!fa.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}x.cdnUrl||z("runtime-host");x.geoApiUrl||z("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var A=self.__AMP_LOG;function B(){if(A.dev)return A.dev;throw Error("failed to call initLogConstructor")}function C(a,b,d){if(!A.user)throw Error("failed to call initLogConstructor");return A.user.assert(a,b,d,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0)}function D(a,b){try{return JSON.parse(a)}catch(d){return null==b||b(d),null}}function ha(a){if(!E(a))return null;var b=a.indexOf("{");return D(a.substr(b),(function(d){return B().error("MESSAGING","Failed to parse message: "+a,d)}))}function E(a){return"string"==typeof a&&0==a.indexOf("amp-")&&-1!=a.indexOf("{")}var ia={getPropertyPriority:function(){return""},getPropertyValue:function(){return""}};var ja=/vertical/,F=new WeakMap,G=new WeakMap,H=new WeakMap;function ka(a,b){var d=a.ownerDocument.defaultView;if(d){var c=G.get(a);c||(c=[],G.set(a,c),I(d).observe(a));if(!c.some((function(f){return f.callback===b&&1===f.type}))){c.push({type:1,callback:b});var e=H.get(a);e&&setTimeout((function(){return J(1,b,e)}))}}}function la(a,b){var d=G.get(a);d&&(ca(d,(function(c){return c.callback===b&&1===c.type})),0==d.length&&(G.delete(a),H.delete(a),(d=a.ownerDocument.defaultView)&&I(d).unobserve(a)))}function I(a){var b=F.get(a);b||(b=new a.ResizeObserver(ma),F.set(a,b));return b}function ma(a){for(var b=new Set,d=a.length-1;0<=d;d--){var c=a[d],e=c.target;if(!b.has(e)){b.add(e);var f=G.get(e);if(f)for(H.set(e,c),e=0;e<f.length;e++){var g=f[e];J(g.type,g.callback,c)}}}}function J(a,b,d){if(0==a)a=d.contentRect,w(b,{width:a.width,height:a.height});else if(1==a){var c=d.borderBoxSize;if(c)var e=0<c.length?c[0]:{inlineSize:0,blockSize:0};else{a=d.target;var f=ja.test((a.ownerDocument.defaultView.getComputedStyle(a)||ia)["writing-mode"]),g=a.offsetHeight,k=a.offsetWidth;if(f){var m=k;var h=g}else h=k,m=g;e={inlineSize:h,blockSize:m}}w(b,e)}}function K(a){this.D=a;this.F=this.I=!1;this.A=this.A.bind(this)}K.prototype.updatePlaying=function(a){a!==this.I&&((this.I=a)?(this.F=!1,ka(this.D,this.A)):la(this.D,this.A))};K.prototype.A=function(a){var b=a.blockSize,d=0<a.inlineSize&&0<b;d!==this.F&&((this.F=d)||this.D.pause())};function na(){var a=this;this.promise=new Promise((function(b,d){a.resolve=b;a.reject=d}))}function L(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return M(a,b)}function N(a){return a.nodeType?L((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function O(a){a=N(a);return a.isSingleDoc()?a.win:a}function M(a,b){a=P(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function Q(a){var b=P(a).consentPolicyManager;if(b){if(b.promise)return b.promise;M(a,"consentPolicyManager");return b.promise=Promise.resolve(b.obj)}return null}function P(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function oa(){var a=new na,b=a.promise,d=a.reject;a=a.resolve;b.catch((function(){}));return{obj:null,promise:b,resolve:a,reject:d,context:null,ctor:null}}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function R(a){var b=Q(O(a));if(b)return b;var d=N(a);return d.whenExtensionsKnown().then((function(){var c=d.getExtensionVersion("amp-consent");return c?L(d.win,"extensions").waitForExtension("amp-consent",c):null})).then((function(c){if(c){var e=O(a);var f=Q(e);f?e=f:(e=P(e),e.consentPolicyManager=oa(),e=e.consentPolicyManager.promise)}else e=null;return e}))}function pa(a,b){var d=b=void 0===b?"default":b;return R(a).then((function(c){return c?c.whenPolicyResolved(d):null}))}function qa(a,b){var d=void 0===b?"default":b;return R(a).then((function(c){return c?c.getConsentStringInfo(d):null}))}function S(){this.L=100;this.B=this.H=0;this.j=Object.create(null)}S.prototype.has=function(a){return!!this.j[a]};S.prototype.get=function(a){var b=this.j[a];if(b)return b.access=++this.B,b.payload};S.prototype.put=function(a,b){this.has(a)||this.H++;this.j[a]={payload:b,access:this.B};if(!(this.H<=this.L)){a=this.j;var c,d=this.B+1;for(c in a){var e=a[c].access;if(e<d){d=e;var f=c}}void 0!==f&&(delete a[f],this.H--)}};v({c:!0,v:!0,a:!0,ad:!0});var T,U;function ra(a){T||(T=self.document.createElement("a"),U=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new S));var b=U,d=T;if(b&&b.has(a))a=b.get(a);else{d.href=a;d.protocol||(d.href=d.href);var c={href:d.href,protocol:d.protocol,host:d.host,hostname:d.hostname,port:"0"==d.port?"":d.port,pathname:d.pathname,search:d.search,hash:d.hash,origin:null};"/"!==c.pathname[0]&&(c.pathname="/"+c.pathname);if("http:"==c.protocol&&80==c.port||"https:"==c.protocol&&443==c.port)c.port="",c.host=c.hostname;c.origin=d.origin&&"null"!=d.origin?d.origin:"data:"!=c.protocol&&c.host?c.protocol+"//"+c.host:c.href;b&&b.put(a,c);a=c}return a}function V(a,b,d){var c=a.listeningFors;!c&&d&&(c=a.listeningFors=Object.create(null));a=c||null;if(!a)return a;var e=a[b];!e&&d&&(e=a[b]=[]);return e||null}function sa(a,b){a=V(a,"amp",!0);for(var d,c=0;c<a.length;c++){var e=a[c];if(e.frame===b){d=e;break}}d||(d={frame:b,events:Object.create(null)},a.push(d));return d.events}function ta(a){for(var b=v({sentinel:"unlisten"}),d=a.length-1;0<=d;d--){var c=a[d];if(!c.frame.contentWindow){a.splice(d,1);var f,e=c.events;for(f in e)e[f].splice(0,1/0).forEach((function(g){g(b)}))}}}function ua(a){a.listeningFors||a.addEventListener("message",(function(b){if(b.data){var d=va(b.data);if(d&&d.sentinel){var c=b.source;var e=V(a,d.sentinel);if(e){for(var f,g=0;g<e.length;g++){var k=e[g],m=k.frame.contentWindow;if(m){var h;if(!(h=c==m))b:{for(h=c;h&&h!=h.parent;h=h.parent)if(h==m){h=!0;break b}h=!1}if(h){f=k;break}}else setTimeout(ta,0,e)}c=f?f.events:null}else c=e;var y=c;if(y){var n=y[d.type];if(n)for(n=n.slice(),c=0;c<n.length;c++)(0,n[c])(d,b.source,b.origin,b)}}}}))}function wa(a,b){function d(k,m,h,y){if("amp"==k.sentinel){if(m!=a.contentWindow)return;var n="null"==h&&void 0;if(e!=h&&!n)return}m==a.contentWindow&&("unlisten"==k.sentinel?g():b(k,m,h,y))}var c=a.ownerDocument.defaultView;ua(c);c=sa(c,a);var e=ra(a.src).origin,f=c["send-consent-data"]||(c["send-consent-data"]=[]);f.push(d);var g=function(){if(d){var k=f.indexOf(d);-1<k&&f.splice(k,1);b=f=d=null}}}function va(a){"string"==typeof a&&(a="{"==a.charAt(0)?D(a,(function(b){B().warn("IFRAME-HELPER","Postmessage could not be parsed. Is it in a valid JSON format?",b)}))||null:E(a)?ha(a):null);return a}function W(a){a=AMP.BaseElement.call(this,a)||this;a.h=null;a.G="";a.C="";a.o="";a.K="";a.J=new K(a.element);return a}var X=AMP.BaseElement;W.prototype=p(X.prototype);W.prototype.constructor=W;if(u)u(W,X);else for(var Y in X)if("prototype"!=Y)if(Object.defineProperties){var Z=Object.getOwnPropertyDescriptor(X,Y);Z&&Object.defineProperty(W,Y,Z)}else W[Y]=X[Y];W.M=X.prototype;W.prototype.preconnectCallback=function(a){L(this.win,"preconnect").url(this.getAmpDoc(),this.o,a)};W.prototype.isLayoutSupported=function(a){return"fixed"==a||"fixed-height"==a||"responsive"==a||"fill"==a||"flex-item"==a||"fluid"==a||"intrinsic"==a};W.prototype.buildCallback=function(){this.element.classList.add("i-amphtml-media-component");this.G=C(this.element.getAttribute("data-pid"),"data-pid attribute is required for <amp-o2-player> %s",this.element);this.C=C(this.element.getAttribute("data-bcid"),"data-bcid attribute is required for <amp-o2-player> %s",this.element);var a=this.element.getAttribute("data-bid"),b=this.element.getAttribute("data-vid"),d=this.element.getAttribute("data-macros");this.o="https://delivery."+("stage"!=this.element.getAttribute("data-env")?"":"dev.")+"vidible.tv";var c=this.o+"/htmlembed/",e=[];c+="pid="+encodeURIComponent(this.G)+"/"+encodeURIComponent(this.C)+".html";a&&e.push("bid="+encodeURIComponent(a));b&&e.push("vid="+encodeURIComponent(b));d&&e.push(d);0<e.length&&(c+="?"+e.join("&"));this.K=c};W.prototype.layoutCallback=function(){var a=this;C(this.G,"data-pid attribute is required for <amp-o2-player> %s",this.element);C(this.C,"data-bcid attribute is required for <amp-o2-player> %s",this.element);var b=this.element.ownerDocument.createElement("iframe");b.setAttribute("frameborder","0");b.setAttribute("allowfullscreen","true");b.src=this.K;this.h=b;this.applyFillContent(b);wa(b,(function(d,c,e){xa(a,c,e)}));this.J.updatePlaying(!0);this.element.appendChild(b);return this.loadPromise(b)};W.prototype.unlayoutCallback=function(){var a=this.h;a&&(this.element.removeChild(a),this.h=null);this.J.updatePlaying(!1);return!0};function xa(a,b,d){var c=AMP.BaseElement.prototype.getConsentPolicy.call(a)||"default",e=ya(a,c),f=za(a,c);Promise.all([f,e]).then((function(g){switch(g[0]){case 1:var k={gdprApplies:!0,user_consent:1,gdprString:g[1]};break;case 2:case 4:k={gdprApplies:!0,user_consent:0,gdprString:g[1]};break;default:k={gdprApplies:!1}}var m=v({sentinel:"amp",type:"consent-data",consentData:k});b.postMessage(m,d)}))}function ya(a,b){return qa(a.element,void 0===b?"default":b)}function za(a,b){return pa(a.element,void 0===b?"default":b)}W.prototype.pauseCallback=function(){this.h&&this.h.contentWindow&&this.h.contentWindow.postMessage(JSON.stringify(v({method:"pause",value:this.o})),"*")};(function(a){a.registerElement("amp-o2-player",W)})(self.AMP)}});//# sourceMappingURL=amp-o2-player-0.1.js.map