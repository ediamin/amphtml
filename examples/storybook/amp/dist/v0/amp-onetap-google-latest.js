(self.AMP=self.AMP||[]).push({n:"amp-onetap-google",ev:"0.1",l:true,v:"2106040012000",m:0,f:function(AMP,_){"use strict";var m="function"==typeof Object.create?Object.create:function(a){function b(){}b.prototype=a;return new b};function q(a){for(var b=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global],c=0;c<b.length;++c){var d=b[c];if(d&&d.Math==Math)return}(function(){throw Error("Cannot find global object")})()}q(this);"function"===typeof Symbol&&Symbol("x");var r;if("function"==typeof Object.setPrototypeOf)r=Object.setPrototypeOf;else{var t;a:{var u={a:!0},v={};try{v.__proto__=u;t=v.a;break a}catch(a){}t=!1}r=t?function(a,b){a.__proto__=b;if(a.__proto__!==b)throw new TypeError(a+" is not extensible");return a}:null}var w=r;var x=Object.prototype.toString;function y(a){return a||{}}var z=self.AMP_CONFIG||{},A=("string"==typeof z.cdnProxyRegex?new RegExp(z.cdnProxyRegex):z.cdnProxyRegex)||/^https:\/\/([a-zA-Z0-9_-]+\.)?cdn\.ampproject\.org$/;function B(a){if(self.document&&self.document.head&&(!self.location||!A.test(self.location.origin))){var b=self.document.head.querySelector('meta[name="'+a+'"]');b&&b.getAttribute("content")}}z.cdnUrl||B("runtime-host");z.geoApiUrl||B("amp-geo-api");self.__AMP_LOG=self.__AMP_LOG||{user:null,dev:null,userForEmbed:null};var C=self.__AMP_LOG;function D(){if(!C.user)throw Error("failed to call initLogConstructor");return C.user}function aa(){var a=this;this.promise=new Promise((function(b,c){a.resolve=b;a.reject=c}))}function E(a,b){a=a.__AMP_TOP||(a.__AMP_TOP=a);return F(a,b)}function G(a,b){a=H(a);a=I(a);return J(a,b)?F(a,b):null}function H(a){return a.nodeType?E((a.ownerDocument||a).defaultView,"ampdoc").getAmpDoc(a):a}function I(a){a=H(a);return a.isSingleDoc()?a.win:a}function F(a,b){J(a,b);a=K(a)[b];a.obj||(a.obj=new a.ctor(a.context),a.context=null,a.resolve&&a.resolve(a.obj));return a.obj}function L(a){var b=K(a).subscriptions;if(b){if(b.promise)return b.promise;F(a,"subscriptions");return b.promise=Promise.resolve(b.obj)}return null}function K(a){var b=a.__AMP_SERVICES;b||(b=a.__AMP_SERVICES={});return b}function J(a,b){a=a.__AMP_SERVICES&&a.__AMP_SERVICES[b];return!(!a||!a.ctor)}function ba(){var a=new aa,b=a.promise,c=a.reject;a=a.resolve;b.catch((function(){}));return{obj:null,promise:b,resolve:a,reject:c,context:null,ctor:null}}var M,N="Webkit webkit Moz moz ms O o".split(" ");function O(a,b){void 0===b&&(b=a.hasAttribute("hidden"));b?a.removeAttribute("hidden"):a.setAttribute("hidden","")}
/* https://mths.be/cssescape v1.5.1 by @mathias | MIT license */
function ca(a){var b=L(I(a));if(b)return b;var c=H(a);return c.whenExtensionsKnown().then((function(){var d=c.getExtensionVersion("amp-subscriptions");return d?E(c.win,"extensions").waitForExtension("amp-subscriptions",d):null})).then((function(d){if(d){var g=I(a);var e=L(g);e?g=e:(g=K(g),g.subscriptions=ba(),g=g.subscriptions.promise)}else g=null;return g}))}function P(){this.D=100;this.A=this.B=0;this.j=Object.create(null)}P.prototype.has=function(a){return!!this.j[a]};P.prototype.get=function(a){var b=this.j[a];if(b)return b.access=++this.A,b.payload};P.prototype.put=function(a,b){this.has(a)||this.B++;this.j[a]={payload:b,access:this.A};if(!(this.B<=this.D)){a=this.j;var d,c=this.A+1;for(d in a){var g=a[d].access;if(g<c){c=g;var e=d}}void 0!==e&&(delete a[e],this.B--)}};y({c:!0,v:!0,a:!0,ad:!0});var Q,R;var S;function da(a,b,c){function d(f){try{return e(f)}catch(n){var h,l;null==(l=(h=self).__AMP_REPORT_ERROR)||l.call(h,n);throw n}}var g=a,e=c,k=ea();g.addEventListener(b,d,k?void 0:!1);return function(){var f;null==(f=g)||f.removeEventListener(b,d,k?void 0:!1);d=g=e=null}}function ea(){if(void 0!==S)return S;S=!1;try{var a={get capture(){S=!0}};self.addEventListener("test-options",null,a);self.removeEventListener("test-options",null,a)}catch(b){}return S}function T(a,b,c){return da(a,b,c)}function V(a){a=AMP.BaseElement.call(this,a)||this;a.h=null;a.C=!0;a.o=null;return a}var W=AMP.BaseElement;V.prototype=m(W.prototype);V.prototype.constructor=V;if(w)w(V,W);else for(var X in W)if("prototype"!=X)if(Object.defineProperties){var Y=Object.getOwnPropertyDescriptor(W,X);Y&&Object.defineProperty(V,X,Y)}else V[X]=W[X];V.F=W.prototype;V.prototype.isLayoutSupported=function(a){return"nodisplay"==a};V.prototype.buildCallback=function(){var a=this;this.getAmpDoc().whenFirstVisible().then((function(){var b=fa,c=a.element.dataset.src,d=a.element;var g=void 0===g?"source":g;var e=null!=c;D().assert(e,"%s %s must be available",d,g,void 0,void 0,void 0,void 0,void 0,void 0,void 0);e=c;if("string"==typeof e){Q||(Q=self.document.createElement("a"),R=self.__AMP_URL_CACHE||(self.__AMP_URL_CACHE=new P));var k=R,f=Q;if(k&&k.has(e))e=k.get(e);else{f.href=e;f.protocol||(f.href=f.href);var h={href:f.href,protocol:f.protocol,host:f.host,hostname:f.hostname,port:"0"==f.port?"":f.port,pathname:f.pathname,search:f.search,hash:f.hash,origin:null};"/"!==h.pathname[0]&&(h.pathname="/"+h.pathname);if("http:"==h.protocol&&80==h.port||"https:"==h.protocol&&443==h.port)h.port="",h.host=h.hostname;h.origin=f.origin&&"null"!=f.origin?f.origin:"data:"!=h.protocol&&h.host?h.protocol+"//"+h.host:h.href;k&&k.put(e,h);e=h}}(k="https:"==e.protocol||"localhost"==e.hostname||"127.0.0.1"==e.hostname)||(e=e.hostname,k=e.length-10,k=0<=k&&e.indexOf(".localhost",k)==k);e=k||/^(\/\/)/.test(c);D().assert(e,'%s %s must start with "https://" or "//" or be relative and served from either https or from localhost. Invalid value: %s',d,g,c,void 0,void 0,void 0,void 0,void 0,void 0);b(a,c)}))};function ha(a,b,c){a.postMessage(b,c)}function ia(a,b,c){if(a.h&&c.source==a.h.contentWindow&&c.origin===b){var d=c.data;if("[object Object]"===x.call(d)&&"onetap_google"==d.sentinel)switch(d.command){case"intermediate_iframe_ready":var g=d.nonce;if(!g)break;ha(c.source,y({sentinel:"onetap_google",command:"parent_frame_ready",nonce:g}),c.origin);break;case"intermediate_iframe_resize":var e=d.height;"number"===typeof e&&!isNaN(e)&&0<e&&a.mutateElement((function(){O(a.element,0<e);var f=a.h,h=d.height+"px";var l=f.style;if("height".startsWith("--"))l="height";else{M||(M=Object.create(null));var n=M.height;if(!n){n="height";if(void 0===l.height){var p;b:{for(p=0;p<N.length;p++){var U=N[p]+"Height";if(void 0!==l[U]){p=U;break b}}p=""}void 0!==l[p]&&(n=p)}M.height=n}l=n}l&&(l.startsWith("--")?f.style.setProperty(l,h):f.style[l]=h)}));break;case"intermediate_iframe_close":a.mutateElement((function(){Z(a)}));break;case"intermediate_iframe_done":a.mutateElement((function(){Z(a);ja(a)}));break;case"set_ui_mode":var k=d.mode;if(!k)break;ka(a,k);break;case"set_tap_outside_mode":a.C=!!d.cancel;break;default:if(C.dev)b=C.dev;else throw Error("failed to call initLogConstructor");b.warn("amp-onetap-google","Unknown action type: "+d.command)}}}function ka(a,b){a.mutateElement((function(){a.h.classList.add("i-amphtml-onetap-google-ui-"+b)}))}function ja(a){Promise.all([la(a),ma(a)]).then((function(b){b.reduce((function(c,d){return c||d}))||D().warn("amp-onetap-google","Sign-in was completed, but there were no entitlements to refresh. Please include amp-access or amp-subscriptions.")}))}function la(a){var b=a.getAmpDoc().getElementById("amp-access");if(!b)return!1;G(a.element,"action").execute(b,"refresh",null,null,null,null,2);return!0}function ma(a){return ca(a.element).then((function(b){if(!b)return!1;b.resetPlatforms();return!0}))}function fa(a,b){a.h||(a.h=a.getAmpDoc().win.document.createElement("iframe"),G(a.element,"url-replace").expandUrlAsync(b).then((function(c){a.win&&na(a,c)})))}function na(a,b){O(a.element,!1);var c=G(a.element,"url").parse(b).origin;a.o=[T(a.win,"message",(function(d){ia(a,c,d)})),T(a.getAmpDoc().getRootNode(),"click",(function(){a.C&&!a.element.hasAttribute("hidden")&&Z(a)}))];a.h.classList.add("i-amphtml-onetap-google-iframe");a.h.src=b;a.element.appendChild(a.h);a.getViewport().addToFixedLayer(a.h)}function Z(a){if(a.h){O(a.element,!1);var b=a.h;b.parentElement&&b.parentElement.removeChild(b);a.h=null;if(a.o)for(;0<a.o.length;)a.o.pop()()}}(function(a){a.registerElement("amp-onetap-google",V,".i-amphtml-onetap-google-iframe{z-index:2147483647;border:none;position:fixed}.i-amphtml-onetap-google-ui-card{width:391px;right:20px;top:20px}.i-amphtml-onetap-google-ui-bottom_sheet{right:auto;left:0;top:auto;bottom:0;width:100%}\n/*# sourceURL=/extensions/amp-onetap-google/0.1/amp-onetap-google.css*/")})(self.AMP)}});//# sourceMappingURL=amp-onetap-google-0.1.js.map